{"version":3,"sources":["utils/pointUtils.ts","config.ts","components/Sidebar/EditableTable/style.ts","components/Sidebar/EditableTable/TableHeader.tsx","components/Sidebar/EditableTable/cells/DropDownTableCell.tsx","components/Sidebar/style.ts","components/Sidebar/EditableInput.tsx","components/Sidebar/EditableStringInput.tsx","components/Sidebar/EditableTable/cells/TextTableCell.tsx","components/Sidebar/EditableNumberInput.tsx","components/Sidebar/EditableTable/cells/NumericalTableCell.tsx","components/Sidebar/EditableTable/cells/BooleanTableCell.tsx","components/Sidebar/EditableTable/TableCell.tsx","components/Sidebar/EditableTable/hooks/useSortableTable.ts","components/Sidebar/EditableTable/NodeTable/NodeTable.tsx","components/Sidebar/EditableTable/ConnectionTable/ConnectionTable.tsx","components/Tabs/Tabs.tsx","components/Sidebar/ModelControls.tsx","components/Sidebar/Sidebar.tsx","components/Plot/LinePlot.tsx","components/Plot/Plot.tsx","components/Canvas/canvasUtils.ts","hooks/useLocalStorageState.ts","components/Canvas/hooks/usePanZoomCanvas.ts","components/Canvas/Controls.tsx","components/Canvas/Canvas.tsx","components/Canvas/hooks/useOnClickCanvas.ts","hooks/useDoubleClick.ts","hooks/useAddConnection.ts","hooks/useMultiSelect.ts","hooks/useOnMouseDown.ts","hooks/useMoveNode.ts","default.ts","App.tsx","hooks/useModelUtils.ts","hooks/useKeyDown.ts","hooks/useDraw.ts","components/Canvas/hooks/useWindowSize.ts","utils/scrollBar.ts","index.tsx"],"names":["ORIGIN","Object","freeze","x","y","diffPoints","p1","p2","scalePoint","scale","config","defaultTempDegC","defaultCapJPerDegK","defaultPowerGenW","canvasHeightPerc","editorWidthPerc","defaultTotalTimeSeconds","defaultTimeStepSeconds","defaultNodeRadius","defaultResistanceDegKPerW","defaultConnectionKind","newNodeNamePrefix","zoomSensitivity","minZoom","maxZoom","activeNodeOutlineWidth","tabHeightPx","plotHeightBufferPx","tableDeleteCellWidthPerc","tableDeleteCellMinWidthPx","plotMargin","left","right","top","bottom","StyledTableWrapper","styled","div","StyledTable","StyledTableBody","StyledRow","heightOffsetPx","isActive","StyledCell","width","minWidth","StyledDeleteCell","StyledHeaderWrapper","StyledColHeader","StyledColText","StyledSortIcon","TableHeader","props","columns","sortState","setSortState","sortIcon","direction","map","col","isSortedCol","key","onClick","sortDirection","minWidthPx","text","toString","style","cursor","StyledSelect","select","DropDownTableCell","value","setOption","id","onChange","event","newVal","target","selectedOption","options","find","option","undefined","onSelectOption","rowId","StyledInput","input","EditableInput","useState","initialValue","setValue","onBlur","getNewValue","handleOnBlur","useCallback","type","EditableStringInput","TextTableCell","initialVal","getFloatVal","newValueText","newValueFloat","parseFloat","isNaN","EditableNumberInput","NumericalTableCell","StyledCheckbox","BooleanTableCell","initialIsActive","setIsActive","tabIndex","onKeyUp","showWhenActive","TableCell","row","initiallySetOption","onUpdateRow","length","useSortableTable","default","first","second","defaultNodeSortState","nodeColumns","NodeTable","sortByState","rows","onDeleteRow","tableRows","sort","tableCell","defaultConnectionSortState","connectionTypes","filterConnectionOptions","colKey","selectedSourceId","selectedTargetId","connections","otherConnections","filter","conn","source","some","c","ConnectionTable","onSelectNewSource","connection","newSourceNode","nodes","node","sourceName","name","onSelectNewTarget","newTargetNode","targetName","onSelectNewConnectionType","rowToUpdate","kind","nodeOptions","connectionColumns","useMemo","activeNodeIds","includes","StyledTabsWrapper","StyledTabs","StyledTab","StyledTabText","StyledInnerContent","Tabs","activeIdx","setActiveIdx","tabs","tab","idx","className","topLeftRounded","_","component","StyledModelControlsWrapper","StyledRunButton","button","StyledTimeControls","StyledTimeControl","StyledInputWrapper","StyledLabel","label","ModelControls","onRunModel","timing","setTiming","totalTimeS","newTotalTimeS","prevTiming","timeStepS","newTimeStepS","StyledEditor","height","StyledTables","Sidebar","nodeTable","updateNodes","deleteNodes","connectionTable","updateConnections","deleteConnections","LinePlot","plotDimensions","plotData","lines","xAxisKey","xLabel","yLabel","ResponsiveContainer","LineChart","margin","data","CartesianGrid","strokeDasharray","XAxis","dataKey","position","dy","YAxis","angle","dx","Tooltip","Legend","layout","verticalAlign","align","wrapperStyle","paddingLeft","colors","StyledCharts","StyledPlot","plotShape","lowerMag","Math","floor","log10","divisibleBy","pow","includeAll","timeSeriesS","tempsAtAllTimes","heatTransfersAtAllTimes","forEach","t","val","abs","temp","time","ht","nodeResults","nodeResult","tempDegC","connectionResults","connectionResult","heatTransferW","push","Plot","res","modelOutput","emptyOutput","tempPlotData","heatTransferPlotData","heatTransferLines","Line","stroke","activeDot","r","isAnimationActive","tempLines","tempPlot","heatTransferPlot","activeNodeStrokeWidth","drawNode","context","center","radius","isBoundary","textDirection","color","save","beginPath","arc","PI","fillStyle","fill","closePath","restore","drawCircle","lineWidth","strokeStyle","drawCircleOutline","translate","rotate","moveTo","lineTo","h","newRadius","sin","acos","drawHashPattern","font","textMetrics","measureText","fillText","actualBoundingBoxAscent","actualBoundingBoxDescent","drawNodeName","drawConnection","start","end","startOffset","endOffset","headLength","headWidth","arrowGap","atan2","adjLength","sqrt","drawBidirectionalArrow","drawUnidirectionalArrow","intersectsCircle","point","circleCenter","deltaX","deltaY","calculateCanvasMouse","canvas","viewportMousePos","pageX","pageY","boundingRect","getBoundingClientRect","mouseToNodeCoords","canvasState","canvasMouse","mouse","offset","useLocalStorageState","defaultValue","React","localState","window","localStorage","getItem","JSON","parse","setItem","stringify","StyledButtons","StyledButton","Controls","setView","savedCanvasState","setSavedCanvasState","StyledCanvasWrapper","StyledCanvas","cssWidth","cssHeight","Canvas","ref","onClickCanvas","canvasWidth","canvasHeight","devicePixelRatio","draw","onMouseDown","handleDoubleClick","setKeyboardActive","canvasRef","useRef","useEffect","handleClickOutside","keyBoardActive","current","contains","document","addEventListener","removeEventListener","setContext","setScale","setOffset","mousePosRef","lastMousePosRef","mouseMove","newMousePos","mouseDiff","prevOffset","mouseUp","startPan","useLayoutEffect","handleWheel","preventDefault","zoom","newScale","mouseOffset","canvasElem","usePanZoomCanvas","renderCtx","getContext","onDoubleClick","useAddConnection","appNodes","appConnections","setAppConnections","clearAndRedraw","drawConnectionBeingMade","clickedNode","nodeCoordsOfMouse","drawArrowWithoutHead","drawConnWrapper","mouseUpOnNode","newConnection","makeConnection","resistanceDegKPerW","useMultiSelect","setActiveNodes","boxStart","drawBox","globalAlpha","fillRect","rect","boxEnd","startBox","endBox","topLeft","bottomRight","bottomLeft","topRight","isInsideBox","useOnMouseDown","clearActiveNodes","makeNewConnection","moveNode","movedRef","activeNodes","offsetMouseToCenter","shiftKeyPressed","shiftKey","newClickedCenter","newClickedNode","newActiveNodes","distanceFromClickedCenter","useMoveNode","multiSelect","defaultBehavior","altKey","test1","makeNode","temperatureDegC","capacitanceJPerDegK","powerGenW","test2","defaultNodes","defaultConnections","StyledApp","StyledWorkspace","App","setModelOutput","setAppNodes","addNode","prevNodes","newNodes","nodesToUpdate","newNode","prevConns","prevConn","nodeToUpdate","nodeIds","connsToUpdate","connIdsToUpdate","oldConns","connIds","useModelUtils","keyboardActive","onKeyDown","metaKey","keyCode","useKeyDown","sourceAppNode","targetAppNode","clearRect","useDraw","doubleClickedNode","numNewNodes","startsWith","newAppNode","useDoubleClick","size","setSize","ratio","setRatio","updateSize","innerWidth","innerHeight","updateRatio","useWindowSize","windowWidth","windowHeight","workspaceWidth","workspaceHeight","plotHeight","plotWidth","editorWidth","output","run","errors","error","console","message","scrollableElem","createElement","innerElem","overflow","borderWidth","appendChild","body","diff","offsetWidth","clientWidth","removeChild","areScrollbarsVisible","classList","add","ReactDOM","render","getElementById"],"mappings":"uMAKaA,EAASC,OAAOC,OAAO,CAAEC,EAAG,EAAGC,EAAG,IAUxC,SAASC,EAAWC,EAAWC,GACpC,MAAO,CAAEJ,EAAGG,EAAGH,EAAII,EAAGJ,EAAGC,EAAGE,EAAGF,EAAIG,EAAGH,GAGjC,SAASI,EAAWF,EAAWG,GACpC,MAAO,CAAEN,EAAGG,EAAGH,EAAIM,EAAOL,EAAGE,EAAGF,EAAIK,GClBtC,IA4BeC,EA5BA,CACbC,gBAAiB,GACjBC,mBAAoB,EACpBC,iBAAkB,EAClBC,iBAAkB,GAClBC,gBAAiB,GACjBC,wBAAyB,GACzBC,uBAAwB,GACxBC,kBAAmB,GACnBC,0BAA2B,GAC3BC,sBAAuB,KACvBC,kBAAmB,WACnBC,gBAAiB,IACjBC,QAAS,IACTC,QAAS,EACTC,uBAAwB,EACxBC,YAAa,GACbC,mBAAoB,GACpBC,yBAA0B,GAC1BC,0BAA2B,GAC3BC,WAAY,CACVC,KAAM,GACNC,MAAO,GACPC,IAAK,GACLC,OAAQ,KCxBCC,EAAqBC,IAAOC,IAAV,+EAAGD,CAAH,iBAIlBE,EAAcF,IAAOC,IAAV,wEAAGD,CAAH,0CAKXG,EAAkBH,IAAOC,IAAV,4EAAGD,CAAH,iBAIfI,EAAYJ,IAAOC,IAAV,sEAAGD,CAAH,mGAQb,gBAAGK,EAAH,EAAGA,eAAH,OACLA,EAAc,UAAMA,EAAN,MAA2B,SAC7B,qBAAGC,SACJ,2BAA6B,UAG/BC,EAAaP,IAAOC,IAAV,uEAAGD,CAAH,6HAMZ,gBAAGQ,EAAH,EAAGA,MAAH,gBAA0B,IAARA,EAAlB,QACI,gBAAGC,EAAH,EAAGA,SAAH,OAAqBA,EAAF,UAAgBA,EAAhB,MAA+B,UAGpDC,EAAmBV,YAAOO,GAAV,6EAAGP,CAAH,+EAUhBW,EAAsBX,IAAOC,IAAV,gFAAGD,CAAH,4EAKvB,gBAAGK,EAAH,EAAGA,eAAH,OACLA,EAAc,UAAMA,EAAN,MAA2B,SAIhCO,EAAkBZ,IAAOC,IAAV,4EAAGD,CAAH,yOAEjB,gBAAGQ,EAAH,EAAGA,MAAH,gBAA0B,IAARA,EAAlB,QACI,gBAAGC,EAAH,EAAGA,SAAH,OAAqBA,EAAF,UAAgBA,EAAhB,MAA+B,UAYpDI,EAAgBb,IAAOC,IAAV,0EAAGD,CAAH,kCAKbc,EAAiBd,IAAOC,IAAV,2EAAGD,CAAH,oE,OC3DZ,SAASe,EACtBC,GAEA,IAAQC,EAAqCD,EAArCC,QAASC,EAA4BF,EAA5BE,UAAWC,EAAiBH,EAAjBG,aAEtBC,EAAYF,EAEU,QAAxBA,EAAUG,UACV,SACA,SAHA,GAKJ,OACE,eAACV,EAAD,CAAqBN,eAAgB/B,EAAOgB,YAA5C,UACG2B,EAAQK,KAAI,SAACC,GACZ,IAAMC,EAAcN,GAAaA,EAAUO,MAAQF,EAAIE,IAWvD,OACE,eAACb,EAAD,CAEEc,QAbY,WAnBxB,IAA+BC,EAoBrBR,EAAa,CACXM,IAAKF,EAAIE,IACTJ,UACGG,GAAgBN,GAvBAS,EAyBST,EAAUG,UAxBvB,QAAlBM,EAA0B,OAAS,OAuB1B,SASNnB,MAAOe,EAAIf,MACXC,SAAUc,EAAIK,WAJhB,UAME,cAACf,EAAD,UAAgBU,EAAIM,OACpB,cAACf,EAAD,UAAiBU,EAAcJ,EAAW,OANrCG,EAAIE,IAAIK,eAUnB,cAAClB,EAAD,CACEJ,MAAOlC,EAAOkB,yBACdiB,SAAUnC,EAAOmB,0BACjBsC,MAAO,CAAEC,OAAQ,c,mBCxDnBC,EAAejC,IAAOkC,OAAV,qFAAGlC,CAAH,kEAeH,SAASmC,EACtBnB,GACqB,IAAD,EAWpB,OACE,cAACiB,EAAD,CAAcG,MAAK,UAAEpB,EAAMqB,iBAAR,aAAE,EAAiBC,GAAIC,SAX5C,SAAsBC,GACpB,IAAMC,EAASD,EAAME,OAAON,MAEtBO,EAAiB3B,EAAM4B,QAAQC,MAAK,SAACC,GAAD,OAAYA,EAAOR,KAAOG,UAE7CM,IAAnBJ,GACF3B,EAAMgC,eAAehC,EAAMiC,MAAON,IAKpC,SACG3B,EAAM4B,QAAQtB,KAAI,SAACwB,GAAD,OACjB,wBAAwBV,MAAOU,EAAOR,GAAtC,SACGQ,EAAOjB,MADGiB,EAAOR,SCjCrB,IAAMY,EAAclD,IAAOmD,MAAV,yEAAGnD,CAAH,uMCWT,SAASoD,EACtBpC,GAEA,MAA0BqC,mBAAiBrC,EAAMsC,aAAaxB,YAA9D,mBAAOM,EAAP,KAAcmB,EAAd,KAEQD,EAAsCtC,EAAtCsC,aAAcE,EAAwBxC,EAAxBwC,OAAQC,EAAgBzC,EAAhByC,YAS9B,IAAMC,EAAeC,uBACnB,SAACnB,GACC,IAAMC,EAASgB,EAAYjB,GACvBA,EAAME,OAAON,QAAUkB,EAAaxB,kBAElBiB,IAAXN,GACTc,EAASd,EAAOX,YAChB0B,EAAOf,KAEPc,EAASD,EAAaxB,YACtB0B,EAAOF,OAGX,CAACG,EAAaH,EAAcE,IAG9B,OACE,cAACN,EAAD,CACEU,KAAK,OACLxB,MAAOA,EACPG,SA3BJ,SAAwBC,GACtB,IAAMC,EAASD,EAAME,OAAON,WACbW,IAAXN,GACFc,EAASd,IAyBTe,OAAQE,ICxCC,SAASG,EACtB7C,GAEA,OACE,cAACoC,EAAD,CACEE,aAActC,EAAMsC,aACpBE,OAAQxC,EAAMwC,OACdC,YAAa,SAACjB,GAAD,OACXA,EAAME,OAAON,SCRN,SAAS0B,EACtB9C,GAEA,OACE,cAAC6C,EAAD,CACEP,aAActC,EAAM+C,WACpBP,OAAQxC,EAAMwC,SCXpB,SAASQ,EACPxB,GAEA,IAAMyB,EAAezB,EAAME,OAAON,MAE5B8B,EAAgBC,WAAW3B,EAAME,OAAON,OAC9C,QAAqBW,IAAjBkB,IAA8BG,MAAMF,GAGxC,OAAOA,EAQM,SAASG,EACtBrD,GAEA,OACE,cAACoC,EAAD,CACEE,aAActC,EAAMsC,aACpBE,OAAQxC,EAAMwC,OACdC,YAAaO,ICnBJ,SAASM,EACtBtD,GAEA,OACE,cAACqD,EAAD,CACEf,aAActC,EAAM+C,WACpBP,OAAQxC,EAAMwC,SCXpB,IAAMe,EAAiBvE,IAAOC,IAAV,uFAAGD,CAAH,2HAgBL,SAASwE,EACtBxD,GAEA,MAAgCqC,wBACJN,IAA1B/B,EAAMyD,iBAAgCzD,EAAMyD,iBAD9C,mBAAOnE,EAAP,KAAiBoE,EAAjB,KAIA,OACE,eAACH,EAAD,CACEI,SAAU,EACVC,QAAS,SAACpC,GACU,UAAdA,EAAMf,MACRiD,GAAapE,GACbU,EAAMU,SAASpB,KAGnBoB,QAAS,WACPgD,GAAapE,GACbU,EAAMU,SAASpB,IAVnB,iBAaSA,EAAWU,EAAM6D,eAAiB,MCrBhC,SAASC,EACtB9D,GAEA,IAAQ+D,EAAuD/D,EAAvD+D,IAAKxD,EAAkDP,EAAlDO,IAAKqB,EAA6C5B,EAA7C4B,QAASoC,EAAoChE,EAApCgE,mBAAoBC,EAAgBjE,EAAhBiE,YACzClB,EAAagB,EAAIxD,EAAIE,KAE3B,OAAMmB,GAAWA,EAAQsC,OAAS,GAAK3D,EAAIyB,eAEvC,cAACb,EAAD,CACEc,MAAO8B,EAAIzC,GACXM,QAASA,EACTP,UAAW2C,EACXhC,eAAgBzB,EAAIyB,iBAGO,kBAAfe,EAEd,cAACD,EAAD,CACEC,WAAYA,EACZP,OAAQ,SAACf,GAAD,OAAYwC,EAAY,2BAAKF,GAAN,kBAAYxD,EAAIE,IAAMgB,QAInC,kBAAfsB,GACiB,kBAAjBgB,EAAIxD,EAAIE,KAGb,cAAC6C,EAAD,CACEP,WAAYA,EACZP,OAAQ,SAACf,GAAD,OAAYwC,EAAY,2BAAKF,GAAN,kBAAYxD,EAAIE,IAAMgB,QAG1B,mBAAfsB,EAEd,cAACS,EAAD,CACEC,gBAAiBV,EACjBrC,QAAS,SAACe,GAAD,OAAYwC,EAAY,2BAAKF,GAAN,kBAAYxD,EAAIE,IAAMgB,MACtDoC,eAAgB,WAIb,6BCzDI,SAASM,EAAoBnE,GAO1C,MAAkCqC,mBAA4BrC,EAAMoE,SAApE,mBAAOlE,EAAP,KAAkBC,EAAlB,KAUA,MAAO,CAACD,EAAWC,EARnB,SAAqBkE,EAAUC,GAC7B,OAAID,EAAMnE,EAAUO,KAAO6D,EAAOpE,EAAUO,KACX,QAAxBP,EAAUG,UAAsB,GAAK,EAEb,QAAxBH,EAAUG,WAAuB,EAAI,ICElD,IAAMkE,EAAgD,CACpD9D,IAAK,OACLJ,UAAW,OAGPmE,EAAiC,CACrC,CACE/D,IAAK,OACLI,KAAM,OACNrB,MAAO,GACPoB,WAAY,KAEd,CACEH,IAAK,kBACLI,KAAM,YACNrB,MAAO,GACPoB,WAAY,KAEd,CACEH,IAAK,sBACLI,KAAM,qBACNrB,MAAO,GACPoB,WAAY,KAEd,CACEH,IAAK,YACLI,KAAM,cACNrB,MAAO,IACPoB,WAAY,IAEd,CACEH,IAAK,aACLI,KAAM,YACNrB,MAAO,IACPoB,WAAY,KAUD,SAAS6D,EAAUzE,GAChC,MAA+CmE,EAA0B,CACvEC,QAASG,IADX,mBAAOrE,EAAP,KAAkBC,EAAlB,KAAgCuE,EAAhC,KAIQC,EAAmC3E,EAAnC2E,KAAMV,EAA6BjE,EAA7BiE,YAAaW,EAAgB5E,EAAhB4E,YAIrBC,EAFaF,EAAKG,KAAKJ,GAEApE,KAAI,SAACyD,GAChC,OACE,eAAC3E,EAAD,CAEEC,eAAgB/B,EAAOgB,YACvBgB,SAAUyE,EAAIzE,SAHhB,UAKGkF,EAAYlE,KAAI,SAACC,GAChB,IAAMwE,EACJ,cAACjB,EAAD,CAAoBC,IAAKA,EAAKxD,IAAKA,EAAK0D,YAAaA,IAEvD,OACE,cAAC1E,EAAD,CAEEC,MAAOe,EAAIf,MACXC,SAAUc,EAAIK,WAHhB,SAKGmE,GAJIxE,EAAIE,QAQf,cAACf,EAAD,CACEiE,SAAU,EACVC,QAAS,SAACpC,GACU,UAAdA,EAAMf,KACRmE,EAAYb,IAGhBvE,MAAOlC,EAAOkB,yBACdiB,SAAUnC,EAAOmB,0BACjBiC,QAAS,kBAAMkE,EAAYb,IAT7B,sBAlBKA,EAAIzC,OAmCf,OACE,cAACvC,EAAD,UACE,eAACG,EAAD,WACE,cAACa,EAAD,CACEE,QAASuE,EACTtE,UAAWA,EACXC,aAAcA,IAEhB,cAAChB,EAAD,UAAkB0F,SCjG1B,IAAMG,EAAiE,CACrEvE,IAAK,aACLJ,UAAW,OAGP4E,EAAgC,CACpC,CACE3D,GAAI,KACJT,KAAM,iBAER,CACES,GAAI,MACJT,KAAM,kBAER,CACES,GAAI,MACJT,KAAM,cAIV,SAASqE,EACPC,EACAvD,EACAwD,EACAC,EACAC,GAEA,IAAMC,EAAmBD,EAAYE,QACnC,SAACC,GAAD,QAEIA,EAAKC,OAAOpE,KAAO8D,GACnBK,EAAK/D,OAAOJ,KAAO+D,MAIzB,MAAe,eAAXF,EAE8BvD,EAAQ4D,QACtC,SAAC1D,GAAD,OAAYA,EAAOR,KAAO+D,KAGGG,QAAO,SAAC1D,GACrC,OAAQyD,EAAiBI,MACvB,SAACC,GAAD,OACGA,EAAEF,OAAOpE,KAAOQ,EAAOR,IAAMsE,EAAElE,OAAOJ,KAAO+D,GAC7CO,EAAEF,OAAOpE,KAAO+D,GAAoBO,EAAElE,OAAOJ,KAAOQ,EAAOR,SAG9C,eAAX6D,EAEuBvD,EAAQ4D,QACtC,SAAC1D,GAAD,OAAYA,EAAOR,KAAO8D,KAGGI,QAAO,SAAC1D,GACrC,OAAQyD,EAAiBI,MACvB,SAACC,GAAD,OACGA,EAAEF,OAAOpE,KAAO8D,GAAoBQ,EAAElE,OAAOJ,KAAOQ,EAAOR,IAC3DsE,EAAEF,OAAOpE,KAAOQ,EAAOR,IAAMsE,EAAElE,OAAOJ,KAAO8D,QAI7CxD,EAWI,SAASiE,EACtB7F,GAEA,MACEmE,EAAqC,CACnCC,QAASY,IAFb,mBAAO9E,EAAP,KAAkBC,EAAlB,KAAgCuE,EAAhC,KAKMoB,EAAoBnD,uBACxB,SAACrB,EAAYQ,GACX,IAAMiE,EAAa/F,EAAM2E,KAAK9C,MAAK,SAAC4D,GAAD,OAAUA,EAAKnE,KAAOA,KACnD0E,EAAgBhG,EAAMiG,MAAMpE,MAAK,SAACqE,GAAD,OAAUA,EAAK5E,KAAOQ,EAAOR,MAEjEyE,GACAC,GACDA,EAAc1E,KAAOyE,EAAWrE,OAAOJ,IAIzCtB,EAAMiE,YAAN,2BACK8B,GADL,IAEEL,OAAQM,EACRG,WAAYH,EAAcI,UAG9B,CAACpG,IAGGqG,EAAoB1D,uBACxB,SAACrB,EAAYQ,GACX,IAAMiE,EAAa/F,EAAM2E,KAAK9C,MAAK,SAAC4D,GAAD,OAAUA,EAAKnE,KAAOA,KACnDgF,EAAgBtG,EAAMiG,MAAMpE,MAAK,SAACqE,GAAD,OAAUA,EAAK5E,KAAOQ,EAAOR,MAEjEyE,GACAO,GACDA,EAAchF,KAAOyE,EAAWL,OAAOpE,IAIzCtB,EAAMiE,YAAN,2BACK8B,GADL,IAEErE,OAAQ4E,EACRC,WAAYD,EAAcF,UAG9B,CAACpG,IAGGwG,EAA4B7D,uBAChC,SAACrB,EAAYQ,GACX,IAAM2E,EAAczG,EAAM2E,KAAK9C,MAAK,SAAC4D,GAAD,OAAUA,EAAKnE,KAAOA,KACtDmF,GACFzG,EAAMiE,YAAN,2BACKwC,GADL,IAEEC,KAAM5E,EAAOR,QAInB,CAACtB,IAGG2G,EAA4B3G,EAAMiG,MAAM3F,KAAI,SAAC4F,GAAD,MAAW,CAC3D5E,GAAI4E,EAAK5E,GACTT,KAAMqF,EAAKE,SAGPQ,EAA6CC,mBACjD,iBAAM,CACJ,CACEhG,KAAM,SACNJ,IAAK,aACLjB,MAAO,IACPoB,WAAY,IACZgB,QAAS+E,EACT3E,eAAgB8D,GAElB,CACEjF,KAAM,SACNJ,IAAK,aACLjB,MAAO,IACPoB,WAAY,IACZgB,QAAS+E,EACT3E,eAAgBqE,GAElB,CACExF,KAAM,oBACNJ,IAAK,qBACLjB,MAAO,IACPoB,WAAY,KAEd,CACEC,KAAM,OACNJ,IAAK,OACLjB,MAAO,IACPoB,WAAY,IACZgB,QAASqD,EACTjD,eAAgBwE,MAGpB,CACEG,EACAH,EACAV,EACAO,IAIES,EAAgB9G,EAAMiG,MACzBT,QAAO,SAACU,GAAD,OAAUA,EAAK5G,YACtBgB,KAAI,SAAC4F,GAAD,OAAUA,EAAK5E,MAahBuD,EAX+C7E,EAAM2E,KACxDrE,KAAI,SAACyD,GACJ,OAAO,2BACFA,GADL,IAEEzE,SACEwH,EAAcC,SAAShD,EAAI2B,OAAOpE,KAClCwF,EAAcC,SAAShD,EAAIrC,OAAOJ,SAGvCwD,KAAKJ,GAEiCpE,KAAI,SAACyD,GAC5C,OACE,eAAC3E,EAAD,CAEEC,eAAgB/B,EAAOgB,YACvBgB,SAAUyE,EAAIzE,SAHhB,UAKGsH,EAAkBtG,KAAI,SAACC,GAAS,IAAD,EACxBwE,EACJ,cAACjB,EAAD,CACEC,IAAKA,EACLxD,IAAKA,EACLqB,QAASsD,EACP3E,EAAIE,IACJF,EAAIqB,SAAW,GACfmC,EAAI2B,OAAOpE,GACXyC,EAAIrC,OAAOJ,GACXtB,EAAM2E,MAERX,mBAAkB,UAAEzD,EAAIqB,eAAN,aAAE,EAAaC,MAC/B,SAACC,GAAD,OACEA,EAAOR,KAAOyC,EAAIxD,EAAIE,MAAQqB,EAAOjB,OAASkD,EAAIxD,EAAIE,QAE1DwD,YAAajE,EAAMiE,cAGvB,OACE,cAAC1E,EAAD,CAEEC,MAAOe,EAAIf,MACXC,SAAUc,EAAIK,WAHhB,SAKGmE,GAJIxE,EAAIE,QAQf,cAACf,EAAD,CACEF,MAAOlC,EAAOkB,yBACdiB,SAAUnC,EAAOmB,0BACjBiC,QAAS,kBAAMV,EAAM4E,YAAYb,IAHnC,sBAjCKA,EAAIzC,OA4Cf,OACE,cAACvC,EAAD,UACE,eAACG,EAAD,WACE,cAACa,EAAD,CACEE,QAAS2G,EACT1G,UAAWA,EACXC,aAAcA,IAEhB,cAAChB,EAAD,UAAkB0F,SC1Q1B,IAAMmC,EAAoBhI,IAAOC,IAAV,8EAAGD,CAAH,2FAQjBiI,EAAajI,IAAOC,IAAV,uEAAGD,CAAH,uJAGJ1B,EAAOgB,aASb4I,EAAYlI,IAAOC,IAAV,sEAAGD,CAAH,qNAEJ,gBAAGQ,EAAH,EAAGA,MAAH,gBAA0B,IAARA,EAAlB,QAqBL2H,EAAgBnI,IAAOC,IAAV,0EAAGD,CAAH,qEASboI,EAAqBpI,IAAOC,IAAV,+EAAGD,CAAH,yCAeT,SAASqI,EAAKrH,GAC3B,MAAkCqC,mBAAS,GAA3C,mBAAOiF,EAAP,KAAkBC,EAAlB,KAEA,OACE,eAACP,EAAD,WACGhH,EAAMwH,KAAKtD,OAAS,GACnB,cAAC+C,EAAD,UACGjH,EAAMwH,KAAKlH,KAAI,SAACmH,EAAKC,GACpB,OACE,cAACR,EAAD,CAEExG,QAAS,kBAAM6G,EAAaG,IAC5BlI,MAAOiI,EAAIjI,MAHb,SAKE,cAAC2H,EAAD,CAAeQ,UAAWD,IAAQJ,EAAY,SAAW,GAAzD,SACGG,EAAI5G,QALF4G,EAAI5G,WAanB,cAACuG,EAAD,CAAoBQ,eAAgB5H,EAAMwH,KAAKtD,QAAU,EAAzD,SACGlE,EAAMwH,KAAKhC,QAAO,SAACqC,EAAGH,GAAJ,OAAYA,IAAQJ,KAAW,GAAGQ,eC1F7D,IAAMC,GAA6B/I,IAAOC,IAAV,gGAAGD,CAAH,qJAW1BgJ,GAAkBhJ,IAAOiJ,OAAV,qFAAGjJ,CAAH,MAEfkJ,GAAqBlJ,IAAOC,IAAV,wFAAGD,CAAH,MAElBmJ,GAAoBnJ,IAAOC,IAAV,uFAAGD,CAAH,4FAQjBoJ,GAAqBpJ,IAAOC,IAAV,wFAAGD,CAAH,iCAKlBqJ,GAAcrJ,IAAOsJ,MAAV,iFAAGtJ,CAAH,yBAUF,SAASuJ,GACtBvI,GAEA,IAAQwI,EAAkCxI,EAAlCwI,WAAYC,EAAsBzI,EAAtByI,OAAQC,EAAc1I,EAAd0I,UAE5B,OACE,eAACX,GAAD,WACE,eAACG,GAAD,WACE,eAACC,GAAD,WACE,cAACE,GAAD,4BACA,cAACD,GAAD,UACE,cAAC/E,EAAD,CACEf,aAAcmG,EAAOE,WACrBnG,OAAQ,SAACoG,GAAD,OACNF,GAAU,SAACG,GAAD,mBAAC,eACNA,GADK,IAERF,WAAYC,eAMtB,eAACT,GAAD,WACE,cAACE,GAAD,6BACA,cAACD,GAAD,UACE,cAAC/E,EAAD,CACEf,aAAcmG,EAAOK,UACrBtG,OAAQ,SAACuG,GAAD,OACNL,GAAU,SAACG,GAAD,mBAAC,eACNA,GADK,IAERC,UAAWC,kBAOvB,cAACf,GAAD,CAAiBtH,QAAS8H,EAA1B,0BCxEN,IAAMQ,GAAehK,IAAOC,IAAV,4EAAGD,CAAH,2DACN,SAACgB,GAAD,OAAWA,EAAMiJ,UAClB,SAACjJ,GAAD,OAAWA,EAAMR,SAItB0J,GAAelK,IAAOC,IAAV,4EAAGD,CAAH,gDAMZ+I,GAA6B/I,IAAOC,IAAV,0FAAGD,CAAH,qCAoBjB,SAASmK,GAAQnJ,GAC9B,IAAMoJ,EACJ,cAAC3E,EAAD,CACEE,KAAM3E,EAAMiG,MACZhC,YAAa,SAACiC,GAAD,OAAmBlG,EAAMqJ,YAAY,CAACnD,IAAO,IAC1DtB,YAAa,SAACsB,GAAD,OAAmBlG,EAAMsJ,YAAY,CAACpD,EAAK5E,QAItDiI,EACJ,cAAC1D,EAAD,CACElB,KAAM3E,EAAMsF,YACZW,MAAOjG,EAAMiG,MACbhC,YAAa,SAAC8B,GAAD,OACX/F,EAAMwJ,kBAAkB,CAACzD,KAE3BnB,YAAa,SAACmB,GAAD,OACX/F,EAAMyJ,kBAAkB,CAAC1D,EAAWzE,QAK1C,OACE,eAAC0H,GAAD,CAAcxJ,MAAOQ,EAAMR,MAAOyJ,OAAQjJ,EAAMiJ,OAAhD,UACE,cAACC,GAAD,UACE,cAAC7B,EAAD,CACEG,KAAM,CACJ,CAAE3G,KAAM,QAASiH,UAAWsB,EAAW5J,MAAO,IAC9C,CAAEqB,KAAM,cAAeiH,UAAWyB,EAAiB/J,MAAO,SAIhE,cAAC,GAAD,UACE,cAAC+I,GAAD,CACEC,WAAYxI,EAAMwI,WAClBC,OAAQzI,EAAMyI,OACdC,UAAW1I,EAAM0I,iB,wFCvDZ,SAASgB,GAAS1J,GAC/B,IAAQ2J,EAA8D3J,EAA9D2J,eAAgBC,EAA8C5J,EAA9C4J,SAAUC,EAAoC7J,EAApC6J,MAAOC,EAA6B9J,EAA7B8J,SAAUC,EAAmB/J,EAAnB+J,OAAQC,EAAWhK,EAAXgK,OAE3D,OACE,cAACC,GAAA,EAAD,CACEhB,OAAQU,EAAeV,OACvBzJ,MAAOmK,EAAenK,MACtBmI,UAAU,QAHZ,SAKE,eAACuC,GAAA,EAAD,CACEjB,OAAQU,EAAeV,OACvBzJ,MAAOmK,EAAenK,MACtB2K,OAAQR,EAAeQ,OACvBC,KAAMR,EAJR,UAME,cAACS,GAAA,EAAD,CAAeC,gBAAgB,QAC/B,cAACC,GAAA,EAAD,CACEC,QAASV,EACTxB,MAAO,CACLlH,MAAO2I,EACPU,SAAU,SACVC,GAAI,MAGR,cAACC,GAAA,EAAD,CACErC,MAAO,CACLlH,MAAO4I,EACPS,SAAU,SACVG,OAAQ,GACRC,IAAK,MAGT,cAACC,GAAA,EAAD,IACA,cAACC,GAAA,EAAD,CACEC,OAAO,aACPC,cAAc,MACdC,MAAM,SACNC,aAAc,CACZC,YAAa,UAIhBvB,OCvDT,IACMwB,GAAS,CACb,UACA,UACA,UACA,UACA,UACA,UACA,WAGIC,GAAetM,IAAOC,IAAV,6SAqBZsM,GAAavM,IAAOC,IAAV,6HAEJ,SAACe,GAAD,OAAWA,EAAMiJ,UAwB7B,SAASuC,GAAUpB,GACjB,IAAMqB,EAAWC,KAAKC,MAAMD,KAAKE,MAAMxB,EAAKzB,aACtCkD,EAAcH,KAAKI,IAAI,GAAIL,EAAW,GAM5C,IAAMM,EAAa3B,EAAK4B,YAAY9H,OAlEL,IAoEzB+H,EAAqC,GACrCC,EAA6C,GAkBnD,OAhBA9B,EAAK4B,YAAYG,SAAQ,SAACC,EAAG1E,GAC3B,GAAIqE,IAVWM,EAUWD,EATa,IAAhCV,KAAKY,IAAID,EAAMR,IASQ,CAC5B,IAAMU,EAAwB,CAAEC,KAAMJ,GAChCK,EAAsB,CAAED,KAAMJ,GACpChC,EAAKsC,YAAYP,SAAQ,SAACQ,GACxBJ,EAAKI,EAAWzG,KAAKE,MAAQuG,EAAWC,SAASlF,MAEnD0C,EAAKyC,kBAAkBV,SAAQ,SAACW,GAC9BL,EAAG,GAAD,OACGK,EAAiB/G,WAAWL,OAAOU,KADtC,eACiD0G,EAAiB/G,WAAWrE,OAAO0E,OAClF0G,EAAiBC,cAAcrF,MAErCuE,EAAgBe,KAAKT,GACrBL,EAAwBc,KAAKP,GAtBjC,IAAiBJ,KAyBV,CAACJ,EAAiBC,GAQZ,SAASe,GAAKjN,GAC3B,IAAMkN,EACFlN,EAAMmN,aAAenN,EAAMmN,YAAYT,YAAYxI,OAAS,EAC1DlE,EAAMmN,YACNC,cAEN,EAA6C5B,GAAU0B,GAAvD,mBAAOG,EAAP,KAAqBC,EAArB,KAEMC,EAAoB1G,mBACxB,kBACEqG,EAAIL,kBAAkBvM,KAAI,SAACwM,EAAkBpF,GAC3C,OACE,cAAC8F,GAAA,EAAD,CAEE5K,KAAM,WACN4H,QAAO,UAAKsC,EAAiB/G,WAAWL,OAAOU,KAAxC,eAAmD0G,EAAiB/G,WAAWrE,OAAO0E,MAC7FqH,OAAQpC,GAAO3D,GACfgG,UAAW,CAAEC,EAAG,GAChBC,mBAAmB,GALdd,EAAiB/G,WAAWzE,SASzC,CAAC4L,EAAIL,oBAGDgB,EAAYhH,mBAChB,kBACEqG,EAAIR,YAAYpM,KAAI,SAACqM,EAAYjF,GAC/B,OACE,cAAC8F,GAAA,EAAD,CAEE5K,KAAM,WACN4H,QAASmC,EAAWzG,KAAKE,KACzBqH,OAAQpC,GAAO3D,GACfgG,UAAW,CAAEC,EAAG,GAChBC,mBAAmB,GALdjB,EAAWzG,KAAK5E,SAS7B,CAAC4L,EAAIR,cAGDoB,EACJ,cAACpE,GAAD,CACEC,eAAgB3J,EAAM2J,eACtBC,SAAUyD,EACVxD,MAAOgE,EACP/D,SAAU,OACVC,OAAQ,WACRC,OAAQ,uBAIN+D,EACJ,cAACrE,GAAD,CACEC,eAAgB3J,EAAM2J,eACtBC,SAAU0D,EACVzD,MAAO0D,EACPzD,SAAU,OACVC,OAAQ,WACRC,OAAQ,0BAIZ,OACE,cAACuB,GAAD,CACEtC,OAAQjJ,EAAM2J,eAAeV,OAC7BzJ,MAAOQ,EAAM2J,eAAenK,MAF9B,SAIE,cAAC8L,GAAD,UACE,cAACjE,EAAD,CACEG,KAAM,CACJ,CACE3G,KAAM,cACNiH,UAAWgG,EACXtO,MAAO,IAET,CACEqB,KAAM,gBACNiH,UAAWiG,EACXvO,MAAO,WChLrB,IAAgCwO,GAA0B1Q,EAAlDe,uBA+HD,SAAS4P,GACdC,EACA9H,EACA+H,EACAC,EACA9O,EACA+O,EACAC,IApIF,SACEJ,EACAC,EACAC,EACAG,GAEAL,EAAQM,OACRN,EAAQO,YACRP,EAAQQ,IAAIP,EAAOpR,EAAGoR,EAAOnR,EAAGoR,EAAQ,EAAG,EAAI1C,KAAKiD,IACpDT,EAAQU,UAAYL,EACpBL,EAAQW,OACRX,EAAQY,YACRZ,EAAQa,UA4HRC,CAAWd,EAASC,EAAQC,EAAQ,OAChC9O,GA1HN,SACE4O,EACAC,EACAC,EACAG,GAEAL,EAAQM,OACRN,EAAQO,YAERP,EAAQQ,IACNP,EAAOpR,EACPoR,EAAOnR,EACPoR,EAASJ,GAAwB,EACjC,EACA,EAAItC,KAAKiD,IAEXT,EAAQe,UAAYjB,GACpBE,EAAQgB,YAAcX,EACtBL,EAAQT,SACRS,EAAQY,YACRZ,EAAQa,UAuGNI,CAAkBjB,EAASC,EAAQC,EAAQ,SAEzCC,GAtGN,SACEH,EACAC,EACAC,GAEAF,EAAQM,OACRN,EAAQe,UAAY,EACpBf,EAAQU,UAAY,UAOpBV,EAAQkB,UAAUjB,EAAOpR,EAAGoR,EAAOnR,GACnCkR,EAAQmB,OAAO3D,KAAKiD,GAAK,GAGzBT,EAAQO,YACRP,EAAQoB,QAAQlB,EAAQ,GACxBF,EAAQqB,OAAOnB,EAAQ,GACvBF,EAAQT,SAIR,IADA,IAAI+B,EAAI,EACDA,EAhBO,IAgBKpB,GAAQ,CACzBoB,GAjBY,IAkBZ,IAAMC,EAAYrB,EAAS1C,KAAKgE,IAAIhE,KAAKiE,KAAKH,EAAIpB,IAClDF,EAAQoB,QAAQG,EAlBH,EAkBuBD,GACpCtB,EAAQqB,OAAOE,EAnBF,EAmBsBD,GACnCtB,EAAQT,SACRS,EAAQoB,QAAQG,EArBH,GAqBwBD,GACrCtB,EAAQqB,OAAOE,EAtBF,GAsBuBD,GACpCtB,EAAQT,SAEVS,EAAQY,YAGRZ,EAAQO,YACRP,EAAQQ,IAAI,EAAG,EAAGN,EA5BH,EA4BoB,EAAa,EAAV1C,KAAKiD,IAAQ,GACnDT,EAAQQ,IAAI,EAAG,EAAGN,EAAQ,EAAa,EAAV1C,KAAKiD,IAAQ,GAC1CT,EAAQW,OAERX,EAAQa,UA4DNa,CAAgB1B,EAASC,EAAQC,GAzDrC,SACEF,EACA9H,EACA+H,EACAC,EACAE,GAGAJ,EAAQM,OACRN,EAAQ2B,KAAO,iBACf,IAAMC,EAAc5B,EAAQ6B,YAAY3J,GAClC5G,EAAQsQ,EAAYtQ,MAC1B0O,EAAQkB,UAAUjB,EAAOpR,EAAGoR,EAAOnR,GACb,MAAlBsR,EACFJ,EAAQ8B,SACN5J,GACC5G,EAAQ,EACTsQ,EAAYG,wBAA0B7B,EAVvB,GAYU,MAAlBE,EACTJ,EAAQ8B,SACN5J,EACAgI,EAfe,EAgBf0B,EAAYG,wBAA0B,GAEb,MAAlB3B,EACTJ,EAAQ8B,SACN5J,GACC5G,EAAQ,IACPsQ,EAAYI,yBAA2B9B,EAtB1B,IAyBjBF,EAAQ8B,SACN5J,IACE5G,EAAQ4O,EA3BK,GA4Bf0B,EAAYG,wBAA0B,GAG1C/B,EAAQa,UAqBRoB,CAAajC,EAAS9H,EAAM+H,EAAQC,EAAQE,GAiIvC,SAAS8B,GACdlC,EACAxI,EACAhE,EACAgF,GAEa,OAATA,EApIC,SACLwH,EACAmC,EACAC,EACA/B,GAGO,IAFPgC,EAEM,uDAFQ,EACdC,EACM,uDADM,EAEZtC,EAAQM,OACRN,EAAQO,YACRP,EAAQgB,YAAcX,EACtBL,EAAQe,UAAY,EACpB,IAAMwB,EAAa,EACbC,EAAY,EACZC,EAAW,EACX9F,EAAKyF,EAAIvT,EAAIsT,EAAMtT,EACnB2N,EAAK4F,EAAItT,EAAIqT,EAAMrT,EACnB4N,EAAQc,KAAKkF,MAAMlG,EAAIG,GAEvBgG,EADSnF,KAAKoF,KAAKjG,EAAKA,EAAKH,EAAKA,GACb8F,EAE3BtC,EAAQkB,UAAUiB,EAAMtT,EAAGsT,EAAMrT,GACjCkR,EAAQmB,OAAOzE,GAEfsD,EAAQO,YACRP,EAAQoB,OAAOiB,EAAaI,GAC5BzC,EAAQqB,OAAOsB,EAAWF,GAC1BzC,EAAQoB,OAAOuB,EAAYJ,EAAYC,EAAYC,GACnDzC,EAAQqB,OAAOsB,EAAWF,GAC1BzC,EAAQqB,OAAOsB,EAAYJ,IAAcC,EAAYC,IAErDzC,EAAQoB,OAAOuB,GAAYF,GAC3BzC,EAAQqB,OAAOgB,GAAcI,GAC7BzC,EAAQoB,OAAOiB,EAAcE,IAAcC,EAAYC,IACvDzC,EAAQqB,OAAOgB,GAAcI,GAC7BzC,EAAQqB,OAAOgB,EAAcE,EAAYC,EAAYC,GAErDzC,EAAQT,SACRS,EAAQY,YACRZ,EAAQa,UA8FNgC,CACE7C,EACAxI,EAAOyI,OACPzM,EAAOyM,OACP,QACAzI,EAAO0I,OACP1M,EAAO0M,QAjGN,SACLF,EACAmC,EACAC,EACA/B,GAGO,IAFPgC,EAEM,uDAFQ,EACdC,EACM,uDADM,EAEZtC,EAAQM,OACRN,EAAQO,YACRP,EAAQgB,YAAcX,EACtBL,EAAQe,UAAY,EACpB,IAAMwB,EAAa,EACbC,EAAY,EACZ7F,EAAKyF,EAAIvT,EAAIsT,EAAMtT,EACnB2N,EAAK4F,EAAItT,EAAIqT,EAAMrT,EACnB4N,EAAQc,KAAKkF,MAAMlG,EAAIG,GAEvBgG,EADSnF,KAAKoF,KAAKjG,EAAKA,EAAKH,EAAKA,GACb8F,EAE3BtC,EAAQkB,UAAUiB,EAAMtT,EAAGsT,EAAMrT,GACjCkR,EAAQmB,OAAOzE,GAEfsD,EAAQO,YACRP,EAAQoB,OAAOiB,EAAa,GAC5BrC,EAAQqB,OAAOsB,EAAW,GAC1B3C,EAAQoB,OAAOuB,EAAYJ,GAAaC,GACxCxC,EAAQqB,OAAOsB,EAAW,GAC1B3C,EAAQqB,OAAOsB,EAAYJ,EAAYC,GACvCxC,EAAQT,SACRS,EAAQY,YACRZ,EAAQa,UAqENiC,CACE9C,EACAxI,EAAOyI,OACPzM,EAAOyM,OACP,QACAzI,EAAO0I,OACP1M,EAAO0M,QAKN,SAAS6C,GACdC,EACAC,EACA/C,GAEA,IAAMgD,EAASF,EAAMnU,EAAIoU,EAAapU,EAChCsU,EAASH,EAAMlU,EAAImU,EAAanU,EACtC,OAAO0O,KAAKI,IAAIsF,EAAQ,GAAK1F,KAAKI,IAAIuF,EAAQ,IAAM3F,KAAKI,IAAIsC,EAAQ,GA8BhE,SAASkD,GACd9P,EACA+P,GAEA,IAAMC,EAAmB,CAAEzU,EAAGyE,EAAMiQ,MAAOzU,EAAGwE,EAAMkQ,OAC9CC,EAAeJ,EAAOK,wBAE5B,OAAO3U,EAAWuU,EADO,CAAEzU,EAAG4U,EAAahT,KAAM3B,EAAG2U,EAAa9S,MAY5D,SAASgT,GACdrQ,EACAsQ,GAEA,GAAIA,EAAY5D,QAAS,CACvB,IAAM6D,EAAcT,GAAqB9P,EAAOsQ,EAAY5D,QAAQqD,QACpE,OAbFS,EAcID,EAbJE,EAcIH,EAAYG,OAbhB5U,EAcIyU,EAAYzU,MAZTJ,EAAWG,EAAW4U,EAAO3U,GAAQ4U,GAe1C,OAAOrV,EApBX,IACEoV,EACAC,EACA5U,ECpWa,SAAS6U,GACtBC,EACA1R,GAEA,MAA0B2R,YAAkB,WAC1C,IAAMC,EAAaC,OAAOC,aAAaC,QAAQ/R,GAC/C,OAAmB,OAAf4R,QAAsCtQ,IAAfsQ,EAClBF,EAEAM,KAAKC,MAAML,MALtB,mBAAOjR,EAAP,KAAcmB,EAAd,KAYA,OAHA6P,aAAgB,WACdE,OAAOC,aAAaI,QAAQlS,EAAKgS,KAAKG,UAAUxR,MAC/C,CAACX,EAAKW,IACF,CAACA,EAAOmB,GCLjB,IAAQnE,GAAsCd,EAAtCc,QAASD,GAA6Bb,EAA7Ba,QAASD,GAAoBZ,EAApBY,gBCR1B,I,MAAM2U,GAAgB7T,IAAOC,IAAV,8EAAGD,CAAH,2EAQb8T,GAAe9T,IAAOiJ,OAAV,6EAAGjJ,CAAH,mBAWH,SAAS+T,GAAS/S,GAC/B,OACE,eAAC6S,GAAD,WACE,cAACC,GAAD,CACEpS,QAAS,kBAAMV,EAAM8R,YAAY5D,SAAWlO,EAAMgT,QAAQpW,EAAQ,IADpE,wBAKA,cAACkW,GAAD,CACEpS,QAAS,kBACPV,EAAM8R,YAAY5D,SAClBlO,EAAMgT,QACJhT,EAAMiT,iBAAiBhB,OACvBjS,EAAMiT,iBAAiB5V,QAL7B,iCAWA,cAACyV,GAAD,CACEpS,QAAS,WACPV,EAAMkT,oBAAoB,CACxBjB,OAAQjS,EAAM8R,YAAYG,OAC1B5U,MAAO2C,EAAM8R,YAAYzU,SAJ/B,0BCnCN,IAAM8V,GAAsBnU,IAAOC,IAAV,6FAMnBmU,GAAepU,IAAOuS,OAAV,6DACP,gBAAG8B,EAAH,EAAGA,SAAH,gBAAqBA,EAArB,SACC,gBAAGC,EAAH,EAAGA,UAAH,gBAAsBA,EAAtB,SAmCG,SAASC,GAAOvT,GAC7B,IChDAwT,EACAC,EDgDEC,EASE1T,EATF0T,YACAC,EAQE3T,EARF2T,aACAC,EAOE5T,EAPF4T,iBACAC,EAME7T,EANF6T,KACAC,EAKE9T,EALF8T,YACAC,EAIE/T,EAJF+T,kBACAd,EAGEjT,EAHFiT,iBACAC,EAEElT,EAFFkT,oBACAc,EACEhU,EADFgU,kBAIIC,EAAYC,iBAA0B,MC7D5CV,ED8DiBS,EC7DjBR,ED6D4BO,EC3D5BG,qBAAU,WACR,IAAMC,EAAqB,SAAC5S,GAC1B,IAAM6S,IACFb,EAAIc,SAAWd,EAAIc,QAAQC,SAAS/S,EAAME,QAC9C+R,EAAcY,IAKhB,OADAG,SAASC,iBAAiB,YAAaL,GAChC,WAELI,SAASE,oBAAoB,YAAaN,MAE3C,CAACZ,EAAKC,ID+CT,MFpDa,SACbQ,GASA,MAA8B5R,mBAA0C,MAAxE,mBAAO6L,EAAP,KAAgByG,EAAhB,KACA,EAA0BzC,GAA6B,EAAG,iBAA1D,mBAAO7U,EAAP,KAAcuX,EAAd,KACA,EAA4B1C,GAC1BtV,EACA,kBAFF,mBAAOqV,EAAP,KAAe4C,EAAf,KAIMC,EAAcZ,iBAActX,GAC5BmY,EAAkBb,iBAActX,GAEhCoW,EAAUrQ,uBACd,SAACsP,EAAe5U,GACdwX,EAAU5C,GACV2C,EAASvX,KAEX,CAACwX,EAAWD,IAIRI,EAAYrS,uBAChB,SAACnB,GACC,GAAI0M,EAAS,CAEX,IAAM+G,EAAc3D,GAAqB9P,EAAO0M,EAAQqD,QACxDwD,EAAgBT,QAAUQ,EAAYR,QACtCQ,EAAYR,QAAUW,EAEtB,IAAMC,EAAY9X,EAChBH,EAAW6X,EAAYR,QAASS,EAAgBT,SAChDjX,GAEFwX,GAAU,SAACM,GAAD,OvB5CmBhY,EuB4CmB+X,EvB3C/C,CAAEnY,GADeG,EuB4CkBiY,GvB3C3BpY,EAAII,EAAGJ,EAAGC,EAAGE,EAAGF,EAAIG,EAAGH,GADjC,IAAmBE,EAAWC,QuB+CjC,CAAC+Q,EAAS7Q,EAAOwX,IAGbO,EAAUzS,uBAAY,WAC1B6R,SAASE,oBAAoB,YAAaM,GAC1CR,SAASE,oBAAoB,UAAWU,KACvC,CAACJ,IAEEK,EAAW1S,uBACf,SAACnB,GACK0M,IACFsG,SAASC,iBAAiB,YAAaO,GACvCR,SAASC,iBAAiB,UAAWW,GACrCN,EAAYR,QAAUhD,GAAqB9P,EAAO0M,EAAQqD,WAG9D,CAACrD,EAAS8G,EAAWI,IAqCvB,OAjCAE,2BAAgB,WACd,SAASC,EAAY/T,GAEnB,GADAA,EAAMgU,iBACFtH,EAAS,CAEX,IAAM+G,EAAc3D,GAAqB9P,EAAO0M,EAAQqD,QACxDwD,EAAgBT,QAAUQ,EAAYR,QACtCQ,EAAYR,QAAUW,EAGtB,IAAMQ,EAAO,EAAIjU,EAAM6P,OAASnT,GAC1BwX,EAAWrY,EAAQoY,EACzB,GAAIC,EAAWtX,IAAWsX,EAAWvX,GACnC,OAIF,IAEMwX,EAAc1Y,EAFFG,EAAW0X,EAAYR,QAASjX,GACjCD,EAAW0X,EAAYR,QAASoB,IAGjDb,EAAU5X,EAAWgV,EAAQ0D,IAC7Bf,EAASc,IAIb,IAAME,EAAa3B,EAAUK,QAC7B,GAAIsB,EAEF,OADAA,EAAWnB,iBAAiB,QAASc,GAC9B,kBAAMK,EAAWlB,oBAAoB,QAASa,MAEtD,CAACtB,EAAW/F,EAAS+D,EAAQ5U,EAAOwX,EAAWD,IAE3C,CAAC1G,EAASyG,EAAY3B,EAASf,EAAQ5U,EAAOgY,GE3CnDQ,CAAiB5B,GADnB,mBAAO/F,EAAP,KAAgByG,EAAhB,KAA4B3B,EAA5B,KAAqCf,EAArC,KAA6C5U,EAA7C,KAAoDgY,EAApD,KAmCA,OA/BAC,2BAAgB,WACd,GAAIrB,EAAUK,QAAS,CAErB,IAAMwB,EAAY7B,EAAUK,QAAQyB,WAAW,MAC/CpB,EAAWmB,MAEZ,CAACnB,IAGJW,2BAAgB,WACVpH,IAEFA,EAAQqD,OAAO/R,MAAQkU,EAAcE,EACrC1F,EAAQqD,OAAOtI,OAAS0K,EAAeC,EAEvC1F,EAAQ7Q,MAAMA,EAAQuW,EAAkBvW,EAAQuW,GAChD1F,EAAQkB,UAAU6C,EAAOlV,EAAGkV,EAAOjV,GAEnC6W,EAAK3F,MAEN,CACDyF,EACAD,EACAxF,EACA0F,EACAC,EACA5B,EAAOlV,EACPkV,EAAOjV,EACPK,IAIA,eAAC8V,GAAD,WACE,cAACJ,GAAD,CACEC,QAASA,EACTlB,YAAa,CAAE5D,UAAS+D,SAAQ5U,QAAOqW,cAAaC,gBACpDV,iBAAkBA,EAClBC,oBAAqBA,IAEvB,cAACE,GAAD,CACEI,IAAKS,EACLzU,MAAOkU,EAAcE,EACrB3K,OAAQ0K,EAAeC,EACvBP,SAAUK,EACVJ,UAAWK,EACXG,YAAa,SAACtS,GAAD,OACXsS,EACEtS,EACA,CAAE0M,UAAS+D,SAAQ5U,QAAOqW,cAAaC,iBACvC,kBAAM0B,EAAS7T,OAGnBwU,cAAe,SAACxU,GAAD,OACbuS,EAAkBvS,EAAO,CACvB0M,UACA+D,SACA5U,QACAqW,cACAC,uBEtHZ,IAAQ1V,GAAyCX,EAAzCW,kBAAmBH,GAAsBR,EAAtBQ,kB,aCA3B,IAAQC,GAAqDT,EAArDS,0BAA2BC,GAA0BV,EAA1BU,sBAEpB,SAASiY,GACtBC,EACAC,EACAC,EACAC,GAMA,IAAMC,EAA0B3T,uBAC9B,SACEnB,EACA+U,EACAzE,GAEA,GAAIA,EAAY5D,QAAS,CACvB,IAAMsI,EAAoB3E,GAAkBrQ,EAAOsQ,GACnDuE,EAAevE,GPwMhB,SACL5D,EACAmC,EACAC,EACA/B,GAGO,IAFPgC,EAEM,uDAFQ,EACdC,EACM,uDADM,EAEZtC,EAAQM,OACRN,EAAQO,YACRP,EAAQgB,YAAcX,EACtBL,EAAQe,UAAY,EACpB,IAAMpE,EAAKyF,EAAIvT,EAAIsT,EAAMtT,EACnB2N,EAAK4F,EAAItT,EAAIqT,EAAMrT,EACnB4N,EAAQc,KAAKkF,MAAMlG,EAAIG,GACvB3G,EAASwH,KAAKoF,KAAKjG,EAAKA,EAAKH,EAAKA,GACxCwD,EAAQkB,UAAUiB,EAAMtT,EAAGsT,EAAMrT,GACjCkR,EAAQmB,OAAOzE,GACfsD,EAAQO,YACRP,EAAQoB,OAAOiB,EAAa,GAC5B,IAAMM,EAAY3M,EAASsM,EAC3BtC,EAAQqB,OAAOsB,EAAW,GAC1B3C,EAAQT,SACRS,EAAQY,YACRZ,EAAQa,UO/NF0H,CACE3E,EAAY5D,QACZqI,EAAYpI,OACZqI,EACA,WAIN,CAACH,IAGH,OAAO1T,uBACL,SACEnB,EACA+U,EACAzE,GAEA,IAAM4E,EAAkB,SAAClV,GACvB8U,EAAwB9U,EAAO+U,EAAazE,IAsC9C0C,SAASC,iBAAiB,YAAaiC,GACvClC,SAASC,iBAAiB,WApCV,SAAVW,EAAW5T,GACfgT,SAASE,oBAAoB,YAAagC,GAC1ClC,SAASE,oBAAoB,UAAWU,GAGxC,IAAMoB,EAAoB3E,GAAkBrQ,EAAOsQ,GAC7C6E,EAAgBT,EAASrU,MAC7B,SAACqE,GAAD,OACE+K,GAAiBuF,EAAmBtQ,EAAKiI,OAAQjI,EAAKkI,SACtDlI,EAAK5E,KAAOiV,EAAYjV,KACvB6U,EAAexQ,MACd,SAACF,GAAD,OACGA,EAAKC,OAAOpE,KAAO4E,EAAK5E,IACvBmE,EAAK/D,OAAOJ,KAAOiV,EAAYjV,IAChCmE,EAAK/D,OAAOJ,KAAO4E,EAAK5E,IACvBmE,EAAKC,OAAOpE,KAAOiV,EAAYjV,SAIzC,GAAIqV,EAAe,CACjB,IAAMC,EAAa,2BACdC,yBAAe,CAChBnR,OAAQ6Q,EACR7U,OAAQiV,EACRG,mBAAoB/Y,GACpB2I,KAAM1I,MALS,IAOjBmI,WAAYoQ,EAAYnQ,KACxBG,WAAYoQ,EAAcvQ,OAE5BgQ,EAAkB,GAAD,oBAAKD,GAAL,CAAqBS,UAEtCP,EAAevE,QAMrB,CACEqE,EACAD,EACAG,EACAC,EACAF,ICvFS,SAASW,GACtBb,EACAc,EACAX,GAEA,OAAO1T,uBACL,SAACnB,EAAsCsQ,GACrC,IAAMmF,EAAWpF,GAAkBrQ,EAAOsQ,GACpCoF,EAAU,SAAC1V,GRiPhB,IACL0M,EACAmC,EACAC,EACA/B,EQpPUuD,EAAY5D,UACdmI,EAAevE,GRgPvB5D,EQ9OU4D,EAAY5D,QR+OtBmC,EQ9OU4G,ER+OV3G,EQ9OUuB,GAAkBrQ,EAAOsQ,GR+OnCvD,EQ9OU,ORgPVL,EAAQM,OACRN,EAAQO,YACRP,EAAQU,UAAYL,EACpBL,EAAQiJ,YAAc,GACtBjJ,EAAQkJ,SAAS/G,EAAMtT,EAAGsT,EAAMrT,EAAGsT,EAAIvT,EAAIsT,EAAMtT,EAAGuT,EAAItT,EAAIqT,EAAMrT,GAClEkR,EAAQY,YAGRZ,EAAQO,YACRP,EAAQgB,YAAcX,EACtBL,EAAQmJ,KAAKhH,EAAMtT,EAAGsT,EAAMrT,EAAGsT,EAAIvT,EAAIsT,EAAMtT,EAAGuT,EAAItT,EAAIqT,EAAMrT,GAC9DkR,EAAQT,SACRS,EAAQY,YAERZ,EAAQa,YQ7OJyF,SAASC,iBAAiB,YAAayC,GACvC1C,SAASC,iBAAiB,WAdV,SAAVW,EAAW5T,GACfgT,SAASE,oBAAoB,YAAawC,GAC1C1C,SAASE,oBAAoB,UAAWU,GAExC,IAAMkC,EAASzF,GAAkBrQ,EAAOsQ,GAClChL,EAAgBoP,EACnB1Q,QACC,SAACU,GAAD,OR2RL,SACLqR,EACAC,EACAtG,GAEA,MACEqG,EAASxa,EAAIya,EAAOza,GAAKwa,EAASva,EAAIwa,EAAOxa,EACzC,CAACua,EAAUC,GACX,CAACA,EAAQD,GAHf,mBAAOE,EAAP,KAAgBC,EAAhB,KAKA,EACEH,EAASxa,EAAIya,EAAOza,GAAKwa,EAASva,EAAIwa,EAAOxa,EACzC,CAACua,EAAUC,GACX,CAACA,EAAQD,GAHf,mBAAOI,EAAP,KAAmBC,EAAnB,KAKA,OACGH,EAAQ1a,GAAKmU,EAAMnU,GAClBmU,EAAMnU,GAAK2a,EAAY3a,GACvB0a,EAAQza,GAAKkU,EAAMlU,GACnBkU,EAAMlU,GAAK0a,EAAY1a,GACxB2a,EAAW5a,GAAKmU,EAAMnU,GACrBmU,EAAMnU,GAAK6a,EAAS7a,GACpB6a,EAAS5a,GAAKkU,EAAMlU,GACpBkU,EAAMlU,GAAK2a,EAAW3a,EQjTd6a,CAAYZ,EAAUK,EAAQpR,EAAKiI,SAAWjI,EAAK5G,YAEtDgB,KAAI,SAAC4F,GAAD,OAAUA,EAAK5E,MACtB0V,EAAelQ,QAKnB,CAACoP,EAAUG,EAAgBW,IChChB,SAASc,GACtB5B,EACAC,EACAC,EACA/M,EACA2N,EACAe,EACA1B,GAMA,IAAM2B,EAAoB/B,GACxBC,EACAC,EACAC,EACAC,GAEI4B,ECzBO,SACb5O,GAOA,IAAM6O,EAAWhE,kBAAgB,GAEjC,OAAOvR,uBACL,SACEnB,EACA+U,EACA4B,EACArG,GAEA,IAAMsG,EAAsBnb,EAC1B4U,GAAkBrQ,EAAOsQ,GACzByE,EAAYpI,QAERkK,EAAkB7W,EAAM8W,SACxBL,EAAW,SAACzW,GAChB,GAAIsQ,EAAY5D,QAAS,CACvBgK,EAAS5D,SAAU,EACnB,IAAMiE,EAAmBtb,EACvB4U,GAAkBrQ,EAAOsQ,GACzBsG,GAEII,EAAc,2BACfjC,GADe,IAElBjX,UAAU,EACV6O,OAAQoK,IAGJE,EACJlC,EAAYjX,UAAY+Y,EACpBF,EAAY7X,KAAI,SAAC4F,GACf,IAAMwS,EAA4Bzb,EAChCsZ,EAAYpI,OACZjI,EAAKiI,QAEP,OAAO,2BACFjI,GADL,IAEEiI,OAAQlR,EACNsb,EACAG,QAIN,GAENrP,EAAY,CAACmP,GAAF,oBAAqBC,KAAkBjX,EAAM8W,YAqB5D9D,SAASC,iBAAiB,YAAawD,GACvCzD,SAASC,iBAAiB,WAnBV,SAAVW,EAAW5T,GACfgT,SAASE,oBAAoB,YAAauD,GAC1CzD,SAASE,oBAAoB,UAAWU,GACxC/L,EACE,CAAC,2BAEMkN,GAFP,IAGIpI,OAAQlR,EACN4U,GAAkBrQ,EAAOsQ,GACzBsG,GAEF9Y,UAAU,MAGb4Y,EAAS5D,UAAY+D,GAExBH,EAAS5D,SAAU,OAKvB,CAACjL,IDnDcsP,CAAYtP,GACvBuP,EAAc7B,GAAeb,EAAUc,EAAgBX,GAE7D,OAAO1T,uBACL,SACEnB,EACAsQ,EACA+G,GAEA,IAAMrC,EAAoB3E,GAAkBrQ,EAAOsQ,GAE7CqG,EAAcjC,EAAS1Q,QAAO,SAACU,GAAD,OAAUA,EAAK5G,YAC7CwH,EAAgBqR,EAAY7X,KAAI,SAAC4F,GAAD,OAAUA,EAAK5E,MAE/CiV,EAAcL,EAASrU,MAAK,SAACqE,GAAD,OAChC+K,GAAiBuF,EAAmBtQ,EAAKiI,OAAQjI,EAAKkI,WAGpDmI,EACE/U,EAAMsX,OACRd,EAAkBxW,EAAO+U,EAAazE,GAC7BtQ,EAAM8W,UAAYxR,EAAcC,SAASwP,EAAYjV,IAC9D0V,EAAelQ,EAActB,QAAO,SAAClE,GAAD,OAAQA,IAAOiV,EAAYjV,OAE/D2W,EAASzW,EAAO+U,EAAa4B,EAAarG,GAGxCtQ,EAAM8W,SACRM,EAAYpX,EAAOsQ,IAEnBiG,IACAc,EAAgBrX,MAItB,CACE0U,EACA6B,EACAE,EACAW,EACAZ,EACAhB,IEpEN,I,SAAM+B,GAAQC,mBAAS,CACrB5S,KAAM,QACN6S,gBAAiB,GACjBC,oBAAqB,IACrBC,UAAW,EACX9K,YAAY,IAGR+K,GAAQJ,mBAAS,CACrB5S,KAAM,QACN6S,gBAAiB,GACjBC,oBAAqB,EACrBC,UAAW,EACX9K,YAAY,IAGDgL,GAA0B,CAAC,2BAEjCN,IAFgC,IAGnC5K,OAAQ,CAAEpR,EAAG,IAAKC,EAAG,KACrBoR,OAAQ9Q,EAAOQ,kBACfyQ,MAAO,MACPjP,UAAU,EACVgP,cAAe,MAPoB,2BAUhC8K,IAVgC,IAWnCjL,OAAQ,CAAEpR,EAAG,IAAKC,EAAG,KACrBoR,OAAQ9Q,EAAOQ,kBACfyQ,MAAO,MACPjP,UAAU,EACVgP,cAAe,OAINgL,GAAsC,CAAC,2BAE7CzC,yBAAe,CAChBnR,OAAQqT,GACRrX,OAAQ0X,GACRtC,mBAAoB,GACpBpQ,KAAM,QANuC,IAQ/CP,WAAY4S,GAAM3S,KAClBG,WAAY6S,GAAMhT,QC9BpBzI,GAKEL,EALFK,gBACAD,GAIEJ,EAJFI,iBACAgB,GAGEpB,EAHFoB,WACAJ,GAEEhB,EAFFgB,YACAC,GACEjB,EADFiB,mBAuBIgb,GAAYva,IAAOC,IAAV,yNAEH,SAACe,GAAD,OAAWA,EAAMiJ,UAOvBuQ,GAAkBxa,IAAOC,IAAV,iEACT,SAACe,GAAD,OAAWA,EAAMiJ,UAClB,SAACjJ,GAAD,OAAY,EAAIrC,IAAmBqC,EAAMR,SAG9C4T,GAAepU,IAAOC,IAAV,gEAEN,SAACe,GAAD,OAAWA,EAAMiJ,UAGd,SAASwQ,KACtB,MAAsCpX,wBACpCN,GADF,mBAAOoL,EAAP,KAAoBuM,EAApB,KAGA,EAA4BxH,GAC1B,CACEpJ,UAAWxL,EAAOO,uBAClB8K,WAAYrL,EAAOM,yBAErB,kBALF,mBAAO6K,EAAP,KAAeC,EAAf,KAOA,EAAgCwJ,GAC9BmH,GACA,iBAFF,mBAAOnD,EAAP,KAAiByD,EAAjB,KAIA,EAA4CzH,GAE1CoH,GAAoB,uBAFtB,mBAAOnD,EAAP,KAAuBC,EAAvB,KAGA,EC9Ea,SACbuD,EACAvD,GAUA,IAAMwD,EAAUjX,uBACd,SAACuD,GACCyT,GAAY,SAACE,GACX,IAAMC,EAAsBD,EAAUvZ,KAAI,SAAC4F,GAAD,mBAAC,eACtCA,GADqC,IAExC5G,UAAU,OAGZ,OADAwa,EAAS9M,KAAT,2BAAmB9G,GAAnB,IAAyB5G,UAAU,KAC5Bwa,OAGX,CAACH,IAGGtQ,EAAc1G,uBAClB,SAACoX,GAAwD,IAA9BhC,EAA6B,wDACtD4B,GAAY,SAACE,GACX,OAAOA,EAAUvZ,KAAI,SAAC4F,GAIpB,OAHqB6T,EAAclY,MACjC,SAACmY,GAAD,OAAaA,EAAQ1Y,KAAO4E,EAAK5E,QAK7ByW,EACK,2BAAK7R,GAAZ,IAAkB5G,UAAU,IAErB4G,SAMfkQ,GAAkB,SAAC6D,GACjB,OAAOA,EAAU3Z,KAAI,SAAC4Z,GACpB,IAAMlU,EAAgB+T,EAAclY,MAClC,SAACsY,GAAD,OAAkBD,EAASxU,OAAOpE,IAAM6Y,EAAa7Y,MAEvD,GAAI0E,EACF,OAAO,2BACFkU,GADL,IAEExU,OAAQM,EACRG,WAAYH,EAAcI,OAI9B,IAAME,EAAgByT,EAAclY,MAClC,SAACsY,GAAD,OAAkBD,EAASxY,OAAOJ,IAAM6Y,EAAa7Y,MAEvD,OAAIgF,EACK,2BACF4T,GADL,IAEExY,OAAQ4E,EACRC,WAAYD,EAAcF,OAIvB8T,UAIb,CAAC9D,EAAmBuD,IA8DtB,MAAO,CACLC,EACAvQ,EA7DkB1G,uBAClB,SAACyX,GACChE,GAAkB,SAAC6D,GACjB,OAAOA,EAAUzU,QACf,SAACC,GAAD,OACG2U,EAAQrT,SAAStB,EAAKC,OAAOpE,MAC7B8Y,EAAQrT,SAAStB,EAAK/D,OAAOJ,UAGpCqY,GAAY,SAACE,GAAD,OACVA,EAAUrU,QAAO,SAACU,GAAD,OAAWkU,EAAQrT,SAASb,EAAK5E,YAGtD,CAAC8U,EAAmBuD,IAGIhX,uBACxB,SAAC0X,GACC,IAAMC,EAAkBD,EAAc/Z,KAAI,SAACmF,GAAD,OAAUA,EAAKnE,MACzD8U,GAAkB,SAAC6D,GACjB,IAAMM,EAAWN,EAAUzU,QACzB,SAACC,GAAD,OAAW6U,EAAgBvT,SAAStB,EAAKnE,OAE3C,MAAM,GAAN,oBAAW+Y,GAAX,aAA6BE,SAGjC,CAACnE,IAGuBzT,uBACxB,SAAC6X,GACCpE,GAAkB,SAAC6D,GAAD,OAChBA,EAAUzU,QAAO,SAACC,GAAD,OAAW+U,EAAQzT,SAAStB,EAAKnE,YAGtD,CAAC8U,IAGoBzT,uBACrB,SAACmE,GACC6S,GAAY,SAACE,GACX,OAAOA,EAAUvZ,KAAI,SAAC4F,GAAD,mBAAC,eACjBA,GADgB,IAEnB5G,SAAUwH,EAAcC,SAASb,EAAK5E,cAI5C,CAACqY,IAGsBhX,uBAAY,WACnCgX,GAAY,SAACE,GACX,OAAOA,EAAUvZ,KAAI,SAAC4F,GAAD,mBAAC,eACjBA,GADgB,IAEnB5G,UAAU,YAGb,CAACqa,KD/CAc,CAAcd,EAAavD,GAR/B,mBACEwD,EADF,KAEEvQ,EAFF,KAGEC,EAHF,KAIEE,EAJF,KAKEC,EALF,KAMEuN,EANF,KAOEe,EAPF,KAUA,EAA4C1V,oBAAkB,GAA9D,mBAAOqY,EAAP,KAAuB1G,EAAvB,MEzFa,SACb0G,EACAxE,EACAyD,EACArQ,GAEA6K,qBAAU,WACR,IAAMwG,EAAY,SAACnZ,GACbkZ,IAEElZ,EAAMoZ,SACc,KAAlBpZ,EAAMqZ,UACRrZ,EAAMgU,iBACNmE,GAAY,SAACE,GAAD,OACVA,EAAUvZ,KAAI,SAAC4F,GACb,OAAO,2BAAKA,GAAZ,IAAkB5G,UAAU,WAOlB,cAAdkC,EAAMf,KAAqC,WAAde,EAAMf,MACrCe,EAAMgU,iBACNlM,EACE4M,EAAS1Q,QAAO,SAACU,GAAD,OAAUA,EAAK5G,YAAUgB,KAAI,SAAC4F,GAAD,OAAUA,EAAK5E,QAK1C,KAAlBE,EAAMqZ,SACRlB,GAAY,SAACE,GAAD,OACVA,EAAUvZ,KAAI,SAAC4F,GAAD,mBAAC,eAAeA,GAAhB,IAAsB5G,UAAU,YAMtD,OADAkV,SAASC,iBAAiB,UAAWkG,GAC9B,kBAAMnG,SAASE,oBAAoB,UAAWiG,MACpD,CAACzE,EAAU5M,EAAaoR,EAAgBf,IFmD3CmB,CAAWJ,EAAgBxE,EAAUyD,EAAarQ,GAElD,MG1Fa,SACb4M,EACAC,GAKA,IAAMtC,EAAOlR,uBACX,SAACuL,GACCgI,EAAS5V,KAAI,SAAC4F,GACZ+H,GACEC,EACAhI,EAAKE,KACLF,EAAKiI,OACLjI,EAAKkI,OACLlI,EAAK5G,SACL4G,EAAKmI,WACLnI,EAAKoI,kBAMT6H,EAAe7V,KAAI,SAACmF,GAClB,IAAQC,EAAyBD,EAAzBC,OAAQhE,EAAiB+D,EAAjB/D,OAAQgF,EAASjB,EAATiB,KAClBqU,EAAgB7E,EAASrU,MAAK,SAACqE,GAAD,OAAUA,EAAK5E,KAAOoE,EAAOpE,MAC3D0Z,EAAgB9E,EAASrU,MAAK,SAACqE,GAAD,OAAUA,EAAK5E,KAAOI,EAAOJ,MAC7DyZ,GAAiBC,GACnB5K,GAAelC,EAAS6M,EAAeC,EAAetU,QAI5D,CAACyP,EAAgBD,IAGbG,EAAiB1T,uBACrB,SAACmP,GACKA,EAAY5D,UACd4D,EAAY5D,QAAQ+M,WACjBnJ,EAAYG,OAAOlV,GACnB+U,EAAYG,OAAOjV,EACpB8U,EAAY4B,YAAc5B,EAAYzU,MACtCyU,EAAY6B,aAAe7B,EAAYzU,OAEzCwW,EAAK/B,EAAY5D,YAGrB,CAAC2F,IAGH,MAAO,CAACA,EAAMwC,GHwCiB6E,CAAQhF,EAAUC,GAAjD,mBAAOtC,EAAP,KAAawC,EAAb,KACMtC,ENnFO,SACbmC,EACA0D,EACAvQ,GAEA,OAAO1G,uBACL,SAACnB,EAAsCsQ,GACrCtQ,EAAMgU,iBAEN,IAAMgB,EAAoB3E,GAAkBrQ,EAAOsQ,GAE7CqJ,EAAoBjF,EAASrU,MAAK,SAACqE,GAAD,OACtC+K,GAAiBuF,EAAmBtQ,EAAKiI,OAAQjI,EAAKkI,WAExD,GAAI+M,EACF9R,EAAY,CAAC,2BAEN8R,GAFK,IAGR7M,eN4VqBjO,EM5VW8a,EAAkB7M,cN8V1C,MAAdjO,EACK,IACgB,MAAdA,EACF,IACgB,MAAdA,EACF,IAEA,aMzWL,CNgWC,IAA0BA,EMtVrB+a,EAAclF,EAAS1Q,QAAO,SAACU,GAAD,OAClCA,EAAKE,KAAKiV,WAAWpd,OACrBiG,OAEI8V,EAAUhB,mBAAS,CACvB5S,KACkB,IAAhBgV,EAAA,UACOnd,IADP,UAEOA,GAFP,aAE6Bmd,EAAc,EAF3C,KAGFnC,gBAAiB3b,EAAOC,gBACxB2b,oBAAqB5b,EAAOE,mBAC5B2b,UAAW7b,EAAOG,iBAClB4Q,YAAY,IAGRiN,EAAmB,2BACpBtB,GADoB,IAEvB7L,OAAQqI,EACRpI,OAAQtQ,GACRyQ,MAAO,MACPjP,UAAU,EACVgP,cAAe,MAEjBsL,EAAQ0B,MAEV,CAAC1B,EAAS1D,EAAU7M,IMkCIkS,CAAerF,EAAU0D,EAASvQ,GACtDyK,EAAcgE,GAClB5B,EACAC,EACAC,EACA/M,EACA2N,EACAe,EACA1B,GAGF,EACEnE,GACE,CACED,OAAQrV,EACRS,MAAO,GAET,4BANJ,mBAAO4V,EAAP,KAAyBC,EAAzB,KASA,EIlHa,WACb,MAAwB7Q,mBAA2B,CAAC,EAAG,IAAvD,mBAAOmZ,EAAP,KAAaC,EAAb,KACA,EAA0BpZ,mBAAS,GAAnC,mBAAOqZ,EAAP,KAAcC,EAAd,KAmBA,OAjBArG,2BAAgB,WACd,SAASsG,IACPH,EAAQ,CAACnJ,OAAOuJ,WAAYvJ,OAAOwJ,cAErC,SAASC,IACP,MAAwCzJ,OAAhCsB,iBACR+H,OADA,MAAkC,EAAlC,GAOF,OAJArJ,OAAOmC,iBAAiB,SAAUmH,GAClCtJ,OAAOmC,iBAAiB,SAAUsH,GAClCH,IACAG,IACO,WACLzJ,OAAOoC,oBAAoB,SAAUkH,GACrCtJ,OAAOoC,oBAAoB,SAAUqH,MAEtC,IACI,CAACP,EAAME,GJ6FQM,GAAtB,mBAAOR,EAAP,KAAaE,EAAb,KACA,cAAoCF,EAApC,GAAOS,EAAP,KAAoBC,EAApB,KAGMC,EAAiBF,EACjBG,GAAkBF,EAClBvI,GAAeuI,EAAexe,GAC9BgW,GAAcuI,GAAe,EAAIte,IACjC0e,IACH,EAAI3e,IAAoBwe,EAAe5d,GAAcC,GAClD+d,GAAY5I,GACZ6I,GAAc5e,GAAkBse,EAEtC,OACE,eAAC1C,GAAD,CAAWtQ,OAAQiT,EAAnB,UACE,eAAC1C,GAAD,CAAiBvQ,OAAQmT,GAAiB5c,MAAO2c,EAAjD,UACE,cAAC,GAAD,CAAclT,OAAQ0K,GAAtB,SACE,cAACJ,GAAD,CACEG,YAAaA,GACbC,aAAcA,GACdC,iBAAkB8H,EAClB7H,KAAMA,EACNC,YAAaA,EACbC,kBAAmBA,EACnBd,iBAAkBA,EAClBC,oBAAqBA,EACrBc,kBAAmBA,MAGvB,cAAC/G,GAAD,CACEtD,eAAgB,CACdV,OAAQoT,GACR7c,MAAO8c,GACPnS,OAAQzL,IAEVyO,YAAaA,OAGjB,cAAChE,GAAD,CACEF,OAAQiT,EACR1c,MAAO+c,GACP9T,OAAQA,EACRC,UAAWA,EACXzC,MAAOiQ,EACP5Q,YAAa6Q,EAEb9M,YAAaA,EACbC,YAAaA,EACbE,kBAAmBA,EACnBC,kBAAmBA,EACnBjB,WAAY,WAAO,IAAD,EACVgU,EAASC,cAAI,CACjBxW,MAAOiQ,EACP5Q,YAAa6Q,EACbrN,UAAWL,EAAOK,UAClBH,WAAYF,EAAOE,cAErB,UAAI6T,EAAOE,cAAX,aAAI,EAAexY,SACjBsY,EAAOE,OAAOvQ,SAAQ,SAACwQ,GAAD,OAAWC,QAAQD,MAAMA,EAAME,YAEvDnD,EAAe8C,SKzJvBlK,OAAOmC,iBAAiB,QAAQ,YAhBhC,WACE,IAAMqI,EAAiBtI,SAASuI,cAAc,OAC5CC,EAAYxI,SAASuI,cAAc,OACrCD,EAAe/b,MAAMvB,MAAQ,OAC7Bsd,EAAe/b,MAAMkI,OAAS,OAC9B6T,EAAe/b,MAAMkc,SAAW,SAChCH,EAAe/b,MAAMmc,YAAc,IACnCF,EAAUjc,MAAMvB,MAAQ,OACxBwd,EAAUjc,MAAMkI,OAAS,OACzB6T,EAAeK,YAAYH,GAC3BxI,SAAS4I,KAAKD,YAAYL,GAC1B,IAAMO,EAAOP,EAAeQ,YAAcR,EAAeS,YAEzD,OADA/I,SAAS4I,KAAKI,YAAYV,GACnBO,EAAO,GAKTI,IACHjJ,SAAS4I,KAAKM,UAAUC,IAAI,4BClBlCC,IAASC,OACP,cAAC,aAAD,UACE,cAACpE,GAAD,MAEFjF,SAASsJ,eAAe,W","file":"static/js/main.a22b1c31.chunk.js","sourcesContent":["export type Point = {\n  x: number;\n  y: number;\n};\n\nexport const ORIGIN = Object.freeze({ x: 0, y: 0 });\n\nexport function makePoint(x: number, y: number): Point {\n  return { x, y };\n}\n\nexport function addPoints(p1: Point, p2: Point): Point {\n  return { x: p1.x + p2.x, y: p1.y + p2.y };\n}\n\nexport function diffPoints(p1: Point, p2: Point): Point {\n  return { x: p1.x - p2.x, y: p1.y - p2.y };\n}\n\nexport function scalePoint(p1: Point, scale: number): Point {\n  return { x: p1.x / scale, y: p1.y / scale };\n}\n\n// export function distanceBetweenPoints(p1: Point, p2: Point): number {\n//   return Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2));\n// }\n","import { HSConnection } from \"hotstuff-network\";\n\nconst config = {\n  defaultTempDegC: 23,\n  defaultCapJPerDegK: 1,\n  defaultPowerGenW: 0,\n  canvasHeightPerc: 0.7,\n  editorWidthPerc: 0.3,\n  defaultTotalTimeSeconds: 60,\n  defaultTimeStepSeconds: 0.1,\n  defaultNodeRadius: 20,\n  defaultResistanceDegKPerW: 10,\n  defaultConnectionKind: \"bi\" as HSConnection[\"kind\"],\n  newNodeNamePrefix: \"New Node\",\n  zoomSensitivity: 1000, // bigger = less zoom per click\n  minZoom: 0.25,\n  maxZoom: 5,\n  activeNodeOutlineWidth: 5,\n  tabHeightPx: 25,\n  plotHeightBufferPx: 10,\n  tableDeleteCellWidthPerc: 0.1,\n  tableDeleteCellMinWidthPx: 40,\n  plotMargin: {\n    left: 10,\n    right: 20,\n    top: 20,\n    bottom: 20,\n  },\n};\n\nexport default config;\n","import styled from \"styled-components/macro\";\n\nexport const StyledTableWrapper = styled.div`\n  width: 100%;\n`;\n\nexport const StyledTable = styled.div`\n  width: 100%;\n  border-collapse: collapse;\n`;\n\nexport const StyledTableBody = styled.div`\n  width: 100%;\n`;\n\nexport const StyledRow = styled.div<{\n  heightOffsetPx?: number;\n  isActive: boolean;\n}>`\n  display: inline-flex;\n  align-items: center;\n  min-width: 100%;\n  position: sticky;\n  top: ${({ heightOffsetPx }) =>\n    heightOffsetPx ? `${heightOffsetPx}px` : \"0px\"};\n  background: ${({ isActive }) =>\n    isActive ? \"rgba(112, 165, 255, 0.2)\" : \"none\"};\n`;\n\nexport const StyledCell = styled.div<{ width: number; minWidth?: number }>`\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid #ddd;\n  height: 2em;\n  width: ${({ width }) => `${width * 100}%`};\n  min-width: ${({ minWidth }) => (!!minWidth ? `${minWidth}px` : \"none\")};\n`;\n\nexport const StyledDeleteCell = styled(StyledCell)`\n  cursor: pointer;\n  user-select: none;\n  min-width: 40px;\n\n  &:hover {\n    background: black;\n  }\n`;\n\nexport const StyledHeaderWrapper = styled.div<{ heightOffsetPx?: number }>`\n  display: flex;\n  width: 100%;\n  height: 100%;\n  position: sticky;\n  top: ${({ heightOffsetPx }) =>\n    heightOffsetPx ? `${heightOffsetPx}px` : \"0px\"};\n  z-index: 1;\n`;\n\nexport const StyledColHeader = styled.div<{ width: number; minWidth?: number }>`\n  display: inline-flex;\n  width: ${({ width }) => `${width * 100}%`};\n  min-width: ${({ minWidth }) => (!!minWidth ? `${minWidth}px` : \"none\")};\n  justify-content: center;\n  align-items: center;\n  font-weight: bold;\n  border: 1px solid lightgrey;\n  cursor: pointer;\n  user-select: none;\n  position: relative;\n  background: white;\n  border-bottom: 1px solid black;\n`;\n\nexport const StyledColText = styled.div`\n  font-size: 0.8em;\n  padding: 1em;\n`;\n\nexport const StyledSortIcon = styled.div`\n  position: absolute;\n  bottom: 0;\n  right: 50%;\n  transform: translate(50%);\n`;\n","import config from \"../../../config\";\nimport {\n  StyledColHeader,\n  StyledColText,\n  StyledHeaderWrapper,\n  StyledSortIcon,\n} from \"./style\";\nimport * as React from \"react\";\nimport { SortDirection, TableColumn, TableSortState } from \"./types\";\n\ntype TableHeaderProps<T> = {\n  columns: TableColumn<T>[];\n  sortState: TableSortState<T>;\n  setSortState: React.Dispatch<React.SetStateAction<TableSortState<T>>>;\n};\n\nfunction oppositeSortDirection(sortDirection: SortDirection): SortDirection {\n  return sortDirection === \"ASC\" ? \"DESC\" : \"ASC\";\n}\n\nexport default function TableHeader<T>(\n  props: TableHeaderProps<T>\n): React.ReactElement {\n  const { columns, sortState, setSortState } = props;\n\n  const sortIcon = !sortState\n    ? \"\"\n    : sortState.direction === \"ASC\"\n    ? \"\\u25B2\"\n    : \"\\u25BC\";\n\n  return (\n    <StyledHeaderWrapper heightOffsetPx={config.tabHeightPx}>\n      {columns.map((col) => {\n        const isSortedCol = sortState && sortState.key === col.key;\n        const onClick = () => {\n          setSortState({\n            key: col.key,\n            direction:\n              !isSortedCol || !sortState\n                ? \"ASC\"\n                : oppositeSortDirection(sortState.direction),\n          });\n        };\n\n        return (\n          <StyledColHeader\n            key={col.key.toString()}\n            onClick={onClick}\n            width={col.width}\n            minWidth={col.minWidthPx}\n          >\n            <StyledColText>{col.text}</StyledColText>\n            <StyledSortIcon>{isSortedCol ? sortIcon : \"\"}</StyledSortIcon>\n          </StyledColHeader>\n        );\n      })}\n      <StyledColHeader\n        width={config.tableDeleteCellWidthPerc}\n        minWidth={config.tableDeleteCellMinWidthPx}\n        style={{ cursor: \"unset\" }}\n      />\n    </StyledHeaderWrapper>\n  );\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { CellOption } from \"../types\";\n\nconst StyledSelect = styled.select`\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n  background: unset;\n`;\n\nexport type DropDownTableCellProps = {\n  rowId: string;\n  options: CellOption[];\n  setOption?: CellOption;\n  onSelectOption: (id: string, option: CellOption) => void;\n  optionsFilter?: (option: CellOption) => CellOption[];\n};\n\nexport default function DropDownTableCell(\n  props: DropDownTableCellProps\n): React.ReactElement {\n  function handleChange(event: React.ChangeEvent<HTMLSelectElement>) {\n    const newVal = event.target.value;\n\n    const selectedOption = props.options.find((option) => option.id === newVal);\n\n    if (selectedOption !== undefined) {\n      props.onSelectOption(props.rowId, selectedOption);\n    }\n  }\n\n  return (\n    <StyledSelect value={props.setOption?.id} onChange={handleChange}>\n      {props.options.map((option) => (\n        <option key={option.id} value={option.id}>\n          {option.text}\n        </option>\n      ))}\n    </StyledSelect>\n  );\n}\n","import styled from \"styled-components/macro\";\n\nexport const StyledInput = styled.input`\n  display: inline-block;\n  border: none;\n  width: 100%;\n  height: 100%;\n  text-align: center;\n  padding: 0;\n  background: unset;\n\n  &::-webkit-inner-spin-button,\n  &::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n`;\n","import React, { useCallback, useState } from \"react\";\nimport { StyledInput } from \"./style\";\n\ninterface CanBeMadeString {\n  toString: () => string;\n}\n\ntype EditableInputProps<T> = {\n  initialValue: T;\n  onBlur: (value: T) => void;\n  getNewValue: (event: React.ChangeEvent<HTMLInputElement>) => T | undefined;\n};\n\nexport default function EditableInput<T extends CanBeMadeString>(\n  props: EditableInputProps<T>\n): React.ReactElement {\n  const [value, setValue] = useState<string>(props.initialValue.toString());\n\n  const { initialValue, onBlur, getNewValue } = props;\n\n  function handleOnChange(event: React.ChangeEvent<HTMLInputElement>) {\n    const newVal = event.target.value;\n    if (newVal !== undefined) {\n      setValue(newVal);\n    }\n  }\n\n  const handleOnBlur = useCallback(\n    (event: React.ChangeEvent<HTMLInputElement>) => {\n      const newVal = getNewValue(event);\n      if (event.target.value === initialValue.toString()) {\n        return;\n      } else if (newVal !== undefined) {\n        setValue(newVal.toString());\n        onBlur(newVal);\n      } else {\n        setValue(initialValue.toString());\n        onBlur(initialValue);\n      }\n    },\n    [getNewValue, initialValue, onBlur]\n  );\n\n  return (\n    <StyledInput\n      type=\"text\"\n      value={value}\n      onChange={handleOnChange}\n      onBlur={handleOnBlur}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableInput from \"./EditableInput\";\n\ntype EditableStringInputProps = {\n  initialValue: string;\n  onBlur: (value: string) => void;\n};\n\nexport default function EditableStringInput(\n  props: EditableStringInputProps\n): React.ReactElement {\n  return (\n    <EditableInput<string>\n      initialValue={props.initialValue}\n      onBlur={props.onBlur}\n      getNewValue={(event: React.ChangeEvent<HTMLInputElement>) =>\n        event.target.value\n      }\n    />\n  );\n}\n","import React from \"react\";\nimport EditableStringInput from \"../../EditableStringInput\";\n\nexport type TextTableCellProps = {\n  initialVal: string;\n  onBlur: (newValue: string) => void;\n};\n\nexport default function TextTableCell(\n  props: TextTableCellProps\n): React.ReactElement {\n  return (\n    <EditableStringInput\n      initialValue={props.initialVal}\n      onBlur={props.onBlur}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableInput from \"./EditableInput\";\n\nfunction getFloatVal(\n  event: React.ChangeEvent<HTMLInputElement>\n): number | undefined {\n  const newValueText = event.target.value;\n  // things like 123.3abc will still parse as 123.3\n  const newValueFloat = parseFloat(event.target.value);\n  if (newValueText === undefined || isNaN(newValueFloat)) {\n    return undefined;\n  }\n  return newValueFloat;\n}\n\ntype EditableNumberInputProps = {\n  initialValue: number;\n  onBlur: (value: number) => void;\n};\n\nexport default function EditableNumberInput(\n  props: EditableNumberInputProps\n): React.ReactElement {\n  return (\n    <EditableInput<number>\n      initialValue={props.initialValue}\n      onBlur={props.onBlur}\n      getNewValue={getFloatVal}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableNumberInput from \"../../EditableNumberInput\";\n\nexport type NumericalTableCellProps = {\n  initialVal: number;\n  onBlur: (newValue: number) => void;\n};\n\nexport default function NumericalTableCell(\n  props: NumericalTableCellProps\n): React.ReactElement {\n  return (\n    <EditableNumberInput\n      initialValue={props.initialVal}\n      onBlur={props.onBlur}\n    />\n  );\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst StyledCheckbox = styled.div`\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  user-select: none;\n`;\n\nexport type BooleanTableCellProps = {\n  initialIsActive?: boolean;\n  onClick: (isActive: boolean) => void;\n  showWhenActive: string;\n};\n\nexport default function BooleanTableCell(\n  props: BooleanTableCellProps\n): React.ReactElement {\n  const [isActive, setIsActive] = useState<boolean>(\n    props.initialIsActive !== undefined ? props.initialIsActive : false\n  );\n\n  return (\n    <StyledCheckbox\n      tabIndex={0}\n      onKeyUp={(event: React.KeyboardEvent) => {\n        if (event.key === \"Enter\") {\n          setIsActive(!isActive);\n          props.onClick(!isActive);\n        }\n      }}\n      onClick={() => {\n        setIsActive(!isActive);\n        props.onClick(!isActive);\n      }}\n    >\n      &nbsp;{isActive ? props.showWhenActive : \"\"}\n    </StyledCheckbox>\n  );\n}\n","import * as React from \"react\";\nimport DropDownTableCell from \"./cells/DropDownTableCell\";\nimport TextTableCell from \"./cells/TextTableCell\";\nimport NumericalTableCell from \"./cells/NumericalTableCell\";\nimport BooleanTableCell from \"./cells/BooleanTableCell\";\nimport { CellOption, TableColumn } from \"./types\";\n\ntype TableCellType = {\n  id: string;\n};\n\ntype TableCellProps<T extends TableCellType> = {\n  row: T;\n  col: TableColumn<T>;\n  options?: CellOption[];\n  initiallySetOption?: CellOption;\n  onUpdateRow: (row: T) => void;\n};\n\nexport default function TableCell<T extends TableCellType>(\n  props: TableCellProps<T>\n): React.ReactElement {\n  const { row, col, options, initiallySetOption, onUpdateRow } = props;\n  const initialVal = row[col.key];\n\n  if (!!options && options.length > 0 && col.onSelectOption) {\n    return (\n      <DropDownTableCell\n        rowId={row.id}\n        options={options}\n        setOption={initiallySetOption}\n        onSelectOption={col.onSelectOption}\n      />\n    );\n  } else if (typeof initialVal === \"string\") {\n    return (\n      <TextTableCell\n        initialVal={initialVal}\n        onBlur={(newVal) => onUpdateRow({ ...row, [col.key]: newVal })}\n      />\n    );\n  } else if (\n    typeof initialVal === \"number\" &&\n    typeof row[col.key] === \"number\"\n  ) {\n    return (\n      <NumericalTableCell\n        initialVal={initialVal}\n        onBlur={(newVal) => onUpdateRow({ ...row, [col.key]: newVal })}\n      />\n    );\n  } else if (typeof initialVal === \"boolean\") {\n    return (\n      <BooleanTableCell\n        initialIsActive={initialVal}\n        onClick={(newVal) => onUpdateRow({ ...row, [col.key]: newVal })}\n        showWhenActive={\"✅\"}\n      />\n    );\n  } else {\n    return <></>;\n  }\n}\n","import { useState } from \"react\";\nimport { TableSortState } from \"../types\";\n\nexport default function useSortableTable<T>(props: {\n  default: TableSortState<T>;\n}): [\n  TableSortState<T>,\n  React.Dispatch<React.SetStateAction<TableSortState<T>>>,\n  (first: T, second: T) => number\n] {\n  const [sortState, setSortState] = useState<TableSortState<T>>(props.default);\n\n  function sortByState(first: T, second: T): number {\n    if (first[sortState.key] > second[sortState.key]) {\n      return sortState.direction === \"ASC\" ? 1 : -1;\n    } else {\n      return sortState.direction === \"ASC\" ? -1 : 1;\n    }\n  }\n\n  return [sortState, setSortState, sortByState];\n}\n","import React from \"react\";\nimport config from \"../../../../config\";\nimport { AppNode } from \"../../../../App\";\nimport {\n  StyledCell,\n  StyledDeleteCell,\n  StyledRow,\n  StyledTable,\n  StyledTableBody,\n  StyledTableWrapper,\n} from \"../style\";\nimport { TableColumn, TableSortState } from \"../types\";\nimport TableHeader from \"../TableHeader\";\nimport TableCell from \"../TableCell\";\nimport useSortableTable from \"../hooks/useSortableTable\";\n\ntype NodeTableColumn = TableColumn<AppNode>;\n\nconst defaultNodeSortState: TableSortState<AppNode> = {\n  key: \"name\",\n  direction: \"ASC\",\n};\n\nconst nodeColumns: NodeTableColumn[] = [\n  {\n    key: \"name\",\n    text: \"Name\",\n    width: 0.2,\n    minWidthPx: 100,\n  },\n  {\n    key: \"temperatureDegC\",\n    text: \"Temp degC\",\n    width: 0.2,\n    minWidthPx: 100,\n  },\n  {\n    key: \"capacitanceJPerDegK\",\n    text: \"Capacitance J/degK\",\n    width: 0.2,\n    minWidthPx: 100,\n  },\n  {\n    key: \"powerGenW\",\n    text: \"Power Gen W\",\n    width: 0.15,\n    minWidthPx: 80,\n  },\n  {\n    key: \"isBoundary\",\n    text: \"Boundary?\",\n    width: 0.15,\n    minWidthPx: 80,\n  },\n];\n\ntype NodeTableProps = {\n  rows: AppNode[];\n  onUpdateRow: (row: AppNode) => void;\n  onDeleteRow: (row: AppNode) => void;\n};\n\nexport default function NodeTable(props: NodeTableProps): React.ReactElement {\n  const [sortState, setSortState, sortByState] = useSortableTable<AppNode>({\n    default: defaultNodeSortState,\n  });\n\n  const { rows, onUpdateRow, onDeleteRow } = props;\n\n  const sortedRows = rows.sort(sortByState);\n\n  const tableRows = sortedRows.map((row) => {\n    return (\n      <StyledRow\n        key={row.id}\n        heightOffsetPx={config.tabHeightPx}\n        isActive={row.isActive}\n      >\n        {nodeColumns.map((col) => {\n          const tableCell = (\n            <TableCell<AppNode> row={row} col={col} onUpdateRow={onUpdateRow} />\n          );\n          return (\n            <StyledCell\n              key={col.key}\n              width={col.width}\n              minWidth={col.minWidthPx}\n            >\n              {tableCell}\n            </StyledCell>\n          );\n        })}\n        <StyledDeleteCell\n          tabIndex={0}\n          onKeyUp={(event: React.KeyboardEvent) => {\n            if (event.key === \"Enter\") {\n              onDeleteRow(row);\n            }\n          }}\n          width={config.tableDeleteCellWidthPerc}\n          minWidth={config.tableDeleteCellMinWidthPx}\n          onClick={() => onDeleteRow(row)}\n        >\n          ❌\n        </StyledDeleteCell>\n      </StyledRow>\n    );\n  });\n\n  return (\n    <StyledTableWrapper>\n      <StyledTable>\n        <TableHeader<AppNode>\n          columns={nodeColumns}\n          sortState={sortState}\n          setSortState={setSortState}\n        />\n        <StyledTableBody>{tableRows}</StyledTableBody>\n      </StyledTable>\n    </StyledTableWrapper>\n  );\n}\n","import React, { useCallback, useMemo } from \"react\";\nimport config from \"../../../../config\";\nimport { AppConnection, AppNode } from \"../../../../App\";\nimport {\n  StyledCell,\n  StyledDeleteCell,\n  StyledRow,\n  StyledTable,\n  StyledTableBody,\n  StyledTableWrapper,\n} from \"../style\";\nimport { CellOption, TableColumn, TableSortState } from \"../types\";\nimport TableHeader from \"../TableHeader\";\nimport TableCell from \"../TableCell\";\nimport useSortableTable from \"../hooks/useSortableTable\";\nimport { ConnectionKind } from \"../../../types\";\n\nexport type AppConnectionTable = AppConnection & { isActive: boolean };\ntype ConnectionTableColumn = TableColumn<AppConnection>;\n\nconst defaultConnectionSortState: TableSortState<AppConnectionTable> = {\n  key: \"sourceName\",\n  direction: \"ASC\",\n};\n\nconst connectionTypes: CellOption[] = [\n  {\n    id: \"bi\",\n    text: \"Bidirectional\",\n  },\n  {\n    id: \"uni\",\n    text: \"Unidirectional\",\n  },\n  {\n    id: \"rad\",\n    text: \"Radiative\",\n  },\n];\n\nfunction filterConnectionOptions(\n  colKey: string,\n  options: CellOption[],\n  selectedSourceId: string,\n  selectedTargetId: string,\n  connections: AppConnection[]\n): CellOption[] {\n  const otherConnections = connections.filter(\n    (conn) =>\n      !(\n        conn.source.id === selectedSourceId &&\n        conn.target.id === selectedTargetId\n      )\n  );\n\n  if (colKey === \"sourceName\") {\n    // options for source node\n    const noSelfConnectionOptions = options.filter(\n      (option) => option.id !== selectedTargetId\n    );\n    // for each source option, there is no other connection that already matches the source -> target or target -> source\n    return noSelfConnectionOptions.filter((option) => {\n      return !otherConnections.some(\n        (c) =>\n          (c.source.id === option.id && c.target.id === selectedTargetId) ||\n          (c.source.id === selectedTargetId && c.target.id === option.id)\n      );\n    });\n  } else if (colKey === \"targetName\") {\n    // options for target node\n    const noSelfConnectionOptions = options.filter(\n      (option) => option.id !== selectedSourceId\n    );\n    // for each target option, there is no other connection that already matches the source -> target or target -> source\n    return noSelfConnectionOptions.filter((option) => {\n      return !otherConnections.some(\n        (c) =>\n          (c.source.id === selectedSourceId && c.target.id === option.id) ||\n          (c.source.id === option.id && c.target.id === selectedSourceId)\n      );\n    });\n  } else {\n    return options;\n  }\n}\n\ntype ConnectionTableProps = {\n  rows: AppConnection[];\n  nodes: AppNode[];\n  onUpdateRow: (row: AppConnection) => void;\n  onDeleteRow: (row: AppConnection) => void;\n};\n\nexport default function ConnectionTable(\n  props: ConnectionTableProps\n): React.ReactElement {\n  const [sortState, setSortState, sortByState] =\n    useSortableTable<AppConnectionTable>({\n      default: defaultConnectionSortState,\n    });\n\n  const onSelectNewSource = useCallback(\n    (id: string, option: CellOption) => {\n      const connection = props.rows.find((conn) => conn.id === id);\n      const newSourceNode = props.nodes.find((node) => node.id === option.id);\n      if (\n        !connection ||\n        !newSourceNode ||\n        newSourceNode.id === connection.target.id\n      ) {\n        return;\n      }\n      props.onUpdateRow({\n        ...connection,\n        source: newSourceNode,\n        sourceName: newSourceNode.name,\n      });\n    },\n    [props]\n  );\n\n  const onSelectNewTarget = useCallback(\n    (id: string, option: CellOption) => {\n      const connection = props.rows.find((conn) => conn.id === id);\n      const newTargetNode = props.nodes.find((node) => node.id === option.id);\n      if (\n        !connection ||\n        !newTargetNode ||\n        newTargetNode.id === connection.source.id\n      ) {\n        return;\n      }\n      props.onUpdateRow({\n        ...connection,\n        target: newTargetNode,\n        targetName: newTargetNode.name,\n      });\n    },\n    [props]\n  );\n\n  const onSelectNewConnectionType = useCallback(\n    (id: string, option: CellOption) => {\n      const rowToUpdate = props.rows.find((conn) => conn.id === id);\n      if (rowToUpdate) {\n        props.onUpdateRow({\n          ...rowToUpdate,\n          kind: option.id as ConnectionKind,\n        });\n      }\n    },\n    [props]\n  );\n\n  const nodeOptions: CellOption[] = props.nodes.map((node) => ({\n    id: node.id,\n    text: node.name,\n  }));\n\n  const connectionColumns: ConnectionTableColumn[] = useMemo(\n    () => [\n      {\n        text: \"Source\",\n        key: \"sourceName\",\n        width: 0.25,\n        minWidthPx: 100,\n        options: nodeOptions,\n        onSelectOption: onSelectNewSource,\n      },\n      {\n        text: \"Target\",\n        key: \"targetName\",\n        width: 0.25,\n        minWidthPx: 100,\n        options: nodeOptions,\n        onSelectOption: onSelectNewTarget,\n      },\n      {\n        text: \"Resistance degK/W\",\n        key: \"resistanceDegKPerW\",\n        width: 0.25,\n        minWidthPx: 100,\n      },\n      {\n        text: \"Kind\",\n        key: \"kind\",\n        width: 0.25,\n        minWidthPx: 100,\n        options: connectionTypes,\n        onSelectOption: onSelectNewConnectionType,\n      },\n    ],\n    [\n      nodeOptions,\n      onSelectNewConnectionType,\n      onSelectNewSource,\n      onSelectNewTarget,\n    ]\n  );\n\n  const activeNodeIds = props.nodes\n    .filter((node) => node.isActive)\n    .map((node) => node.id);\n\n  const sortedRowsWithIsActive: AppConnectionTable[] = props.rows\n    .map((row) => {\n      return {\n        ...row,\n        isActive:\n          activeNodeIds.includes(row.source.id) ||\n          activeNodeIds.includes(row.target.id),\n      };\n    })\n    .sort(sortByState);\n\n  const tableRows = sortedRowsWithIsActive.map((row) => {\n    return (\n      <StyledRow\n        key={row.id}\n        heightOffsetPx={config.tabHeightPx}\n        isActive={row.isActive}\n      >\n        {connectionColumns.map((col) => {\n          const tableCell = (\n            <TableCell<AppConnectionTable>\n              row={row}\n              col={col}\n              options={filterConnectionOptions(\n                col.key,\n                col.options || [],\n                row.source.id,\n                row.target.id,\n                props.rows\n              )}\n              initiallySetOption={col.options?.find(\n                (option) =>\n                  option.id === row[col.key] || option.text === row[col.key]\n              )}\n              onUpdateRow={props.onUpdateRow}\n            />\n          );\n          return (\n            <StyledCell\n              key={col.key}\n              width={col.width}\n              minWidth={col.minWidthPx}\n            >\n              {tableCell}\n            </StyledCell>\n          );\n        })}\n        <StyledDeleteCell\n          width={config.tableDeleteCellWidthPerc}\n          minWidth={config.tableDeleteCellMinWidthPx}\n          onClick={() => props.onDeleteRow(row)}\n        >\n          ❌\n        </StyledDeleteCell>\n      </StyledRow>\n    );\n  });\n\n  return (\n    <StyledTableWrapper>\n      <StyledTable>\n        <TableHeader<AppConnectionTable>\n          columns={connectionColumns}\n          sortState={sortState}\n          setSortState={setSortState}\n        />\n        <StyledTableBody>{tableRows}</StyledTableBody>\n      </StyledTable>\n    </StyledTableWrapper>\n  );\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components/macro\";\nimport config from \"../../config\";\n\nconst StyledTabsWrapper = styled.div`\n  display: inline-flex;\n  width: 100%;\n  flex-direction: column;\n  overflow: auto;\n  position: relative;\n`;\n\nconst StyledTabs = styled.div`\n  display: inline-flex;\n  width: 100%;\n  height: ${config.tabHeightPx}px;\n  justify-content: space-evenly;\n  position: sticky;\n  top: 0px;\n  background: white;\n  box-sizing: border-box;\n  z-index: 1;\n`;\n\nconst StyledTab = styled.div<{ width: number }>`\n  display: inline-flex;\n  width: ${({ width }) => `${width * 100}%`};\n  cursor: pointer;\n  text-decoration: none;\n  align-items: center;\n  background: lightgray;\n  /* background: rgb(85, 9, 121);\n  background: linear-gradient(\n    90deg,\n    rgba(85, 9, 121, 1) 0%,\n    rgba(255, 0, 230, 1) 49%,\n    rgba(46, 228, 233, 1) 100%\n  ); */\n  border-radius: 5px 5px 0 0;\n  border: 1px solid black;\n  border-bottom: 2px solid black;\n\n  &:hover {\n    opacity: 0.75;\n  }\n`;\n\nconst StyledTabText = styled.div`\n  font-size: 1.1em;\n  padding: 0.2em 0.5em;\n\n  &.active {\n    font-weight: bold;\n  }\n`;\n\nconst StyledInnerContent = styled.div<{ topLeftRounded: boolean }>`\n  background: white;\n  position: relative;\n`;\n\ntype Tab = {\n  text: string;\n  component: React.ReactElement;\n  width: number; // between 0 and 1\n};\n\nexport type TabsProps = {\n  tabs: Tab[];\n};\n\nexport default function Tabs(props: TabsProps): React.ReactElement {\n  const [activeIdx, setActiveIdx] = useState(0);\n\n  return (\n    <StyledTabsWrapper>\n      {props.tabs.length > 1 && (\n        <StyledTabs>\n          {props.tabs.map((tab, idx) => {\n            return (\n              <StyledTab\n                key={tab.text}\n                onClick={() => setActiveIdx(idx)}\n                width={tab.width}\n              >\n                <StyledTabText className={idx === activeIdx ? \"active\" : \"\"}>\n                  {tab.text}\n                </StyledTabText>\n              </StyledTab>\n            );\n          })}\n        </StyledTabs>\n      )}\n\n      <StyledInnerContent topLeftRounded={props.tabs.length <= 1}>\n        {props.tabs.filter((_, idx) => idx === activeIdx)[0].component}\n      </StyledInnerContent>\n    </StyledTabsWrapper>\n  );\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport EditableNumberInput from \"./EditableNumberInput\";\nimport { Timing } from \"../../App\";\n\nconst StyledModelControlsWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n  justify-content: center;\n  align-items: center;\n  border-top: 3px solid black;\n  padding-top: 1em;\n`;\n\nconst StyledRunButton = styled.button``;\n\nconst StyledTimeControls = styled.div``;\n\nconst StyledTimeControl = styled.div`\n  display: flex;\n  width: 100%;\n  align-items: center;\n  justify-content: space-between;\n  margin: 0.5em;\n`;\n\nconst StyledInputWrapper = styled.div`\n  max-width: 3em;\n  height: 1.5em;\n`;\n\nconst StyledLabel = styled.label`\n  margin-right: 0.2em;\n`;\n\nexport type ModelControlsProps = {\n  onRunModel: () => void;\n  timing: Timing;\n  setTiming: React.Dispatch<React.SetStateAction<Timing>>;\n};\n\nexport default function ModelControls(\n  props: ModelControlsProps\n): React.ReactElement {\n  const { onRunModel, timing, setTiming } = props;\n\n  return (\n    <StyledModelControlsWrapper>\n      <StyledTimeControls>\n        <StyledTimeControl>\n          <StyledLabel>Run Time [s]:</StyledLabel>\n          <StyledInputWrapper>\n            <EditableNumberInput\n              initialValue={timing.totalTimeS}\n              onBlur={(newTotalTimeS: number) =>\n                setTiming((prevTiming) => ({\n                  ...prevTiming,\n                  totalTimeS: newTotalTimeS,\n                }))\n              }\n            />\n          </StyledInputWrapper>\n        </StyledTimeControl>\n        <StyledTimeControl>\n          <StyledLabel>Time Step [s]:</StyledLabel>\n          <StyledInputWrapper>\n            <EditableNumberInput\n              initialValue={timing.timeStepS}\n              onBlur={(newTimeStepS: number) =>\n                setTiming((prevTiming) => ({\n                  ...prevTiming,\n                  timeStepS: newTimeStepS,\n                }))\n              }\n            />\n          </StyledInputWrapper>\n        </StyledTimeControl>\n      </StyledTimeControls>\n      <StyledRunButton onClick={onRunModel}>Run Model</StyledRunButton>\n    </StyledModelControlsWrapper>\n  );\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { AppConnection, AppNode, Timing } from \"../../App\";\nimport NodeTable from \"./EditableTable/NodeTable/NodeTable\";\nimport ConnectionTable from \"./EditableTable/ConnectionTable/ConnectionTable\";\nimport Tabs from \"../Tabs/Tabs\";\nimport ModelControls from \"./ModelControls\";\n\nconst StyledEditor = styled.div<{ width: number; height: number }>`\n  height: ${(props) => props.height}px;\n  width: ${(props) => props.width}px;\n  border-left: 3px solid black;\n`;\n\nconst StyledTables = styled.div`\n  display: inline-flex;\n  width: 100%;\n  height: 50%;\n`;\n\nconst StyledModelControlsWrapper = styled.div`\n  display: inline-flex;\n  width: 100%;\n`;\n\ntype SidebarProps = {\n  width: number;\n  height: number;\n  timing: Timing;\n  setTiming: React.Dispatch<React.SetStateAction<Timing>>;\n  nodes: AppNode[];\n  connections: AppConnection[];\n  // addNode: (node: AppNode) => void;\n  updateNodes: (nodes: AppNode[], clearActiveNodes: boolean) => void;\n  deleteNodes: (nodeIds: string[]) => void;\n  updateConnections: (connections: AppConnection[]) => void;\n  deleteConnections: (connectionIds: string[]) => void;\n  onRunModel: () => void;\n};\n\nexport default function Sidebar(props: SidebarProps): React.ReactElement {\n  const nodeTable = (\n    <NodeTable\n      rows={props.nodes}\n      onUpdateRow={(node: AppNode) => props.updateNodes([node], false)}\n      onDeleteRow={(node: AppNode) => props.deleteNodes([node.id])}\n    />\n  );\n\n  const connectionTable = (\n    <ConnectionTable\n      rows={props.connections}\n      nodes={props.nodes}\n      onUpdateRow={(connection: AppConnection) =>\n        props.updateConnections([connection])\n      }\n      onDeleteRow={(connection: AppConnection) =>\n        props.deleteConnections([connection.id])\n      }\n    />\n  );\n\n  return (\n    <StyledEditor width={props.width} height={props.height}>\n      <StyledTables>\n        <Tabs\n          tabs={[\n            { text: \"Nodes\", component: nodeTable, width: 0.5 },\n            { text: \"Connections\", component: connectionTable, width: 0.5 },\n          ]}\n        />\n      </StyledTables>\n      <StyledModelControlsWrapper>\n        <ModelControls\n          onRunModel={props.onRunModel}\n          timing={props.timing}\n          setTiming={props.setTiming}\n        />\n      </StyledModelControlsWrapper>\n    </StyledEditor>\n  );\n}\n","import {\n  CartesianGrid,\n  Legend,\n  LineChart,\n  ResponsiveContainer,\n  Tooltip,\n  XAxis,\n  YAxis,\n} from \"recharts\";\nimport * as React from \"react\";\nimport { PlotDimensions } from \"./Plot\";\n\ntype LinePlotProps = {\n  plotDimensions: PlotDimensions;\n  plotData?: ReadonlyArray<Record<string, unknown>>;\n  lines: React.ReactElement[];\n  xAxisKey: string;\n  xLabel: string;\n  yLabel: string;\n};\n\nexport default function LinePlot(props: LinePlotProps): React.ReactElement {\n  const { plotDimensions, plotData, lines, xAxisKey, xLabel, yLabel } = props;\n\n  return (\n    <ResponsiveContainer\n      height={plotDimensions.height}\n      width={plotDimensions.width}\n      className=\"chart\"\n    >\n      <LineChart\n        height={plotDimensions.height}\n        width={plotDimensions.width}\n        margin={plotDimensions.margin}\n        data={plotData}\n      >\n        <CartesianGrid strokeDasharray=\"3 3\" />\n        <XAxis\n          dataKey={xAxisKey}\n          label={{\n            value: xLabel,\n            position: \"center\",\n            dy: 20,\n          }}\n        />\n        <YAxis\n          label={{\n            value: yLabel,\n            position: \"center\",\n            angle: -90,\n            dx: -20,\n          }}\n        />\n        <Tooltip />\n        <Legend\n          layout=\"horizontal\"\n          verticalAlign=\"top\"\n          align=\"center\"\n          wrapperStyle={{\n            paddingLeft: \"10px\",\n          }}\n          // fontSize={5}\n        />\n        {lines}\n      </LineChart>\n    </ResponsiveContainer>\n  );\n}\n","import * as React from \"react\";\nimport { useMemo } from \"react\";\nimport { Line } from \"recharts\";\nimport styled from \"styled-components\";\nimport { emptyOutput, ModelOutput } from \"hotstuff-network\";\nimport LinePlot from \"./LinePlot\";\nimport Tabs from \"../Tabs/Tabs\";\n\nconst MAX_PLOT_POINTS_PER_NODE = 400;\nconst colors = [\n  \"#2ecc71\",\n  \"#3498db\",\n  \"#9b59b6\",\n  \"#e74c3c\",\n  \"#e67e22\",\n  \"#34495e\",\n  \"#16a085\",\n];\n\nconst StyledCharts = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n\n  .chart {\n    width: 60% !important;\n    max-width: 900px;\n\n    @media only screen and (max-width: 600px) {\n      width: 90% !important;\n      touch-action: pan-y;\n    }\n  }\n`;\n\n{\n  /*  */\n}\n\nconst StyledPlot = styled.div<{ height: number; width: number }>`\n  width: 100%;\n  height: ${(props) => props.height}px;\n  border-top: 3px solid black;\n  margin: 0;\n  padding: 0;\n`;\n\ntype Margin = {\n  left: number;\n  right: number;\n  top: number;\n  bottom: number;\n};\n\nexport type PlotDimensions = {\n  height: number;\n  width: number;\n  margin: Margin;\n};\n\ntype PlotDataForTime = {\n  time: number;\n  [key: string]: number;\n};\n\nfunction plotShape(data: ModelOutput): [PlotDataForTime[], PlotDataForTime[]] {\n  const lowerMag = Math.floor(Math.log10(data.totalTimeS));\n  const divisibleBy = Math.pow(10, lowerMag - 1);\n\n  function include(val: number) {\n    return Math.abs(val % divisibleBy) === 0;\n  }\n\n  const includeAll = data.timeSeriesS.length < MAX_PLOT_POINTS_PER_NODE;\n\n  const tempsAtAllTimes: PlotDataForTime[] = [];\n  const heatTransfersAtAllTimes: PlotDataForTime[] = [];\n\n  data.timeSeriesS.forEach((t, idx) => {\n    if (includeAll || include(t)) {\n      const temp: PlotDataForTime = { time: t };\n      const ht: PlotDataForTime = { time: t };\n      data.nodeResults.forEach((nodeResult) => {\n        temp[nodeResult.node.name] = nodeResult.tempDegC[idx];\n      });\n      data.connectionResults.forEach((connectionResult) => {\n        ht[\n          `${connectionResult.connection.source.name} to ${connectionResult.connection.target.name}`\n        ] = connectionResult.heatTransferW[idx];\n      });\n      tempsAtAllTimes.push(temp);\n      heatTransfersAtAllTimes.push(ht);\n    }\n  });\n  return [tempsAtAllTimes, heatTransfersAtAllTimes];\n}\n\ntype PlotProps = {\n  plotDimensions: PlotDimensions;\n  modelOutput?: ModelOutput;\n};\n\nexport default function Plot(props: PlotProps): React.ReactElement {\n  const res =\n    !!props.modelOutput && props.modelOutput.nodeResults.length > 0\n      ? props.modelOutput\n      : emptyOutput;\n\n  const [tempPlotData, heatTransferPlotData] = plotShape(res);\n\n  const heatTransferLines = useMemo(\n    () =>\n      res.connectionResults.map((connectionResult, idx) => {\n        return (\n          <Line\n            key={connectionResult.connection.id}\n            type={\"monotone\"}\n            dataKey={`${connectionResult.connection.source.name} to ${connectionResult.connection.target.name}`}\n            stroke={colors[idx]}\n            activeDot={{ r: 8 }}\n            isAnimationActive={false}\n          />\n        );\n      }),\n    [res.connectionResults]\n  );\n\n  const tempLines = useMemo(\n    () =>\n      res.nodeResults.map((nodeResult, idx) => {\n        return (\n          <Line\n            key={nodeResult.node.id}\n            type={\"monotone\"}\n            dataKey={nodeResult.node.name}\n            stroke={colors[idx]}\n            activeDot={{ r: 8 }}\n            isAnimationActive={false}\n          />\n        );\n      }),\n    [res.nodeResults]\n  );\n\n  const tempPlot = (\n    <LinePlot\n      plotDimensions={props.plotDimensions}\n      plotData={tempPlotData}\n      lines={tempLines}\n      xAxisKey={\"time\"}\n      xLabel={\"Time [s]\"}\n      yLabel={\"Temperature [degC]\"}\n    />\n  );\n\n  const heatTransferPlot = (\n    <LinePlot\n      plotDimensions={props.plotDimensions}\n      plotData={heatTransferPlotData}\n      lines={heatTransferLines}\n      xAxisKey={\"time\"}\n      xLabel={\"Time [s]\"}\n      yLabel={\"Heat Transfer [Watts]\"}\n    />\n  );\n\n  return (\n    <StyledPlot\n      height={props.plotDimensions.height}\n      width={props.plotDimensions.width}\n    >\n      <StyledCharts>\n        <Tabs\n          tabs={[\n            {\n              text: \"Temperature\",\n              component: tempPlot,\n              width: 0.5,\n            },\n            {\n              text: \"Heat Transfer\",\n              component: heatTransferPlot,\n              width: 0.5,\n            },\n          ]}\n        />\n      </StyledCharts>\n    </StyledPlot>\n  );\n}\n","import { diffPoints, ORIGIN, Point, scalePoint } from \"../../utils/pointUtils\";\nimport config from \"../../config\";\nimport { AppNode, Direction } from \"../../App\";\nimport * as React from \"react\";\nimport { CanvasState } from \"./Canvas\";\nimport { ConnectionKind } from \"../types\";\n\nconst { activeNodeOutlineWidth: activeNodeStrokeWidth } = config;\n\nfunction drawCircle(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number,\n  color: string\n): void {\n  context.save();\n  context.beginPath();\n  context.arc(center.x, center.y, radius, 0, 2 * Math.PI);\n  context.fillStyle = color;\n  context.fill();\n  context.closePath();\n  context.restore();\n}\n\nfunction drawCircleOutline(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number,\n  color: string\n): void {\n  context.save();\n  context.beginPath();\n  // inset\n  context.arc(\n    center.x,\n    center.y,\n    radius - activeNodeStrokeWidth / 2,\n    0,\n    2 * Math.PI\n  );\n  context.lineWidth = activeNodeStrokeWidth;\n  context.strokeStyle = color;\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nfunction drawHashPattern(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number\n) {\n  context.save();\n  context.lineWidth = 2;\n  context.fillStyle = \"#FFFFFF\";\n\n  const delta = 4.5;\n  const buffer = 1;\n  const circle = 2;\n\n  // save the canvas above, now transform it for ease of drawing\n  context.translate(center.x, center.y);\n  context.rotate(Math.PI / 4);\n\n  // draw horizontal line\n  context.beginPath();\n  context.moveTo(-radius, 0);\n  context.lineTo(radius, 0);\n  context.stroke();\n\n  // draw smaller horizontal lines offset vertically from center\n  let h = 0; // vertical distance from center\n  while (h + delta < radius) {\n    h = h + delta;\n    const newRadius = radius * Math.sin(Math.acos(h / radius));\n    context.moveTo(-newRadius - buffer, h);\n    context.lineTo(newRadius + buffer, h);\n    context.stroke();\n    context.moveTo(-newRadius - buffer, -h);\n    context.lineTo(newRadius + buffer, -h);\n    context.stroke();\n  }\n  context.closePath();\n\n  // clip off the extra bits around the circle\n  context.beginPath();\n  context.arc(0, 0, radius + circle, 0, Math.PI * 2, false);\n  context.arc(0, 0, radius, 0, Math.PI * 2, true);\n  context.fill();\n\n  context.restore();\n}\n\nfunction drawNodeName(\n  context: CanvasRenderingContext2D,\n  name: string,\n  center: Point,\n  radius: number,\n  textDirection: Direction\n) {\n  const bufferText = 2;\n  context.save();\n  context.font = \"14px Helvetica\";\n  const textMetrics = context.measureText(name);\n  const width = textMetrics.width;\n  context.translate(center.x, center.y);\n  if (textDirection === \"D\") {\n    context.fillText(\n      name,\n      -width / 2,\n      textMetrics.actualBoundingBoxAscent + radius + bufferText\n    );\n  } else if (textDirection === \"R\") {\n    context.fillText(\n      name,\n      radius + bufferText,\n      textMetrics.actualBoundingBoxAscent / 2\n    );\n  } else if (textDirection === \"U\") {\n    context.fillText(\n      name,\n      -width / 2,\n      -(textMetrics.actualBoundingBoxDescent + radius + bufferText)\n    );\n  } else {\n    context.fillText(\n      name,\n      -(width + radius + bufferText),\n      textMetrics.actualBoundingBoxAscent / 2\n    );\n  }\n  context.restore();\n}\n\nexport function drawNode(\n  context: CanvasRenderingContext2D,\n  name: string,\n  center: Point,\n  radius: number,\n  isActive: boolean,\n  isBoundary: boolean,\n  textDirection: Direction\n  // temperatureDegC: number, // determines color?\n  // capacitanceJPerDegK: number // determines size?\n): void {\n  drawCircle(context, center, radius, \"red\");\n  if (isActive) {\n    drawCircleOutline(context, center, radius, \"black\");\n  }\n  if (isBoundary) {\n    drawHashPattern(context, center, radius);\n  }\n  drawNodeName(context, name, center, radius, textDirection);\n}\n\nexport function drawBidirectionalArrow(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string,\n  startOffset = 0,\n  endOffset = 0\n): void {\n  context.save();\n  context.beginPath();\n  context.strokeStyle = color;\n  context.lineWidth = 2;\n  const headLength = 9;\n  const headWidth = 4;\n  const arrowGap = 0;\n  const dx = end.x - start.x;\n  const dy = end.y - start.y;\n  const angle = Math.atan2(dy, dx);\n  const length = Math.sqrt(dx * dx + dy * dy);\n  const adjLength = length - endOffset;\n\n  context.translate(start.x, start.y);\n  context.rotate(angle);\n\n  context.beginPath();\n  context.moveTo(startOffset, arrowGap);\n  context.lineTo(adjLength, arrowGap);\n  context.moveTo(adjLength - headLength, headWidth + arrowGap);\n  context.lineTo(adjLength, arrowGap);\n  context.lineTo(adjLength - headLength, -(headWidth - arrowGap));\n\n  context.moveTo(adjLength, -arrowGap);\n  context.lineTo(startOffset, -arrowGap);\n  context.moveTo(startOffset + headLength, -(headWidth + arrowGap));\n  context.lineTo(startOffset, -arrowGap);\n  context.lineTo(startOffset + headLength, headWidth - arrowGap);\n\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nexport function drawUnidirectionalArrow(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string,\n  startOffset = 0,\n  endOffset = 0\n): void {\n  context.save();\n  context.beginPath();\n  context.strokeStyle = color;\n  context.lineWidth = 2;\n  const headLength = 9;\n  const headWidth = 4;\n  const dx = end.x - start.x;\n  const dy = end.y - start.y;\n  const angle = Math.atan2(dy, dx);\n  const length = Math.sqrt(dx * dx + dy * dy);\n  const adjLength = length - endOffset;\n\n  context.translate(start.x, start.y);\n  context.rotate(angle);\n\n  context.beginPath();\n  context.moveTo(startOffset, 0);\n  context.lineTo(adjLength, 0);\n  context.moveTo(adjLength - headLength, -headWidth);\n  context.lineTo(adjLength, 0);\n  context.lineTo(adjLength - headLength, headWidth);\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nexport function drawArrowWithoutHead(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string,\n  startOffset = 0,\n  endOffset = 0\n): void {\n  context.save();\n  context.beginPath();\n  context.strokeStyle = color;\n  context.lineWidth = 2;\n  const dx = end.x - start.x;\n  const dy = end.y - start.y;\n  const angle = Math.atan2(dy, dx);\n  const length = Math.sqrt(dx * dx + dy * dy);\n  context.translate(start.x, start.y);\n  context.rotate(angle);\n  context.beginPath();\n  context.moveTo(startOffset, 0);\n  const adjLength = length - endOffset;\n  context.lineTo(adjLength, 0);\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nexport function drawClearBox(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string\n): void {\n  context.save();\n  context.beginPath();\n  context.fillStyle = color;\n  context.globalAlpha = 0.2;\n  context.fillRect(start.x, start.y, end.x - start.x, end.y - start.y);\n  context.closePath();\n\n  // outline\n  context.beginPath();\n  context.strokeStyle = color;\n  context.rect(start.x, start.y, end.x - start.x, end.y - start.y);\n  context.stroke();\n  context.closePath();\n\n  context.restore();\n}\n\nexport function drawConnection(\n  context: CanvasRenderingContext2D,\n  source: AppNode,\n  target: AppNode,\n  kind: ConnectionKind\n): void {\n  if (kind === \"bi\") {\n    drawBidirectionalArrow(\n      context,\n      source.center,\n      target.center,\n      \"black\",\n      source.radius,\n      target.radius\n    );\n  } else {\n    drawUnidirectionalArrow(\n      context,\n      source.center,\n      target.center,\n      \"black\",\n      source.radius,\n      target.radius\n    );\n  }\n}\n\nexport function intersectsCircle(\n  point: Point,\n  circleCenter: Point,\n  radius: number\n): boolean {\n  const deltaX = point.x - circleCenter.x;\n  const deltaY = point.y - circleCenter.y;\n  return Math.pow(deltaX, 2) + Math.pow(deltaY, 2) <= Math.pow(radius, 2);\n}\n\nexport function isInsideBox(\n  startBox: Point,\n  endBox: Point,\n  point: Point\n): boolean {\n  const [topLeft, bottomRight] =\n    startBox.x < endBox.x && startBox.y < endBox.y\n      ? [startBox, endBox]\n      : [endBox, startBox];\n\n  const [bottomLeft, topRight] =\n    startBox.x < endBox.x && startBox.y > endBox.y\n      ? [startBox, endBox]\n      : [endBox, startBox];\n\n  return (\n    (topLeft.x <= point.x &&\n      point.x <= bottomRight.x &&\n      topLeft.y <= point.y &&\n      point.y <= bottomRight.y) ||\n    (bottomLeft.x <= point.x &&\n      point.x <= topRight.x &&\n      topRight.y <= point.y &&\n      point.y <= bottomLeft.y)\n  );\n}\n\nexport function calculateCanvasMouse(\n  event: React.MouseEvent | MouseEvent,\n  canvas: HTMLCanvasElement\n): Point {\n  const viewportMousePos = { x: event.pageX, y: event.pageY };\n  const boundingRect = canvas.getBoundingClientRect();\n  const topLeftCanvasPos = { x: boundingRect.left, y: boundingRect.top };\n  return diffPoints(viewportMousePos, topLeftCanvasPos);\n}\n\nfunction canvasMouseToNodeCoords(\n  mouse: Point,\n  offset: Point,\n  scale: number\n): Point {\n  return diffPoints(scalePoint(mouse, scale), offset);\n}\n\nexport function mouseToNodeCoords(\n  event: React.MouseEvent | MouseEvent,\n  canvasState: CanvasState\n): Point {\n  if (canvasState.context) {\n    const canvasMouse = calculateCanvasMouse(event, canvasState.context.canvas);\n    return canvasMouseToNodeCoords(\n      canvasMouse,\n      canvasState.offset,\n      canvasState.scale\n    );\n  } else {\n    return ORIGIN;\n  }\n}\n\nexport function rotatedDirection(direction: Direction): Direction {\n  // assume rotate counter-clockwise\n  if (direction === \"D\") {\n    return \"R\";\n  } else if (direction === \"R\") {\n    return \"U\";\n  } else if (direction === \"U\") {\n    return \"L\";\n  } else {\n    return \"D\";\n  }\n}\n","import * as React from \"react\";\n\nexport default function useLocalStorageState<T>(\n  defaultValue: T,\n  key: string\n): [T, React.Dispatch<React.SetStateAction<T>>] {\n  const [value, setValue] = React.useState<T>(() => {\n    const localState = window.localStorage.getItem(key);\n    if (localState === null || localState === undefined) {\n      return defaultValue;\n    } else {\n      return JSON.parse(localState) as T;\n    }\n  });\n\n  React.useEffect(() => {\n    window.localStorage.setItem(key, JSON.stringify(value));\n  }, [key, value]);\n  return [value, setValue];\n}\n","import * as React from \"react\";\nimport { useCallback, useLayoutEffect, useRef, useState } from \"react\";\nimport {\n  addPoints,\n  diffPoints,\n  ORIGIN,\n  Point,\n  scalePoint,\n} from \"../../../utils/pointUtils\";\nimport config from \"../../../config\";\nimport { calculateCanvasMouse } from \"../canvasUtils\";\nimport useLocalStorageState from \"../../../hooks/useLocalStorageState\";\n\nconst { maxZoom, minZoom, zoomSensitivity } = config;\n\nexport default function usePanZoomCanvas(\n  canvasRef: React.RefObject<HTMLCanvasElement>\n): [\n  CanvasRenderingContext2D | null,\n  React.Dispatch<React.SetStateAction<CanvasRenderingContext2D | null>>,\n  (offset: Point, scale: number) => void,\n  Point,\n  number,\n  (event: React.MouseEvent | MouseEvent) => void\n] {\n  const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\n  const [scale, setScale] = useLocalStorageState<number>(1, \"hotstuffScale\");\n  const [offset, setOffset] = useLocalStorageState<Point>(\n    ORIGIN,\n    \"hotstuffOffset\"\n  );\n  const mousePosRef = useRef<Point>(ORIGIN);\n  const lastMousePosRef = useRef<Point>(ORIGIN);\n\n  const setView = useCallback(\n    (offset: Point, scale: number) => {\n      setOffset(offset);\n      setScale(scale);\n    },\n    [setOffset, setScale]\n  );\n\n  // functions for panning\n  const mouseMove = useCallback(\n    (event: React.MouseEvent | MouseEvent) => {\n      if (context) {\n        // update mouse position\n        const newMousePos = calculateCanvasMouse(event, context.canvas);\n        lastMousePosRef.current = mousePosRef.current;\n        mousePosRef.current = newMousePos;\n\n        const mouseDiff = scalePoint(\n          diffPoints(mousePosRef.current, lastMousePosRef.current),\n          scale\n        );\n        setOffset((prevOffset) => addPoints(prevOffset, mouseDiff));\n      }\n    },\n    [context, scale, setOffset]\n  );\n\n  const mouseUp = useCallback(() => {\n    document.removeEventListener(\"mousemove\", mouseMove);\n    document.removeEventListener(\"mouseup\", mouseUp);\n  }, [mouseMove]);\n\n  const startPan = useCallback(\n    (event: React.MouseEvent | MouseEvent) => {\n      if (context) {\n        document.addEventListener(\"mousemove\", mouseMove);\n        document.addEventListener(\"mouseup\", mouseUp);\n        mousePosRef.current = calculateCanvasMouse(event, context.canvas);\n      }\n    },\n    [context, mouseMove, mouseUp]\n  );\n\n  // add event listener on canvas for zoom\n  useLayoutEffect(() => {\n    function handleWheel(event: WheelEvent) {\n      event.preventDefault();\n      if (context) {\n        // update mouse position\n        const newMousePos = calculateCanvasMouse(event, context.canvas);\n        lastMousePosRef.current = mousePosRef.current;\n        mousePosRef.current = newMousePos;\n\n        // calculate new scale/zoom\n        const zoom = 1 - event.deltaY / zoomSensitivity;\n        const newScale = scale * zoom;\n        if (newScale > maxZoom || newScale < minZoom) {\n          return;\n        }\n\n        // offset the canvas such that the point under the mouse doesn't move\n        const lastMouse = scalePoint(mousePosRef.current, scale);\n        const newMouse = scalePoint(mousePosRef.current, newScale);\n        const mouseOffset = diffPoints(lastMouse, newMouse);\n\n        setOffset(diffPoints(offset, mouseOffset));\n        setScale(newScale);\n      }\n    }\n\n    const canvasElem = canvasRef.current;\n    if (canvasElem) {\n      canvasElem.addEventListener(\"wheel\", handleWheel);\n      return () => canvasElem.removeEventListener(\"wheel\", handleWheel);\n    }\n  }, [canvasRef, context, offset, scale, setOffset, setScale]);\n\n  return [context, setContext, setView, offset, scale, startPan];\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { ORIGIN, Point } from \"../../utils/pointUtils\";\nimport { CanvasState, SavedCanvasState } from \"./Canvas\";\n\nconst StyledButtons = styled.div`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst StyledButton = styled.button`\n  margin: 0.2em;\n`;\n\ntype ControlsProps = {\n  setView: (offset: Point, scale: number) => void;\n  canvasState: CanvasState;\n  savedCanvasState: SavedCanvasState;\n  setSavedCanvasState: React.Dispatch<React.SetStateAction<SavedCanvasState>>;\n};\n\nexport default function Controls(props: ControlsProps): React.ReactElement {\n  return (\n    <StyledButtons>\n      <StyledButton\n        onClick={() => props.canvasState.context && props.setView(ORIGIN, 1)}\n      >\n        Reset View\n      </StyledButton>\n      <StyledButton\n        onClick={() =>\n          props.canvasState.context &&\n          props.setView(\n            props.savedCanvasState.offset,\n            props.savedCanvasState.scale\n          )\n        }\n      >\n        Reset View to Saved\n      </StyledButton>\n      <StyledButton\n        onClick={() => {\n          props.setSavedCanvasState({\n            offset: props.canvasState.offset,\n            scale: props.canvasState.scale,\n          });\n        }}\n      >\n        Save View\n      </StyledButton>\n    </StyledButtons>\n  );\n}\n","import * as React from \"react\";\nimport { useLayoutEffect, useRef } from \"react\";\nimport styled from \"styled-components\";\nimport usePanZoomCanvas from \"./hooks/usePanZoomCanvas\";\nimport { Point } from \"../../utils/pointUtils\";\nimport Controls from \"./Controls\";\nimport useOnClickCanvas from \"./hooks/useOnClickCanvas\";\n\nconst StyledCanvasWrapper = styled.div`\n  display: block;\n  max-height: 100%;\n  position: relative;\n`;\n\nconst StyledCanvas = styled.canvas<{ cssWidth: number; cssHeight: number }>`\n  width: ${({ cssWidth }) => `${cssWidth}px`};\n  height: ${({ cssHeight }) => `${cssHeight}px`};\n`;\n\nexport type CanvasState = {\n  context: CanvasRenderingContext2D | null;\n  offset: Point;\n  scale: number;\n  canvasWidth: number;\n  canvasHeight: number;\n};\n\nexport type SavedCanvasState = {\n  offset: Point;\n  scale: number;\n};\n\nexport type CanvasProps = {\n  canvasWidth: number;\n  canvasHeight: number;\n  devicePixelRatio: number;\n  draw: (context: CanvasRenderingContext2D) => void;\n  onMouseDown: (\n    event: React.MouseEvent | MouseEvent,\n    canvasState: CanvasState,\n    defaultBehavior: (event: React.MouseEvent | MouseEvent) => void\n  ) => void;\n  handleDoubleClick: (\n    event: React.MouseEvent,\n    canvasState: CanvasState\n  ) => void;\n  savedCanvasState: SavedCanvasState;\n  setSavedCanvasState: React.Dispatch<React.SetStateAction<SavedCanvasState>>;\n  setKeyboardActive: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nexport default function Canvas(props: CanvasProps): React.ReactElement {\n  const {\n    canvasWidth,\n    canvasHeight,\n    devicePixelRatio,\n    draw,\n    onMouseDown,\n    handleDoubleClick,\n    savedCanvasState,\n    setSavedCanvasState,\n    setKeyboardActive,\n  } = props;\n\n  // hooks\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  useOnClickCanvas(canvasRef, setKeyboardActive);\n  const [context, setContext, setView, offset, scale, startPan] =\n    usePanZoomCanvas(canvasRef);\n\n  // setup canvas and set context\n  useLayoutEffect(() => {\n    if (canvasRef.current) {\n      // get new drawing context\n      const renderCtx = canvasRef.current.getContext(\"2d\");\n      setContext(renderCtx);\n    }\n  }, [setContext]);\n\n  // draw\n  useLayoutEffect(() => {\n    if (context) {\n      // clear canvas\n      context.canvas.width = canvasWidth * devicePixelRatio;\n      context.canvas.height = canvasHeight * devicePixelRatio;\n\n      context.scale(scale * devicePixelRatio, scale * devicePixelRatio);\n      context.translate(offset.x, offset.y);\n\n      draw(context);\n    }\n  }, [\n    canvasHeight,\n    canvasWidth,\n    context,\n    devicePixelRatio,\n    draw,\n    offset.x,\n    offset.y,\n    scale,\n  ]);\n\n  return (\n    <StyledCanvasWrapper>\n      <Controls\n        setView={setView}\n        canvasState={{ context, offset, scale, canvasWidth, canvasHeight }}\n        savedCanvasState={savedCanvasState}\n        setSavedCanvasState={setSavedCanvasState}\n      />\n      <StyledCanvas\n        ref={canvasRef}\n        width={canvasWidth * devicePixelRatio}\n        height={canvasHeight * devicePixelRatio}\n        cssWidth={canvasWidth}\n        cssHeight={canvasHeight}\n        onMouseDown={(event: React.MouseEvent | MouseEvent) =>\n          onMouseDown(\n            event,\n            { context, offset, scale, canvasWidth, canvasHeight },\n            () => startPan(event)\n          )\n        }\n        onDoubleClick={(event: React.MouseEvent) =>\n          handleDoubleClick(event, {\n            context,\n            offset,\n            scale,\n            canvasWidth,\n            canvasHeight,\n          })\n        }\n      />\n    </StyledCanvasWrapper>\n  );\n}\n","import * as React from \"react\";\nimport { useEffect } from \"react\";\n\nexport default function useOnClickCanvas(\n  ref: React.RefObject<HTMLCanvasElement>,\n  onClickCanvas: React.Dispatch<React.SetStateAction<boolean>>\n): void {\n  useEffect(() => {\n    const handleClickOutside = (event: React.MouseEvent | MouseEvent) => {\n      const keyBoardActive =\n        !!ref.current && ref.current.contains(event.target as Node);\n      onClickCanvas(keyBoardActive);\n    };\n\n    // Bind the event listener\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      // Unbind the event listener on clean up\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [ref, onClickCanvas]);\n}\n","import React, { useCallback } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport { makeNode } from \"hotstuff-network\";\nimport {\n  intersectsCircle,\n  mouseToNodeCoords,\n  rotatedDirection,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppNode } from \"../App\";\nimport config from \"../config\";\n\nconst { newNodeNamePrefix, defaultNodeRadius } = config;\n\nexport default function useDoubleClick(\n  appNodes: AppNode[],\n  addNode: (node: AppNode) => void,\n  updateNodes: (nodes: AppNode[]) => void\n): (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => void {\n  return useCallback(\n    (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => {\n      event.preventDefault();\n\n      const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n\n      const doubleClickedNode = appNodes.find((node) =>\n        intersectsCircle(nodeCoordsOfMouse, node.center, node.radius)\n      );\n      if (doubleClickedNode) {\n        updateNodes([\n          {\n            ...doubleClickedNode,\n            textDirection: rotatedDirection(doubleClickedNode.textDirection),\n          },\n        ]);\n        return;\n      }\n\n      const numNewNodes = appNodes.filter((node) =>\n        node.name.startsWith(newNodeNamePrefix)\n      ).length;\n\n      const newNode = makeNode({\n        name:\n          numNewNodes === 0\n            ? `${newNodeNamePrefix}`\n            : `${newNodeNamePrefix} (${numNewNodes + 1})`,\n        temperatureDegC: config.defaultTempDegC,\n        capacitanceJPerDegK: config.defaultCapJPerDegK,\n        powerGenW: config.defaultPowerGenW,\n        isBoundary: false,\n      });\n\n      const newAppNode: AppNode = {\n        ...newNode,\n        center: nodeCoordsOfMouse,\n        radius: defaultNodeRadius,\n        color: \"red\",\n        isActive: false,\n        textDirection: \"D\",\n      };\n      addNode(newAppNode);\n    },\n    [addNode, appNodes, updateNodes]\n  );\n}\n","import React, { useCallback } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport {\n  drawArrowWithoutHead,\n  intersectsCircle,\n  mouseToNodeCoords,\n} from \"../components/Canvas/canvasUtils\";\nimport { makeConnection } from \"hotstuff-network\";\nimport { AppConnection, AppNode } from \"../App\";\nimport config from \"../config\";\n\nconst { defaultResistanceDegKPerW, defaultConnectionKind } = config;\n\nexport default function useAddConnection(\n  appNodes: AppNode[],\n  appConnections: AppConnection[],\n  setAppConnections: React.Dispatch<React.SetStateAction<AppConnection[]>>,\n  clearAndRedraw: (canvasState: CanvasState) => void\n): (\n  event: React.MouseEvent | MouseEvent,\n  clickedNode: AppNode,\n  canvasState: CanvasState\n) => void {\n  const drawConnectionBeingMade = useCallback(\n    (\n      event: React.MouseEvent | MouseEvent,\n      clickedNode: AppNode,\n      canvasState: CanvasState\n    ) => {\n      if (canvasState.context) {\n        const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n        clearAndRedraw(canvasState);\n        drawArrowWithoutHead(\n          canvasState.context,\n          clickedNode.center,\n          nodeCoordsOfMouse,\n          \"grey\"\n        );\n      }\n    },\n    [clearAndRedraw]\n  );\n\n  return useCallback(\n    (\n      event: React.MouseEvent | MouseEvent,\n      clickedNode: AppNode,\n      canvasState: CanvasState\n    ) => {\n      const drawConnWrapper = (event: React.MouseEvent | MouseEvent) => {\n        drawConnectionBeingMade(event, clickedNode, canvasState);\n      };\n\n      const mouseUp = (event: React.MouseEvent | MouseEvent) => {\n        document.removeEventListener(\"mousemove\", drawConnWrapper);\n        document.removeEventListener(\"mouseup\", mouseUp);\n\n        // if arrow released on a node, make new connection\n        const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n        const mouseUpOnNode = appNodes.find(\n          (node) =>\n            intersectsCircle(nodeCoordsOfMouse, node.center, node.radius) &&\n            node.id !== clickedNode.id &&\n            !appConnections.some(\n              (conn) =>\n                (conn.source.id === node.id &&\n                  conn.target.id === clickedNode.id) ||\n                (conn.target.id === node.id &&\n                  conn.source.id === clickedNode.id)\n            )\n        );\n\n        if (mouseUpOnNode) {\n          const newConnection = {\n            ...makeConnection({\n              source: clickedNode,\n              target: mouseUpOnNode,\n              resistanceDegKPerW: defaultResistanceDegKPerW,\n              kind: defaultConnectionKind,\n            }),\n            sourceName: clickedNode.name,\n            targetName: mouseUpOnNode.name,\n          };\n          setAppConnections([...appConnections, newConnection]);\n        } else {\n          clearAndRedraw(canvasState);\n        }\n      };\n      document.addEventListener(\"mousemove\", drawConnWrapper);\n      document.addEventListener(\"mouseup\", mouseUp);\n    },\n    [\n      appConnections,\n      appNodes,\n      clearAndRedraw,\n      drawConnectionBeingMade,\n      setAppConnections,\n    ]\n  );\n}\n","import React, { useCallback } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport {\n  drawClearBox,\n  isInsideBox,\n  mouseToNodeCoords,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppNode } from \"../App\";\n\nexport default function useMultiSelect(\n  appNodes: AppNode[],\n  setActiveNodes: (activeNodeIds: string[]) => void,\n  clearAndRedraw: (canvasState: CanvasState) => void\n): (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => void {\n  return useCallback(\n    (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => {\n      const boxStart = mouseToNodeCoords(event, canvasState);\n      const drawBox = (event: React.MouseEvent | MouseEvent) => {\n        if (canvasState.context) {\n          clearAndRedraw(canvasState);\n          drawClearBox(\n            canvasState.context,\n            boxStart,\n            mouseToNodeCoords(event, canvasState),\n            \"grey\"\n          );\n        }\n      };\n      const mouseUp = (event: React.MouseEvent | MouseEvent) => {\n        document.removeEventListener(\"mousemove\", drawBox);\n        document.removeEventListener(\"mouseup\", mouseUp);\n\n        const boxEnd = mouseToNodeCoords(event, canvasState);\n        const activeNodeIds = appNodes\n          .filter(\n            (node) =>\n              isInsideBox(boxStart, boxEnd, node.center) || node.isActive\n          )\n          .map((node) => node.id);\n        setActiveNodes(activeNodeIds);\n      };\n      document.addEventListener(\"mousemove\", drawBox);\n      document.addEventListener(\"mouseup\", mouseUp);\n    },\n    [appNodes, clearAndRedraw, setActiveNodes]\n  );\n}\n","import * as React from \"react\";\nimport { useCallback } from \"react\";\nimport {\n  intersectsCircle,\n  mouseToNodeCoords,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport useAddConnection from \"./useAddConnection\";\nimport useMoveNode from \"./useMoveNode\";\nimport useMultiSelect from \"./useMultiSelect\";\n\nexport default function useOnMouseDown(\n  appNodes: AppNode[],\n  appConnections: AppConnection[],\n  setAppConnections: React.Dispatch<React.SetStateAction<AppConnection[]>>,\n  updateNodes: (nodesToUpdate: AppNode[], clearActiveNodes?: boolean) => void,\n  setActiveNodes: (activeNodeIds: string[]) => void,\n  clearActiveNodes: () => void,\n  clearAndRedraw: (canvasState: CanvasState) => void\n): (\n  event: React.MouseEvent | MouseEvent,\n  canvasState: CanvasState,\n  defaultBehavior: (event: React.MouseEvent | MouseEvent) => void\n) => void {\n  const makeNewConnection = useAddConnection(\n    appNodes,\n    appConnections,\n    setAppConnections,\n    clearAndRedraw\n  );\n  const moveNode = useMoveNode(updateNodes);\n  const multiSelect = useMultiSelect(appNodes, setActiveNodes, clearAndRedraw);\n\n  return useCallback(\n    (\n      event: React.MouseEvent | MouseEvent,\n      canvasState: CanvasState,\n      defaultBehavior: (event: React.MouseEvent | MouseEvent) => void\n    ) => {\n      const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n\n      const activeNodes = appNodes.filter((node) => node.isActive);\n      const activeNodeIds = activeNodes.map((node) => node.id);\n\n      const clickedNode = appNodes.find((node) =>\n        intersectsCircle(nodeCoordsOfMouse, node.center, node.radius)\n      );\n\n      if (clickedNode) {\n        if (event.altKey) {\n          makeNewConnection(event, clickedNode, canvasState);\n        } else if (event.shiftKey && activeNodeIds.includes(clickedNode.id)) {\n          setActiveNodes(activeNodeIds.filter((id) => id !== clickedNode.id));\n        } else {\n          moveNode(event, clickedNode, activeNodes, canvasState);\n        }\n      } else {\n        if (event.shiftKey) {\n          multiSelect(event, canvasState);\n        } else {\n          clearActiveNodes();\n          defaultBehavior(event);\n        }\n      }\n    },\n    [\n      appNodes,\n      clearActiveNodes,\n      moveNode,\n      multiSelect,\n      makeNewConnection,\n      setActiveNodes,\n    ]\n  );\n}\n","import React, { useCallback, useRef } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport { mouseToNodeCoords } from \"../components/Canvas/canvasUtils\";\nimport { AppNode } from \"../App\";\nimport { diffPoints } from \"../utils/pointUtils\";\n\nexport default function useMoveNode(\n  updateNodes: (nodesToUpdate: AppNode[], clearActiveNodes?: boolean) => void\n): (\n  event: React.MouseEvent | MouseEvent,\n  clickedNode: AppNode,\n  activeNodes: AppNode[],\n  canvasState: CanvasState\n) => void {\n  const movedRef = useRef<boolean>(false);\n\n  return useCallback(\n    (\n      event: React.MouseEvent | MouseEvent,\n      clickedNode: AppNode,\n      activeNodes: AppNode[],\n      canvasState: CanvasState\n    ) => {\n      const offsetMouseToCenter = diffPoints(\n        mouseToNodeCoords(event, canvasState),\n        clickedNode.center\n      );\n      const shiftKeyPressed = event.shiftKey;\n      const moveNode = (event: React.MouseEvent | MouseEvent) => {\n        if (canvasState.context) {\n          movedRef.current = true;\n          const newClickedCenter = diffPoints(\n            mouseToNodeCoords(event, canvasState),\n            offsetMouseToCenter\n          );\n          const newClickedNode = {\n            ...clickedNode,\n            isActive: true,\n            center: newClickedCenter,\n          };\n\n          const newActiveNodes =\n            clickedNode.isActive || shiftKeyPressed\n              ? activeNodes.map((node) => {\n                  const distanceFromClickedCenter = diffPoints(\n                    clickedNode.center,\n                    node.center\n                  );\n                  return {\n                    ...node,\n                    center: diffPoints(\n                      newClickedCenter,\n                      distanceFromClickedCenter\n                    ),\n                  };\n                })\n              : [];\n\n          updateNodes([newClickedNode, ...newActiveNodes], !event.shiftKey);\n        }\n      };\n      const mouseUp = (event: React.MouseEvent | MouseEvent) => {\n        document.removeEventListener(\"mousemove\", moveNode);\n        document.removeEventListener(\"mouseup\", mouseUp);\n        updateNodes(\n          [\n            {\n              ...clickedNode,\n              center: diffPoints(\n                mouseToNodeCoords(event, canvasState),\n                offsetMouseToCenter\n              ),\n              isActive: true,\n            },\n          ],\n          !movedRef.current && !shiftKeyPressed\n        );\n        movedRef.current = false;\n      };\n      document.addEventListener(\"mousemove\", moveNode);\n      document.addEventListener(\"mouseup\", mouseUp);\n    },\n    [updateNodes]\n  );\n}\n","import { makeConnection, makeNode } from \"hotstuff-network\";\nimport { AppConnection, AppNode } from \"./App\";\nimport config from \"./config\";\n\nconst test1 = makeNode({\n  name: \"test1\",\n  temperatureDegC: 85,\n  capacitanceJPerDegK: 100,\n  powerGenW: 0,\n  isBoundary: true,\n});\n\nconst test2 = makeNode({\n  name: \"test2\",\n  temperatureDegC: 23,\n  capacitanceJPerDegK: 2,\n  powerGenW: 0,\n  isBoundary: false,\n});\n\nexport const defaultNodes: AppNode[] = [\n  {\n    ...test1,\n    center: { x: 200, y: 200 },\n    radius: config.defaultNodeRadius,\n    color: \"red\",\n    isActive: false,\n    textDirection: \"D\",\n  },\n  {\n    ...test2,\n    center: { x: 650, y: 450 },\n    radius: config.defaultNodeRadius,\n    color: \"red\",\n    isActive: false,\n    textDirection: \"D\",\n  },\n];\n\nexport const defaultConnections: AppConnection[] = [\n  {\n    ...makeConnection({\n      source: test1,\n      target: test2,\n      resistanceDegKPerW: 10,\n      kind: \"bi\",\n    }),\n    sourceName: test1.name,\n    targetName: test2.name,\n  },\n];\n","import { HSConnection, HSNode, ModelOutput, run } from \"hotstuff-network\";\nimport React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { ORIGIN, Point } from \"./utils/pointUtils\";\nimport Sidebar from \"./components/Sidebar/Sidebar\";\nimport Plot from \"./components/Plot/Plot\";\nimport config from \"./config\";\nimport useWindowSize from \"./components/Canvas/hooks/useWindowSize\";\nimport Canvas, { SavedCanvasState } from \"./components/Canvas/Canvas\";\nimport useDraw from \"./hooks/useDraw\";\nimport useDoubleClick from \"./hooks/useDoubleClick\";\nimport useModelUtils from \"./hooks/useModelUtils\";\nimport useOnMouseDown from \"./hooks/useOnMouseDown\";\nimport useKeyDown from \"./hooks/useKeyDown\";\nimport { defaultConnections, defaultNodes } from \"./default\";\nimport useLocalStorageState from \"./hooks/useLocalStorageState\";\n\nconst {\n  editorWidthPerc,\n  canvasHeightPerc,\n  plotMargin,\n  tabHeightPx,\n  plotHeightBufferPx,\n} = config;\n\nexport type Direction = \"L\" | \"R\" | \"U\" | \"D\";\n\nexport type AppNode = HSNode & {\n  center: Point;\n  radius: number;\n  color: string;\n  isActive: boolean;\n  textDirection: Direction;\n};\n\nexport type AppConnection = HSConnection & {\n  sourceName: string;\n  targetName: string;\n};\n\nexport type Timing = {\n  timeStepS: number;\n  totalTimeS: number;\n};\n\nconst StyledApp = styled.div<{ height: number }>`\n  display: flex;\n  height: ${(props) => props.height}px;\n  user-select: none;\n  -webkit-user-select: none; /* Chrome/Safari */\n  -moz-user-select: none; /* Firefox */\n  -ms-user-select: none; /* IE10+ */\n`;\n\nconst StyledWorkspace = styled.div<{ height: number; width: number }>`\n  height: ${(props) => props.height}px;\n  width: ${(props) => (1 - editorWidthPerc) * props.width}px;\n`;\n\nconst StyledCanvas = styled.div<{ height: number }>`\n  width: 100%;\n  height: ${(props) => props.height}px;\n`;\n\nexport default function App(): React.ReactElement {\n  const [modelOutput, setModelOutput] = useState<ModelOutput | undefined>(\n    undefined\n  );\n  const [timing, setTiming] = useLocalStorageState<Timing>(\n    {\n      timeStepS: config.defaultTimeStepSeconds,\n      totalTimeS: config.defaultTotalTimeSeconds,\n    },\n    \"hotstuffTiming\"\n  );\n  const [appNodes, setAppNodes] = useLocalStorageState<AppNode[]>(\n    defaultNodes,\n    \"hotstuffNodes\"\n  );\n  const [appConnections, setAppConnections] = useLocalStorageState<\n    AppConnection[]\n  >(defaultConnections, \"hotstuffConnections\");\n  const [\n    addNode,\n    updateNodes,\n    deleteNodes,\n    updateConnections,\n    deleteConnections,\n    setActiveNodes,\n    clearActiveNodes,\n  ] = useModelUtils(setAppNodes, setAppConnections);\n\n  const [keyboardActive, setKeyboardActive] = useState<boolean>(true);\n  useKeyDown(keyboardActive, appNodes, setAppNodes, deleteNodes);\n\n  const [draw, clearAndRedraw] = useDraw(appNodes, appConnections);\n  const handleDoubleClick = useDoubleClick(appNodes, addNode, updateNodes);\n  const onMouseDown = useOnMouseDown(\n    appNodes,\n    appConnections,\n    setAppConnections,\n    updateNodes,\n    setActiveNodes,\n    clearActiveNodes,\n    clearAndRedraw\n  );\n\n  const [savedCanvasState, setSavedCanvasState] =\n    useLocalStorageState<SavedCanvasState>(\n      {\n        offset: ORIGIN,\n        scale: 1,\n      },\n      \"hotstuffSavedCanvasState\"\n    );\n\n  const [size, ratio] = useWindowSize();\n  const [windowWidth, windowHeight] = size;\n\n  // width/heights\n  const workspaceWidth = windowWidth;\n  const workspaceHeight = windowHeight;\n  const canvasHeight = windowHeight * canvasHeightPerc;\n  const canvasWidth = windowWidth * (1 - editorWidthPerc);\n  const plotHeight =\n    (1 - canvasHeightPerc) * windowHeight - tabHeightPx - plotHeightBufferPx;\n  const plotWidth = canvasWidth;\n  const editorWidth = editorWidthPerc * windowWidth;\n\n  return (\n    <StyledApp height={windowHeight}>\n      <StyledWorkspace height={workspaceHeight} width={workspaceWidth}>\n        <StyledCanvas height={canvasHeight}>\n          <Canvas\n            canvasWidth={canvasWidth}\n            canvasHeight={canvasHeight}\n            devicePixelRatio={ratio}\n            draw={draw}\n            onMouseDown={onMouseDown}\n            handleDoubleClick={handleDoubleClick}\n            savedCanvasState={savedCanvasState}\n            setSavedCanvasState={setSavedCanvasState}\n            setKeyboardActive={setKeyboardActive}\n          />\n        </StyledCanvas>\n        <Plot\n          plotDimensions={{\n            height: plotHeight,\n            width: plotWidth,\n            margin: plotMargin,\n          }}\n          modelOutput={modelOutput}\n        />\n      </StyledWorkspace>\n      <Sidebar\n        height={windowHeight}\n        width={editorWidth}\n        timing={timing}\n        setTiming={setTiming}\n        nodes={appNodes}\n        connections={appConnections}\n        // addNode={addNode}\n        updateNodes={updateNodes}\n        deleteNodes={deleteNodes}\n        updateConnections={updateConnections}\n        deleteConnections={deleteConnections}\n        onRunModel={() => {\n          const output = run({\n            nodes: appNodes,\n            connections: appConnections,\n            timeStepS: timing.timeStepS,\n            totalTimeS: timing.totalTimeS,\n          });\n          if (output.errors?.length) {\n            output.errors.forEach((error) => console.error(error.message));\n          }\n          setModelOutput(output);\n        }}\n      />\n    </StyledApp>\n  );\n}\n","import * as React from \"react\";\nimport { useCallback } from \"react\";\nimport { AppConnection, AppNode } from \"../App\";\n\nexport default function useModelUtils(\n  setAppNodes: React.Dispatch<React.SetStateAction<AppNode[]>>,\n  setAppConnections: React.Dispatch<React.SetStateAction<AppConnection[]>>\n): [\n  (node: AppNode) => void,\n  (nodesToUpdate: AppNode[], clearActiveNodes?: boolean) => void,\n  (nodeIds: string[]) => void,\n  (connsToUpdate: AppConnection[]) => void,\n  (connIds: string[]) => void,\n  (activeNodeIds: string[]) => void,\n  () => void\n] {\n  const addNode = useCallback(\n    (node: AppNode) => {\n      setAppNodes((prevNodes) => {\n        const newNodes: AppNode[] = prevNodes.map((node) => ({\n          ...node,\n          isActive: false,\n        }));\n        newNodes.push({ ...node, isActive: true });\n        return newNodes;\n      });\n    },\n    [setAppNodes]\n  );\n\n  const updateNodes = useCallback(\n    (nodesToUpdate: AppNode[], clearActiveNodes = false) => {\n      setAppNodes((prevNodes) => {\n        return prevNodes.map((node) => {\n          const nodeToUpdate = nodesToUpdate.find(\n            (newNode) => newNode.id === node.id\n          );\n          if (nodeToUpdate) {\n            return nodeToUpdate;\n          } else {\n            if (clearActiveNodes) {\n              return { ...node, isActive: false };\n            } else {\n              return node;\n            }\n          }\n        });\n      });\n\n      setAppConnections((prevConns) => {\n        return prevConns.map((prevConn) => {\n          const newSourceNode = nodesToUpdate.find(\n            (nodeToUpdate) => prevConn.source.id == nodeToUpdate.id\n          );\n          if (newSourceNode) {\n            return {\n              ...prevConn,\n              source: newSourceNode,\n              sourceName: newSourceNode.name,\n            };\n          }\n\n          const newTargetNode = nodesToUpdate.find(\n            (nodeToUpdate) => prevConn.target.id == nodeToUpdate.id\n          );\n          if (newTargetNode) {\n            return {\n              ...prevConn,\n              target: newTargetNode,\n              targetName: newTargetNode.name,\n            };\n          }\n\n          return prevConn;\n        });\n      });\n    },\n    [setAppConnections, setAppNodes]\n  );\n\n  const deleteNodes = useCallback(\n    (nodeIds: string[]) => {\n      setAppConnections((prevConns) => {\n        return prevConns.filter(\n          (conn) =>\n            !nodeIds.includes(conn.source.id) &&\n            !nodeIds.includes(conn.target.id)\n        );\n      });\n      setAppNodes((prevNodes) =>\n        prevNodes.filter((node) => !nodeIds.includes(node.id))\n      );\n    },\n    [setAppConnections, setAppNodes]\n  );\n\n  const updateConnections = useCallback(\n    (connsToUpdate: AppConnection[]) => {\n      const connIdsToUpdate = connsToUpdate.map((conn) => conn.id);\n      setAppConnections((prevConns) => {\n        const oldConns = prevConns.filter(\n          (conn) => !connIdsToUpdate.includes(conn.id)\n        );\n        return [...connsToUpdate, ...oldConns];\n      });\n    },\n    [setAppConnections]\n  );\n\n  const deleteConnections = useCallback(\n    (connIds: string[]) => {\n      setAppConnections((prevConns) =>\n        prevConns.filter((conn) => !connIds.includes(conn.id))\n      );\n    },\n    [setAppConnections]\n  );\n\n  const setActiveNodes = useCallback(\n    (activeNodeIds: string[]) => {\n      setAppNodes((prevNodes) => {\n        return prevNodes.map((node) => ({\n          ...node,\n          isActive: activeNodeIds.includes(node.id),\n        }));\n      });\n    },\n    [setAppNodes]\n  );\n\n  const clearActiveNodes = useCallback(() => {\n    setAppNodes((prevNodes) => {\n      return prevNodes.map((node) => ({\n        ...node,\n        isActive: false,\n      }));\n    });\n  }, [setAppNodes]);\n\n  return [\n    addNode,\n    updateNodes,\n    deleteNodes,\n    updateConnections,\n    deleteConnections,\n    setActiveNodes,\n    clearActiveNodes,\n  ];\n}\n","import React, { useEffect } from \"react\";\nimport { AppNode } from \"../App\";\n\nexport default function useKeyDown(\n  keyboardActive: boolean,\n  appNodes: AppNode[],\n  setAppNodes: React.Dispatch<React.SetStateAction<AppNode[]>>,\n  deleteNodes: (nodeIds: string[]) => void\n): void {\n  useEffect(() => {\n    const onKeyDown = (event: React.KeyboardEvent | KeyboardEvent) => {\n      if (keyboardActive) {\n        // shift + A makes all nodes active\n        if (event.metaKey) {\n          if (event.keyCode === 65) {\n            event.preventDefault();\n            setAppNodes((prevNodes) =>\n              prevNodes.map((node) => {\n                return { ...node, isActive: true };\n              })\n            );\n          }\n        }\n\n        // delete active nodes on back/del\n        if (event.key === \"Backspace\" || event.key === \"Delete\") {\n          event.preventDefault();\n          deleteNodes(\n            appNodes.filter((node) => node.isActive).map((node) => node.id)\n          );\n        }\n\n        // escape key makes all inactive\n        if (event.keyCode === 27) {\n          setAppNodes((prevNodes) =>\n            prevNodes.map((node) => ({ ...node, isActive: false }))\n          );\n        }\n      }\n    };\n    document.addEventListener(\"keydown\", onKeyDown);\n    return () => document.removeEventListener(\"keydown\", onKeyDown);\n  }, [appNodes, deleteNodes, keyboardActive, setAppNodes]);\n}\n","import { useCallback } from \"react\";\nimport { drawConnection, drawNode } from \"../components/Canvas/canvasUtils\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\n\nexport default function useDraw(\n  appNodes: AppNode[],\n  appConnections: AppConnection[]\n): [\n  (context: CanvasRenderingContext2D) => void,\n  (canvasState: CanvasState) => void\n] {\n  const draw = useCallback(\n    (context: CanvasRenderingContext2D) => {\n      appNodes.map((node) => {\n        drawNode(\n          context,\n          node.name,\n          node.center,\n          node.radius,\n          node.isActive,\n          node.isBoundary,\n          node.textDirection\n          // node.temperatureDegC,\n          // node.capacitanceJPerDegK\n        );\n      });\n\n      appConnections.map((conn) => {\n        const { source, target, kind } = conn;\n        const sourceAppNode = appNodes.find((node) => node.id === source.id);\n        const targetAppNode = appNodes.find((node) => node.id === target.id);\n        if (sourceAppNode && targetAppNode) {\n          drawConnection(context, sourceAppNode, targetAppNode, kind);\n        }\n      });\n    },\n    [appConnections, appNodes]\n  );\n\n  const clearAndRedraw = useCallback(\n    (canvasState: CanvasState) => {\n      if (canvasState.context) {\n        canvasState.context.clearRect(\n          -canvasState.offset.x,\n          -canvasState.offset.y,\n          canvasState.canvasWidth / canvasState.scale,\n          canvasState.canvasHeight / canvasState.scale\n        );\n        draw(canvasState.context);\n      }\n    },\n    [draw]\n  );\n\n  return [draw, clearAndRedraw];\n}\n","import { useLayoutEffect, useState } from \"react\";\n\nexport default function useWindowSize(): [[number, number], number] {\n  const [size, setSize] = useState<[number, number]>([0, 0]);\n  const [ratio, setRatio] = useState(1);\n\n  useLayoutEffect(() => {\n    function updateSize() {\n      setSize([window.innerWidth, window.innerHeight]);\n    }\n    function updateRatio() {\n      const { devicePixelRatio: ratio = 1 } = window;\n      setRatio(ratio);\n    }\n    window.addEventListener(\"resize\", updateSize);\n    window.addEventListener(\"resize\", updateRatio);\n    updateSize();\n    updateRatio();\n    return () => {\n      window.removeEventListener(\"resize\", updateSize);\n      window.removeEventListener(\"resize\", updateRatio);\n    };\n  }, []);\n  return [size, ratio];\n}\n","export function forceShowScrollbars(): void {\n  // Returns whether scrollbars show up on scrollable elements.\n  // This is false on Macs when the \"General > Show scroll bars\" setting is\n  // not set to \"Always\" (the default is \"When scrolling\"). The approach\n  // taken here is to create an element that will scroll and then compare\n  // its outer width (including scrollbars) to its inner width (excluding\n  // scrollbars).\n  function areScrollbarsVisible() {\n    const scrollableElem = document.createElement(\"div\"),\n      innerElem = document.createElement(\"div\");\n    scrollableElem.style.width = \"30px\";\n    scrollableElem.style.height = \"30px\";\n    scrollableElem.style.overflow = \"scroll\";\n    scrollableElem.style.borderWidth = \"0\";\n    innerElem.style.width = \"30px\";\n    innerElem.style.height = \"60px\";\n    scrollableElem.appendChild(innerElem);\n    document.body.appendChild(scrollableElem); // Elements only have width if they're in the layout\n    const diff = scrollableElem.offsetWidth - scrollableElem.clientWidth;\n    document.body.removeChild(scrollableElem);\n    return diff > 0;\n  }\n\n  window.addEventListener(\"load\", function () {\n    // Show scrollbars if they're hidden.\n    if (!areScrollbarsVisible()) {\n      document.body.classList.add(\"force-show-scrollbars\");\n    }\n  });\n}\n","import * as React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport { forceShowScrollbars } from \"./utils/scrollBar\";\n\nforceShowScrollbars();\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}