(this.webpackJsonphotstuff=this.webpackJsonphotstuff||[]).push([[0],{181:function(e,t,n){},338:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n(64),a=n.n(o),c=(n(181),n(8)),r=n(33),s=n(25),d=n(11),u=Object.freeze({x:0,y:0});function l(e,t){return{x:e.x-t.x,y:e.y-t.y}}function f(e,t){return{x:e.x/t,y:e.y/t}}var h={defaultTempDegC:23,defaultCapJPerDegK:1,defaultPowerGenW:0,canvasHeightPerc:.7,editorWidthPerc:.3,defaultTotalTimeSeconds:60,defaultTimeStepSeconds:.1,defaultNodeRadius:20,defaultResistanceDegKPerW:10,defaultConnectionKind:"bi",newNodeNamePrefix:"New Node",zoomSensitivity:1e3,minZoom:.25,maxZoom:5,activeNodeOutlineWidth:5,tabHeightPx:25,plotHeightBufferPx:10,tableDeleteCellWidthPerc:.1,tableDeleteCellMinWidthPx:40,plotMargin:{left:10,right:20,top:20,bottom:20}},b=d.a.div.withConfig({displayName:"style__StyledTableWrapper",componentId:"sc-em5pgb-0"})(["width:100%;"]),m=d.a.div.withConfig({displayName:"style__StyledTable",componentId:"sc-em5pgb-1"})(["width:100%;border-collapse:collapse;"]),v=d.a.div.withConfig({displayName:"style__StyledTableBody",componentId:"sc-em5pgb-2"})(["width:100%;"]),p=d.a.div.withConfig({displayName:"style__StyledRow",componentId:"sc-em5pgb-3"})(["display:inline-flex;align-items:center;min-width:100%;position:sticky;top:",";background:",";"],(function(e){var t=e.heightOffsetPx;return t?"".concat(t,"px"):"0px"}),(function(e){return e.isActive?"rgba(112, 165, 255, 0.2)":"none"})),j=d.a.div.withConfig({displayName:"style__StyledCell",componentId:"sc-em5pgb-4"})(["display:inline-flex;justify-content:center;align-items:center;border:1px solid #ddd;height:2em;width:",";min-width:",";"],(function(e){var t=e.width;return"".concat(100*t,"%")}),(function(e){var t=e.minWidth;return t?"".concat(t,"px"):"none"})),x=Object(d.a)(j).withConfig({displayName:"style__StyledDeleteCell",componentId:"sc-em5pgb-5"})(["cursor:pointer;user-select:none;min-width:40px;&:hover{background:black;}"]),g=d.a.div.withConfig({displayName:"style__StyledHeaderWrapper",componentId:"sc-em5pgb-6"})(["display:flex;width:100%;height:100%;position:sticky;top:",";z-index:1;"],(function(e){var t=e.heightOffsetPx;return t?"".concat(t,"px"):"0px"})),O=d.a.div.withConfig({displayName:"style__StyledColHeader",componentId:"sc-em5pgb-7"})(["display:inline-flex;width:",";min-width:",";justify-content:center;align-items:center;font-weight:bold;border:1px solid lightgrey;cursor:pointer;user-select:none;position:relative;background:white;border-bottom:1px solid black;"],(function(e){var t=e.width;return"".concat(100*t,"%")}),(function(e){var t=e.minWidth;return t?"".concat(t,"px"):"none"})),y=d.a.div.withConfig({displayName:"style__StyledColText",componentId:"sc-em5pgb-8"})(["font-size:0.8em;padding:1em;"]),w=d.a.div.withConfig({displayName:"style__StyledSortIcon",componentId:"sc-em5pgb-9"})(["position:absolute;bottom:0;right:50%;transform:translate(50%);"]),C=n(2);function S(e){var t=e.columns,n=e.sortState,i=e.setSortState,o=n?"ASC"===n.direction?"\u25b2":"\u25bc":"";return Object(C.jsxs)(g,{heightOffsetPx:h.tabHeightPx,children:[t.map((function(e){var t=n&&n.key===e.key;return Object(C.jsxs)(O,{onClick:function(){var o;i({key:e.key,direction:t&&n?(o=n.direction,"ASC"===o?"DESC":"ASC"):"ASC"})},width:e.width,minWidth:e.minWidthPx,children:[Object(C.jsx)(y,{children:e.text}),Object(C.jsx)(w,{children:t?o:""})]},e.key.toString())})),Object(C.jsx)(O,{width:h.tableDeleteCellWidthPerc,minWidth:h.tableDeleteCellMinWidthPx,style:{cursor:"unset"}})]})}var k=n(57),P=n(3),T=d.a.select.withConfig({displayName:"DropDownTableCell__StyledSelect",componentId:"sc-qr2hm7-0"})(["display:inline-flex;width:100%;height:100%;background:unset;"]);function N(e){var t;return Object(C.jsx)(T,{value:null===(t=e.setOption)||void 0===t?void 0:t.id,onChange:function(t){var n=t.target.value,i=e.options.find((function(e){return e.id===n}));void 0!==i&&e.onSelectOption(e.rowId,i)},children:e.options.map((function(e){return Object(C.jsx)("option",{value:e.id,children:e.text},e.id)}))})}var W=d.a.input.withConfig({displayName:"style__StyledInput",componentId:"sc-13tzkm8-0"})(["display:inline-block;border:none;width:100%;height:100%;text-align:center;padding:0;background:unset;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;margin:0;}"]);function D(e){var t=Object(i.useState)(e.initialValue.toString()),n=Object(c.a)(t,2),o=n[0],a=n[1],r=e.initialValue,s=e.onBlur,d=e.getNewValue;var u=Object(i.useCallback)((function(e){var t=d(e);e.target.value!==r.toString()&&(void 0!==t?(a(t.toString()),s(t)):(a(r.toString()),s(r)))}),[d,r,s]);return Object(C.jsx)(W,{type:"text",value:o,onChange:function(e){var t=e.target.value;void 0!==t&&a(t)},onBlur:u})}function _(e){return Object(C.jsx)(D,{initialValue:e.initialValue,onBlur:e.onBlur,getNewValue:function(e){return e.target.value}})}function R(e){return Object(C.jsx)(_,{initialValue:e.initialVal,onBlur:e.onBlur})}function A(e){var t=e.target.value,n=parseFloat(e.target.value);if(void 0!==t&&!isNaN(n))return n}function I(e){return Object(C.jsx)(D,{initialValue:e.initialValue,onBlur:e.onBlur,getNewValue:A})}function E(e){return Object(C.jsx)(I,{initialValue:e.initialVal,onBlur:e.onBlur})}var M=d.a.div.withConfig({displayName:"BooleanTableCell__StyledCheckbox",componentId:"sc-1aoxdk6-0"})(["display:inline-flex;width:100%;height:100%;justify-content:center;align-items:center;cursor:pointer;user-select:none;"]);function L(e){var t=Object(i.useState)(void 0!==e.initialIsActive&&e.initialIsActive),n=Object(c.a)(t,2),o=n[0],a=n[1];return Object(C.jsxs)(M,{tabIndex:0,onKeyUp:function(t){"Enter"===t.key&&(a(!o),e.onClick(!o))},onClick:function(){a(!o),e.onClick(!o)},children:["\xa0",o?e.showWhenActive:""]})}function B(e){var t=e.row,n=e.col,i=e.options,o=e.initiallySetOption,a=e.onUpdateRow,c=t[n.key];return i&&i.length>0&&n.onSelectOption?Object(C.jsx)(N,{rowId:t.id,options:i,setOption:o,onSelectOption:n.onSelectOption}):"string"===typeof c?Object(C.jsx)(R,{initialVal:c,onBlur:function(e){return a(Object(P.a)(Object(P.a)({},t),{},Object(k.a)({},n.key,e)))}}):"number"===typeof c&&"number"===typeof t[n.key]?Object(C.jsx)(E,{initialVal:c,onBlur:function(e){return a(Object(P.a)(Object(P.a)({},t),{},Object(k.a)({},n.key,e)))}}):"boolean"===typeof c?Object(C.jsx)(L,{initialIsActive:c,onClick:function(e){return a(Object(P.a)(Object(P.a)({},t),{},Object(k.a)({},n.key,e)))},showWhenActive:"\u2705"}):Object(C.jsx)(C.Fragment,{})}function K(e){var t=Object(i.useState)(e.default),n=Object(c.a)(t,2),o=n[0],a=n[1];return[o,a,function(e,t){return e[o.key]>t[o.key]?"ASC"===o.direction?1:-1:"ASC"===o.direction?-1:1}]}var H={key:"name",direction:"ASC"},V=[{key:"name",text:"Name",width:.2,minWidthPx:100},{key:"temperatureDegC",text:"Temp degC",width:.2,minWidthPx:100},{key:"capacitanceJPerDegK",text:"Capacitance J/degK",width:.2,minWidthPx:100},{key:"powerGenW",text:"Power Gen W",width:.15,minWidthPx:80},{key:"isBoundary",text:"Boundary?",width:.15,minWidthPx:80}];function z(e){var t=K({default:H}),n=Object(c.a)(t,3),i=n[0],o=n[1],a=n[2],r=e.rows,s=e.onUpdateRow,d=e.onDeleteRow,u=r.sort(a).map((function(e){return Object(C.jsxs)(p,{heightOffsetPx:h.tabHeightPx,isActive:e.isActive,children:[V.map((function(t){var n=Object(C.jsx)(B,{row:e,col:t,onUpdateRow:s});return Object(C.jsx)(j,{width:t.width,minWidth:t.minWidthPx,children:n},t.key)})),Object(C.jsx)(x,{tabIndex:0,onKeyUp:function(t){"Enter"===t.key&&d(e)},width:h.tableDeleteCellWidthPerc,minWidth:h.tableDeleteCellMinWidthPx,onClick:function(){return d(e)},children:"\u274c"})]},e.id)}));return Object(C.jsx)(b,{children:Object(C.jsxs)(m,{children:[Object(C.jsx)(S,{columns:V,sortState:i,setSortState:o}),Object(C.jsx)(v,{children:u})]})})}var U={key:"sourceName",direction:"ASC"},J=[{id:"bi",text:"Bidirectional"},{id:"uni",text:"Unidirectional"},{id:"rad",text:"Radiative"}];function F(e,t,n,i,o){var a=o.filter((function(e){return!(e.source.id===n&&e.target.id===i)}));return"sourceName"===e?t.filter((function(e){return e.id!==i})).filter((function(e){return!a.some((function(t){return t.source.id===e.id&&t.target.id===i||t.source.id===i&&t.target.id===e.id}))})):"targetName"===e?t.filter((function(e){return e.id!==n})).filter((function(e){return!a.some((function(t){return t.source.id===n&&t.target.id===e.id||t.source.id===e.id&&t.target.id===n}))})):t}function G(e){var t=K({default:U}),n=Object(c.a)(t,3),o=n[0],a=n[1],r=n[2],s=Object(i.useCallback)((function(t,n){var i=e.rows.find((function(e){return e.id===t})),o=e.nodes.find((function(e){return e.id===n.id}));i&&o&&o.id!==i.target.id&&e.onUpdateRow(Object(P.a)(Object(P.a)({},i),{},{source:o,sourceName:o.name}))}),[e]),d=Object(i.useCallback)((function(t,n){var i=e.rows.find((function(e){return e.id===t})),o=e.nodes.find((function(e){return e.id===n.id}));i&&o&&o.id!==i.source.id&&e.onUpdateRow(Object(P.a)(Object(P.a)({},i),{},{target:o,targetName:o.name}))}),[e]),u=Object(i.useCallback)((function(t,n){var i=e.rows.find((function(e){return e.id===t}));i&&e.onUpdateRow(Object(P.a)(Object(P.a)({},i),{},{kind:n.id}))}),[e]),l=e.nodes.map((function(e){return{id:e.id,text:e.name}})),f=Object(i.useMemo)((function(){return[{text:"Source",key:"sourceName",width:.25,minWidthPx:100,options:l,onSelectOption:s},{text:"Target",key:"targetName",width:.25,minWidthPx:100,options:l,onSelectOption:d},{text:"Resistance degK/W",key:"resistanceDegKPerW",width:.25,minWidthPx:100},{text:"Kind",key:"kind",width:.25,minWidthPx:100,options:J,onSelectOption:u}]}),[l,u,s,d]),g=e.nodes.filter((function(e){return e.isActive})).map((function(e){return e.id})),O=e.rows.map((function(e){return Object(P.a)(Object(P.a)({},e),{},{isActive:g.includes(e.source.id)||g.includes(e.target.id)})})).sort(r).map((function(t){return Object(C.jsxs)(p,{heightOffsetPx:h.tabHeightPx,isActive:t.isActive,children:[f.map((function(n){var i,o=Object(C.jsx)(B,{row:t,col:n,options:F(n.key,n.options||[],t.source.id,t.target.id,e.rows),initiallySetOption:null===(i=n.options)||void 0===i?void 0:i.find((function(e){return e.id===t[n.key]||e.text===t[n.key]})),onUpdateRow:e.onUpdateRow});return Object(C.jsx)(j,{width:n.width,minWidth:n.minWidthPx,children:o},n.key)})),Object(C.jsx)(x,{width:h.tableDeleteCellWidthPerc,minWidth:h.tableDeleteCellMinWidthPx,onClick:function(){return e.onDeleteRow(t)},children:"\u274c"})]},t.id)}));return Object(C.jsx)(b,{children:Object(C.jsxs)(m,{children:[Object(C.jsx)(S,{columns:f,sortState:o,setSortState:a}),Object(C.jsx)(v,{children:O})]})})}var q=d.a.div.withConfig({displayName:"Tabs__StyledTabsWrapper",componentId:"sc-1lldz8u-0"})(["display:inline-flex;width:100%;flex-direction:column;overflow:auto;position:relative;"]),Z=d.a.div.withConfig({displayName:"Tabs__StyledTabs",componentId:"sc-1lldz8u-1"})(["display:inline-flex;width:100%;height:","px;justify-content:space-evenly;position:sticky;top:0px;background:white;box-sizing:border-box;z-index:1;"],h.tabHeightPx),Y=d.a.div.withConfig({displayName:"Tabs__StyledTab",componentId:"sc-1lldz8u-2"})(["display:inline-flex;width:",";cursor:pointer;text-decoration:none;align-items:center;background:lightgray;border-radius:5px 5px 0 0;border:1px solid black;border-bottom:2px solid black;&:hover{opacity:0.75;}"],(function(e){var t=e.width;return"".concat(100*t,"%")})),X=d.a.div.withConfig({displayName:"Tabs__StyledTabText",componentId:"sc-1lldz8u-3"})(["font-size:1.1em;padding:0.2em 0.5em;&.active{font-weight:bold;}"]),Q=d.a.div.withConfig({displayName:"Tabs__StyledInnerContent",componentId:"sc-1lldz8u-4"})(["background:white;position:relative;"]);function $(e){var t=Object(i.useState)(0),n=Object(c.a)(t,2),o=n[0],a=n[1];return Object(C.jsxs)(q,{children:[e.tabs.length>1&&Object(C.jsx)(Z,{children:e.tabs.map((function(e,t){return Object(C.jsx)(Y,{onClick:function(){return a(t)},width:e.width,children:Object(C.jsx)(X,{className:t===o?"active":"",children:e.text})},e.text)}))}),Object(C.jsx)(Q,{topLeftRounded:e.tabs.length<=1,children:e.tabs.filter((function(e,t){return t===o}))[0].component})]})}var ee=d.a.div.withConfig({displayName:"ModelControls__StyledModelControlsWrapper",componentId:"sc-1sx26x7-0"})(["display:flex;flex-direction:column;height:100%;width:100%;justify-content:center;align-items:center;border-top:3px solid black;padding-top:1em;"]),te=d.a.button.withConfig({displayName:"ModelControls__StyledRunButton",componentId:"sc-1sx26x7-1"})([""]),ne=d.a.div.withConfig({displayName:"ModelControls__StyledTimeControls",componentId:"sc-1sx26x7-2"})([""]),ie=d.a.div.withConfig({displayName:"ModelControls__StyledTimeControl",componentId:"sc-1sx26x7-3"})(["display:flex;width:100%;align-items:center;justify-content:space-between;margin:0.5em;"]),oe=d.a.div.withConfig({displayName:"ModelControls__StyledInputWrapper",componentId:"sc-1sx26x7-4"})(["max-width:3em;height:1.5em;"]),ae=d.a.label.withConfig({displayName:"ModelControls__StyledLabel",componentId:"sc-1sx26x7-5"})(["margin-right:0.2em;"]);function ce(e){var t=e.onRunModel,n=e.timing,i=e.setTiming;return Object(C.jsxs)(ee,{children:[Object(C.jsxs)(ne,{children:[Object(C.jsxs)(ie,{children:[Object(C.jsx)(ae,{children:"Run Time [s]:"}),Object(C.jsx)(oe,{children:Object(C.jsx)(I,{initialValue:n.totalTimeS,onBlur:function(e){return i((function(t){return Object(P.a)(Object(P.a)({},t),{},{totalTimeS:e})}))}})})]}),Object(C.jsxs)(ie,{children:[Object(C.jsx)(ae,{children:"Time Step [s]:"}),Object(C.jsx)(oe,{children:Object(C.jsx)(I,{initialValue:n.timeStepS,onBlur:function(e){return i((function(t){return Object(P.a)(Object(P.a)({},t),{},{timeStepS:e})}))}})})]})]}),Object(C.jsx)(te,{onClick:t,children:"Run Model"})]})}var re=d.a.div.withConfig({displayName:"Sidebar__StyledEditor",componentId:"sc-1mf7iys-0"})(["height:","px;width:","px;border-left:3px solid black;"],(function(e){return e.height}),(function(e){return e.width})),se=d.a.div.withConfig({displayName:"Sidebar__StyledTables",componentId:"sc-1mf7iys-1"})(["display:inline-flex;width:100%;height:50%;"]),de=d.a.div.withConfig({displayName:"Sidebar__StyledModelControlsWrapper",componentId:"sc-1mf7iys-2"})(["display:inline-flex;width:100%;"]);function ue(e){var t=Object(C.jsx)(z,{rows:e.nodes,onUpdateRow:function(t){return e.updateNodes([t],!1)},onDeleteRow:function(t){return e.deleteNodes([t.id])}}),n=Object(C.jsx)(G,{rows:e.connections,nodes:e.nodes,onUpdateRow:function(t){return e.updateConnections([t])},onDeleteRow:function(t){return e.deleteConnections([t.id])}});return Object(C.jsxs)(re,{width:e.width,height:e.height,children:[Object(C.jsx)(se,{children:Object(C.jsx)($,{tabs:[{text:"Nodes",component:t,width:.5},{text:"Connections",component:n,width:.5}]})}),Object(C.jsx)(de,{children:Object(C.jsx)(ce,{onRunModel:e.onRunModel,timing:e.timing,setTiming:e.setTiming})})]})}var le,fe,he=n(171),be=n(339),me=n(340),ve=n(344),pe=n(168),je=n(169),xe=n(75),ge=n(72);function Oe(e){var t=e.plotDimensions,n=e.plotData,i=e.lines,o=e.xAxisKey,a=e.xLabel,c=e.yLabel;return Object(C.jsx)(be.a,{height:t.height,width:t.width,className:"chart",children:Object(C.jsxs)(me.a,{height:t.height,width:t.width,margin:t.margin,data:n,children:[Object(C.jsx)(ve.a,{strokeDasharray:"3 3"}),Object(C.jsx)(pe.a,{dataKey:o,label:{value:a,position:"center",dy:20}}),Object(C.jsx)(je.a,{label:{value:c,position:"center",angle:-90,dx:-20}}),Object(C.jsx)(xe.a,{}),Object(C.jsx)(ge.a,{layout:"horizontal",verticalAlign:"top",align:"center",wrapperStyle:{paddingLeft:"10px"}}),i]})})}var ye=["#2ecc71","#3498db","#9b59b6","#e74c3c","#e67e22","#34495e","#16a085"],we=d.a.div(le||(le=Object(r.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n\n  .chart {\n    width: 60% !important;\n    max-width: 900px;\n\n    @media only screen and (max-width: 600px) {\n      width: 90% !important;\n      touch-action: pan-y;\n    }\n  }\n"]))),Ce=d.a.div(fe||(fe=Object(r.a)(["\n  width: 100%;\n  height: ","px;\n  border-top: 3px solid black;\n  margin: 0;\n  padding: 0;\n"])),(function(e){return e.height}));function Se(e){var t=Math.floor(Math.log10(e.totalTimeS)),n=Math.pow(10,t-1);var i=e.timeSeriesS.length<400,o=[],a=[];return e.timeSeriesS.forEach((function(t,c){if(i||(d=t,0===Math.abs(d%n))){var r={time:t},s={time:t};e.nodeResults.forEach((function(e){r[e.node.name]=e.tempDegC[c]})),e.connectionResults.forEach((function(e){s["".concat(e.connection.source.name," to ").concat(e.connection.target.name)]=e.heatTransferW[c]})),o.push(r),a.push(s)}var d})),[o,a]}function ke(e){var t=e.modelOutput&&e.modelOutput.nodeResults.length>0?e.modelOutput:s.emptyOutput,n=Se(t),o=Object(c.a)(n,2),a=o[0],r=o[1],d=Object(i.useMemo)((function(){return t.connectionResults.map((function(e,t){return Object(C.jsx)(he.a,{type:"monotone",dataKey:"".concat(e.connection.source.name," to ").concat(e.connection.target.name),stroke:ye[t],activeDot:{r:8},isAnimationActive:!1},e.connection.id)}))}),[t.connectionResults]),u=Object(i.useMemo)((function(){return t.nodeResults.map((function(e,t){return Object(C.jsx)(he.a,{type:"monotone",dataKey:e.node.name,stroke:ye[t],activeDot:{r:8},isAnimationActive:!1},e.node.id)}))}),[t.nodeResults]),l=Object(C.jsx)(Oe,{plotDimensions:e.plotDimensions,plotData:a,lines:u,xAxisKey:"time",xLabel:"Time [s]",yLabel:"Temperature [degC]"}),f=Object(C.jsx)(Oe,{plotDimensions:e.plotDimensions,plotData:r,lines:d,xAxisKey:"time",xLabel:"Time [s]",yLabel:"Heat Transfer [Watts]"});return Object(C.jsx)(Ce,{height:e.plotDimensions.height,width:e.plotDimensions.width,children:Object(C.jsx)(we,{children:Object(C.jsx)($,{tabs:[{text:"Temperature",component:l,width:.5},{text:"Heat Transfer",component:f,width:.5}]})})})}var Pe=h.activeNodeOutlineWidth;function Te(e,t,n,i,o,a,c){!function(e,t,n,i){e.save(),e.beginPath(),e.arc(t.x,t.y,n,0,2*Math.PI),e.fillStyle=i,e.fill(),e.closePath(),e.restore()}(e,n,i,"red"),o&&function(e,t,n,i){e.save(),e.beginPath(),e.arc(t.x,t.y,n-Pe/2,0,2*Math.PI),e.lineWidth=Pe,e.strokeStyle=i,e.stroke(),e.closePath(),e.restore()}(e,n,i,"black"),a&&function(e,t,n){e.save(),e.lineWidth=2,e.fillStyle="#FFFFFF",e.translate(t.x,t.y),e.rotate(Math.PI/4),e.beginPath(),e.moveTo(-n,0),e.lineTo(n,0),e.stroke();for(var i=0;i+4.5<n;){i+=4.5;var o=n*Math.sin(Math.acos(i/n));e.moveTo(-o-1,i),e.lineTo(o+1,i),e.stroke(),e.moveTo(-o-1,-i),e.lineTo(o+1,-i),e.stroke()}e.closePath(),e.beginPath(),e.arc(0,0,n+2,0,2*Math.PI,!1),e.arc(0,0,n,0,2*Math.PI,!0),e.fill(),e.restore()}(e,n,i),function(e,t,n,i,o){e.save(),e.font="14px Helvetica";var a=e.measureText(t),c=a.width;e.translate(n.x,n.y),"D"===o?e.fillText(t,-c/2,a.actualBoundingBoxAscent+i+2):"R"===o?e.fillText(t,i+2,a.actualBoundingBoxAscent/2):"U"===o?e.fillText(t,-c/2,-(a.actualBoundingBoxDescent+i+2)):e.fillText(t,-(c+i+2),a.actualBoundingBoxAscent/2),e.restore()}(e,t,n,i,c)}function Ne(e,t,n,i){"bi"===i?function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;e.save(),e.beginPath(),e.strokeStyle=i,e.lineWidth=2;var c=9,r=4,s=0,d=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,d),f=Math.sqrt(d*d+u*u)-a;e.translate(t.x,t.y),e.rotate(l),e.beginPath(),e.moveTo(o,s),e.lineTo(f,s),e.moveTo(f-c,r+s),e.lineTo(f,s),e.lineTo(f-c,-(r-s)),e.moveTo(f,-s),e.lineTo(o,-s),e.moveTo(o+c,-(r+s)),e.lineTo(o,-s),e.lineTo(o+c,r-s),e.stroke(),e.closePath(),e.restore()}(e,t.center,n.center,"black",t.radius,n.radius):function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;e.save(),e.beginPath(),e.strokeStyle=i,e.lineWidth=2;var c=9,r=4,s=n.x-t.x,d=n.y-t.y,u=Math.atan2(d,s),l=Math.sqrt(s*s+d*d)-a;e.translate(t.x,t.y),e.rotate(u),e.beginPath(),e.moveTo(o,0),e.lineTo(l,0),e.moveTo(l-c,-r),e.lineTo(l,0),e.lineTo(l-c,r),e.stroke(),e.closePath(),e.restore()}(e,t.center,n.center,"black",t.radius,n.radius)}function We(e,t,n){var i=e.x-t.x,o=e.y-t.y;return Math.pow(i,2)+Math.pow(o,2)<=Math.pow(n,2)}function De(e,t){var n={x:e.pageX,y:e.pageY},i=t.getBoundingClientRect();return l(n,{x:i.left,y:i.top})}function _e(e,t){if(t.context){var n=De(e,t.context.canvas);return i=n,o=t.offset,a=t.scale,l(f(i,a),o)}return u;var i,o,a}function Re(e,t){var n=i.useState((function(){var n=window.localStorage.getItem(t);return null===n||void 0===n?e:JSON.parse(n)})),o=Object(c.a)(n,2),a=o[0],r=o[1];return i.useEffect((function(){window.localStorage.setItem(t,JSON.stringify(a))}),[t,a]),[a,r]}var Ae=h.maxZoom,Ie=h.minZoom,Ee=h.zoomSensitivity;var Me,Le,Be=d.a.div.withConfig({displayName:"Controls__StyledButtons",componentId:"sc-1s5x3rc-0"})(["position:absolute;bottom:0;left:0;display:flex;flex-direction:column;"]),Ke=d.a.button.withConfig({displayName:"Controls__StyledButton",componentId:"sc-1s5x3rc-1"})(["margin:0.2em;"]);function He(e){return Object(C.jsxs)(Be,{children:[Object(C.jsx)(Ke,{onClick:function(){return e.canvasState.context&&e.setView(u,1)},children:"Reset View"}),Object(C.jsx)(Ke,{onClick:function(){return e.canvasState.context&&e.setView(e.savedCanvasState.offset,e.savedCanvasState.scale)},children:"Reset View to Saved"}),Object(C.jsx)(Ke,{onClick:function(){e.setSavedCanvasState({offset:e.canvasState.offset,scale:e.canvasState.scale})},children:"Save View"})]})}var Ve=d.a.div(Me||(Me=Object(r.a)(["\n  display: block;\n  max-height: 100%;\n  position: relative;\n"]))),ze=d.a.canvas(Le||(Le=Object(r.a)(["\n  width: ",";\n  height: ",";\n"])),(function(e){var t=e.cssWidth;return"".concat(t,"px")}),(function(e){var t=e.cssHeight;return"".concat(t,"px")}));function Ue(e){var t,n,o=e.canvasWidth,a=e.canvasHeight,r=e.devicePixelRatio,s=e.draw,d=e.onMouseDown,h=e.handleDoubleClick,b=e.savedCanvasState,m=e.setSavedCanvasState,v=e.setKeyboardActive,p=Object(i.useRef)(null);t=p,n=v,Object(i.useEffect)((function(){var e=function(e){var i=!!t.current&&t.current.contains(e.target);n(i)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[t,n]);var j=function(e){var t=Object(i.useState)(null),n=Object(c.a)(t,2),o=n[0],a=n[1],r=Re(1,"hotstuffScale"),s=Object(c.a)(r,2),d=s[0],h=s[1],b=Re(u,"hotstuffOffset"),m=Object(c.a)(b,2),v=m[0],p=m[1],j=Object(i.useRef)(u),x=Object(i.useRef)(u),g=Object(i.useCallback)((function(e,t){p(e),h(t)}),[p,h]),O=Object(i.useCallback)((function(e){if(o){var t=De(e,o.canvas);x.current=j.current,j.current=t;var n=f(l(j.current,x.current),d);p((function(e){return i=n,{x:(t=e).x+i.x,y:t.y+i.y};var t,i}))}}),[o,d,p]),y=Object(i.useCallback)((function(){document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",y)}),[O]),w=Object(i.useCallback)((function(e){o&&(document.addEventListener("mousemove",O),document.addEventListener("mouseup",y),j.current=De(e,o.canvas))}),[o,O,y]);return Object(i.useLayoutEffect)((function(){function t(e){if(e.preventDefault(),o){var t=De(e,o.canvas);x.current=j.current,j.current=t;var n=1-e.deltaY/Ee,i=d*n;if(i>Ae||i<Ie)return;var a=l(f(j.current,d),f(j.current,i));p(l(v,a)),h(i)}}var n=e.current;if(n)return n.addEventListener("wheel",t),function(){return n.removeEventListener("wheel",t)}}),[e,o,v,d,p,h]),[o,a,g,v,d,w]}(p),x=Object(c.a)(j,6),g=x[0],O=x[1],y=x[2],w=x[3],S=x[4],k=x[5];return Object(i.useLayoutEffect)((function(){if(p.current){var e=p.current.getContext("2d");O(e)}}),[O]),Object(i.useLayoutEffect)((function(){g&&(g.canvas.width=o*r,g.canvas.height=a*r,g.scale(S*r,S*r),g.translate(w.x,w.y),s(g))}),[a,o,g,r,s,w.x,w.y,S]),Object(C.jsxs)(Ve,{children:[Object(C.jsx)(He,{setView:y,canvasState:{context:g,offset:w,scale:S,canvasWidth:o,canvasHeight:a},savedCanvasState:b,setSavedCanvasState:m}),Object(C.jsx)(ze,{ref:p,width:o*r,height:a*r,cssWidth:o,cssHeight:a,onMouseDown:function(e){return d(e,{context:g,offset:w,scale:S,canvasWidth:o,canvasHeight:a},(function(){return k(e)}))},onDoubleClick:function(e){return h(e,{context:g,offset:w,scale:S,canvasWidth:o,canvasHeight:a})}})]})}var Je=h.newNodeNamePrefix,Fe=h.defaultNodeRadius;var Ge=n(48);var qe=h.defaultResistanceDegKPerW,Ze=h.defaultConnectionKind;function Ye(e,t,n,o){var a=Object(i.useCallback)((function(e,t,n){if(n.context){var i=_e(e,n);o(n),function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;e.save(),e.beginPath(),e.strokeStyle=i,e.lineWidth=2;var c=n.x-t.x,r=n.y-t.y,s=Math.atan2(r,c),d=Math.sqrt(c*c+r*r);e.translate(t.x,t.y),e.rotate(s),e.beginPath(),e.moveTo(o,0);var u=d-a;e.lineTo(u,0),e.stroke(),e.closePath(),e.restore()}(n.context,t.center,i,"grey")}}),[o]);return Object(i.useCallback)((function(i,c,r){var d=function(e){a(e,c,r)};document.addEventListener("mousemove",d),document.addEventListener("mouseup",(function i(a){document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",i);var u=_e(a,r),l=e.find((function(e){return We(u,e.center,e.radius)&&e.id!==c.id&&!t.some((function(t){return t.source.id===e.id&&t.target.id===c.id||t.target.id===e.id&&t.source.id===c.id}))}));if(l){var f=Object(P.a)(Object(P.a)({},Object(s.makeConnection)({source:c,target:l,resistanceDegKPerW:qe,kind:Ze})),{},{sourceName:c.name,targetName:l.name});n([].concat(Object(Ge.a)(t),[f]))}else o(r)}))}),[t,e,o,a,n])}function Xe(e,t,n){return Object(i.useCallback)((function(i,o){var a=_e(i,o),r=function(e){var t,i,c,r;o.context&&(n(o),t=o.context,i=a,c=_e(e,o),r="grey",t.save(),t.beginPath(),t.fillStyle=r,t.globalAlpha=.2,t.fillRect(i.x,i.y,c.x-i.x,c.y-i.y),t.closePath(),t.beginPath(),t.strokeStyle=r,t.rect(i.x,i.y,c.x-i.x,c.y-i.y),t.stroke(),t.closePath(),t.restore())};document.addEventListener("mousemove",r),document.addEventListener("mouseup",(function n(i){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n);var s=_e(i,o),d=e.filter((function(e){return function(e,t,n){var i=e.x<t.x&&e.y<t.y?[e,t]:[t,e],o=Object(c.a)(i,2),a=o[0],r=o[1],s=e.x<t.x&&e.y>t.y?[e,t]:[t,e],d=Object(c.a)(s,2),u=d[0],l=d[1];return a.x<=n.x&&n.x<=r.x&&a.y<=n.y&&n.y<=r.y||u.x<=n.x&&n.x<=l.x&&l.y<=n.y&&n.y<=u.y}(a,s,e.center)||e.isActive})).map((function(e){return e.id}));t(d)}))}),[e,n,t])}function Qe(e,t,n,o,a,c,r){var s=Ye(e,t,n,r),d=function(e){var t=Object(i.useRef)(!1);return Object(i.useCallback)((function(n,i,o,a){var c=l(_e(n,a),i.center),r=n.shiftKey,s=function(n){if(a.context){t.current=!0;var s=l(_e(n,a),c),d=Object(P.a)(Object(P.a)({},i),{},{isActive:!0,center:s}),u=i.isActive||r?o.map((function(e){var t=l(i.center,e.center);return Object(P.a)(Object(P.a)({},e),{},{center:l(s,t)})})):[];e([d].concat(Object(Ge.a)(u)),!n.shiftKey)}};document.addEventListener("mousemove",s),document.addEventListener("mouseup",(function n(o){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",n),e([Object(P.a)(Object(P.a)({},i),{},{center:l(_e(o,a),c),isActive:!0})],!t.current&&!r),t.current=!1}))}),[e])}(o),u=Xe(e,a,r);return Object(i.useCallback)((function(t,n,i){var o=_e(t,n),r=e.filter((function(e){return e.isActive})),l=r.map((function(e){return e.id})),f=e.find((function(e){return We(o,e.center,e.radius)}));f?t.altKey?s(t,f,n):t.shiftKey&&l.includes(f.id)?a(l.filter((function(e){return e!==f.id}))):d(t,f,r,n):t.shiftKey?u(t,n):(c(),i(t))}),[e,c,d,u,s,a])}var $e,et,tt,nt=Object(s.makeNode)({name:"test1",temperatureDegC:85,capacitanceJPerDegK:100,powerGenW:0,isBoundary:!0}),it=Object(s.makeNode)({name:"test2",temperatureDegC:23,capacitanceJPerDegK:2,powerGenW:0,isBoundary:!1}),ot=[Object(P.a)(Object(P.a)({},nt),{},{center:{x:200,y:200},radius:h.defaultNodeRadius,color:"red",isActive:!1,textDirection:"D"}),Object(P.a)(Object(P.a)({},it),{},{center:{x:650,y:450},radius:h.defaultNodeRadius,color:"red",isActive:!1,textDirection:"D"})],at=[Object(P.a)(Object(P.a)({},Object(s.makeConnection)({source:nt,target:it,resistanceDegKPerW:10,kind:"bi"})),{},{sourceName:nt.name,targetName:it.name})],ct=h.editorWidthPerc,rt=h.canvasHeightPerc,st=h.plotMargin,dt=h.tabHeightPx,ut=h.plotHeightBufferPx,lt=d.a.div($e||($e=Object(r.a)(["\n  display: flex;\n  height: ","px;\n  user-select: none;\n  -webkit-user-select: none; /* Chrome/Safari */\n  -moz-user-select: none; /* Firefox */\n  -ms-user-select: none; /* IE10+ */\n"])),(function(e){return e.height})),ft=d.a.div(et||(et=Object(r.a)(["\n  height: ","px;\n  width: ","px;\n"])),(function(e){return e.height}),(function(e){return(1-ct)*e.width})),ht=d.a.div(tt||(tt=Object(r.a)(["\n  width: 100%;\n  height: ","px;\n"])),(function(e){return e.height}));function bt(){var e=Object(i.useState)(void 0),t=Object(c.a)(e,2),n=t[0],o=t[1],a=Re({timeStepS:h.defaultTimeStepSeconds,totalTimeS:h.defaultTotalTimeSeconds},"hotstuffTiming"),r=Object(c.a)(a,2),d=r[0],l=r[1],f=Re(ot,"hotstuffNodes"),b=Object(c.a)(f,2),m=b[0],v=b[1],p=Re(at,"hotstuffConnections"),j=Object(c.a)(p,2),x=j[0],g=j[1],O=function(e,t){var n=Object(i.useCallback)((function(t){e((function(e){var n=e.map((function(e){return Object(P.a)(Object(P.a)({},e),{},{isActive:!1})}));return n.push(Object(P.a)(Object(P.a)({},t),{},{isActive:!0})),n}))}),[e]),o=Object(i.useCallback)((function(n){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e((function(e){return e.map((function(e){return n.find((function(t){return t.id===e.id}))||(i?Object(P.a)(Object(P.a)({},e),{},{isActive:!1}):e)}))})),t((function(e){return e.map((function(e){var t=n.find((function(t){return e.source.id==t.id}));if(t)return Object(P.a)(Object(P.a)({},e),{},{source:t,sourceName:t.name});var i=n.find((function(t){return e.target.id==t.id}));return i?Object(P.a)(Object(P.a)({},e),{},{target:i,targetName:i.name}):e}))}))}),[t,e]);return[n,o,Object(i.useCallback)((function(n){t((function(e){return e.filter((function(e){return!n.includes(e.source.id)&&!n.includes(e.target.id)}))})),e((function(e){return e.filter((function(e){return!n.includes(e.id)}))}))}),[t,e]),Object(i.useCallback)((function(e){var n=e.map((function(e){return e.id}));t((function(t){var i=t.filter((function(e){return!n.includes(e.id)}));return[].concat(Object(Ge.a)(e),Object(Ge.a)(i))}))}),[t]),Object(i.useCallback)((function(e){t((function(t){return t.filter((function(t){return!e.includes(t.id)}))}))}),[t]),Object(i.useCallback)((function(t){e((function(e){return e.map((function(e){return Object(P.a)(Object(P.a)({},e),{},{isActive:t.includes(e.id)})}))}))}),[e]),Object(i.useCallback)((function(){e((function(e){return e.map((function(e){return Object(P.a)(Object(P.a)({},e),{},{isActive:!1})}))}))}),[e])]}(v,g),y=Object(c.a)(O,7),w=y[0],S=y[1],k=y[2],T=y[3],N=y[4],W=y[5],D=y[6],_=Object(i.useState)(!0),R=Object(c.a)(_,2),A=R[0],I=R[1];!function(e,t,n,o){Object(i.useEffect)((function(){var i=function(i){e&&(i.metaKey&&65===i.keyCode&&(i.preventDefault(),n((function(e){return e.map((function(e){return Object(P.a)(Object(P.a)({},e),{},{isActive:!0})}))}))),"Backspace"!==i.key&&"Delete"!==i.key||(i.preventDefault(),o(t.filter((function(e){return e.isActive})).map((function(e){return e.id})))),27===i.keyCode&&n((function(e){return e.map((function(e){return Object(P.a)(Object(P.a)({},e),{},{isActive:!1})}))})))};return document.addEventListener("keydown",i),function(){return document.removeEventListener("keydown",i)}}),[t,o,e,n])}(A,m,v,k);var E=function(e,t){var n=Object(i.useCallback)((function(n){e.map((function(e){Te(n,e.name,e.center,e.radius,e.isActive,e.isBoundary,e.textDirection)})),t.map((function(t){var i=t.source,o=t.target,a=t.kind,c=e.find((function(e){return e.id===i.id})),r=e.find((function(e){return e.id===o.id}));c&&r&&Ne(n,c,r,a)}))}),[t,e]),o=Object(i.useCallback)((function(e){e.context&&(e.context.clearRect(-e.offset.x,-e.offset.y,e.canvasWidth/e.scale,e.canvasHeight/e.scale),n(e.context))}),[n]);return[n,o]}(m,x),M=Object(c.a)(E,2),L=M[0],B=M[1],K=function(e,t,n){return Object(i.useCallback)((function(i,o){i.preventDefault();var a=_e(i,o),c=e.find((function(e){return We(a,e.center,e.radius)}));if(c)n([Object(P.a)(Object(P.a)({},c),{},{textDirection:(r=c.textDirection,"D"===r?"R":"R"===r?"U":"U"===r?"L":"D")})]);else{var r,d=e.filter((function(e){return e.name.startsWith(Je)})).length,u=Object(s.makeNode)({name:0===d?"".concat(Je):"".concat(Je," (").concat(d+1,")"),temperatureDegC:h.defaultTempDegC,capacitanceJPerDegK:h.defaultCapJPerDegK,powerGenW:h.defaultPowerGenW,isBoundary:!1}),l=Object(P.a)(Object(P.a)({},u),{},{center:a,radius:Fe,color:"red",isActive:!1,textDirection:"D"});t(l)}}),[t,e,n])}(m,w,S),H=Qe(m,x,g,S,W,D,B),V=Re({offset:u,scale:1},"hotstuffSavedCanvasState"),z=Object(c.a)(V,2),U=z[0],J=z[1],F=function(){var e=Object(i.useState)([0,0]),t=Object(c.a)(e,2),n=t[0],o=t[1],a=Object(i.useState)(1),r=Object(c.a)(a,2),s=r[0],d=r[1];return Object(i.useLayoutEffect)((function(){function e(){o([window.innerWidth,window.innerHeight])}function t(){var e=window.devicePixelRatio;d(void 0===e?1:e)}return window.addEventListener("resize",e),window.addEventListener("resize",t),e(),t(),function(){window.removeEventListener("resize",e),window.removeEventListener("resize",t)}}),[]),[n,s]}(),G=Object(c.a)(F,2),q=G[0],Z=G[1],Y=Object(c.a)(q,2),X=Y[0],Q=Y[1],$=X,ee=Q,te=Q*rt,ne=X*(1-ct),ie=(1-rt)*Q-dt-ut,oe=ne,ae=ct*X;return Object(C.jsxs)(lt,{height:Q,children:[Object(C.jsxs)(ft,{height:ee,width:$,children:[Object(C.jsx)(ht,{height:te,children:Object(C.jsx)(Ue,{canvasWidth:ne,canvasHeight:te,devicePixelRatio:Z,draw:L,onMouseDown:H,handleDoubleClick:K,savedCanvasState:U,setSavedCanvasState:J,setKeyboardActive:I})}),Object(C.jsx)(ke,{plotDimensions:{height:ie,width:oe,margin:st},modelOutput:n})]}),Object(C.jsx)(ue,{height:Q,width:ae,timing:d,setTiming:l,nodes:m,connections:x,updateNodes:S,deleteNodes:k,updateConnections:T,deleteConnections:N,onRunModel:function(){var e,t=Object(s.run)({nodes:m,connections:x,timeStepS:d.timeStepS,totalTimeS:d.totalTimeS});(null===(e=t.errors)||void 0===e?void 0:e.length)&&t.errors.forEach((function(e){return console.error(e.message)})),o(t)}})]})}window.addEventListener("load",(function(){(function(){var e=document.createElement("div"),t=document.createElement("div");e.style.width="30px",e.style.height="30px",e.style.overflow="scroll",e.style.borderWidth="0",t.style.width="30px",t.style.height="60px",e.appendChild(t),document.body.appendChild(e);var n=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),n>0})()||document.body.classList.add("force-show-scrollbars")})),a.a.render(Object(C.jsx)(i.StrictMode,{children:Object(C.jsx)(bt,{})}),document.getElementById("root"))}},[[338,1,2]]]);
//# sourceMappingURL=main.a22b1c31.chunk.js.map