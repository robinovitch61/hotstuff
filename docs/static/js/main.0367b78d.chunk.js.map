{"version":3,"sources":["config.ts","style.tsx","components/Sidebar/EditableTable/style.tsx","components/Sidebar/EditableTable/TableHeader.tsx","hooks/useOnClickOutside.ts","components/Sidebar/DropDown.tsx","components/Sidebar/EditableTable/cells/DropDownTableCell.tsx","components/Sidebar/style.tsx","components/Sidebar/EditableInput.tsx","components/Sidebar/EditableStringInput.tsx","components/Sidebar/EditableTable/cells/TextTableCell.tsx","components/Sidebar/EditableNumberInput.tsx","components/Sidebar/EditableTable/cells/NumericalTableCell.tsx","components/Sidebar/EditableTable/cells/BooleanTableCell.tsx","components/Sidebar/EditableTable/TableCell.tsx","components/Sidebar/EditableTable/hooks/useSortableTable.ts","img/icons/Icon.tsx","img/icons/CrossMark.tsx","img/icons/cross-mark.png","components/Sidebar/EditableTable/DeleteCell.tsx","utils/nodeConnectionUtils.ts","components/Sidebar/EditableTable/tableUtils.tsx","components/Sidebar/EditableTable/NodeTable/NodeTable.tsx","utils/imageUtils.ts","img/hotsprings.png","img/link.png","img/sunny.png","components/Sidebar/EditableTable/ConnectionTable/ConnectionKindOption.tsx","components/Sidebar/EditableTable/ConnectionTable/ConnectionTable.tsx","components/Tabs/Tabs.tsx","utils/pointUtils.ts","default.ts","components/Sidebar/ioUtils.tsx","components/Sidebar/ModelControls.tsx","components/Sidebar/hooks/useTemporaryError.tsx","components/Modal/style.tsx","components/Modal/ErrorModal.tsx","components/Sidebar/Sidebar.tsx","components/Plot/LinePlot.tsx","components/Plot/plotUtils.tsx","components/Plot/Plot.tsx","components/Canvas/canvasUtils.ts","components/Canvas/hooks/usePanZoomCanvas.ts","components/Canvas/CanvasControls.tsx","components/Canvas/Canvas.tsx","components/Canvas/hooks/useOnClickCanvas.ts","hooks/useDraw.ts","hooks/useConnectionKindImageMap.ts","hooks/useAddConnection.ts","hooks/useMoveNode.ts","hooks/useMultiSelect.ts","hooks/useOnMouseDown.ts","hooks/useClickAndDragElement.ts","hooks/useResizablePanels.ts","components/Modal/ConfirmationModal.tsx","components/Modal/TheoryModal.tsx","components/Modal/TutorialModal.tsx","components/Modal/Modal.tsx","components/Header/ModalControls.tsx","img/thermalmodel-logo.png","components/Header/Logo.tsx","components/Header/style.tsx","App.tsx","hooks/useSessionStorageState.ts","hooks/useAppStateModifiers.ts","hooks/useNodeConnectionUtils.ts","hooks/useKeyDown.ts","hooks/useDoubleClick.ts","components/Canvas/hooks/useWindowSize.ts","utils/scrollBar.ts","index.tsx"],"names":["lightGrey","config","borderWidthPx","headerHeightPx","maxTimeSteps","defaultTempDegC","defaultCapJPerDegK","defaultPowerGenW","defaultTotalTimeSeconds","defaultTimeStepSeconds","defaultNodeName","defaultNodeRadius","defaultResistanceDegKPerW","defaultSmallResistanceDegKPerW","defaultEditorWidthFraction","defaultCanvasHeightFraction","defaultTableHeightFraction","minPanelFraction","newNodeNamePrefix","zoomSensitivity","minZoom","maxZoom","maxZoomDelta","minRadiusPx","maxRadiusPx","minLineThicknessPx","maxLineThicknessPx","activeNodeOutlineWidthPx","tabHeightPx","tableDeleteCellWidthPercent","tableDeleteCellMinWidthPx","plotHeightBufferPx","plotMargin","left","right","top","bottom","plotYDomainPaddingPx","plotTickFontSizePx","maxPlotPoints","multiSelectKeys","errorMessageDurationSeconds","maxNoteLengthChars","activeColor","pasteXOffset","primaryColor","secondaryColor","tabColor","inactiveTabColor","StyledApp","styled","div","props","height","modalOpen","StyledDraggableBorder","StyledHorizontalBorder","width","y","StyledVerticalBorder","x","StyledWorkspace","StyledCanvas","sharedButtonStyles","css","primary","StyledButton","button","StyledAnchorAsButton","a","StyledTableWrapper","StyledTable","StyledTableBody","StyledAddButtonWrapper","StyledAddButton","StyledRow","heightOffsetPx","isActive","StyledCell","minWidth","StyledDeleteCell","StyledHeaderWrapper","StyledColHeader","widthPercent","minWidthPx","StyledColText","StyledSortIcon","TableHeader","columns","sortState","setSortState","sortIcon","direction","map","col","isSortedCol","key","onClick","sortDirection","text","toString","style","cursor","useOnClickOutside","ref","onClickOutside","useEffect","listener","event","current","contains","target","document","addEventListener","removeEventListener","StyledDropDown","StyledCurrentValue","hasOptions","StyledOptions","StyledOption","StyledOptionText","StyledDropDownIcon","DropDown","useState","isOpen","setIsOpen","wrapperRef","useRef","options","length","toggleOpen","useCallback","tabIndex","onKeyUp","value","option","onChange","id","DropDownTableCell","setOption","filter","newVal","selectedOption","find","undefined","onSelectOption","rowId","StyledInput","input","StyledEditor","StyledTables","heightFrac","StyledModelControlsWrapper","EditableInput","initialValue","onBlur","getNewValue","afterValue","validator","inputRef","withAfterValue","val","setValue","handleOnBlur","validated","prevVal","type","onFocus","replace","onKeyDown","includes","blur","EditableStringInput","TextTableCell","initialVal","getFloatVal","newValueText","newValueFloat","parseFloat","isNaN","EditableNumberInput","NumericalTableCell","StyledCheckbox","BooleanTableCell","initialIsActive","setIsActive","showWhenActive","TableCell","row","onUpdateRow","initiallySetOption","useSortableTable","defaultSortState","tieBreakerKey","ultraSuperDuperTieBreakerKey","first","second","StyledImg","img","Icon","src","CrossMark","DeleteCell","onDeleteRow","ALL_CONNECTION_KINDS","DO_NOT_PAIR_KINDS","getExistingConnections","firstNodeId","secondNodeId","connections","conn","firstNode","secondNode","makeNewConnection","kind","resistance","firstNodeFirst","name","makeConnection","resistanceDegKPerW","connectionNotes","getNewConnection","existingConnections","existingKinds","remainingKinds","every","k","some","newNodeName","allNodeNames","makeName","i","getNewAppNode","appNodes","center","node","newNode","makeNode","temperatureDegC","capacitanceJPerDegK","powerGenW","isBoundary","textDirection","nodeNotes","getConnectionAfterValue","filterConnectionOptions","colKey","selectedConnection","otherConnections","filterKey","allOtherConnections","filteringFirstNode","otherConnection","isIllegalConnectionKindCombo","filterFirstAndSecondNodeOptions","possibleKinds","connectionKind","getNewConnectionKindsPossible","opt","getConnectionKey","connection","getConnectionsToCounts","connectionToCount","Map","forEach","connectionsToCounts","set","get","incrementConnectionCount","noteValidator","setTemporaryErrors","navigator","clipboard","writeText","slice","defaultNodeSortState","NodeTable","rows","onClickEditableCell","sortByState","nodeColumns","useMemo","otherNames","trimName","trim","safeName","n","validateNodeName","r","tempVal","KELVIN","tableRows","sort","tableCell","connectionKindToImgSrc","StyledWrapper","ConnectionKindOption","defaultConnectionSortState","connectionKindOptions","ConnectionTable","nodes","onSelectNewFirstNode","newFirstNodeNode","onSelectNewSecondNode","newSecondNodeNode","onSelectNewConnectionType","rowToUpdate","nodeOptions","connectionColumns","resistanceNumber","activeNodeIds","cols","makeStyledCell","StyledTabsWrapper","StyledTabs","StyledTab","active","StyledTabText","StyledInnerContent","Tabs","activeIdx","setActiveIdx","tabs","tab","idx","topLeftRounded","_","component","after","ORIGIN","Object","freeze","diffPoints","p1","p2","scalePoint","scale","jerryNode","jerryAppNode","bedNode","bedAppNode","airNode","defaultNodes","defaultConnections","defaultTiming","timeStepS","totalTimeS","defaultCanvasViewState","offset","defaultPanelSizes","editorWidthFraction","canvasHeightFraction","tableHeightFraction","defaultModalState","visible","defaultAppState","timing","canvasViewState","savedCanvasState","panelSizes","defaultAppClipboard","copiedNodes","copiedConnections","nicelyFormattedJsonString","toFormat","JSON","stringify","isoFormattedCurrentTimeInLocalTime","Date","setHours","getHours","getTimezoneOffset","toISOString","getUrlForObject","inputObject","blob","Blob","URL","createObjectURL","StyledModelControlButton","StyledAnchor","StyledImport","StyledTopControls","StyledTimeControls","StyledTimeControl","StyledInputWrapper","StyledLabel","label","ModelControls","appState","setAppState","setOutput","setModalState","onRunModel","setTiming","stagedAppState","setStagedAppState","downloadModelRef","runAndDownloadModelRef","newTotalTimeS","newTimeStepS","newOutput","output","url","setAttribute","downloadAppStateFromAnchor","exportedAppState","downloadExportedAppStateFromAnchor","parse","accept","display","files","file","reader","FileReader","onload","contents","result","readAsText","importFileFromUser","htmlFor","prev","onConfirm","confirmText","useTemporaryError","errors","setErrors","setTimeout","StyledText","p","StyledLink","StyledListItem","li","StyledModalContent","StyledTitle","h1","StyledSubTitle","h2","StyledExitButton","StyledError","isVisible","ErrorModal","err","Sidebar","onAddNode","onAddConnection","updateNodes","deleteNodes","setActiveNodes","updateConnections","deleteConnections","tableErrors","setTableErrors","setTemporaryTableErrors","modelControlsErrors","setModelControlsErrors","setTemporaryModelControlsErrors","nodeTable","nodeAddButton","connectionTable","connectionAddButton","Math","ceil","StyledToolTip","StyledToolTipTitle","StyledToolTipItem","color","StyledToolTipValue","CustomTooltip","payload","sortedPayload","b","item","LinePlot","plotDimensions","plotData","lines","xAxisKey","xLabel","yLabel","unit","LineChart","margin","data","CartesianGrid","strokeDasharray","XAxis","dataKey","tick","fontSize","position","dy","YAxis","domain","allowDecimals","padding","angle","dx","ReferenceLine","stroke","strokeWidth","Tooltip","content","Legend","layout","verticalAlign","align","wrapperStyle","paddingLeft","paddingBottom","firstNodeStartsHotter","getDataKeyForConnection","firstStartsHotter","firstName","secondName","roundToNearestHundredth","round","getDataForPlots","lowerMag","floor","log10","divisibleBy","pow","includeAll","timeSeriesS","tempsAtAllTimes","heatTransfersAtAllTimes","t","abs","temp","time","ht","nodeResults","nodeResult","tempDegC","connectionResults","connectionResult","heatTransferVal","heatTransferW","signedHeatTransferVal","push","colors","StyledCharts","StyledPlot","Plot","res","modelOutput","emptyOutput","tempPlotData","heatTransferPlotData","heatTransferLines","Line","activeDot","isAnimationActive","tempLines","tempPlot","heatTransferPlot","DEFAULT_RADIUS","DEFAULT_LINE_THICKNESS","drawNode","context","radius","powerGen","save","beginPath","arc","PI","fillStyle","fill","closePath","restore","drawCircle","lineWidth","strokeStyle","drawCircleOutline","translate","rotate","moveTo","lineTo","h","newRadius","sin","acos","drawHashPattern","precision","textMetrics","genString","toExponential","fontPx","font","measureText","actualBoundingBoxAscent","w","arcTo","roundRect","fillText","drawPowerGen","actualBoundingBoxDescent","drawNodeName","drawNodes","nodeRadius","determineRadius","nodeColor","temperature","allTemperatures","minTemp","min","maxTemp","max","range","scaleDiverging","colorScale","determineColor","drawConnections","appConnections","connectionKindImageMap","leftToDrawConnectionCount","allResistances","imgForConnectionKind","firstNodeAppNode","secondNodeAppNode","firstNodeRadius","secondNodeRadius","leftToDraw","alreadyDrawn","firstNodeCenter","secondNodeCenter","lineThicknessPx","start","end","startOffset","endOffset","atan2","sqrt","adjLength","imageSize","buffer","drawImage","drawLineBetween","drawConnection","determineLineThickness","currentCount","decrementConnectionCount","intersectsCircle","point","circleCenter","deltaX","deltaY","calculateMousePositionOnElement","element","viewportMousePos","pageX","pageY","boundingRect","getBoundingClientRect","mouseToNodeCoords","canvasState","canvasMouse","canvas","mouse","capacitance","allCapacitances","StyledCanvasControlButtons","StyledCanvasControlButton","CanvasControls","setCanvasViewState","setSavedCanvasState","StyledCanvasWrapper","StyledCanvasState","cssWidth","cssHeight","Canvas","onClickCanvas","canvasWidth","canvasHeight","devicePixelRatio","draw","onMouseDown","handleDoubleClick","savedCanvasViewState","setSavedCanvasViewState","setKeyboardActive","canvasRef","handleClickOutside","keyBoardActive","setContext","mousePosRef","lastMousePosRef","lastCanvasViewState","mouseMove","newMousePos","mouseDiff","newCanvasViewState","mouseUp","startPan","useLayoutEffect","handleWheel","preventDefault","zoomDelta","zoom","newScale","mouseOffset","canvasElem","usePanZoomCanvas","renderCtx","getContext","onDoubleClick","useDraw","images","setImages","Image","useConnectionKindImageMap","clearAndRedraw","clearRect","useAddConnection","addConnection","drawConnectionBeingMade","clickedNode","nodeCoordsOfMouse","drawLine","drawConnWrapper","mouseUpOnNode","newConnection","getNewAppNodes","clickedMouseEvent","currentMouseEvent","multiSelectKeyPressed","activeNodes","offsetMouseToCenter","newClickedCenter","newClickedNode","newActiveNodes","distanceFromClickedCenter","useMultiSelect","boxStart","drawBox","globalAlpha","fillRect","rect","boxEnd","startBox","endBox","topLeft","bottomRight","bottomLeft","topRight","isInsideBox","useOnMouseDown","clearActiveNodes","moveNode","movedRef","mouseDownEvent","newNodes","mouseUpEvent","useMoveNode","multiSelect","defaultBehavior","reverse","altKey","onMouseUp","clientX","clientY","useClickAndDragElement","params","lastMousePos","onDragX","onDragY","constrainX","constrainY","onMouseMove","mouseMoveEvent","currentMousePos","diff","constrainPanelSize","newPanelSize","StyledConfirmationModal","StyledConfirmationText","StyledConfirmationButtons","StyledConfirmationButton","ConfirmationModal","modalState","TheoryModal","href","tex","String","raw","TutorialModal","StyledModal","Modal","modalRef","modalContent","getModalContent","prevState","StyledModalControls","StyledModalControlButton","ModalControls","Logo","logo","StyledHeader","App","defaultValue","React","localState","window","sessionStorage","getItem","setItem","useSessionStorageState","appErrors","setAppErrors","setTemporaryAppErrors","newConnections","newCanvasState","newSavedCanvasState","newTiming","useAppStateModifiers","setAppNodes","setAppConnections","addNode","nodesToUpdate","prevConn","newfirstNodeNode","nodeToUpdate","newsecondNodeNode","nodeIds","connsToUpdate","sortedConnsToUpdate","connIdsToUpdate","oldConns","connIds","useNodeConnectionUtils","keyboardActive","setClipboard","metaKey","keyCode","activeNodeIdToNewNode","newFirstNode","newSecondNode","useKeyDown","doubleClickedNode","newAppNode","useDoubleClick","size","setSize","ratio","setRatio","updateSize","innerWidth","innerHeight","updateRatio","useWindowSize","windowWidth","windowHeight","newX","minPx","maxPx","newY","deltaYPx","prevAppState","deltaXPx","useResizablePanels","canvasPlotBorderRef","onMouseDownOnCanvasPlotBorder","leftRightBorderRef","onMouseDownOnLeftRightBorder","tableControlsBorderRef","onMouseDownOnTableControlsBorder","workspaceWidth","workspaceHeight","headerHeight","plotHeight","plotWidth","editorWidth","plot","addNodeInCenterOfCanvas","topLeftPoint","getCanvasCenter","createNewLogicalConnection","getNewPossibleConnection","conns","run","message","scrollableElem","createElement","innerElem","overflow","borderWidth","appendChild","body","offsetWidth","clientWidth","removeChild","areScrollbarsVisible","classList","add","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.0367b78d.chunk.js","sourcesContent":["type MouseEventKey = \"shiftKey\" | \"altKey\" | \"metaKey\" | \"ctrlKey\";\n\nconst lightGrey = \"#dedede\";\n\nconst config = {\n  borderWidthPx: 2,\n  headerHeightPx: 50,\n  maxTimeSteps: 100000,\n  defaultTempDegC: 23,\n  defaultCapJPerDegK: 10,\n  defaultPowerGenW: 0,\n  defaultTotalTimeSeconds: 600,\n  defaultTimeStepSeconds: 0.1,\n  defaultNodeName: \"Unnamed\",\n  defaultNodeRadius: 20,\n  defaultResistanceDegKPerW: 10,\n  defaultSmallResistanceDegKPerW: 0.01,\n  defaultEditorWidthFraction: 0.45,\n  defaultCanvasHeightFraction: 1 / 1.61803398875,\n  defaultTableHeightFraction: 0.5,\n  minPanelFraction: 0.1,\n  newNodeNamePrefix: \"New Node\",\n  zoomSensitivity: 1500, // bigger = less zoom per click\n  minZoom: 0.5,\n  maxZoom: 2,\n  maxZoomDelta: 2,\n  minRadiusPx: 20,\n  maxRadiusPx: 40,\n  minLineThicknessPx: 2,\n  maxLineThicknessPx: 4,\n  activeNodeOutlineWidthPx: 5,\n  tabHeightPx: 25,\n  tableDeleteCellWidthPercent: 0.1,\n  tableDeleteCellMinWidthPx: 40,\n  plotHeightBufferPx: 10,\n  plotMargin: {\n    left: 10,\n    right: 20,\n    top: 20,\n    bottom: 20,\n  },\n  plotYDomainPaddingPx: 15,\n  plotTickFontSizePx: 15,\n  maxPlotPoints: 400,\n  multiSelectKeys: [\"shiftKey\", \"metaKey\", \"ctrlKey\"] as MouseEventKey[],\n  errorMessageDurationSeconds: 4,\n  maxNoteLengthChars: 500,\n  activeColor: \"rgba(112, 165, 255, 0.2)\",\n  pasteXOffset: 45,\n  lightGrey: lightGrey,\n  primaryColor: \"#000000\",\n  secondaryColor: \"#ffffff\",\n  tabColor: lightGrey,\n  inactiveTabColor: lightGrey,\n};\n\nexport default config;\n","import styled from \"styled-components/macro\";\nimport config from \"./config\";\nimport { css } from \"styled-components\";\n\nexport const StyledApp = styled.div<{ height: number; modalOpen: boolean }>`\n  display: flex;\n  height: ${(props) => props.height}px;\n  filter: ${(props) => (props.modalOpen ? \"blur(5px)\" : \"unset\")};\n  pointer-events: ${(props) => (props.modalOpen ? \"none\" : \"unset\")};\n  user-select: none;\n  -webkit-user-select: none; /* Chrome/Safari */\n  -moz-user-select: none; /* Firefox */\n  -ms-user-select: none; /* IE10+ */\n`;\n\nexport const StyledDraggableBorder = styled.div`\n  position: absolute;\n  z-index: 1;\n`;\n\nexport const StyledHorizontalBorder = styled(StyledDraggableBorder)<{\n  width: number;\n  y: number;\n  left: number;\n}>`\n  width: ${(props) => props.width * 100}%;\n  height: 10px;\n  top: ${(props) => props.y * 100}%;\n  transform: translate(0, -5px);\n  cursor: row-resize;\n  left: ${(props) => props.left * 100}%;\n`;\n\nexport const StyledVerticalBorder = styled(StyledDraggableBorder)<{\n  x: number;\n}>`\n  height: 100%;\n  width: 10px;\n  left: ${(props) => props.x * 100}%;\n  transform: translate(-5px, 0);\n  cursor: col-resize;\n`;\n\nexport const StyledWorkspace = styled.div<{ height: number; width: number }>`\n  height: ${(props) => props.height}px;\n  width: ${(props) => props.width}px;\n`;\n\nexport const StyledCanvas = styled.div<{ height: number }>`\n  width: 100%;\n  height: ${(props) => props.height}px;\n`;\n\nconst sharedButtonStyles = css<{ primary?: boolean }>`\n  background: ${(props) =>\n    !!props.primary ? config.primaryColor : config.secondaryColor};\n  color: ${(props) => (!!props.primary ? \"white\" : \"inherit\")};\n  border: 1px solid black;\n  padding: 0.5em 0.8em;\n  font: inherit;\n  cursor: pointer;\n  outline: inherit;\n  text-decoration: none;\n  text-align: center;\n\n  &:focus,\n  &:hover {\n    opacity: 0.7;\n    font-style: italic;\n  }\n\n  :focus:not(:focus-visible) {\n    opacity: 1;\n    font-style: unset;\n  }\n`;\n\nexport const StyledButton = styled.button`\n  ${sharedButtonStyles}\n`;\n\nexport const StyledAnchorAsButton = styled.a`\n  ${sharedButtonStyles}\n`;\n","import styled from \"styled-components/macro\";\nimport config from \"../../../config\";\nimport { StyledButton } from \"../../../style\";\n\nexport const StyledTableWrapper = styled.div`\n  width: 100%;\n`;\n\nexport const StyledTable = styled.div`\n  width: 100%;\n  border-collapse: collapse;\n`;\n\nexport const StyledTableBody = styled.div`\n  width: 100%;\n`;\n\nexport const StyledAddButtonWrapper = styled.div`\n  position: sticky;\n  top: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  margin-bottom: 1em;\n`;\n\nexport const StyledAddButton = styled(StyledButton)`\n  padding: 0.5em 1em;\n  margin-top: 5px;\n  font-size: 0.75em;\n`;\n\nexport const StyledRow = styled.div<{\n  heightOffsetPx?: number;\n  isActive: boolean;\n}>`\n  display: inline-flex;\n  align-items: center;\n  min-width: 100%;\n  top: ${({ heightOffsetPx }) =>\n    heightOffsetPx ? `${heightOffsetPx}px` : \"0px\"};\n  background: ${({ isActive }) => (isActive ? config.activeColor : \"none\")};\n`;\n\nexport const StyledCell = styled.div<{\n  width?: number;\n  minWidth?: number;\n}>`\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid #ddd;\n  height: 2em;\n  width: ${({ width }) => (!!width ? `${width * 100}%` : \"none\")};\n  min-width: ${({ minWidth }) => (!!minWidth ? `${minWidth}px` : \"none\")};\n`;\n\nexport const StyledDeleteCell = styled(StyledCell)`\n  cursor: pointer;\n  user-select: none;\n  min-width: 40px;\n\n  &:hover {\n    background: black;\n  }\n`;\n\nexport const StyledHeaderWrapper = styled.div<{ heightOffsetPx?: number }>`\n  display: flex;\n  width: 100%;\n  height: 100%;\n  position: sticky;\n  top: ${({ heightOffsetPx }) =>\n    heightOffsetPx ? `${heightOffsetPx}px` : \"0px\"};\n  z-index: 1;\n`;\n\nexport const StyledColHeader = styled.div<{\n  widthPercent?: number;\n  minWidthPx?: number;\n}>`\n  display: inline-flex;\n  width: ${({ widthPercent }) =>\n    !!widthPercent ? `${widthPercent * 100}%` : \"none\"};\n  min-width: ${({ minWidthPx }) => (!!minWidthPx ? `${minWidthPx}px` : \"none\")};\n  justify-content: center;\n  align-items: center;\n  font-weight: bold;\n  border: 1px solid lightgrey;\n  cursor: pointer;\n  user-select: none;\n  position: relative;\n  background: white;\n  border-bottom: 1px solid black;\n`;\n\nexport const StyledColText = styled.div`\n  font-size: 0.8em;\n  padding: 1em;\n`;\n\nexport const StyledSortIcon = styled.div`\n  position: absolute;\n  bottom: 2px;\n  right: 50%;\n  transform: translate(50%);\n  font-size: 10px;\n`;\n","import config from \"../../../config\";\nimport {\n  StyledColHeader,\n  StyledColText,\n  StyledHeaderWrapper,\n  StyledSortIcon,\n} from \"./style\";\nimport * as React from \"react\";\nimport { SortDirection, TableColumn, TableSortState } from \"./types\";\n\ntype TableHeaderProps<T> = {\n  columns: TableColumn<T>[];\n  sortState: TableSortState<T>;\n  setSortState: React.Dispatch<React.SetStateAction<TableSortState<T>>>;\n};\n\nfunction oppositeSortDirection(sortDirection: SortDirection): SortDirection {\n  return sortDirection === \"ASC\" ? \"DESC\" : \"ASC\";\n}\n\nexport default function TableHeader<T>(\n  props: TableHeaderProps<T>\n): React.ReactElement {\n  const { columns, sortState, setSortState } = props;\n\n  const sortIcon = !sortState\n    ? \"\"\n    : sortState.direction === \"ASC\"\n    ? \"\\u25B2\"\n    : \"\\u25BC\";\n\n  return (\n    <StyledHeaderWrapper heightOffsetPx={config.tabHeightPx}>\n      {columns.map((col) => {\n        const isSortedCol = sortState && sortState.key === col.key;\n        const onClick = () => {\n          setSortState({\n            key: col.key,\n            direction:\n              !isSortedCol || !sortState\n                ? \"ASC\"\n                : oppositeSortDirection(sortState.direction),\n          });\n        };\n\n        return (\n          <StyledColHeader\n            key={col.key.toString()}\n            onClick={onClick}\n            widthPercent={col.widthPercent}\n            minWidthPx={col.minWidthPx}\n          >\n            <StyledColText>{col.text}</StyledColText>\n            <StyledSortIcon>{isSortedCol ? sortIcon : \"\"}</StyledSortIcon>\n          </StyledColHeader>\n        );\n      })}\n      <StyledColHeader\n        widthPercent={config.tableDeleteCellWidthPercent}\n        minWidthPx={config.tableDeleteCellMinWidthPx}\n        style={{ cursor: \"unset\" }}\n      />\n    </StyledHeaderWrapper>\n  );\n}\n","import * as React from \"react\";\nimport { useEffect } from \"react\";\n\nexport default function useOnClickOutside(\n  ref: React.RefObject<HTMLDivElement>,\n  onClickOutside: () => void\n): void {\n  useEffect(() => {\n    const listener = (\n      event: React.MouseEvent | MouseEvent | React.TouchEvent | TouchEvent\n    ) => {\n      // Do nothing if clicking ref's element or descendent elements\n      if (!ref.current || ref.current.contains(event.target as Node | null)) {\n        return;\n      }\n      onClickOutside();\n    };\n    document.addEventListener(\"mousedown\", listener);\n    document.addEventListener(\"touchstart\", listener);\n    return () => {\n      document.removeEventListener(\"mousedown\", listener);\n      document.removeEventListener(\"touchstart\", listener);\n    };\n  }, [ref, onClickOutside]);\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { CellOption } from \"./EditableTable/types\";\nimport { useCallback, useRef, useState } from \"react\";\nimport useOnClickOutside from \"../../hooks/useOnClickOutside\";\nimport config from \"../../config\";\n\nconst StyledDropDown = styled.div<{ isOpen: boolean }>`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  justify-content: center;\n  position: relative;\n\n  &:visited {\n    outline: none;\n  }\n`;\n\nconst StyledCurrentValue = styled.div<{ hasOptions: boolean }>`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  align-items: center;\n  justify-content: space-between;\n  cursor: ${({ hasOptions }) => (hasOptions ? \"pointer\" : \"unset\")};\n`;\n\nconst StyledOptions = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  position: absolute;\n  top: 100%;\n  left: -2px;\n  right: -2px;\n  border: 1px solid black;\n  background: white;\n  z-index: 10;\n`;\n\nconst StyledOption = styled.div`\n  display: flex;\n  width: 100%;\n  padding: 5px 0;\n\n  &:hover {\n    background: ${config.activeColor};\n    cursor: pointer;\n  }\n`;\n\nconst StyledOptionText = styled.div`\n  display: flex;\n  align-items: center;\n  height: 100%;\n  max-width: 100px;\n  margin: 0 5px;\n  overflow: hidden;\n  white-space: nowrap;\n  font-size: 0.8em;\n`;\n\nconst StyledDropDownIcon = styled.div`\n  padding: 2px;\n  font-size: 10px;\n`;\n\ntype DropDownProps = {\n  value: CellOption;\n  options: CellOption[];\n  onChange: (newOption: CellOption) => void;\n};\n\nexport default function DropDown(props: DropDownProps): React.ReactElement {\n  const [isOpen, setIsOpen] = useState(false);\n  const wrapperRef = useRef<HTMLDivElement | null>(null);\n  useOnClickOutside(wrapperRef, () => setIsOpen(false));\n\n  const hasOptions = !!props.options.length;\n  const toggleOpen = useCallback(\n    (isOpen: boolean): void => {\n      if (hasOptions) {\n        setIsOpen(!isOpen);\n      }\n    },\n    [hasOptions]\n  );\n\n  return (\n    <StyledDropDown\n      isOpen={isOpen}\n      ref={wrapperRef}\n      tabIndex={0}\n      onKeyUp={(event: React.KeyboardEvent) =>\n        event.key === \"Enter\" && toggleOpen(isOpen)\n      }\n      onClick={() => toggleOpen(isOpen)}\n    >\n      <StyledCurrentValue hasOptions={hasOptions}>\n        <StyledOptionText>{props.value.text}</StyledOptionText>\n        {hasOptions && <StyledDropDownIcon>{\"▼\"}</StyledDropDownIcon>}\n      </StyledCurrentValue>\n\n      {isOpen && (\n        <StyledOptions>\n          {props.options.map((option) => (\n            <StyledOption\n              key={option.id}\n              onClick={() => props.onChange(option)}\n              tabIndex={0}\n              onKeyUp={(event) => {\n                if (event.key === \"Enter\") {\n                  props.onChange(option);\n                  toggleOpen(isOpen);\n                }\n              }}\n            >\n              <StyledOptionText>{option.text}</StyledOptionText>\n            </StyledOption>\n          ))}\n        </StyledOptions>\n      )}\n    </StyledDropDown>\n  );\n}\n","import * as React from \"react\";\nimport { CellOption } from \"../types\";\nimport DropDown from \"../../DropDown\";\n\nexport type DropDownTableCellProps = {\n  rowId: string;\n  options: CellOption[];\n  setOption?: CellOption;\n  onSelectOption: (id: string, option: CellOption) => void;\n  optionsFilter?: (option: CellOption) => CellOption[];\n};\n\nexport default function DropDownTableCell(\n  props: DropDownTableCellProps\n): React.ReactElement {\n  function handleChange(newVal: CellOption) {\n    const selectedOption = props.options.find(\n      (option) => option.id === newVal.id\n    );\n\n    if (selectedOption !== undefined) {\n      props.onSelectOption(props.rowId, selectedOption);\n    }\n  }\n\n  const setOption = props.setOption;\n  if (!setOption) {\n    return <></>;\n  }\n\n  return (\n    <DropDown\n      value={setOption}\n      options={props.options.filter((option) => option.id !== setOption.id)}\n      onChange={handleChange}\n    />\n  );\n}\n","import styled from \"styled-components/macro\";\nimport config from \"../../config\";\n\nexport const StyledInput = styled.input`\n  display: inline-block;\n  border: none;\n  width: 100%;\n  height: 100%;\n  text-align: center;\n  padding: 0;\n  background: unset;\n\n  &::-webkit-inner-spin-button,\n  &::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n`;\n\nexport const StyledEditor = styled.div<{ width: number; height: number }>`\n  height: ${(props) => props.height}px;\n  width: ${(props) => props.width}px;\n  border-left: ${config.borderWidthPx}px solid black;\n`;\n\nexport const StyledTables = styled.div<{ heightFrac: number }>`\n  display: inline-flex;\n  width: 100%;\n  height: ${(props) => props.heightFrac * 100}%;\n  position: relative;\n`;\n\nexport const StyledModelControlsWrapper = styled.div<{ heightFrac: number }>`\n  display: inline-flex;\n  width: 100%;\n  height: ${(props) => props.heightFrac * 100}%;\n  position: relative;\n`;\n","import React, { useCallback, useRef, useState } from \"react\";\nimport { StyledInput } from \"./style\";\n\ninterface CanBeMadeString {\n  toString: () => string;\n}\n\ntype EditableInputProps<T> = {\n  initialValue: T;\n  onBlur: (value: T) => void;\n  getNewValue: (event: React.ChangeEvent<HTMLInputElement>) => T | undefined;\n  afterValue?: string;\n  validator: (value: string) => T;\n};\n\nexport default function EditableInput<T extends CanBeMadeString>(\n  props: EditableInputProps<T>\n): React.ReactElement {\n  const { initialValue, onBlur, getNewValue, afterValue, validator } = props;\n\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const withAfterValue = useCallback(\n    (val: string) => val + (afterValue || \"\"),\n    [afterValue]\n  );\n\n  const [value, setValue] = useState<string>(\n    withAfterValue(initialValue.toString())\n  );\n\n  function handleOnChange(event: React.ChangeEvent<HTMLInputElement>) {\n    const newVal = event.target.value;\n    if (newVal !== undefined) {\n      setValue(newVal);\n    }\n  }\n\n  const handleOnBlur = useCallback(\n    (event: React.ChangeEvent<HTMLInputElement>) => {\n      const newVal = getNewValue(event);\n      if (event.target.value === initialValue.toString()) {\n        setValue((prevVal) => withAfterValue(prevVal));\n        return;\n      } else if (newVal !== undefined) {\n        const validated = validator(newVal.toString());\n        setValue(withAfterValue(validated.toString()));\n        onBlur(validated);\n      } else {\n        const validated = validator(initialValue.toString());\n        setValue(withAfterValue(validated.toString()));\n        onBlur(validated);\n      }\n    },\n    [getNewValue, initialValue, onBlur, validator, withAfterValue]\n  );\n\n  return (\n    <StyledInput\n      ref={inputRef}\n      type=\"text\"\n      value={value}\n      onChange={handleOnChange}\n      onFocus={() =>\n        setValue((prevVal) => prevVal.replace(afterValue || \"\", \"\"))\n      }\n      onBlur={handleOnBlur}\n      onKeyDown={(event: React.KeyboardEvent) => {\n        if ([\"Escape\", \"Enter\"].includes(event.key)) {\n          inputRef.current && inputRef.current.blur();\n        }\n      }}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableInput from \"./EditableInput\";\n\ntype EditableStringInputProps = {\n  initialValue: string;\n  onBlur: (value: string) => void;\n  validator?: (val: string) => string;\n};\n\nexport default function EditableStringInput(\n  props: EditableStringInputProps\n): React.ReactElement {\n  const validator = (val: string) =>\n    props.validator ? props.validator(val) : val;\n\n  return (\n    <EditableInput<string>\n      key={props.initialValue}\n      initialValue={props.initialValue}\n      onBlur={props.onBlur}\n      getNewValue={(event: React.ChangeEvent<HTMLInputElement>) =>\n        event.target.value\n      }\n      validator={validator}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableStringInput from \"../../EditableStringInput\";\n\nexport type TextTableCellProps = {\n  initialVal: string;\n  onBlur: (newValue: string) => void;\n  validator?: (val: string) => string;\n};\n\nexport default function TextTableCell(\n  props: TextTableCellProps\n): React.ReactElement {\n  return (\n    <EditableStringInput\n      initialValue={props.initialVal}\n      onBlur={props.onBlur}\n      validator={props.validator}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableInput from \"./EditableInput\";\n\nfunction getFloatVal(\n  event: React.ChangeEvent<HTMLInputElement>\n): number | undefined {\n  const newValueText = event.target.value;\n  // things like 123.3abc will still parse as 123.3\n  const newValueFloat = parseFloat(event.target.value);\n  if (newValueText === undefined || isNaN(newValueFloat)) {\n    return undefined;\n  }\n  return newValueFloat;\n}\n\ntype EditableNumberInputProps = {\n  initialValue: number;\n  onBlur: (value: number) => void;\n  afterValue?: string;\n  validator?: (val: string) => string;\n};\n\nexport default function EditableNumberInput(\n  props: EditableNumberInputProps\n): React.ReactElement {\n  const validator = (val: string) =>\n    props.validator\n      ? parseFloat(props.validator(val.toString()))\n      : parseFloat(val);\n\n  return (\n    <EditableInput<number>\n      key={props.initialValue + (props.afterValue || \"\")}\n      initialValue={props.initialValue}\n      onBlur={props.onBlur}\n      getNewValue={getFloatVal}\n      afterValue={props.afterValue}\n      validator={validator}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableNumberInput from \"../../EditableNumberInput\";\n\nexport type NumericalTableCellProps = {\n  initialVal: number;\n  onBlur: (newValue: number) => void;\n  afterValue?: string;\n  validator?: (val: string) => string;\n};\n\nexport default function NumericalTableCell(\n  props: NumericalTableCellProps\n): React.ReactElement {\n  return (\n    <EditableNumberInput\n      initialValue={props.initialVal}\n      onBlur={props.onBlur}\n      afterValue={props.afterValue}\n      validator={props.validator}\n    />\n  );\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst StyledCheckbox = styled.div`\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  user-select: none;\n`;\n\nexport type BooleanTableCellProps = {\n  initialIsActive?: boolean;\n  onClick: (isActive: boolean) => void;\n  showWhenActive: string;\n};\n\nexport default function BooleanTableCell(\n  props: BooleanTableCellProps\n): React.ReactElement {\n  const [isActive, setIsActive] = useState<boolean>(\n    props.initialIsActive !== undefined ? props.initialIsActive : false\n  );\n\n  return (\n    <StyledCheckbox\n      tabIndex={0}\n      onKeyUp={(event: React.KeyboardEvent) => {\n        if (event.key === \"Enter\") {\n          setIsActive(!isActive);\n          props.onClick(!isActive);\n        }\n      }}\n      onClick={() => {\n        setIsActive(!isActive);\n        props.onClick(!isActive);\n      }}\n    >\n      &nbsp;{isActive ? props.showWhenActive : \"\"}\n    </StyledCheckbox>\n  );\n}\n","import * as React from \"react\";\nimport DropDownTableCell from \"./cells/DropDownTableCell\";\nimport TextTableCell from \"./cells/TextTableCell\";\nimport NumericalTableCell from \"./cells/NumericalTableCell\";\nimport BooleanTableCell from \"./cells/BooleanTableCell\";\nimport { CellOption, TableColumn } from \"./types\";\n\ntype TableCellType = {\n  id: string;\n};\n\ntype TableCellProps<T extends TableCellType> = {\n  row: T;\n  col: TableColumn<T>;\n  onUpdateRow: (row: T) => void;\n  options?: CellOption[];\n  initiallySetOption?: CellOption;\n  afterValue?: string;\n};\n\nexport default function TableCell<T extends TableCellType>(\n  props: TableCellProps<T>\n): React.ReactElement {\n  const { row, col, onUpdateRow, options, initiallySetOption, afterValue } =\n    props;\n  const initialVal = row[col.key];\n\n  if (!!options && options.length > 0 && col.onSelectOption) {\n    return (\n      <DropDownTableCell\n        key={row.id}\n        rowId={row.id}\n        options={options}\n        setOption={initiallySetOption}\n        onSelectOption={col.onSelectOption}\n      />\n    );\n  } else if (typeof initialVal === \"string\") {\n    return (\n      <TextTableCell\n        initialVal={initialVal}\n        onBlur={(newVal) => onUpdateRow({ ...row, [col.key]: newVal })}\n        validator={(val) => (col.validator ? col.validator(row.id, val) : val)}\n      />\n    );\n  } else if (\n    typeof initialVal === \"number\" &&\n    typeof row[col.key] === \"number\"\n  ) {\n    return (\n      <NumericalTableCell\n        key={initialVal}\n        initialVal={initialVal}\n        onBlur={(newVal) => onUpdateRow({ ...row, [col.key]: newVal })}\n        afterValue={afterValue}\n        validator={(val) => (col.validator ? col.validator(row.id, val) : val)}\n      />\n    );\n  } else if (typeof initialVal === \"boolean\") {\n    return (\n      <BooleanTableCell\n        key={initialVal.toString()}\n        initialIsActive={initialVal}\n        onClick={(newVal) => onUpdateRow({ ...row, [col.key]: newVal })}\n        showWhenActive={\"✅\"}\n      />\n    );\n  } else {\n    return <></>;\n  }\n}\n","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { TableSortState } from \"../types\";\n\nexport default function useSortableTable<T>(\n  defaultSortState: TableSortState<T>,\n  tieBreakerKey: keyof T,\n  ultraSuperDuperTieBreakerKey: keyof T\n): [\n  TableSortState<T>,\n  React.Dispatch<React.SetStateAction<TableSortState<T>>>,\n  (first: T, second: T) => number\n] {\n  const [sortState, setSortState] =\n    useState<TableSortState<T>>(defaultSortState);\n\n  function sortByState(first: T, second: T): number {\n    if (sortState.direction === \"ASC\") {\n      if (first[sortState.key] > second[sortState.key]) {\n        return 1;\n      } else if (first[sortState.key] === second[sortState.key]) {\n        if (first[tieBreakerKey] > second[tieBreakerKey]) {\n          return 1;\n        } else if (first[tieBreakerKey] === second[tieBreakerKey]) {\n          return first[ultraSuperDuperTieBreakerKey] >\n            second[ultraSuperDuperTieBreakerKey]\n            ? 1\n            : -1;\n        } else {\n          return -1;\n        }\n      } else {\n        return -1;\n      }\n    } else {\n      if (first[sortState.key] > second[sortState.key]) {\n        return -1;\n      } else if (first[sortState.key] === second[sortState.key]) {\n        return first[tieBreakerKey] > second[tieBreakerKey] ? 1 : -1;\n      } else {\n        return 1;\n      }\n    }\n  }\n\n  return [sortState, setSortState, sortByState];\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst StyledImg = styled.img`\n  max-width: 90%;\n  max-height: 90%;\n`;\n\nexport default function Icon(props: { src: string }): React.ReactElement {\n  return <StyledImg src={props.src} />;\n}\n","import * as React from \"react\";\nimport Icon from \"./Icon\";\nimport crossmark from \"./cross-mark.png\";\n\nexport default function CrossMark(): React.ReactElement {\n  return <Icon src={crossmark} />;\n}\n","export default \"data:image/png;base64,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\"","import React from \"react\";\nimport config from \"../../../config\";\nimport { StyledDeleteCell } from \"./style\";\nimport CrossMark from \"../../../img/icons/CrossMark\";\n\ntype DeleteCellProps<T> = {\n  row: T;\n  onDeleteRow: (row: T) => void;\n};\n\nexport default function DeleteCell<T>(\n  props: DeleteCellProps<T>\n): React.ReactElement {\n  return (\n    <StyledDeleteCell\n      tabIndex={0}\n      onKeyUp={(event: React.KeyboardEvent) => {\n        if (event.key === \"Enter\") {\n          props.onDeleteRow(props.row);\n        }\n      }}\n      width={config.tableDeleteCellWidthPercent}\n      minWidth={config.tableDeleteCellMinWidthPx}\n      onClick={() => props.onDeleteRow(props.row)}\n    >\n      <CrossMark />\n    </StyledDeleteCell>\n  );\n}\n","import {\n  HSConnection,\n  HSConnectionKind,\n  HSNode,\n  makeConnection,\n  makeNode,\n} from \"hotstuff-network\";\nimport config from \"../config\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { Point } from \"./pointUtils\";\nimport {\n  AppConnectionTable,\n  ConnectionTableColumn,\n} from \"../components/Sidebar/EditableTable/ConnectionTable/ConnectionTable\";\nimport { CellOption } from \"../components/Sidebar/EditableTable/types\";\n\nconst ALL_CONNECTION_KINDS: HSConnectionKind[] = [\"cond\", \"conv\", \"rad\"];\nconst DO_NOT_PAIR_KINDS: HSConnectionKind[] = [\"cond\", \"conv\"]; // cannot have both of these at once\n\nexport function getExistingConnections(\n  firstNodeId: string,\n  secondNodeId: string,\n  connections: HSConnection[]\n): HSConnection[] {\n  return connections.filter(\n    (conn) =>\n      (conn.firstNode.id === firstNodeId &&\n        conn.secondNode.id === secondNodeId) ||\n      (conn.firstNode.id === secondNodeId && conn.secondNode.id === firstNodeId)\n  );\n}\n\nexport const makeNewConnection = (\n  firstNode: HSNode,\n  secondNode: HSNode,\n  kind: HSConnectionKind,\n  resistance?: number\n): AppConnection => {\n  const firstNodeFirst = firstNode.name <= secondNode.name;\n  return {\n    ...makeConnection({\n      firstNode: firstNodeFirst ? firstNode : secondNode,\n      secondNode: firstNodeFirst ? secondNode : firstNode,\n      resistanceDegKPerW: resistance || config.defaultResistanceDegKPerW,\n      kind,\n    }),\n    firstNodeId: firstNodeFirst ? firstNode.id : secondNode.id,\n    secondNodeId: firstNodeFirst ? secondNode.id : firstNode.id,\n    connectionNotes: \"\",\n  };\n};\n\nexport function getNewConnectionKindsPossible(\n  connectionKind: HSConnectionKind,\n  firstNodeId: string,\n  secondNodeId: string,\n  otherConnections: HSConnection[]\n): HSConnectionKind[] {\n  // if there's another connection between the nodes (either direction) with that same kind:\n  // - no option for the same kind of connection\n  // - no option for both conduction and convection at once as this doesn't make sense physically (solid vs. fluid)\n  const existingConnections = getExistingConnections(\n    firstNodeId,\n    secondNodeId,\n    otherConnections\n  );\n  const existingKinds = existingConnections.map((conn) => conn.kind);\n  if (\n    connectionKind === \"rad\" &&\n    DO_NOT_PAIR_KINDS.some((k) => existingKinds.includes(k))\n  ) {\n    return [];\n  } else\n    return ALL_CONNECTION_KINDS.filter((kind) => !existingKinds.includes(kind));\n}\n\nexport function getNewConnection(\n  firstNode: AppNode,\n  secondNode: AppNode,\n  connections: AppConnection[]\n): AppConnection | undefined {\n  const existingConnections = getExistingConnections(\n    firstNode.id,\n    secondNode.id,\n    connections\n  );\n  // if no current connections, make a conductive connection\n  if (existingConnections.length === 0) {\n    return makeNewConnection(firstNode, secondNode, \"cond\");\n  }\n\n  const existingKinds = existingConnections.map((conn) => conn.kind);\n  const remainingKinds = ALL_CONNECTION_KINDS.filter(\n    (kind) => !existingKinds.includes(kind)\n  );\n\n  if (DO_NOT_PAIR_KINDS.every((k) => !existingKinds.includes(k))) {\n    return makeNewConnection(firstNode, secondNode, \"cond\");\n  } else if (\n    DO_NOT_PAIR_KINDS.some((k) => remainingKinds.includes(k)) &&\n    !existingKinds.includes(\"rad\")\n  ) {\n    return makeNewConnection(firstNode, secondNode, \"rad\");\n  }\n}\n\nexport function getNewPossibleConnection(\n  appNodes: AppNode[],\n  appConnections: AppConnection[]\n): AppConnection | undefined {\n  for (const firstNode of appNodes) {\n    for (const secondNode of appNodes) {\n      if (firstNode.id !== secondNode.id) {\n        const newConnection = getNewConnection(\n          firstNode,\n          secondNode,\n          appConnections\n        );\n        if (!!newConnection) {\n          return newConnection;\n        }\n      }\n    }\n  }\n  return undefined;\n}\n\nexport function newNodeName(allNodeNames: string[], name: string): string {\n  function makeName(i: number): string {\n    if (i === 1) {\n      return name;\n    }\n    return `${name} [${i}]`;\n  }\n\n  let i = 1;\n  while (allNodeNames.includes(makeName(i))) {\n    i += 1;\n  }\n  return makeName(i);\n}\n\nexport function getNewAppNode(appNodes: AppNode[], center: Point): AppNode {\n  const allNodeNames = appNodes.map((node) => node.name);\n\n  const newNode = makeNode({\n    name: newNodeName(allNodeNames, config.newNodeNamePrefix),\n    temperatureDegC: config.defaultTempDegC,\n    capacitanceJPerDegK: config.defaultCapJPerDegK,\n    powerGenW: config.defaultPowerGenW,\n    isBoundary: false,\n  });\n\n  return {\n    ...newNode,\n    center: center,\n    isActive: false,\n    textDirection: \"D\",\n    nodeNotes: \"\",\n  };\n}\n\nexport function validateNodeName(name: string, otherNames: string[]): string {\n  const trimName = name.trim();\n  const safeName = trimName === \"\" ? config.defaultNodeName.trim() : trimName;\n  const safeAllNames = otherNames.map((n) => n.trim());\n  return newNodeName(safeAllNames, safeName);\n}\n\nexport function getConnectionAfterValue(\n  col: ConnectionTableColumn,\n  row: AppConnectionTable\n): string | undefined {\n  return col.key !== \"resistanceDegKPerW\"\n    ? undefined\n    : row.kind === \"rad\"\n    ? \" [K\\u2074/W]\"\n    : \" [K/W]\";\n}\n\nfunction filterFirstAndSecondNodeOptions(\n  filterKey: \"firstNodeId\" | \"secondNodeId\",\n  options: CellOption[],\n  selectedConnection: AppConnection,\n  allOtherConnections: AppConnection[]\n) {\n  const filteringFirstNode = filterKey === \"firstNodeId\";\n\n  // the selected connection should not consider its currently selected value or the ability to connect to itself\n  const noSelfConnectionOptions = options.filter(\n    (option) =>\n      option.id !==\n        (filteringFirstNode\n          ? selectedConnection.firstNode.id\n          : selectedConnection.secondNode.id) &&\n      option.id !==\n        (filteringFirstNode\n          ? selectedConnection.secondNode.id\n          : selectedConnection.firstNode.id)\n  );\n\n  // exclude the options that would create duplicate or illegal connections\n  return noSelfConnectionOptions.filter((option) => {\n    return !allOtherConnections.some((otherConnection) => {\n      const isIllegalConnectionKindCombo =\n        (DO_NOT_PAIR_KINDS.includes(selectedConnection.kind) &&\n          DO_NOT_PAIR_KINDS.includes(otherConnection.kind)) ||\n        selectedConnection.kind === otherConnection.kind;\n\n      if (filteringFirstNode) {\n        return (\n          (isIllegalConnectionKindCombo &&\n            option.id === otherConnection.firstNode.id &&\n            selectedConnection.secondNode.id ===\n              otherConnection.secondNode.id) ||\n          (isIllegalConnectionKindCombo &&\n            option.id === otherConnection.secondNode.id &&\n            selectedConnection.secondNode.id === otherConnection.firstNode.id)\n        );\n      } else {\n        return (\n          (isIllegalConnectionKindCombo &&\n            option.id === otherConnection.secondNode.id &&\n            selectedConnection.firstNode.id === otherConnection.firstNode.id) ||\n          (isIllegalConnectionKindCombo &&\n            option.id === otherConnection.firstNode.id &&\n            selectedConnection.firstNode.id === otherConnection.secondNode.id)\n        );\n      }\n    });\n  });\n}\n\nexport function filterConnectionOptions(\n  colKey: string,\n  options: CellOption[],\n  selectedConnection: AppConnection,\n  connections: AppConnection[]\n): CellOption[] {\n  const otherConnections = connections.filter(\n    (conn) => conn.id !== selectedConnection.id\n  );\n\n  if ([\"firstNodeId\", \"secondNodeId\"].includes(colKey)) {\n    return filterFirstAndSecondNodeOptions(\n      colKey as \"firstNodeId\" | \"secondNodeId\",\n      options,\n      selectedConnection,\n      otherConnections\n    );\n  } else if (colKey === \"kind\") {\n    if (!!selectedConnection) {\n      const possibleKinds = getNewConnectionKindsPossible(\n        selectedConnection.kind,\n        selectedConnection.firstNode.id,\n        selectedConnection.secondNode.id,\n        connections\n      );\n      return options.filter((opt) =>\n        possibleKinds.includes(opt.id as HSConnectionKind)\n      );\n    } else {\n      return options;\n    }\n  } else {\n    return options;\n  }\n}\n\nexport function getConnectionKey(connection: HSConnection): string {\n  return connection.firstNode.id > connection.secondNode.id\n    ? `${connection.firstNode.id}-${connection.secondNode.id}`\n    : `${connection.secondNode.id}-${connection.firstNode.id}`;\n}\n\nexport function getConnectionsToCounts(\n  connections: HSConnection[]\n): Map<string, number> {\n  const connectionToCount = new Map();\n  connections.forEach((conn) => {\n    incrementConnectionCount(connectionToCount, conn);\n  });\n  return connectionToCount;\n}\n\nexport function incrementConnectionCount(\n  connectionsToCounts: Map<string, number>,\n  connection: HSConnection\n): void {\n  const key = getConnectionKey(connection);\n  connectionsToCounts.set(key, (connectionsToCounts.get(key) ?? 0) + 1);\n}\n\nexport function decrementConnectionCount(\n  connectionsToCounts: Map<string, number>,\n  connection: HSConnection\n): void {\n  const key = getConnectionKey(connection);\n  const currentCount = connectionsToCounts.get(key) ?? 0;\n  if (currentCount > 1) {\n    connectionsToCounts.set(key, currentCount - 1);\n  }\n}\n","import config from \"../../../config\";\n\nexport default function noteValidator(\n  rowId: string,\n  value: string,\n  setTemporaryErrors: (error: string[]) => void\n): string {\n  if (value.length > config.maxNoteLengthChars) {\n    navigator.clipboard.writeText(value);\n    setTemporaryErrors([\n      `Note too long. Copied note to clipboard and truncated to first ${config.maxNoteLengthChars} characters in table`,\n    ]);\n    return value.slice(0, config.maxNoteLengthChars);\n  }\n  return value;\n}\n","import React, { useMemo } from \"react\";\nimport config from \"../../../../config\";\nimport { AppNode } from \"../../../../App\";\nimport {\n  StyledCell,\n  StyledRow,\n  StyledTable,\n  StyledTableBody,\n  StyledTableWrapper,\n} from \"../style\";\nimport { TableColumn, TableSortState } from \"../types\";\nimport TableHeader from \"../TableHeader\";\nimport TableCell from \"../TableCell\";\nimport useSortableTable from \"../hooks/useSortableTable\";\nimport DeleteCell from \"../DeleteCell\";\nimport { validateNodeName } from \"../../../../utils/nodeConnectionUtils\";\nimport { KELVIN } from \"hotstuff-network\";\nimport noteValidator from \"../tableUtils\";\n\ntype NodeTableColumn = TableColumn<AppNode>;\n\nconst defaultNodeSortState: TableSortState<AppNode> = {\n  key: \"name\",\n  direction: \"ASC\",\n};\n\ntype NodeTableProps = {\n  rows: AppNode[];\n  onUpdateRow: (row: AppNode) => void;\n  onDeleteRow: (row: AppNode) => void;\n  onClickEditableCell: (rowId: string) => void;\n  setTemporaryErrors: (error: string[]) => void;\n};\n\nexport default function NodeTable(props: NodeTableProps): React.ReactElement {\n  const {\n    rows,\n    onUpdateRow,\n    onDeleteRow,\n    onClickEditableCell,\n    setTemporaryErrors,\n  } = props;\n\n  const [sortState, setSortState, sortByState] = useSortableTable<AppNode>(\n    defaultNodeSortState,\n    \"temperatureDegC\",\n    \"capacitanceJPerDegK\"\n  );\n\n  const nodeColumns: NodeTableColumn[] = useMemo(\n    () => [\n      {\n        key: \"name\",\n        text: \"Name\",\n        minWidthPx: 150,\n        validator: (rowId: string, name: string) =>\n          validateNodeName(\n            name,\n            rows.filter((r) => r.id !== rowId).map((r) => r.name)\n          ),\n      },\n      {\n        key: \"temperatureDegC\",\n        text: \"Temp [C]\",\n        minWidthPx: 120,\n        validator: (rowId, tempVal) => {\n          if (parseFloat(tempVal) < -KELVIN) {\n            setTemporaryErrors([\n              \"Temperature colder than what is physically possible\",\n            ]);\n            return (-KELVIN).toString();\n          }\n          return tempVal;\n        },\n      },\n      {\n        key: \"capacitanceJPerDegK\",\n        text: \"Capacitance [J/K]\",\n        minWidthPx: 120,\n      },\n      {\n        key: \"powerGenW\",\n        text: \"Power Gen [W]\",\n        minWidthPx: 120,\n      },\n      {\n        key: \"isBoundary\",\n        text: \"Fixed Temp?\",\n        minWidthPx: 100,\n      },\n      {\n        key: \"nodeNotes\",\n        text: \"Notes\",\n        widthPercent: 1,\n        minWidthPx: 100,\n        validator: (rowId, value) =>\n          noteValidator(rowId, value, setTemporaryErrors),\n      },\n    ],\n    [rows, setTemporaryErrors]\n  );\n\n  const sortedRows = rows.sort(sortByState);\n\n  const tableRows = sortedRows.map((row) => {\n    return (\n      <StyledRow\n        key={row.id}\n        heightOffsetPx={config.tabHeightPx}\n        isActive={row.isActive}\n      >\n        {nodeColumns.map((col) => {\n          const tableCell = (\n            <TableCell<AppNode> row={row} col={col} onUpdateRow={onUpdateRow} />\n          );\n          return (\n            <StyledCell\n              key={col.key}\n              width={col.widthPercent}\n              minWidth={col.minWidthPx}\n              onFocus={() => onClickEditableCell(row.id)} // onFocus so as not to interfere with child onClicks\n            >\n              {tableCell}\n            </StyledCell>\n          );\n        })}\n        <DeleteCell row={row} onDeleteRow={() => onDeleteRow(row)} />\n      </StyledRow>\n    );\n  });\n\n  return (\n    <StyledTableWrapper>\n      <StyledTable>\n        <TableHeader<AppNode>\n          columns={nodeColumns}\n          sortState={sortState}\n          setSortState={setSortState}\n        />\n        <StyledTableBody>{tableRows}</StyledTableBody>\n      </StyledTable>\n    </StyledTableWrapper>\n  );\n}\n","import { HSConnectionKind } from \"hotstuff-network\";\nimport hotsprings from \"../img/hotsprings.png\";\nimport link from \"../img/link.png\";\nimport sunny from \"../img/sunny.png\";\n\nexport default function connectionKindToImgSrc(\n  connectionKind: HSConnectionKind\n): string {\n  switch (connectionKind) {\n    case \"conv\":\n      return hotsprings;\n    case \"cond\":\n      return link;\n    default:\n      return sunny;\n  }\n}\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","import * as React from \"react\";\nimport { CellOption } from \"../types\";\nimport connectionKindToImgSrc from \"../../../../utils/imageUtils\";\nimport { HSConnectionKind } from \"hotstuff-network\";\nimport styled from \"styled-components/macro\";\n\nconst StyledWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst StyledImg = styled.img`\n  width: 20px;\n  padding-right: 2px;\n`;\n\nexport default function ConnectionKindOption(props: {\n  option: CellOption;\n}): React.ReactElement {\n  return (\n    <StyledWrapper>\n      <StyledImg\n        src={connectionKindToImgSrc(props.option.id as HSConnectionKind)}\n      />\n      {props.option.text}\n    </StyledWrapper>\n  );\n}\n","import React, { useCallback, useMemo } from \"react\";\nimport config from \"../../../../config\";\nimport { AppConnection, AppNode } from \"../../../../App\";\nimport {\n  StyledCell,\n  StyledRow,\n  StyledTable,\n  StyledTableBody,\n  StyledTableWrapper,\n} from \"../style\";\nimport { CellOption, TableColumn, TableSortState } from \"../types\";\nimport TableHeader from \"../TableHeader\";\nimport TableCell from \"../TableCell\";\nimport useSortableTable from \"../hooks/useSortableTable\";\nimport DeleteCell from \"../DeleteCell\";\nimport { HSConnectionKind } from \"hotstuff-network\";\nimport {\n  filterConnectionOptions,\n  getConnectionAfterValue,\n} from \"../../../../utils/nodeConnectionUtils\";\nimport noteValidator from \"../tableUtils\";\nimport ConnectionKindOption from \"./ConnectionKindOption\";\n\nexport type AppConnectionTable = AppConnection & { isActive: boolean };\nexport type ConnectionTableColumn = TableColumn<AppConnectionTable>;\n\nconst defaultConnectionSortState: TableSortState<AppConnectionTable> = {\n  key: \"firstNodeId\",\n  direction: \"ASC\",\n};\n\nconst connectionKindOptions: CellOption[] = [\n  {\n    id: \"cond\",\n    text: \"Conduction\",\n  },\n  {\n    id: \"conv\",\n    text: \"Convection️️\",\n  },\n  {\n    id: \"rad\",\n    text: \"Radiation️\",\n  },\n];\n\ntype ConnectionTableProps = {\n  rows: AppConnection[];\n  nodes: AppNode[];\n  onUpdateRow: (row: AppConnection) => void;\n  onDeleteRow: (row: AppConnection) => void;\n  setTemporaryErrors: (error: string[]) => void;\n};\n\nexport default function ConnectionTable(\n  props: ConnectionTableProps\n): React.ReactElement {\n  const { rows, nodes, onUpdateRow, onDeleteRow, setTemporaryErrors } = props;\n\n  const [sortState, setSortState, sortByState] =\n    useSortableTable<AppConnectionTable>(\n      defaultConnectionSortState,\n      \"secondNodeId\",\n      \"kind\"\n    );\n\n  const onSelectNewFirstNode = useCallback(\n    (id: string, option: CellOption) => {\n      const connection = rows.find((conn) => conn.id === id);\n      const newFirstNodeNode = nodes.find((node) => node.id === option.id);\n      if (\n        !connection ||\n        !newFirstNodeNode ||\n        newFirstNodeNode.id === connection.secondNode.id\n      ) {\n        return;\n      }\n      onUpdateRow({\n        ...connection,\n        firstNode: newFirstNodeNode,\n        firstNodeId: newFirstNodeNode.id,\n      });\n    },\n    [nodes, onUpdateRow, rows]\n  );\n\n  const onSelectNewSecondNode = useCallback(\n    (id: string, option: CellOption) => {\n      const connection = rows.find((conn) => conn.id === id);\n      const newSecondNodeNode = nodes.find((node) => node.id === option.id);\n      if (\n        !connection ||\n        !newSecondNodeNode ||\n        newSecondNodeNode.id === connection.firstNode.id\n      ) {\n        return;\n      }\n      onUpdateRow({\n        ...connection,\n        secondNode: newSecondNodeNode,\n        secondNodeId: newSecondNodeNode.id,\n      });\n    },\n    [nodes, onUpdateRow, rows]\n  );\n\n  const onSelectNewConnectionType = useCallback(\n    (id: string, option: CellOption) => {\n      const rowToUpdate = rows.find((conn) => conn.id === id);\n      if (rowToUpdate) {\n        onUpdateRow({\n          ...rowToUpdate,\n          kind: option.id as HSConnectionKind,\n        });\n      }\n    },\n    [onUpdateRow, rows]\n  );\n\n  const nodeOptions: CellOption[] = nodes.map((node) => ({\n    id: node.id,\n    text: node.name,\n  }));\n\n  const connectionColumns: ConnectionTableColumn[] = useMemo(\n    () => [\n      {\n        key: \"firstNodeId\",\n        text: \"First Node\",\n        minWidthPx: 120,\n        options: nodeOptions,\n        onSelectOption: onSelectNewFirstNode,\n      },\n      {\n        key: \"secondNodeId\",\n        text: \"Second Node\",\n        minWidthPx: 120,\n        options: nodeOptions,\n        onSelectOption: onSelectNewSecondNode,\n      },\n      {\n        key: \"resistanceDegKPerW\",\n        text: \"Resistance\",\n        minWidthPx: 120,\n        validator: (rowId, resistance) => {\n          const resistanceNumber = parseFloat(resistance);\n          if (resistanceNumber <= 0) {\n            if (resistanceNumber === 0) {\n              setTemporaryErrors([\"Resistance cannot be zero\"]);\n            } else {\n              setTemporaryErrors([\"Resistance cannot be negative\"]);\n            }\n            return config.defaultSmallResistanceDegKPerW.toString();\n          }\n          return resistance;\n        },\n      },\n      {\n        key: \"kind\",\n        text: \"Kind\",\n        minWidthPx: 120,\n        options: connectionKindOptions.map((option) => ({\n          ...option,\n          text: ConnectionKindOption({ option }),\n        })),\n        onSelectOption: onSelectNewConnectionType,\n      },\n      {\n        key: \"connectionNotes\",\n        text: \"Notes\",\n        widthPercent: 1,\n        minWidthPx: 100,\n        validator: (rowId, value) =>\n          noteValidator(rowId, value, setTemporaryErrors),\n      },\n    ],\n    [\n      nodeOptions,\n      onSelectNewConnectionType,\n      onSelectNewFirstNode,\n      onSelectNewSecondNode,\n      setTemporaryErrors,\n    ]\n  );\n\n  const activeNodeIds = nodes\n    .filter((node) => node.isActive)\n    .map((node) => node.id);\n\n  const sortedRowsWithActiveInfo: AppConnectionTable[] = rows\n    .map((row) => {\n      return {\n        ...row,\n        isActive:\n          activeNodeIds.includes(row.firstNode.id) ||\n          activeNodeIds.includes(row.secondNode.id),\n      };\n    })\n    .sort(sortByState);\n\n  const tableRows = sortedRowsWithActiveInfo.map((row) => {\n    const cols = connectionColumns.map((col) => {\n      function makeStyledCell(\n        options: CellOption[],\n        setOption: CellOption | undefined\n      ) {\n        return (\n          <StyledCell\n            key={col.key}\n            width={col.widthPercent}\n            minWidth={col.minWidthPx}\n          >\n            <TableCell<AppConnectionTable>\n              row={row}\n              col={col}\n              options={options}\n              initiallySetOption={setOption}\n              onUpdateRow={onUpdateRow}\n              afterValue={getConnectionAfterValue(col, row)}\n            />\n          </StyledCell>\n        );\n      }\n\n      if (!!col.options) {\n        const setOption = col.options.find(\n          (option) => option.id === row[col.key]\n        );\n\n        const options = !setOption\n          ? []\n          : [\n              setOption,\n              ...filterConnectionOptions(\n                col.key,\n                col.options || [],\n                row,\n                rows\n              ).filter((opt) => opt.id !== setOption.id),\n            ];\n\n        return makeStyledCell(options, setOption);\n      } else {\n        return makeStyledCell([], undefined);\n      }\n    });\n\n    return (\n      <StyledRow\n        key={row.id}\n        heightOffsetPx={config.tabHeightPx}\n        isActive={row.isActive}\n      >\n        {cols}\n        <DeleteCell row={row} onDeleteRow={() => onDeleteRow(row)} />\n      </StyledRow>\n    );\n  });\n\n  return (\n    <StyledTableWrapper>\n      <StyledTable>\n        <TableHeader<AppConnectionTable>\n          columns={connectionColumns}\n          sortState={sortState}\n          setSortState={setSortState}\n        />\n        <StyledTableBody>{tableRows}</StyledTableBody>\n      </StyledTable>\n    </StyledTableWrapper>\n  );\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components/macro\";\nimport config from \"../../config\";\n\nconst StyledTabsWrapper = styled.div`\n  display: inline-flex;\n  width: 100%;\n  flex-direction: column;\n  overflow: auto;\n  position: relative;\n`;\n\nconst StyledTabs = styled.div`\n  display: inline-flex;\n  width: 100%;\n  height: ${config.tabHeightPx}px;\n  justify-content: space-evenly;\n  position: sticky;\n  top: 0;\n  left: 0;\n  background: white;\n  box-sizing: border-box;\n  z-index: 1;\n`;\n\nconst StyledTab = styled.button<{ width: number; active: boolean }>`\n  display: inline-flex;\n  font-size: 16px;\n  width: ${({ width }) => `${width * 100}%`};\n  cursor: pointer;\n  text-decoration: none;\n  align-items: center;\n  background: ${(props) =>\n    props.active ? config.tabColor : config.inactiveTabColor};\n  //background: rgb(85, 9, 121);\n  //background: linear-gradient(\n  //  90deg,\n  //  rgba(46, 228, 233, 1) 0%,\n  //  rgba(46, 228, 233, 1) 40%,\n  //  rgba(255, 0, 230, 1) 80%,\n  //  rgba(85, 9, 121, 1) 100%\n  //);\n  border-radius: 5px 5px 0 0;\n  border: 1px solid black;\n  border-bottom: 2px solid black;\n  white-space: nowrap;\n\n  &:hover,\n  &:focus {\n    opacity: 0.7;\n  }\n`;\n\nconst StyledTabText = styled.div<{ active: boolean }>`\n  font-size: 1.1em;\n  font-weight: ${(props) => (props.active ? \"bold\" : \"unset\")};\n  opacity: ${(props) => (props.active ? 1 : \"inherit\")};\n  text-decoration: ${(props) => (props.active ? \"underline\" : \"unset\")};\n  }\n`;\n\nconst StyledInnerContent = styled.div<{ topLeftRounded: boolean }>`\n  background: white;\n  position: relative;\n`;\n\ntype Tab = {\n  text: string;\n  component: React.ReactElement;\n  after?: React.ReactElement;\n  width: number; // between 0 and 1\n};\n\nexport type TabsProps = {\n  tabs: Tab[];\n};\n\nexport default function Tabs(props: TabsProps): React.ReactElement {\n  const [activeIdx, setActiveIdx] = useState(0);\n\n  return (\n    <StyledTabsWrapper>\n      {props.tabs.length > 1 && (\n        <StyledTabs>\n          {props.tabs.map((tab, idx) => {\n            const active = idx === activeIdx;\n            return (\n              <StyledTab\n                key={tab.text}\n                tabIndex={0}\n                onClick={() => setActiveIdx(idx)}\n                onKeyUp={(event: React.KeyboardEvent) => {\n                  if (event.key === \"Enter\") {\n                    setActiveIdx(idx);\n                  }\n                }}\n                width={tab.width}\n                active={active}\n              >\n                <StyledTabText active={active}>{tab.text}</StyledTabText>\n              </StyledTab>\n            );\n          })}\n        </StyledTabs>\n      )}\n\n      <StyledInnerContent topLeftRounded={props.tabs.length <= 1}>\n        {props.tabs.filter((_, idx) => idx === activeIdx)[0].component}\n      </StyledInnerContent>\n\n      {props.tabs.filter((_, idx) => idx === activeIdx)[0].after}\n    </StyledTabsWrapper>\n  );\n}\n","export type Point = {\n  x: number;\n  y: number;\n};\n\nexport const ORIGIN = Object.freeze({ x: 0, y: 0 });\n\nexport function makePoint(x: number, y: number): Point {\n  return { x, y };\n}\n\nexport function addPoints(p1: Point, p2: Point): Point {\n  return { x: p1.x + p2.x, y: p1.y + p2.y };\n}\n\nexport function diffPoints(p1: Point, p2: Point): Point {\n  return { x: p1.x - p2.x, y: p1.y - p2.y };\n}\n\nexport function scalePoint(p1: Point, scale: number): Point {\n  return { x: p1.x / scale, y: p1.y / scale };\n}\n\n// export function distanceBetweenPoints(p1: Point, p2: Point): number {\n//   return Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2));\n// }\n","import { makeNode } from \"hotstuff-network\";\nimport {\n  AppClipboard,\n  AppConnection,\n  AppNode,\n  AppState,\n  ModalState,\n  PanelSizes,\n  Timing,\n} from \"./App\";\nimport config from \"./config\";\nimport { ORIGIN } from \"./utils/pointUtils\";\nimport { CanvasViewState } from \"./components/Canvas/Canvas\";\nimport { makeNewConnection } from \"./utils/nodeConnectionUtils\";\n\nconst jerryNode = makeNode({\n  name: \"Jerry the Cat\",\n  temperatureDegC: 38.3,\n  capacitanceJPerDegK: 16.2e3, // 3.6kJ/kg/degK * 4.5kg\n  powerGenW: 100, // ??\n  isBoundary: false,\n});\nconst jerryAppNode: AppNode = {\n  ...jerryNode,\n  center: { x: 200, y: 150 },\n  isActive: false,\n  textDirection: \"L\",\n  nodeNotes: \"Jerry is the best cat.\",\n};\n\nconst bedNode = makeNode({\n  name: \"Heated Cat Bed\",\n  temperatureDegC: 40, // ??\n  capacitanceJPerDegK: 10e3,\n  powerGenW: 4,\n  isBoundary: false,\n});\nconst bedAppNode: AppNode = {\n  ...bedNode,\n  center: { x: 500, y: 150 },\n  isActive: false,\n  textDirection: \"R\",\n  nodeNotes: \"\",\n};\n\nconst airNode = makeNode({\n  name: \"Apartment Air\",\n  temperatureDegC: 22.5,\n  capacitanceJPerDegK: 6e5, // 1.0035J/g/degK * 600,000g\n  powerGenW: 0,\n  isBoundary: false,\n});\nconst airAppNode: AppNode = {\n  ...airNode,\n  center: { x: 350, y: 300 },\n  isActive: false,\n  textDirection: \"D\",\n  nodeNotes: \"\",\n};\n\nexport const defaultNodes: AppNode[] = [jerryAppNode, bedAppNode, airAppNode];\n\nexport const defaultConnections: AppConnection[] = [\n  makeNewConnection(jerryNode, bedNode, \"cond\", 2.5), // 0.01m / 0.1m^2 / 0.04W/m/degK\n  makeNewConnection(airNode, jerryNode, \"conv\", 0.33), // 1 / 0.3m^2 / 10W/m^2/degK\n  makeNewConnection(airNode, bedNode, \"conv\", 0.67), // 1 / 0.3m^2 / 5W/m^2/degK\n];\n\nexport const defaultTiming: Timing = {\n  timeStepS: config.defaultTimeStepSeconds,\n  totalTimeS: config.defaultTotalTimeSeconds,\n};\n\nexport const defaultCanvasViewState: CanvasViewState = {\n  offset: ORIGIN,\n  scale: 1,\n};\n\nexport const defaultPanelSizes: PanelSizes = {\n  editorWidthFraction: config.defaultEditorWidthFraction,\n  canvasHeightFraction: config.defaultCanvasHeightFraction,\n  tableHeightFraction: config.defaultTableHeightFraction,\n};\n\nexport const defaultModalState: ModalState = {\n  visible: false,\n  type: \"theory\",\n};\n\nexport const defaultAppState: AppState = {\n  timing: defaultTiming,\n  nodes: defaultNodes,\n  connections: defaultConnections,\n  canvasViewState: defaultCanvasViewState,\n  savedCanvasState: defaultCanvasViewState,\n  panelSizes: defaultPanelSizes,\n};\n\nexport const defaultAppClipboard: AppClipboard = {\n  copiedNodes: [],\n  copiedConnections: [],\n};\n","import * as React from \"react\";\nimport { AppState, ExportedAppState } from \"../../App\";\nimport { ModelOutput } from \"hotstuff-network\";\n\nexport function nicelyFormattedJsonString<T>(toFormat: T): string {\n  return JSON.stringify(toFormat, null, 2);\n}\n\nfunction isoFormattedCurrentTimeInLocalTime(): string {\n  return new Date(\n    new Date().setHours(\n      new Date().getHours() - new Date().getTimezoneOffset() / 60\n    )\n  ).toISOString();\n}\n\nfunction getUrlForObject<T>(inputObject: T): string {\n  const blob = new Blob([nicelyFormattedJsonString<T>(inputObject)], {\n    type: \"text/plain;charset=utf-8\",\n  });\n  return URL.createObjectURL(blob);\n}\n\nexport function downloadAppStateFromAnchor(\n  ref: React.RefObject<HTMLAnchorElement | null>,\n  appState: AppState\n): void {\n  if (ref.current) {\n    const url = getUrlForObject<AppState>(appState);\n    ref.current.setAttribute(\"href\", url);\n\n    ref.current.setAttribute(\n      \"download\",\n      `${isoFormattedCurrentTimeInLocalTime()}_thermal_model.json`\n    );\n  }\n}\n\nexport function downloadExportedAppStateFromAnchor(\n  ref: React.RefObject<HTMLAnchorElement | null>,\n  exportedAppState: ExportedAppState\n): void {\n  if (ref.current) {\n    const url = getUrlForObject<ExportedAppState>(exportedAppState);\n    ref.current.setAttribute(\"href\", url);\n\n    ref.current.setAttribute(\n      \"download\",\n      `${isoFormattedCurrentTimeInLocalTime()}_thermal_model_with_results.json`\n    );\n  }\n}\n\nexport function importFileFromUser(\n  event: React.ChangeEvent<HTMLInputElement>,\n  setAppState: React.Dispatch<React.SetStateAction<AppState>>,\n  setOutput: React.Dispatch<React.SetStateAction<ModelOutput | undefined>>\n): void {\n  const files = event.target.files;\n  if (!files || files.length === 0) {\n    return;\n  }\n  const file = files[0];\n  const reader = new FileReader();\n\n  reader.onload = () => {\n    const contents = reader.result;\n    if (!!contents && typeof contents === \"string\") {\n      const inputObject = JSON.parse(contents);\n      setAppState(inputObject);\n      setOutput(inputObject.output);\n    }\n  };\n\n  reader.readAsText(file);\n}\n","import * as React from \"react\";\nimport { useRef, useState } from \"react\";\nimport styled from \"styled-components/macro\";\nimport EditableNumberInput from \"./EditableNumberInput\";\nimport { AppState, ExportedAppState, ModalState, Timing } from \"../../App\";\nimport { defaultAppState } from \"../../default\";\nimport { ModelOutput } from \"hotstuff-network\";\nimport {\n  downloadAppStateFromAnchor,\n  downloadExportedAppStateFromAnchor,\n  importFileFromUser,\n  nicelyFormattedJsonString,\n} from \"./ioUtils\";\nimport config from \"../../config\";\nimport { StyledAnchorAsButton, StyledButton } from \"../../style\";\n\nconst StyledModelControlsWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  justify-content: center;\n  align-items: center;\n  border-top: ${config.borderWidthPx}px solid black;\n  flex-wrap: wrap;\n`;\n\nconst StyledModelControlButton = styled(StyledButton)`\n  margin-top: 5px;\n  margin-bottom: 5px;\n`;\n\nconst StyledAnchor = styled(StyledAnchorAsButton)``;\n\nconst StyledImport = styled.div`\n  padding: 0.2em;\n  border: 1px solid black;\n`;\n\nconst StyledInput = styled.input`\n  margin-right: 0.5em;\n`;\n\nconst StyledTopControls = styled.div`\n  display: flex;\n  > * {\n    margin: 1em;\n  }\n`;\n\nconst StyledTimeControls = styled.div``;\n\nconst StyledTimeControl = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  width: 100%;\n  align-items: center;\n  justify-content: space-between;\n  margin: 0.5em;\n`;\n\nconst StyledInputWrapper = styled.div`\n  border: 1px solid black;\n  border-radius: 2px;\n  max-width: 3em;\n  height: 1.5em;\n`;\n\nconst StyledLabel = styled.label`\n  margin-right: 0.2em;\n`;\n\nexport type ModelControlsProps = {\n  appState: AppState;\n  setAppState: React.Dispatch<React.SetStateAction<AppState>>;\n  setOutput: React.Dispatch<React.SetStateAction<ModelOutput | undefined>>;\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n  onRunModel: () => ModelOutput | undefined;\n  setTiming: (newTiming: Timing) => void;\n};\n\nexport default function ModelControls(\n  props: ModelControlsProps\n): React.ReactElement {\n  const {\n    appState,\n    setAppState,\n    setOutput,\n    setModalState,\n    onRunModel,\n    setTiming,\n  } = props;\n\n  const [stagedAppState, setStagedAppState] = useState<string>(\"\");\n  const downloadModelRef = useRef<HTMLAnchorElement>(null);\n  const runAndDownloadModelRef = useRef<HTMLAnchorElement>(null);\n\n  return (\n    <StyledModelControlsWrapper>\n      <StyledTimeControls>\n        <StyledTimeControl>\n          <StyledLabel>Run Time [s]:</StyledLabel>\n          <StyledInputWrapper>\n            <EditableNumberInput\n              initialValue={appState.timing.totalTimeS}\n              onBlur={(newTotalTimeS: number) =>\n                setTiming({ ...appState.timing, totalTimeS: newTotalTimeS })\n              }\n            />\n          </StyledInputWrapper>\n        </StyledTimeControl>\n        <StyledTimeControl>\n          <StyledLabel>Time Step [s]:</StyledLabel>\n          <StyledInputWrapper>\n            <EditableNumberInput\n              initialValue={appState.timing.timeStepS}\n              onBlur={(newTimeStepS: number) =>\n                setTiming({\n                  ...appState.timing,\n                  timeStepS: newTimeStepS,\n                })\n              }\n            />\n          </StyledInputWrapper>\n        </StyledTimeControl>\n      </StyledTimeControls>\n      <StyledTopControls>\n        <StyledModelControlButton primary onClick={onRunModel}>\n          Run Model\n        </StyledModelControlButton>\n        <StyledModelControlButton\n          onClick={() =>\n            navigator.clipboard.writeText(\n              nicelyFormattedJsonString<AppState>(appState)\n            )\n          }\n        >\n          Copy Model\n        </StyledModelControlButton>\n        <StyledModelControlButton\n          onClick={() => {\n            const newOutput = onRunModel();\n            navigator.clipboard.writeText(\n              nicelyFormattedJsonString<ExportedAppState>({\n                ...appState,\n                output: newOutput,\n              })\n            );\n          }}\n        >\n          Run & Copy Results\n        </StyledModelControlButton>\n        <StyledAnchor\n          ref={downloadModelRef}\n          onClick={() => downloadAppStateFromAnchor(downloadModelRef, appState)}\n        >\n          Download Model\n        </StyledAnchor>\n        <StyledAnchor\n          ref={runAndDownloadModelRef}\n          onClick={() => {\n            const newOutput = onRunModel();\n            downloadExportedAppStateFromAnchor(runAndDownloadModelRef, {\n              ...appState,\n              output: newOutput,\n            });\n          }}\n        >\n          Run & Download Results\n        </StyledAnchor>\n      </StyledTopControls>\n      <StyledImport>\n        <StyledLabel>Model:</StyledLabel>\n        <StyledInput\n          value={stagedAppState}\n          onChange={(event) => setStagedAppState(event.target.value)}\n        />\n        <StyledModelControlButton\n          onClick={() => {\n            const inputObject = JSON.parse(stagedAppState);\n            setAppState(inputObject);\n            setOutput(inputObject.output);\n            setStagedAppState(\"\");\n          }}\n        >\n          Import\n        </StyledModelControlButton>\n        <div>\n          <input\n            id={\"file-importer\"}\n            type={\"file\"}\n            accept={\".json\"}\n            style={{ display: \"none\" }}\n            onChange={(event) =>\n              importFileFromUser(event, setAppState, setOutput)\n            }\n          />\n          <label htmlFor={\"file-importer\"}>Import Model from File</label>\n        </div>\n      </StyledImport>\n\n      <StyledModelControlButton\n        onClick={() =>\n          setModalState((prev) => ({\n            ...prev,\n            visible: true,\n            type: \"confirm\",\n            onConfirm: () => {\n              setAppState(defaultAppState);\n              setOutput(undefined);\n            },\n            confirmText: [\n              \"This will reset the entire model, discarding all your current nodes, connections, parameters and results.\",\n              \"Permanently reset everything?\",\n            ],\n          }))\n        }\n      >\n        Reset\n      </StyledModelControlButton>\n    </StyledModelControlsWrapper>\n  );\n}\n","import * as React from \"react\";\nimport config from \"../../../config\";\nimport { useState } from \"react\";\n\nexport default function useTemporaryError(): [\n  string[],\n  React.Dispatch<React.SetStateAction<string[]>>,\n  (errors: string[]) => void\n] {\n  const [errors, setErrors] = useState<string[]>([]);\n\n  const setTemporaryErrors = (errors: string[]) => {\n    setErrors(errors);\n    setTimeout(() => setErrors([]), config.errorMessageDurationSeconds * 1000);\n  };\n\n  return [errors, setErrors, setTemporaryErrors];\n}\n","import styled from \"styled-components/macro\";\n\nexport const StyledText = styled.p``;\n\nexport const StyledLink = styled.a``;\n\nexport const StyledListItem = styled.li`\n  margin-bottom: 1em;\n`;\n\nexport const StyledModalContent = styled.div`\n  max-width: 1200px;\n  height: 100%;\n  overflow-y: auto;\n  padding: 3em;\n`;\n\nexport const StyledTitle = styled.h1`\n  line-height: 1em;\n`;\n\nexport const StyledSubTitle = styled.h2`\n  margin-top: 1.5em;\n  line-height: 1em;\n`;\n\nexport const StyledExitButton = styled.button`\n  position: absolute;\n  right: 1em;\n  top: 1em;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 40px;\n  height: 40px;\n  margin: 1em;\n  padding: 0;\n`;\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport config from \"../../config\";\nimport { StyledExitButton } from \"./style\";\nimport CrossMark from \"../../img/icons/CrossMark\";\n\nexport const StyledError = styled.div<{ isVisible: boolean }>`\n  color: red;\n  background: white;\n  font-size: 2em;\n  text-align: center;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translateX(-50%) translateY(-50%);\n  padding: 2em;\n  z-index: 20;\n  width: 80%;\n  border: 1px solid red;\n  opacity: 0.9;\n  animation: FadeAnimation ${config.errorMessageDurationSeconds}s ease-in\n    forwards;\n\n  @keyframes FadeAnimation {\n    0% {\n      opacity: 0.9;\n      visibility: ${({ isVisible }) => (isVisible ? \"visible\" : \"hidden\")};\n    }\n    80% {\n      opacity: 0.9;\n      visibility: ${({ isVisible }) => (isVisible ? \"visible\" : \"hidden\")};\n    }\n    100% {\n      opacity: 0;\n      visibility: hidden;\n    }\n  }\n`;\n\ntype ErrorModalProps = {\n  errors: string[];\n  setErrors: React.Dispatch<React.SetStateAction<string[]>>;\n};\n\nexport default function ErrorModal(props: ErrorModalProps): React.ReactElement {\n  const { errors, setErrors } = props;\n\n  if (errors.length === 0) {\n    return <></>;\n  }\n\n  return (\n    <StyledError isVisible={true}>\n      <StyledExitButton\n        onClick={() => {\n          setErrors([]);\n        }}\n      >\n        <CrossMark />\n      </StyledExitButton>\n      {errors.map((err) => (\n        <div key={err}>{err}</div>\n      ))}\n    </StyledError>\n  );\n}\n","import * as React from \"react\";\nimport {\n  AppConnection,\n  AppNode,\n  AppState,\n  ModalState,\n  Timing,\n} from \"../../App\";\nimport NodeTable from \"./EditableTable/NodeTable/NodeTable\";\nimport ConnectionTable from \"./EditableTable/ConnectionTable/ConnectionTable\";\nimport Tabs from \"../Tabs/Tabs\";\nimport ModelControls from \"./ModelControls\";\nimport {\n  StyledEditor,\n  StyledModelControlsWrapper,\n  StyledTables,\n} from \"./style\";\nimport { ModelOutput } from \"hotstuff-network\";\nimport useTemporaryError from \"./hooks/useTemporaryError\";\nimport config from \"../../config\";\nimport ErrorModal from \"../Modal/ErrorModal\";\nimport { StyledAddButton, StyledAddButtonWrapper } from \"./EditableTable/style\";\n\ntype SidebarProps = {\n  appState: AppState;\n  setAppState: React.Dispatch<React.SetStateAction<AppState>>;\n  setOutput: React.Dispatch<React.SetStateAction<ModelOutput | undefined>>;\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n  width: number;\n  height: number;\n  setTiming: (newTiming: Timing) => void;\n  onAddNode: () => void;\n  onAddConnection: () => void;\n  updateNodes: (nodes: AppNode[], clearActiveNodes: boolean) => void;\n  deleteNodes: (nodeIds: string[]) => void;\n  setActiveNodes: (nodeIds: string[]) => void;\n  updateConnections: (connections: AppConnection[]) => void;\n  deleteConnections: (connectionIds: string[]) => void;\n  onRunModel: () => ModelOutput | undefined;\n};\n\nexport default function Sidebar(props: SidebarProps): React.ReactElement {\n  const {\n    appState,\n    setAppState,\n    setOutput,\n    setModalState,\n    width,\n    height,\n    setTiming,\n    onAddNode,\n    onAddConnection,\n    updateNodes,\n    deleteNodes,\n    setActiveNodes,\n    updateConnections,\n    deleteConnections,\n    onRunModel,\n  } = props;\n\n  const [tableErrors, setTableErrors, setTemporaryTableErrors] =\n    useTemporaryError();\n  const [\n    modelControlsErrors,\n    setModelControlsErrors,\n    setTemporaryModelControlsErrors,\n  ] = useTemporaryError();\n\n  const nodeTable = (\n    <NodeTable\n      rows={appState.nodes}\n      onUpdateRow={(node: AppNode) => updateNodes([node], false)}\n      onDeleteRow={(node: AppNode) => deleteNodes([node.id])}\n      onClickEditableCell={(rowId: string) => setActiveNodes([rowId])}\n      setTemporaryErrors={setTemporaryTableErrors}\n    />\n  );\n\n  const nodeAddButton = (\n    <StyledAddButtonWrapper>\n      <StyledAddButton onClick={onAddNode}>Add Node</StyledAddButton>\n    </StyledAddButtonWrapper>\n  );\n\n  const connectionTable = (\n    <ConnectionTable\n      rows={appState.connections}\n      nodes={appState.nodes}\n      onUpdateRow={(connection: AppConnection) =>\n        updateConnections([connection])\n      }\n      onDeleteRow={(connection: AppConnection) =>\n        deleteConnections([connection.id])\n      }\n      setTemporaryErrors={setTemporaryTableErrors}\n    />\n  );\n\n  const connectionAddButton = (\n    <StyledAddButtonWrapper>\n      <StyledAddButton onClick={onAddConnection}>\n        Add Connection\n      </StyledAddButton>\n    </StyledAddButtonWrapper>\n  );\n\n  return (\n    <StyledEditor width={width} height={height}>\n      <StyledTables heightFrac={appState.panelSizes.tableHeightFraction}>\n        <ErrorModal errors={tableErrors} setErrors={setTableErrors} />\n        <Tabs\n          tabs={[\n            {\n              text: \"Nodes\",\n              component: nodeTable,\n              after: nodeAddButton,\n              width: 0.5,\n            },\n            {\n              text: \"Connections\",\n              component: connectionTable,\n              after: connectionAddButton,\n              width: 0.5,\n            },\n          ]}\n        />\n      </StyledTables>\n      <StyledModelControlsWrapper\n        heightFrac={1 - appState.panelSizes.tableHeightFraction}\n      >\n        <ErrorModal\n          errors={modelControlsErrors}\n          setErrors={setModelControlsErrors}\n        />\n        <ModelControls\n          appState={appState}\n          setAppState={setAppState}\n          setOutput={setOutput}\n          setModalState={setModalState}\n          onRunModel={() => {\n            if (\n              Math.ceil(\n                appState.timing.totalTimeS / appState.timing.timeStepS\n              ) > config.maxTimeSteps\n            ) {\n              setTemporaryModelControlsErrors([\n                `Decrease model run time or increase time step size`,\n              ]);\n              return;\n            }\n            return onRunModel();\n          }}\n          setTiming={setTiming}\n        />\n      </StyledModelControlsWrapper>\n    </StyledEditor>\n  );\n}\n","import {\n  CartesianGrid,\n  Legend,\n  LineChart,\n  ReferenceLine,\n  Tooltip,\n  TooltipPayload,\n  TooltipProps,\n  XAxis,\n  YAxis,\n} from \"recharts\";\nimport * as React from \"react\";\nimport { PlotDimensions } from \"./Plot\";\nimport styled from \"styled-components/macro\";\nimport config from \"../../config\";\n// import { generateYTicks } from \"./plotUtils\";\n\nconst StyledToolTip = styled.div`\n  background: rgba(255, 255, 255, 0.7);\n  padding: 0.2em;\n  //border-radius: 10px;\n  border: 1px solid black;\n`;\n\nconst StyledToolTipTitle = styled.div`\n  font-size: 1em;\n  font-weight: bold;\n`;\n\nconst StyledToolTipItem = styled.div<{ color: string }>`\n  color: ${(props) => props.color};\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst StyledToolTipValue = styled.div<{ after: string }>`\n  margin-left: 1em;\n\n  &::after {\n    content: \"${(props) => props.after}\";\n  }\n`;\n\nfunction CustomTooltip(props: TooltipProps & { after: string }) {\n  const { active, payload, label, after } = props;\n\n  if (active && payload && payload.length) {\n    const sortedPayload = [...payload].sort(\n      (a: TooltipPayload, b: TooltipPayload) => {\n        if (a.value > b.value) {\n          return -1;\n        } else if (a.value === b.value) {\n          if (a.name > b.name) {\n            return 1;\n          } else {\n            return -1;\n          }\n        } else {\n          return 1;\n        }\n      }\n    );\n\n    return (\n      <StyledToolTip>\n        <StyledToolTipTitle>{`Time: ${label}s`}</StyledToolTipTitle>\n        {sortedPayload.map((item) => {\n          return (\n            <StyledToolTipItem key={item.name} color={item.color || \"black\"}>\n              <div>{item.name}</div>\n              <StyledToolTipValue after={after}>\n                {item.value}\n              </StyledToolTipValue>\n            </StyledToolTipItem>\n          );\n        })}\n      </StyledToolTip>\n    );\n  }\n\n  return null;\n}\n\ntype LinePlotProps = {\n  plotDimensions: PlotDimensions;\n  plotData?: ReadonlyArray<Record<string, unknown>>;\n  lines: React.ReactElement[];\n  xAxisKey: string;\n  xLabel: string;\n  yLabel: string;\n  unit: string;\n};\n\nexport default function LinePlot(props: LinePlotProps): React.ReactElement {\n  const { plotDimensions, plotData, lines, xAxisKey, xLabel, yLabel, unit } =\n    props;\n\n  return (\n    <LineChart\n      height={plotDimensions.height}\n      width={plotDimensions.width}\n      margin={plotDimensions.margin}\n      data={plotData}\n    >\n      <CartesianGrid strokeDasharray=\"3 3\" />\n      <XAxis\n        dataKey={xAxisKey}\n        tick={{ fontSize: `${config.plotTickFontSizePx}` }}\n        label={{\n          value: xLabel,\n          position: \"center\",\n          dy: 20,\n        }}\n      />\n      <YAxis\n        domain={[\"dataMin\", \"auto\"]}\n        allowDecimals={false}\n        tick={{ fontSize: `${config.plotTickFontSizePx}` }}\n        padding={{\n          top: config.plotYDomainPaddingPx,\n          bottom: config.plotYDomainPaddingPx,\n        }}\n        label={{\n          value: yLabel,\n          position: \"center\",\n          angle: -90,\n          dx: -20,\n        }}\n      />\n      <ReferenceLine y={0} stroke=\"black\" strokeWidth={2} />\n      <Tooltip content={<CustomTooltip after={unit} />} />\n      <Legend\n        layout=\"horizontal\"\n        verticalAlign=\"top\"\n        align=\"center\"\n        wrapperStyle={{\n          paddingLeft: \"10px\",\n          paddingBottom: \"10px\",\n        }}\n      />\n      {lines}\n    </LineChart>\n  );\n}\n","import { HSConnection, ModelOutput } from \"hotstuff-network\";\nimport config from \"../../config\";\n\nfunction firstNodeStartsHotter(connection: HSConnection): boolean {\n  return (\n    connection.firstNode.temperatureDegC >=\n    connection.secondNode.temperatureDegC\n  );\n}\n\nexport function getDataKeyForConnection(connection: HSConnection): string {\n  const firstStartsHotter = firstNodeStartsHotter(connection);\n  const firstName = firstStartsHotter\n    ? connection.firstNode.name\n    : connection.secondNode.name;\n  const secondName = firstStartsHotter\n    ? connection.secondNode.name\n    : connection.firstNode.name;\n  return `${firstName} to ${secondName}`;\n}\n\nexport function roundToNearestTenth(input: number): number {\n  return Math.round(input * 10) / 10;\n}\n\nexport function roundToNearestHundredth(input: number): number {\n  return Math.round(input * 100) / 100;\n}\n\ntype TimeSeriesPlotData = {\n  time: number;\n  [key: string]: number;\n};\n\nexport function getDataForPlots(\n  data: ModelOutput\n): [TimeSeriesPlotData[], TimeSeriesPlotData[]] {\n  // the number of points depends on the order of magnitude\n  const lowerMag = Math.floor(Math.log10(data.totalTimeS));\n  const divisibleBy = Math.pow(10, lowerMag - 1);\n  function include(val: number) {\n    return Math.abs(val % divisibleBy) === 0;\n  }\n\n  const includeAll = data.timeSeriesS.length < config.maxPlotPoints;\n\n  const tempsAtAllTimes: TimeSeriesPlotData[] = [];\n  const heatTransfersAtAllTimes: TimeSeriesPlotData[] = [];\n\n  data.timeSeriesS.forEach((t, idx) => {\n    if (includeAll || include(t)) {\n      const temp: TimeSeriesPlotData = { time: t };\n      const ht: TimeSeriesPlotData = { time: t };\n\n      data.nodeResults.forEach((nodeResult) => {\n        const tempVal = nodeResult.tempDegC[idx];\n        temp[nodeResult.node.name] = roundToNearestTenth(tempVal);\n      });\n\n      data.connectionResults.forEach((connectionResult) => {\n        const heatTransferVal = connectionResult.heatTransferW[idx];\n        const signedHeatTransferVal = firstNodeStartsHotter(\n          connectionResult.connection\n        )\n          ? heatTransferVal\n          : -heatTransferVal;\n        ht[getDataKeyForConnection(connectionResult.connection)] =\n          roundToNearestHundredth(signedHeatTransferVal);\n      });\n\n      tempsAtAllTimes.push(temp);\n      heatTransfersAtAllTimes.push(ht);\n    }\n  });\n  return [tempsAtAllTimes, heatTransfersAtAllTimes];\n}\n","import * as React from \"react\";\nimport { useMemo } from \"react\";\nimport { Line } from \"recharts\";\nimport styled from \"styled-components\";\nimport { emptyOutput, ModelOutput } from \"hotstuff-network\";\nimport LinePlot from \"./LinePlot\";\nimport Tabs from \"../Tabs/Tabs\";\nimport { getDataForPlots, getDataKeyForConnection } from \"./plotUtils\";\nimport config from \"../../config\";\n\nconst colors = [\n  \"#2ecc71\",\n  \"#3498db\",\n  \"#9b59b6\",\n  \"#e74c3c\",\n  \"#e67e22\",\n  \"#34495e\",\n  \"#16a085\",\n];\n\nconst StyledCharts = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n\n  .chart {\n    width: 60% !important;\n    max-width: 900px;\n\n    @media only screen and (max-width: 600px) {\n      width: 90% !important;\n      touch-action: pan-y;\n    }\n  }\n`;\n\nconst StyledPlot = styled.div<{ height: number; width: number }>`\n  width: 100%;\n  height: ${(props) => props.height}px;\n  border-top: ${config.borderWidthPx}px solid black;\n  margin: 0;\n  padding: 0;\n`;\n\ntype Margin = {\n  left: number;\n  right: number;\n  top: number;\n  bottom: number;\n};\n\nexport type PlotDimensions = {\n  height: number;\n  width: number;\n  margin: Margin;\n};\n\ntype PlotProps = {\n  plotDimensions: PlotDimensions;\n  modelOutput?: ModelOutput;\n};\n\nexport default function Plot(props: PlotProps): React.ReactElement {\n  const modelHasOutput = !!(\n    props.modelOutput && props.modelOutput.nodeResults.length > 0\n  );\n  const res =\n    modelHasOutput && props.modelOutput ? props.modelOutput : emptyOutput;\n\n  const [tempPlotData, heatTransferPlotData] = getDataForPlots(res);\n\n  const heatTransferLines = useMemo(\n    () =>\n      res.connectionResults.map((connectionResult, idx) => {\n        return (\n          <Line\n            key={connectionResult.connection.id}\n            type={\"monotone\"}\n            dataKey={getDataKeyForConnection(connectionResult.connection)}\n            stroke={colors[idx]}\n            activeDot={{ r: 8 }}\n            isAnimationActive={false}\n          />\n        );\n      }),\n    [res.connectionResults]\n  );\n\n  const tempLines = useMemo(\n    () =>\n      res.nodeResults.map((nodeResult, idx) => {\n        return (\n          <Line\n            key={nodeResult.node.id}\n            type={\"monotone\"}\n            dataKey={nodeResult.node.name}\n            stroke={colors[idx]}\n            activeDot={{ r: 8 }}\n            isAnimationActive={false}\n          />\n        );\n      }),\n    [res.nodeResults]\n  );\n\n  const tempPlot = (\n    <LinePlot\n      plotDimensions={props.plotDimensions}\n      plotData={tempPlotData}\n      lines={tempLines}\n      xAxisKey={\"time\"}\n      xLabel={\"Time [s]\"}\n      yLabel={\"Temperature [degC]\"}\n      unit={\"degC\"}\n    />\n  );\n\n  const heatTransferPlot = (\n    <LinePlot\n      plotDimensions={props.plotDimensions}\n      plotData={heatTransferPlotData}\n      lines={heatTransferLines}\n      xAxisKey={\"time\"}\n      xLabel={\"Time [s]\"}\n      yLabel={\"Heat Transfer [W]\"}\n      unit={\"W\"}\n    />\n  );\n\n  return (\n    <StyledPlot\n      height={props.plotDimensions.height}\n      width={props.plotDimensions.width}\n    >\n      <StyledCharts>\n        <Tabs\n          tabs={[\n            {\n              text: \"Temperature\",\n              component: tempPlot,\n              width: 0.5,\n            },\n            {\n              text: \"Heat Transfer\",\n              component: heatTransferPlot,\n              width: 0.5,\n            },\n          ]}\n        />\n      </StyledCharts>\n    </StyledPlot>\n  );\n}\n","import { diffPoints, ORIGIN, Point, scalePoint } from \"../../utils/pointUtils\";\nimport config from \"../../config\";\nimport { AppConnection, AppNode, Direction } from \"../../App\";\nimport * as React from \"react\";\nimport { CanvasState } from \"./Canvas\";\nimport { scaleDiverging } from \"d3-scale\";\nimport { HSConnectionKind } from \"hotstuff-network\";\nimport {\n  decrementConnectionCount,\n  getConnectionKey,\n  getConnectionsToCounts,\n} from \"../../utils/nodeConnectionUtils\";\n\nconst {\n  activeNodeOutlineWidthPx,\n  minRadiusPx,\n  maxRadiusPx,\n  minLineThicknessPx,\n  maxLineThicknessPx,\n} = config;\nexport const DEFAULT_RADIUS = Math.floor((minRadiusPx + maxRadiusPx) / 2);\nexport const DEFAULT_LINE_THICKNESS = Math.floor(\n  (minLineThicknessPx + maxLineThicknessPx) / 2\n);\n\nfunction scientificNotation(num: number, precision: number): string {\n  return num.toExponential(precision).replace(\"+\", \"\");\n}\n\nfunction roundRect(\n  context: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  r: number\n) {\n  if (w < 2 * r) {\n    r = w / 2;\n  }\n  if (h < 2 * r) {\n    r = h / 2;\n  }\n  context.beginPath();\n  context.moveTo(x + r, y);\n  context.arcTo(x + w, y, x + w, y + h, r);\n  context.arcTo(x + w, y + h, x, y + h, r);\n  context.arcTo(x, y + h, x, y, r);\n  context.arcTo(x, y, x + w, y, r);\n  context.closePath();\n}\n\nfunction drawCircle(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number,\n  color: string\n): void {\n  context.save();\n\n  // draw node itself\n  context.beginPath();\n  context.arc(center.x, center.y, radius, 0, 2 * Math.PI);\n  context.fillStyle = color;\n  context.fill();\n  context.closePath();\n\n  context.restore();\n}\n\nfunction drawPowerGen(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number,\n  powerGen: number\n): void {\n  context.save();\n  const genString =\n    (powerGen >= 1000 || powerGen <= -1000\n      ? scientificNotation(powerGen, 1)\n      : powerGen.toString()) + \"W\";\n  let width;\n  let fontPx = 12;\n  let textMetrics;\n  do {\n    context.font = `${fontPx}px Helvetica`;\n    textMetrics = context.measureText(genString);\n    width = textMetrics.width;\n    fontPx--;\n  } while (width + 10 > radius * 2);\n  const height = textMetrics.actualBoundingBoxAscent;\n\n  context.fillStyle = \"black\";\n  roundRect(\n    context,\n    center.x - width / 2 - 1,\n    center.y - height,\n    width + 2,\n    height * 2,\n    height / 4\n  );\n  context.fill();\n  context.fillStyle = \"white\";\n  context.fillText(genString, center.x - width / 2, center.y + height / 2);\n  context.restore();\n}\n\nfunction drawCircleOutline(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number,\n  color: string\n): void {\n  context.save();\n  context.beginPath();\n  // inset\n  context.arc(\n    center.x,\n    center.y,\n    radius - activeNodeOutlineWidthPx / 2,\n    0,\n    2 * Math.PI\n  );\n  context.lineWidth = activeNodeOutlineWidthPx;\n  context.strokeStyle = color;\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nfunction drawHashPattern(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number\n) {\n  context.save();\n  context.lineWidth = 2;\n  context.fillStyle = \"#FFFFFF\";\n\n  const delta = 4.5;\n  const buffer = 1;\n  const circle = 2;\n\n  // save the canvas above, now transform it for ease of drawing\n  context.translate(center.x, center.y);\n  context.rotate(Math.PI / 4);\n\n  // draw horizontal line\n  context.beginPath();\n  context.moveTo(-radius, 0);\n  context.lineTo(radius, 0);\n  context.stroke();\n\n  // draw smaller horizontal lines offset vertically from center\n  let h = 0; // vertical distance from center\n  while (h + delta < radius) {\n    h = h + delta;\n    const newRadius = radius * Math.sin(Math.acos(h / radius));\n    context.moveTo(-newRadius - buffer, h);\n    context.lineTo(newRadius + buffer, h);\n    context.stroke();\n    context.moveTo(-newRadius - buffer, -h);\n    context.lineTo(newRadius + buffer, -h);\n    context.stroke();\n  }\n  context.closePath();\n\n  // clip off the extra bits around the circle\n  context.beginPath();\n  context.arc(0, 0, radius + circle, 0, Math.PI * 2, false);\n  context.arc(0, 0, radius, 0, Math.PI * 2, true);\n  context.fill();\n\n  context.restore();\n}\n\nfunction drawNodeName(\n  context: CanvasRenderingContext2D,\n  name: string,\n  center: Point,\n  radius: number,\n  textDirection: Direction\n) {\n  const bufferText = 2;\n  context.save();\n  context.font = \"14px Helvetica\";\n  const textMetrics = context.measureText(name);\n  const width = textMetrics.width;\n  context.translate(center.x, center.y);\n  if (textDirection === \"D\") {\n    context.fillText(\n      name,\n      -width / 2,\n      textMetrics.actualBoundingBoxAscent + radius + bufferText\n    );\n  } else if (textDirection === \"R\") {\n    context.fillText(\n      name,\n      radius + bufferText,\n      textMetrics.actualBoundingBoxAscent / 2\n    );\n  } else if (textDirection === \"U\") {\n    context.fillText(\n      name,\n      -width / 2,\n      -(textMetrics.actualBoundingBoxDescent + radius + bufferText)\n    );\n  } else {\n    context.fillText(\n      name,\n      -(width + radius + bufferText),\n      textMetrics.actualBoundingBoxAscent / 2\n    );\n  }\n  context.restore();\n}\n\nexport function drawNode(\n  context: CanvasRenderingContext2D,\n  name: string,\n  center: Point,\n  radius: number,\n  color: string,\n  isActive: boolean,\n  isBoundary: boolean,\n  textDirection: Direction,\n  powerGen: number\n): void {\n  drawCircle(context, center, radius, color);\n  if (isActive) {\n    drawCircleOutline(context, center, radius, \"black\");\n  }\n  if (isBoundary) {\n    drawHashPattern(context, center, radius);\n  }\n  if (powerGen !== 0) {\n    drawPowerGen(context, center, radius, powerGen);\n  }\n  drawNodeName(context, name, center, radius, textDirection);\n}\n\nexport function drawNodes(\n  context: CanvasRenderingContext2D,\n  appNodes: AppNode[]\n): void {\n  appNodes.forEach((node) => {\n    const nodeRadius = determineRadius(\n      node.capacitanceJPerDegK,\n      appNodes.map((node) => node.capacitanceJPerDegK)\n    );\n    const nodeColor = determineColor(\n      node.temperatureDegC,\n      appNodes.map((node) => node.temperatureDegC)\n    );\n    drawNode(\n      context,\n      node.name,\n      node.center,\n      nodeRadius,\n      nodeColor,\n      node.isActive,\n      node.isBoundary,\n      node.textDirection,\n      node.powerGenW\n    );\n  });\n}\n\nfunction drawLineBetween(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string,\n  lineThicknessPx: number,\n  imgForConnectionKind: HTMLImageElement,\n  startOffset = 0,\n  endOffset = 0,\n  alreadyDrawn = 0,\n  leftToDraw = 1\n): void {\n  // this function assumes there will never be more than 2 left to draw (can't have conduction + convection + radiation)\n  if (leftToDraw === 0) {\n    return;\n  }\n\n  const dx = end.x - start.x;\n  const dy = end.y - start.y;\n  const angle = Math.atan2(dy, dx);\n  const length = Math.sqrt(dx * dx + dy * dy);\n  const adjLength = length - endOffset;\n\n  // draw connecting line\n  if (alreadyDrawn === 0) {\n    context.save();\n\n    context.strokeStyle = color;\n    context.lineWidth = lineThicknessPx;\n\n    context.translate(start.x, start.y);\n    context.rotate(angle);\n\n    context.beginPath();\n    context.moveTo(startOffset, 0);\n    context.lineTo(adjLength, 0);\n    context.moveTo(adjLength, -0);\n    context.lineTo(startOffset, -0);\n    context.stroke();\n    context.closePath();\n\n    context.restore();\n  }\n\n  // draw image for connection kind\n  const imageSize = 20;\n  const buffer = 2;\n  const offset =\n    alreadyDrawn === 0 && leftToDraw === 2\n      ? -(imageSize / 2 + buffer)\n      : alreadyDrawn === 1 && leftToDraw === 1\n      ? imageSize / 2 + buffer\n      : 0;\n\n  context.save();\n  context.fillStyle = \"white\";\n\n  context.translate(start.x, start.y);\n  context.rotate(angle);\n  context.translate(length / 2 + offset, 0);\n  context.beginPath();\n  context.arc(0, 0, imageSize / 2, 0, Math.PI * 2);\n  context.fill();\n  context.closePath();\n\n  context.rotate(-angle);\n  context.translate(-imageSize / 2, imageSize / 2);\n  context.drawImage(imgForConnectionKind, 0, -imageSize, imageSize, imageSize);\n\n  context.restore();\n}\n\nexport function drawConnections(\n  context: CanvasRenderingContext2D,\n  appNodes: AppNode[],\n  appConnections: AppConnection[],\n  connectionKindImageMap: Map<HSConnectionKind, HTMLImageElement>\n): void {\n  const connectionToCount = getConnectionsToCounts(appConnections);\n  const leftToDrawConnectionCount = new Map(connectionToCount);\n  const allResistances = appConnections.map((conn) => conn.resistanceDegKPerW);\n  appConnections.map((conn) => {\n    const { firstNode, secondNode, kind } = conn;\n    const imgForConnectionKind = connectionKindImageMap.get(kind);\n    if (imgForConnectionKind) {\n      const firstNodeAppNode = appNodes.find(\n        (node) => node.id === firstNode.id\n      );\n      const secondNodeAppNode = appNodes.find(\n        (node) => node.id === secondNode.id\n      );\n      if (firstNodeAppNode && secondNodeAppNode) {\n        const firstNodeRadius = determineRadius(\n          firstNodeAppNode.capacitanceJPerDegK,\n          appNodes.map((node) => node.capacitanceJPerDegK)\n        );\n        const secondNodeRadius = determineRadius(\n          secondNodeAppNode.capacitanceJPerDegK,\n          appNodes.map((node) => node.capacitanceJPerDegK)\n        );\n\n        const key = getConnectionKey(conn);\n        const leftToDraw = leftToDrawConnectionCount.get(key) ?? 0;\n        const alreadyDrawn = (connectionToCount.get(key) ?? 0) - leftToDraw;\n        drawConnection(\n          context,\n          firstNodeAppNode.center,\n          firstNodeRadius,\n          secondNodeAppNode.center,\n          secondNodeRadius,\n          determineLineThickness(conn.resistanceDegKPerW, allResistances),\n          imgForConnectionKind,\n          alreadyDrawn,\n          leftToDraw\n        );\n        decrementConnectionCount(leftToDrawConnectionCount, conn);\n      }\n    }\n  });\n}\n\nexport function drawLine(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string,\n  startOffset = 0,\n  endOffset = 0\n): void {\n  context.save();\n  context.beginPath();\n  context.strokeStyle = color;\n  context.lineWidth = 2;\n  const dx = end.x - start.x;\n  const dy = end.y - start.y;\n  const angle = Math.atan2(dy, dx);\n  const length = Math.sqrt(dx * dx + dy * dy);\n  context.translate(start.x, start.y);\n  context.rotate(angle);\n  context.beginPath();\n  context.moveTo(startOffset, 0);\n  const adjLength = length - endOffset;\n  context.lineTo(adjLength, 0);\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nexport function drawClearBox(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string\n): void {\n  context.save();\n  context.beginPath();\n  context.fillStyle = color;\n  context.globalAlpha = 0.2;\n  context.fillRect(start.x, start.y, end.x - start.x, end.y - start.y);\n  context.closePath();\n\n  // outline\n  context.beginPath();\n  context.strokeStyle = color;\n  context.rect(start.x, start.y, end.x - start.x, end.y - start.y);\n  context.stroke();\n  context.closePath();\n\n  context.restore();\n}\n\nfunction drawConnection(\n  context: CanvasRenderingContext2D,\n  firstNodeCenter: Point,\n  firstNodeRadius: number,\n  secondNodeCenter: Point,\n  secondNodeRadius: number,\n  lineThicknessPx: number,\n  imgForConnectionKind: HTMLImageElement,\n  alreadyDrawn: number,\n  leftToDraw: number\n): void {\n  drawLineBetween(\n    context,\n    firstNodeCenter,\n    secondNodeCenter,\n    \"black\",\n    lineThicknessPx,\n    imgForConnectionKind,\n    firstNodeRadius,\n    secondNodeRadius,\n    alreadyDrawn,\n    leftToDraw\n  );\n}\n\nexport function intersectsCircle(\n  point: Point,\n  circleCenter: Point,\n  radius: number\n): boolean {\n  const deltaX = point.x - circleCenter.x;\n  const deltaY = point.y - circleCenter.y;\n  return Math.pow(deltaX, 2) + Math.pow(deltaY, 2) <= Math.pow(radius, 2);\n}\n\nexport function isInsideBox(\n  startBox: Point,\n  endBox: Point,\n  point: Point\n): boolean {\n  const [topLeft, bottomRight] =\n    startBox.x < endBox.x && startBox.y < endBox.y\n      ? [startBox, endBox]\n      : [endBox, startBox];\n\n  const [bottomLeft, topRight] =\n    startBox.x < endBox.x && startBox.y > endBox.y\n      ? [startBox, endBox]\n      : [endBox, startBox];\n\n  return (\n    (topLeft.x <= point.x &&\n      point.x <= bottomRight.x &&\n      topLeft.y <= point.y &&\n      point.y <= bottomRight.y) ||\n    (bottomLeft.x <= point.x &&\n      point.x <= topRight.x &&\n      topRight.y <= point.y &&\n      point.y <= bottomLeft.y)\n  );\n}\n\nexport function calculateMousePositionOnElement(\n  event: React.MouseEvent | MouseEvent,\n  element: HTMLElement\n): Point {\n  const viewportMousePos = { x: event.pageX, y: event.pageY };\n  const boundingRect = element.getBoundingClientRect();\n  const topLeftCanvasPos = { x: boundingRect.left, y: boundingRect.top };\n  return diffPoints(viewportMousePos, topLeftCanvasPos);\n}\n\nfunction canvasMouseToNodeCoords(\n  mouse: Point,\n  offset: Point,\n  scale: number\n): Point {\n  return diffPoints(scalePoint(mouse, scale), offset);\n}\n\nexport function mouseToNodeCoords(\n  event: React.MouseEvent | MouseEvent,\n  canvasState: CanvasState\n): Point {\n  if (canvasState.context) {\n    const canvasMouse = calculateMousePositionOnElement(\n      event,\n      canvasState.context.canvas\n    );\n    return canvasMouseToNodeCoords(\n      canvasMouse,\n      canvasState.canvasViewState.offset,\n      canvasState.canvasViewState.scale\n    );\n  } else {\n    return ORIGIN;\n  }\n}\n\nexport function rotatedDirection(direction: Direction): Direction {\n  // assume rotate counter-clockwise\n  if (direction === \"D\") {\n    return \"R\";\n  } else if (direction === \"R\") {\n    return \"U\";\n  } else if (direction === \"U\") {\n    return \"L\";\n  } else {\n    return \"D\";\n  }\n}\n\nexport function getCanvasCenter(\n  canvasWidth: number,\n  canvasHeight: number,\n  offset: Point,\n  scale: number\n): Point {\n  const topLeftPoint = offset;\n  const distanceToCenter = scalePoint(\n    { x: canvasWidth, y: canvasHeight },\n    2 * scale\n  );\n  return diffPoints(distanceToCenter, topLeftPoint);\n}\n\nexport function determineRadius(\n  capacitance: number,\n  allCapacitances: number[]\n): number {\n  const min = Math.min(...allCapacitances);\n  const max = Math.max(...allCapacitances);\n  if (min === max) {\n    return DEFAULT_RADIUS;\n  }\n  // linear interpolation\n  return (\n    ((capacitance - min) / (max - min)) * (maxRadiusPx - minRadiusPx) +\n    minRadiusPx\n  );\n}\n\nexport function determineColor(\n  temperature: number,\n  allTemperatures: number[]\n): string {\n  const minTemp = Math.min(...allTemperatures);\n  const maxTemp = Math.max(...allTemperatures);\n  const range = maxTemp - minTemp;\n  const colorScale = scaleDiverging<string>()\n    .domain([minTemp - range / 3, (minTemp + maxTemp) / 2, maxTemp + range / 3])\n    .range([\"blue\", \"#ababab\", \"red\"]);\n  return colorScale(temperature);\n}\n\nexport function determineLineThickness(\n  resistance: number,\n  allResistances: number[]\n): number {\n  const min = Math.min(...allResistances);\n  const max = Math.max(...allResistances);\n  if (min === max) {\n    return DEFAULT_LINE_THICKNESS;\n  }\n  // linear interpolation\n  return (\n    ((resistance - min) / (max - min)) *\n      (maxLineThicknessPx - minLineThicknessPx) +\n    minLineThicknessPx\n  );\n}\n","import * as React from \"react\";\nimport { useCallback, useLayoutEffect, useRef, useState } from \"react\";\nimport {\n  addPoints,\n  diffPoints,\n  ORIGIN,\n  Point,\n  scalePoint,\n} from \"../../../utils/pointUtils\";\nimport config from \"../../../config\";\nimport { calculateMousePositionOnElement } from \"../canvasUtils\";\nimport { CanvasViewState } from \"../Canvas\";\n\nconst { maxZoom, minZoom, zoomSensitivity, maxZoomDelta } = config;\n\nexport default function usePanZoomCanvas(\n  canvasRef: React.RefObject<HTMLCanvasElement>,\n  canvasViewState: CanvasViewState,\n  setCanvasViewState: (newCanvasViewState: CanvasViewState) => void\n): [\n  CanvasRenderingContext2D | null,\n  React.Dispatch<React.SetStateAction<CanvasRenderingContext2D | null>>,\n  (event: React.MouseEvent | MouseEvent) => void\n] {\n  const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\n  const mousePosRef = useRef<Point>(ORIGIN);\n  const lastMousePosRef = useRef<Point>(ORIGIN);\n  const lastCanvasViewState = useRef<CanvasViewState>(canvasViewState);\n\n  // functions for panning\n  const mouseMove = useCallback(\n    (event: React.MouseEvent | MouseEvent) => {\n      if (context) {\n        // update mouse position\n        const newMousePos = calculateMousePositionOnElement(\n          event,\n          context.canvas\n        );\n        lastMousePosRef.current = mousePosRef.current;\n        mousePosRef.current = newMousePos;\n\n        const mouseDiff = scalePoint(\n          diffPoints(mousePosRef.current, lastMousePosRef.current),\n          canvasViewState.scale\n        );\n        const newCanvasViewState = {\n          scale: canvasViewState.scale,\n          offset: addPoints(lastCanvasViewState.current.offset, mouseDiff),\n        };\n        setCanvasViewState(newCanvasViewState);\n        lastCanvasViewState.current = newCanvasViewState;\n      }\n    },\n    [context, canvasViewState.scale, setCanvasViewState]\n  );\n\n  const mouseUp = useCallback(() => {\n    document.removeEventListener(\"mousemove\", mouseMove);\n    document.removeEventListener(\"mouseup\", mouseUp);\n  }, [mouseMove]);\n\n  const startPan = useCallback(\n    (event: React.MouseEvent | MouseEvent) => {\n      if (context) {\n        document.addEventListener(\"mousemove\", mouseMove);\n        document.addEventListener(\"mouseup\", mouseUp);\n        mousePosRef.current = calculateMousePositionOnElement(\n          event,\n          context.canvas\n        );\n      }\n    },\n    [context, mouseMove, mouseUp]\n  );\n\n  // add event listener on canvas for zoom\n  useLayoutEffect(() => {\n    function handleWheel(event: WheelEvent) {\n      event.preventDefault();\n      if (context) {\n        // update mouse position\n        const newMousePos = calculateMousePositionOnElement(\n          event,\n          context.canvas\n        );\n        lastMousePosRef.current = mousePosRef.current;\n        mousePosRef.current = newMousePos;\n\n        // calculate new scale/zoom\n        const zoomDelta = event.deltaY / zoomSensitivity;\n        const zoom =\n          1 -\n          (Math.abs(zoomDelta) > maxZoomDelta\n            ? (zoomDelta / Math.abs(zoomDelta)) * maxZoomDelta\n            : zoomDelta);\n        const newScale = canvasViewState.scale * zoom;\n        if (newScale > maxZoom || newScale < minZoom) {\n          return;\n        }\n\n        // offset the canvas such that the point under the mouse doesn't move\n        const lastMouse = scalePoint(\n          mousePosRef.current,\n          canvasViewState.scale\n        );\n        const newMouse = scalePoint(mousePosRef.current, newScale);\n        const mouseOffset = diffPoints(lastMouse, newMouse);\n\n        const newCanvasViewState = {\n          offset: diffPoints(lastCanvasViewState.current.offset, mouseOffset),\n          scale: newScale,\n        };\n        setCanvasViewState(newCanvasViewState);\n        lastCanvasViewState.current = newCanvasViewState;\n      }\n    }\n\n    const canvasElem = canvasRef.current;\n    if (canvasElem) {\n      lastCanvasViewState.current = canvasViewState;\n      canvasElem.addEventListener(\"wheel\", handleWheel);\n      return () => canvasElem.removeEventListener(\"wheel\", handleWheel);\n    }\n  }, [canvasRef, canvasViewState, context, setCanvasViewState]);\n\n  return [context, setContext, startPan];\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { ORIGIN } from \"../../utils/pointUtils\";\nimport { CanvasState, CanvasViewState } from \"./Canvas\";\nimport { StyledButton } from \"../../style\";\n\nconst StyledCanvasControlButtons = styled.div`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst StyledCanvasControlButton = styled(StyledButton)`\n  margin: 0.2em;\n  font-size: 0.75em;\n`;\n\ntype CanvasControlsProps = {\n  setCanvasViewState: (canvasViewState: CanvasViewState) => void;\n  canvasState: CanvasState;\n  savedCanvasState: CanvasViewState;\n  setSavedCanvasState: (newSavedCanvasState: CanvasViewState) => void;\n};\n\nexport default function CanvasControls(\n  props: CanvasControlsProps\n): React.ReactElement {\n  return (\n    <StyledCanvasControlButtons>\n      <StyledCanvasControlButton\n        onClick={() =>\n          props.canvasState.context &&\n          props.setCanvasViewState({\n            offset: props.savedCanvasState.offset,\n            scale: props.savedCanvasState.scale,\n          })\n        }\n      >\n        Saved View\n      </StyledCanvasControlButton>\n      <StyledCanvasControlButton\n        onClick={() =>\n          props.canvasState.context &&\n          props.setCanvasViewState({ offset: ORIGIN, scale: 1 })\n        }\n      >\n        Zero View\n      </StyledCanvasControlButton>\n      <StyledCanvasControlButton\n        onClick={() => {\n          props.setSavedCanvasState({\n            offset: props.canvasState.canvasViewState.offset,\n            scale: props.canvasState.canvasViewState.scale,\n          });\n        }}\n      >\n        Overwrite Saved View\n      </StyledCanvasControlButton>\n    </StyledCanvasControlButtons>\n  );\n}\n","import * as React from \"react\";\nimport { useLayoutEffect, useRef } from \"react\";\nimport styled from \"styled-components\";\nimport usePanZoomCanvas from \"./hooks/usePanZoomCanvas\";\nimport { Point } from \"../../utils/pointUtils\";\nimport CanvasControls from \"./CanvasControls\";\nimport useOnClickCanvas from \"./hooks/useOnClickCanvas\";\nimport { roundToNearestHundredth } from \"../Plot/plotUtils\";\n\nconst StyledCanvasWrapper = styled.div`\n  display: block;\n  max-height: 100%;\n  position: relative;\n`;\n\nconst StyledCanvasState = styled.div`\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  padding: 0.5em;\n  font-size: 0.75em;\n`;\n\nconst StyledCanvas = styled.canvas<{ cssWidth: number; cssHeight: number }>`\n  width: ${({ cssWidth }) => `${cssWidth}px`};\n  height: ${({ cssHeight }) => `${cssHeight}px`};\n`;\n\nexport type CanvasViewState = {\n  offset: Point;\n  scale: number;\n};\n\nexport type CanvasState = {\n  context: CanvasRenderingContext2D | null;\n  canvasViewState: CanvasViewState;\n  canvasWidth: number;\n  canvasHeight: number;\n};\n\nexport type CanvasProps = {\n  canvasWidth: number;\n  canvasHeight: number;\n  devicePixelRatio: number;\n  draw: (context: CanvasRenderingContext2D) => void;\n  onMouseDown: (\n    event: React.MouseEvent | MouseEvent,\n    canvasState: CanvasState,\n    defaultBehavior: (event: React.MouseEvent | MouseEvent) => void\n  ) => void;\n  handleDoubleClick: (\n    event: React.MouseEvent,\n    canvasState: CanvasState\n  ) => void;\n  canvasViewState: CanvasViewState;\n  setCanvasViewState: (newCanvasState: CanvasViewState) => void;\n  savedCanvasViewState: CanvasViewState;\n  setSavedCanvasViewState: (newSavedCanvasState: CanvasViewState) => void;\n  setKeyboardActive: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nexport default function Canvas(props: CanvasProps): React.ReactElement {\n  const {\n    canvasWidth,\n    canvasHeight,\n    devicePixelRatio,\n    draw,\n    onMouseDown,\n    handleDoubleClick,\n    canvasViewState,\n    setCanvasViewState,\n    savedCanvasViewState,\n    setSavedCanvasViewState,\n    setKeyboardActive,\n  } = props;\n\n  // hooks\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  useOnClickCanvas(canvasRef, setKeyboardActive);\n  const [context, setContext, startPan] = usePanZoomCanvas(\n    canvasRef,\n    canvasViewState,\n    setCanvasViewState\n  );\n\n  // setup canvas and set context\n  useLayoutEffect(() => {\n    if (canvasRef.current) {\n      // get new drawing context\n      const renderCtx = canvasRef.current.getContext(\"2d\");\n      setContext(renderCtx);\n    }\n  }, [setContext]);\n\n  // draw\n  useLayoutEffect(() => {\n    if (context) {\n      // clear canvas\n      context.canvas.width = canvasWidth * devicePixelRatio;\n      context.canvas.height = canvasHeight * devicePixelRatio;\n\n      context.scale(\n        canvasViewState.scale * devicePixelRatio,\n        canvasViewState.scale * devicePixelRatio\n      );\n      context.translate(canvasViewState.offset.x, canvasViewState.offset.y);\n\n      draw(context);\n    }\n  }, [\n    canvasHeight,\n    canvasWidth,\n    context,\n    devicePixelRatio,\n    draw,\n    canvasViewState.offset.x,\n    canvasViewState.offset.y,\n    canvasViewState.scale,\n  ]);\n\n  return (\n    <StyledCanvasWrapper>\n      <StyledCanvasState>\n        <div>{`x: ${Math.round(canvasViewState.offset.x)}`}</div>\n        <div>{`y: ${Math.round(canvasViewState.offset.y)}`}</div>\n        <div>{`scale: ${roundToNearestHundredth(canvasViewState.scale)}`}</div>\n      </StyledCanvasState>\n      <CanvasControls\n        setCanvasViewState={setCanvasViewState}\n        canvasState={{\n          context,\n          canvasViewState,\n          canvasWidth,\n          canvasHeight,\n        }}\n        savedCanvasState={savedCanvasViewState}\n        setSavedCanvasState={setSavedCanvasViewState}\n      />\n      <StyledCanvas\n        ref={canvasRef}\n        width={canvasWidth * devicePixelRatio}\n        height={canvasHeight * devicePixelRatio}\n        cssWidth={canvasWidth}\n        cssHeight={canvasHeight}\n        onMouseDown={(event: React.MouseEvent | MouseEvent) =>\n          onMouseDown(\n            event,\n            { context, canvasViewState, canvasWidth, canvasHeight },\n            () => startPan(event)\n          )\n        }\n        onDoubleClick={(event: React.MouseEvent) =>\n          handleDoubleClick(event, {\n            context,\n            canvasViewState,\n            canvasWidth,\n            canvasHeight,\n          })\n        }\n      />\n    </StyledCanvasWrapper>\n  );\n}\n","import * as React from \"react\";\nimport { useEffect } from \"react\";\n\nexport default function useOnClickCanvas(\n  ref: React.RefObject<HTMLCanvasElement>,\n  onClickCanvas: React.Dispatch<React.SetStateAction<boolean>>\n): void {\n  useEffect(() => {\n    const handleClickOutside = (event: React.MouseEvent | MouseEvent) => {\n      const keyBoardActive =\n        !!ref.current && ref.current.contains(event.target as Node);\n      onClickCanvas(keyBoardActive);\n    };\n\n    // Bind the event listener\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      // Unbind the event listener on clean up\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [ref, onClickCanvas]);\n}\n","import { useCallback } from \"react\";\nimport { drawConnections, drawNodes } from \"../components/Canvas/canvasUtils\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport useConnectionKindImageMap from \"./useConnectionKindImageMap\";\n\nexport default function useDraw(\n  appNodes: AppNode[],\n  appConnections: AppConnection[]\n): [\n  (context: CanvasRenderingContext2D) => void,\n  (canvasState: CanvasState) => void\n] {\n  const connectionKindImageMap = useConnectionKindImageMap();\n  const draw = useCallback(\n    (context: CanvasRenderingContext2D) => {\n      drawNodes(context, appNodes);\n      drawConnections(\n        context,\n        appNodes,\n        appConnections,\n        connectionKindImageMap\n      );\n    },\n    [appConnections, appNodes, connectionKindImageMap]\n  );\n\n  const clearAndRedraw = useCallback(\n    (canvasState: CanvasState) => {\n      if (canvasState.context) {\n        canvasState.context.clearRect(\n          -canvasState.canvasViewState.offset.x,\n          -canvasState.canvasViewState.offset.y,\n          canvasState.canvasWidth / canvasState.canvasViewState.scale,\n          canvasState.canvasHeight / canvasState.canvasViewState.scale\n        );\n        draw(canvasState.context);\n      }\n    },\n    [draw]\n  );\n\n  return [draw, clearAndRedraw];\n}\n","import { useEffect, useState } from \"react\";\nimport { HSConnectionKind } from \"hotstuff-network\";\nimport connectionKindToImgSrc from \"../utils/imageUtils\";\n\nexport default function useConnectionKindImageMap(): Map<\n  HSConnectionKind,\n  HTMLImageElement\n> {\n  const [images, setImages] = useState<Map<HSConnectionKind, HTMLImageElement>>(\n    new Map()\n  );\n\n  useEffect(() => {\n    const connectionKinds: HSConnectionKind[] = [\"cond\", \"conv\", \"rad\"];\n    connectionKinds.forEach((kind) => {\n      const img = new Image();\n      img.src = connectionKindToImgSrc(kind);\n      img.onload = () => setImages((prev) => new Map(prev.set(kind, img)));\n    });\n  }, []);\n\n  return images;\n}\n","import React, { useCallback } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport {\n  determineRadius,\n  drawLine,\n  intersectsCircle,\n  mouseToNodeCoords,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { getNewConnection } from \"../utils/nodeConnectionUtils\";\n\nexport default function useAddConnection(\n  appNodes: AppNode[],\n  appConnections: AppConnection[],\n  addConnection: (newConnection: AppConnection) => void,\n  clearAndRedraw: (canvasState: CanvasState) => void\n): (\n  event: React.MouseEvent | MouseEvent,\n  clickedNode: AppNode,\n  canvasState: CanvasState\n) => void {\n  const drawConnectionBeingMade = useCallback(\n    (\n      event: React.MouseEvent | MouseEvent,\n      clickedNode: AppNode,\n      canvasState: CanvasState\n    ) => {\n      if (canvasState.context) {\n        const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n        clearAndRedraw(canvasState);\n        drawLine(\n          canvasState.context,\n          clickedNode.center,\n          nodeCoordsOfMouse,\n          \"grey\"\n        );\n      }\n    },\n    [clearAndRedraw]\n  );\n\n  return useCallback(\n    (\n      event: React.MouseEvent | MouseEvent,\n      clickedNode: AppNode,\n      canvasState: CanvasState\n    ) => {\n      const drawConnWrapper = (event: React.MouseEvent | MouseEvent) => {\n        drawConnectionBeingMade(event, clickedNode, canvasState);\n      };\n\n      const mouseUp = (event: React.MouseEvent | MouseEvent) => {\n        document.removeEventListener(\"mousemove\", drawConnWrapper);\n        document.removeEventListener(\"mouseup\", mouseUp);\n\n        // if arrow released on a node, make new connection\n        const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n        const mouseUpOnNode = appNodes.find((node) => {\n          const nodeRadius = determineRadius(\n            node.capacitanceJPerDegK,\n            appNodes.map((node) => node.capacitanceJPerDegK)\n          );\n          return (\n            intersectsCircle(nodeCoordsOfMouse, node.center, nodeRadius) &&\n            node.id !== clickedNode.id\n          );\n        });\n\n        if (mouseUpOnNode) {\n          const newConnection = getNewConnection(\n            clickedNode,\n            mouseUpOnNode,\n            appConnections\n          );\n          if (!!newConnection) {\n            addConnection(newConnection);\n          } else {\n            clearAndRedraw(canvasState);\n          }\n        } else {\n          clearAndRedraw(canvasState);\n        }\n      };\n      document.addEventListener(\"mousemove\", drawConnWrapper);\n      document.addEventListener(\"mouseup\", mouseUp);\n    },\n    [\n      addConnection,\n      appConnections,\n      appNodes,\n      clearAndRedraw,\n      drawConnectionBeingMade,\n    ]\n  );\n}\n","import React, { useCallback, useRef } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport { mouseToNodeCoords } from \"../components/Canvas/canvasUtils\";\nimport { AppNode } from \"../App\";\nimport { diffPoints } from \"../utils/pointUtils\";\nimport config from \"../config\";\n\nfunction getNewAppNodes(\n  clickedMouseEvent: React.MouseEvent | MouseEvent,\n  currentMouseEvent: React.MouseEvent | MouseEvent,\n  canvasState: CanvasState,\n  clickedNode: AppNode,\n  multiSelectKeyPressed: boolean,\n  activeNodes: AppNode[]\n): AppNode[] {\n  const offsetMouseToCenter = diffPoints(\n    mouseToNodeCoords(clickedMouseEvent, canvasState),\n    clickedNode.center\n  );\n\n  const newClickedCenter = diffPoints(\n    mouseToNodeCoords(currentMouseEvent, canvasState),\n    offsetMouseToCenter\n  );\n\n  const newClickedNode = {\n    ...clickedNode,\n    isActive: true,\n    center: newClickedCenter,\n  };\n\n  const newActiveNodes =\n    clickedNode.isActive || multiSelectKeyPressed\n      ? activeNodes.map((node) => {\n          const distanceFromClickedCenter = diffPoints(\n            clickedNode.center,\n            node.center\n          );\n          return {\n            ...node,\n            center: diffPoints(newClickedCenter, distanceFromClickedCenter),\n          };\n        })\n      : [];\n\n  return [newClickedNode, ...newActiveNodes];\n}\n\nexport default function useMoveNode(\n  updateNodes: (nodesToUpdate: AppNode[], clearActiveNodes?: boolean) => void\n): (\n  event: React.MouseEvent | MouseEvent,\n  clickedNode: AppNode,\n  activeNodes: AppNode[],\n  canvasState: CanvasState\n) => void {\n  const movedRef = useRef<boolean>(false);\n\n  return useCallback(\n    (\n      mouseDownEvent: React.MouseEvent | MouseEvent,\n      clickedNode: AppNode,\n      activeNodes: AppNode[],\n      canvasState: CanvasState\n    ) => {\n      const multiSelectKeyPressed = config.multiSelectKeys.some(\n        (k) => mouseDownEvent[k]\n      );\n      const moveNode = (currentMouseEvent: React.MouseEvent | MouseEvent) => {\n        if (canvasState.context) {\n          movedRef.current = true;\n          const newNodes = getNewAppNodes(\n            mouseDownEvent,\n            currentMouseEvent,\n            canvasState,\n            clickedNode,\n            multiSelectKeyPressed,\n            activeNodes\n          );\n          updateNodes(\n            newNodes,\n            !config.multiSelectKeys.some((k) => currentMouseEvent[k])\n          );\n        }\n      };\n      const mouseUp = (mouseUpEvent: React.MouseEvent | MouseEvent) => {\n        document.removeEventListener(\"mousemove\", moveNode);\n        document.removeEventListener(\"mouseup\", mouseUp);\n        const newNodes = getNewAppNodes(\n          mouseDownEvent,\n          mouseUpEvent,\n          canvasState,\n          clickedNode,\n          multiSelectKeyPressed,\n          activeNodes\n        );\n        updateNodes(newNodes, !multiSelectKeyPressed);\n        movedRef.current = false;\n      };\n      document.addEventListener(\"mousemove\", moveNode);\n      document.addEventListener(\"mouseup\", mouseUp);\n    },\n    [updateNodes]\n  );\n}\n","import React, { useCallback } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport {\n  drawClearBox,\n  isInsideBox,\n  mouseToNodeCoords,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppNode } from \"../App\";\n\nexport default function useMultiSelect(\n  appNodes: AppNode[],\n  setActiveNodes: (activeNodeIds: string[]) => void,\n  clearAndRedraw: (canvasState: CanvasState) => void\n): (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => void {\n  return useCallback(\n    (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => {\n      const boxStart = mouseToNodeCoords(event, canvasState);\n      const drawBox = (event: React.MouseEvent | MouseEvent) => {\n        if (canvasState.context) {\n          clearAndRedraw(canvasState);\n          drawClearBox(\n            canvasState.context,\n            boxStart,\n            mouseToNodeCoords(event, canvasState),\n            \"grey\"\n          );\n        }\n      };\n      const mouseUp = (event: React.MouseEvent | MouseEvent) => {\n        document.removeEventListener(\"mousemove\", drawBox);\n        document.removeEventListener(\"mouseup\", mouseUp);\n\n        const boxEnd = mouseToNodeCoords(event, canvasState);\n        const activeNodeIds = appNodes\n          .filter(\n            (node) =>\n              isInsideBox(boxStart, boxEnd, node.center) || node.isActive\n          )\n          .map((node) => node.id);\n        setActiveNodes(activeNodeIds);\n      };\n      document.addEventListener(\"mousemove\", drawBox);\n      document.addEventListener(\"mouseup\", mouseUp);\n    },\n    [appNodes, clearAndRedraw, setActiveNodes]\n  );\n}\n","import * as React from \"react\";\nimport { useCallback } from \"react\";\nimport {\n  determineRadius,\n  intersectsCircle,\n  mouseToNodeCoords,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport useAddConnection from \"./useAddConnection\";\nimport useMoveNode from \"./useMoveNode\";\nimport useMultiSelect from \"./useMultiSelect\";\nimport config from \"../config\";\n\nexport default function useOnMouseDown(\n  appNodes: AppNode[],\n  appConnections: AppConnection[],\n  addConnection: (newConnection: AppConnection) => void,\n  updateNodes: (nodesToUpdate: AppNode[], clearActiveNodes?: boolean) => void,\n  setActiveNodes: (activeNodeIds: string[]) => void,\n  clearActiveNodes: () => void,\n  clearAndRedraw: (canvasState: CanvasState) => void\n): (\n  event: React.MouseEvent | MouseEvent,\n  canvasState: CanvasState,\n  defaultBehavior: (event: React.MouseEvent | MouseEvent) => void\n) => void {\n  const makeNewConnection = useAddConnection(\n    appNodes,\n    appConnections,\n    addConnection,\n    clearAndRedraw\n  );\n  const moveNode = useMoveNode(updateNodes);\n  const multiSelect = useMultiSelect(appNodes, setActiveNodes, clearAndRedraw);\n\n  return useCallback(\n    (\n      mouseDownEvent: React.MouseEvent | MouseEvent,\n      canvasState: CanvasState,\n      defaultBehavior: (event: React.MouseEvent | MouseEvent) => void\n    ) => {\n      const nodeCoordsOfMouse = mouseToNodeCoords(mouseDownEvent, canvasState);\n\n      const activeNodes = appNodes.filter((node) => node.isActive);\n      const activeNodeIds = activeNodes.map((node) => node.id);\n\n      // reversing is important here as the last appNodes are painted on top of the first ones\n      const clickedNode = appNodes.reverse().find((node) => {\n        const nodeRadius = determineRadius(\n          node.capacitanceJPerDegK,\n          appNodes.map((node) => node.capacitanceJPerDegK)\n        );\n        return intersectsCircle(nodeCoordsOfMouse, node.center, nodeRadius);\n      });\n\n      if (clickedNode) {\n        if (mouseDownEvent.altKey) {\n          makeNewConnection(mouseDownEvent, clickedNode, canvasState);\n        } else if (\n          config.multiSelectKeys.some((k) => mouseDownEvent[k]) &&\n          activeNodeIds.includes(clickedNode.id)\n        ) {\n          setActiveNodes(activeNodeIds.filter((id) => id !== clickedNode.id));\n        } else {\n          moveNode(mouseDownEvent, clickedNode, activeNodes, canvasState);\n        }\n      } else {\n        if (config.multiSelectKeys.some((k) => mouseDownEvent[k])) {\n          multiSelect(mouseDownEvent, canvasState);\n        } else {\n          // only clear active nodes if click with no pan\n          const onMouseUp = (mouseUpEvent: React.MouseEvent | MouseEvent) => {\n            if (\n              mouseUpEvent.clientX === mouseDownEvent.clientX &&\n              mouseUpEvent.clientY === mouseDownEvent.clientY\n            ) {\n              clearActiveNodes();\n            }\n            document.removeEventListener(\"mouseup\", onMouseUp);\n          };\n          document.addEventListener(\"mouseup\", onMouseUp);\n          defaultBehavior(mouseDownEvent);\n        }\n      }\n    },\n    [\n      appNodes,\n      clearActiveNodes,\n      moveNode,\n      multiSelect,\n      makeNewConnection,\n      setActiveNodes,\n    ]\n  );\n}\n","import * as React from \"react\";\nimport { useRef } from \"react\";\nimport { diffPoints, Point } from \"../utils/pointUtils\";\n\nexport default function useClickAndDragElement(params: {\n  onDragX?: (deltaXPx: number) => void;\n  onDragY?: (deltaYPx: number) => void;\n  constrainX?: (newYPx: number) => number;\n  constrainY?: (newYPx: number) => number;\n}): (mouseDownEvent: React.MouseEvent | MouseEvent) => void {\n  const lastMousePos = useRef<Point | undefined>(undefined);\n\n  const { onDragX, onDragY, constrainX, constrainY } = params;\n\n  const onMouseUp = () => {\n    document.removeEventListener(\"mousemove\", onMouseMove);\n    document.removeEventListener(\"mouseup\", onMouseUp);\n  };\n\n  const onMouseMove = (mouseMoveEvent: React.MouseEvent | MouseEvent) => {\n    if (lastMousePos.current) {\n      const currentMousePos = {\n        x: mouseMoveEvent.pageX,\n        y: mouseMoveEvent.pageY,\n      };\n      const diff = diffPoints(currentMousePos, lastMousePos.current);\n      onDragX && onDragX(diff.x);\n      onDragY && onDragY(diff.y);\n      lastMousePos.current = {\n        x: constrainX ? constrainX(currentMousePos.x) : currentMousePos.x,\n        y: constrainY ? constrainY(currentMousePos.y) : currentMousePos.y,\n      };\n    }\n  };\n\n  return (mouseDownEvent: React.MouseEvent | MouseEvent) => {\n    document.addEventListener(\"mousemove\", onMouseMove);\n    document.addEventListener(\"mouseup\", onMouseUp);\n    lastMousePos.current = { x: mouseDownEvent.pageX, y: mouseDownEvent.pageY };\n  };\n}\n","import * as React from \"react\";\nimport { useCallback, useRef } from \"react\";\nimport useClickAndDragElement from \"./useClickAndDragElement\";\nimport { AppState } from \"../App\";\nimport config from \"../config\";\n\nfunction constrainPanelSize(newPanelSize: number): number {\n  return newPanelSize < config.minPanelFraction\n    ? config.minPanelFraction\n    : newPanelSize > 1 - config.minPanelFraction\n    ? 1 - config.minPanelFraction\n    : newPanelSize;\n}\n\nexport default function useResizablePanels(\n  setAppState: React.Dispatch<React.SetStateAction<AppState>>,\n  windowHeight: number,\n  windowWidth: number\n): [\n  React.MutableRefObject<null>,\n  (mouseDownEvent: MouseEvent | React.MouseEvent<Element, MouseEvent>) => void,\n  React.MutableRefObject<null>,\n  (mouseDownEvent: MouseEvent | React.MouseEvent<Element, MouseEvent>) => void,\n  React.MutableRefObject<null>,\n  (mouseDownEvent: MouseEvent | React.MouseEvent<Element, MouseEvent>) => void\n] {\n  const constrainX = useCallback(\n    (newX: number) => {\n      const minPx = windowWidth * config.minPanelFraction;\n      const maxPx = windowWidth * (1 - config.minPanelFraction);\n      if (newX < minPx) {\n        return minPx;\n      } else if (newX > maxPx) {\n        return maxPx;\n      } else {\n        return newX;\n      }\n    },\n    [windowWidth]\n  );\n\n  const constrainY = useCallback(\n    (newY: number) => {\n      const minPx = windowHeight * config.minPanelFraction;\n      const maxPx = windowHeight * (1 - config.minPanelFraction);\n      if (newY < minPx) {\n        return minPx;\n      } else if (newY > maxPx) {\n        return maxPx;\n      } else {\n        return newY;\n      }\n    },\n    [windowHeight]\n  );\n\n  const canvasPlotBorderRef = useRef(null);\n  const onDragYCanvasPlot = useCallback(\n    (deltaYPx: number) => {\n      setAppState((prevAppState) => ({\n        ...prevAppState,\n        panelSizes: {\n          ...prevAppState.panelSizes,\n          canvasHeightFraction: constrainPanelSize(\n            prevAppState.panelSizes.canvasHeightFraction +\n              deltaYPx / windowHeight\n          ),\n        },\n      }));\n    },\n    [setAppState, windowHeight]\n  );\n  const onMouseDownOnCanvasPlotBorder = useClickAndDragElement({\n    onDragY: onDragYCanvasPlot,\n    constrainY,\n  });\n\n  const leftRightBorderRef = useRef(null);\n  const onDragXLeftRight = useCallback(\n    (deltaXPx: number) => {\n      setAppState((prevAppState) => ({\n        ...prevAppState,\n        panelSizes: {\n          ...prevAppState.panelSizes,\n          editorWidthFraction: constrainPanelSize(\n            prevAppState.panelSizes.editorWidthFraction - deltaXPx / windowWidth\n          ),\n        },\n      }));\n    },\n    [setAppState, windowWidth]\n  );\n  const onMouseDownOnLeftRightBorder = useClickAndDragElement({\n    onDragX: onDragXLeftRight,\n    constrainX,\n  });\n\n  const tableControlsBorderRef = useRef(null);\n  const onDragYTableControls = useCallback(\n    (deltaYPx: number) => {\n      setAppState((prevAppState) => ({\n        ...prevAppState,\n        panelSizes: {\n          ...prevAppState.panelSizes,\n          tableHeightFraction: constrainPanelSize(\n            prevAppState.panelSizes.tableHeightFraction +\n              deltaYPx / windowHeight\n          ),\n        },\n      }));\n    },\n    [setAppState, windowHeight]\n  );\n  const onMouseDownOnTableControlsBorder = useClickAndDragElement({\n    onDragY: onDragYTableControls,\n    constrainY,\n  });\n\n  return [\n    canvasPlotBorderRef,\n    onMouseDownOnCanvasPlotBorder,\n    leftRightBorderRef,\n    onMouseDownOnLeftRightBorder,\n    tableControlsBorderRef,\n    onMouseDownOnTableControlsBorder,\n  ];\n}\n","import * as React from \"react\";\nimport { ModalState } from \"../../App\";\nimport styled from \"styled-components/macro\";\n\nconst StyledConfirmationModal = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin: 2em;\n  justify-content: center;\n  align-items: center;\n  line-height: 1.8em;\n`;\n\nconst StyledConfirmationText = styled.p`\n  margin: 0.8em;\n  font-size: 1.5em;\n  font-weight: bold;\n  max-width: 800px;\n  text-align: center;\n`;\n\nconst StyledConfirmationButtons = styled.div`\n  display: flex;\n`;\n\nconst StyledConfirmationButton = styled.button`\n  font-size: 1.5em;\n  margin-left: 1em;\n  margin-right: 1em;\n  min-width: 100px;\n`;\n\ntype ConfirmationModalProps = {\n  modalState: ModalState;\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n};\n\nexport default function ConfirmationModal(\n  props: ConfirmationModalProps\n): React.ReactElement {\n  const { modalState, setModalState } = props;\n\n  return (\n    <StyledConfirmationModal>\n      {modalState.confirmText &&\n        modalState.confirmText.map((text) => (\n          <StyledConfirmationText key={text}>{text}</StyledConfirmationText>\n        ))}\n      <StyledConfirmationButtons>\n        <StyledConfirmationButton\n          onClick={() => setModalState((prev) => ({ ...prev, visible: false }))}\n        >\n          No\n        </StyledConfirmationButton>\n        <StyledConfirmationButton\n          onClick={() => {\n            modalState.onConfirm && modalState.onConfirm();\n            setModalState((prev) => ({ ...prev, visible: false }));\n          }}\n        >\n          Yes\n        </StyledConfirmationButton>\n      </StyledConfirmationButtons>\n    </StyledConfirmationModal>\n  );\n}\n","import * as React from \"react\";\nimport { MathComponent } from \"mathjax-react\";\nimport {\n  StyledLink,\n  StyledListItem,\n  StyledModalContent,\n  StyledSubTitle,\n  StyledText,\n  StyledTitle,\n} from \"./style\";\n\nexport default function TheoryModal(): React.ReactElement {\n  return (\n    <StyledModalContent>\n      <StyledTitle>How Does thermalmodel.com Work?</StyledTitle>\n\n      <StyledText>\n        The model used by thermalmodel.com is a linear{\" \"}\n        <StyledLink\n          href={\"https://en.wikipedia.org/wiki/State-space_representation\"}\n          target={\"_blank\"}\n        >\n          state space\n        </StyledLink>{\" \"}\n        model based off conservation of heat flow:{\" \"}\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`\\sum{q_{in/out}} + \\sum{q_{generated/consumed}} = 0`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\sum{q_{in/out}}`} />{\" \"}\n          is the sum of all heat transfer in or out, in Watts{\" \"}\n          <MathComponent display={false} tex={String.raw`[W]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent\n            display={false}\n            tex={String.raw`\\sum{q_{generated/consumed}}`}\n          />{\" \"}\n          is the sum of all heat generated or consumed, in Watts{\" \"}\n          <MathComponent display={false} tex={String.raw`[W]`} />\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        The class of model is referred to as a{\" \"}\n        <StyledLink\n          href={\n            \"https://en.wikipedia.org/wiki/Lumped-element_model#Thermal_systems\"\n          }\n          target={\"_blank\"}\n        >\n          Lumped-Element model\n        </StyledLink>\n        , which produces accurate results when each &quot;lump&quot;, or in the\n        terminology of this website, &quot;node&quot;, can be assumed to have\n        uniform temperature. A node can be assumed to be uniform temperature\n        when the diffusion of heat within it is much greater than the transfer\n        of heat into or out of it. This is quantified by a small{\" \"}\n        <StyledLink\n          href={\"https://en.wikipedia.org/wiki/Biot_number\"}\n          target={\"_blank\"}\n        >\n          Biot number\n        </StyledLink>\n        .\n      </StyledText>\n\n      <StyledText>\n        What follows is the definition and manipulation of fundamental heat\n        transfer equations into the numerical form thermalmodel.com uses to\n        calculate node temperatures when it runs a model.\n      </StyledText>\n\n      <StyledSubTitle>\n        Fourier&apos;s Law and Thermal Conductance\n      </StyledSubTitle>\n      <StyledText>\n        <StyledLink\n          href={\n            \"https://en.wikipedia.org/wiki/Thermal_conduction#Fourier's_law\"\n          }\n          target={\"_blank\"}\n        >\n          Fourier&apos;s Law in 1 dimension\n        </StyledLink>{\" \"}\n        states:\n      </StyledText>\n\n      <MathComponent display={true} tex={String.raw`q =-c \\Delta T`} />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`q`} /> is heat\n          transfer, in Watts{\" \"}\n          <MathComponent display={false} tex={String.raw`[W]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`c`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_contact_conductance\"}\n            target={\"_blank\"}\n          >\n            Thermal Conductance\n          </StyledLink>{\" \"}\n          or{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_transmittance\"}\n            target={\"_blank\"}\n          >\n            Thermal Transmittance,\n          </StyledLink>{\" \"}\n          in Watts per degree Kelvin{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{W}{K}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta T`} /> is the\n          temperature difference, in degrees{\" \"}\n          <MathComponent display={false} tex={String.raw`[K]`} />\n        </StyledListItem>\n      </ul>\n\n      <StyledSubTitle>Thermal Resistance</StyledSubTitle>\n      <StyledText>\n        The reciprocal of Thermal Conductance is{\" \"}\n        <StyledLink\n          href={\"https://en.wikipedia.org/wiki/Thermal_resistance\"}\n          target={\"_blank\"}\n        >\n          Thermal Resistance\n        </StyledLink>{\" \"}\n        , <MathComponent display={false} tex={String.raw`R = \\frac{1}{c}`} />,\n        measured in degrees Kelvin per Watt{\" \"}\n        <MathComponent display={false} tex={String.raw`[\\frac{K}{W}]`} />. A\n        given object or material&apos;s Thermal Resistance can be thought of as\n        the temperature difference required to get one Watt of heat to flow\n        through it. A material with a higher Thermal Resistance requires a\n        higher temperature difference across it to achieve the same heat flow as\n        one with a lower Thermal Resistance.\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`q = -\\frac{\\Delta T}{R} \\space\\space\\space[1]`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`q`} /> is heat\n          transfer, in Watts{\" \"}\n          <MathComponent display={false} tex={String.raw`[W]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta T`} /> is the\n          temperature difference, in degrees{\" \"}\n          <MathComponent display={false} tex={String.raw`[K]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`R`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_resistance\"}\n            target={\"_blank\"}\n          >\n            Thermal Resistance\n          </StyledLink>\n          , in degrees Kelvin per Watt{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{K}{W}]`} />\n        </StyledListItem>\n      </ul>\n\n      <StyledSubTitle>Thermal Capacitance</StyledSubTitle>\n      <StyledText>\n        <StyledLink\n          href={\"https://en.wikipedia.org/wiki/Heat_capacity\"}\n          target={\"_blank\"}\n        >\n          Thermal Capacitance\n        </StyledLink>{\" \"}\n        (different than Thermal Conductance above) can be thought of as the\n        amount of heat energy absorbed by an object to increase its temperature\n        by 1 degree:\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`C = \\lim_{\\Delta T \\to 0} \\frac{Q}{\\Delta T} = \\frac{dQ}{dT}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`C`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Heat_capacity\"}\n            target={\"_blank\"}\n          >\n            Thermal Capacitance\n          </StyledLink>{\" \"}\n          , or Heat Capacity, in Joules per degree Kelvin{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{J}{K}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`Q`} /> is heat\n          transfer, in Joules{\" \"}\n          <MathComponent display={false} tex={String.raw`[J]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta T`} /> is the\n          temperature difference, in degrees{\" \"}\n          <MathComponent display={false} tex={String.raw`[K]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\frac{dQ}{dT}`} /> is\n          the rate of change of heat energy with respect to temperature, in\n          Joules per degree{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{J}{K}]`} />\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        Rearranging and differentiating the equation above with respect to time,\n        we obtain the following:\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`q = C \\frac{dT}{dt} \\space\\space\\space[2]`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`q`} /> is heat\n          transfer, in Watts (i.e. Joules per second){\" \"}\n          <MathComponent display={false} tex={String.raw`[W = \\frac{J}{s}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`C`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Heat_capacity\"}\n            target={\"_blank\"}\n          >\n            Thermal Capacitance\n          </StyledLink>{\" \"}\n          , or Heat Capacity, in Joules per degree Kelvin{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{J}{K}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\frac{dT}{dt}`} /> is\n          the derivative of temperature with respect to time, in degrees per\n          second{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{K}{s}]`} />\n        </StyledListItem>\n      </ul>\n\n      <StyledSubTitle>Model Equation</StyledSubTitle>\n      <StyledText>\n        We now have two equations for{\" \"}\n        <MathComponent display={false} tex={String.raw`q`} />, heat transfer, in\n        Watts. Equating these, working out the signs, and adding in power\n        generated or consumed, we obtain the following:\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`C \\frac{dT}{dt} = \\sum{\\frac{\\Delta T}{R}} - q_{generated/consumed}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`C`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Heat_capacity\"}\n            target={\"_blank\"}\n          >\n            Thermal Capacitance\n          </StyledLink>{\" \"}\n          , or Heat Capacity, in Joules per degree Kelvin{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{J}{K}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\frac{dT}{dt}`} /> is\n          the derivative of temperature with respect to time, in degrees per\n          second{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{K}{s}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta T`} /> is the\n          temperature difference, in degrees{\" \"}\n          <MathComponent display={false} tex={String.raw`[K]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`R`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_resistance\"}\n            target={\"_blank\"}\n          >\n            Thermal Resistance\n          </StyledLink>\n          , in degrees Kelvin per Watt{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{K}{W}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent\n            display={false}\n            tex={String.raw`q_{generated/consumed}`}\n          />{\" \"}\n          is the net heat generated or consumed, in Watts{\" \"}\n          <MathComponent display={false} tex={String.raw`[W]`} />\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        This partial differential equation can be simplified to a numerical\n        equation. The results of the equation are reasonable when the time step\n        size between discrete states is small. You&apos;ll notice that if you\n        rerun a model with too large a time step too much, unstable results\n        appear - at too high a time step size, errors compound at each step and\n        blow up the temperature differences to unreasonable numbers. If you see\n        instability, decrease the time step size and rerun your model.\n      </StyledText>\n\n      <StyledText>\n        Assuming small time steps, this equation holds for each node in the\n        model:\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`\\Delta T_{node} = \\frac{\\Delta{t}}{C_{node}}\\left(\\sum{\\frac{T_{other\\_node} - T_{node}}{R_{other\\_node \\leftrightarrow node}}} - q_{generated/consumed}\\right)`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta{T}_{node}`} />{\" \"}\n          is the change in temperature of the node of interest at that time\n          step, in degrees{\" \"}\n          <MathComponent display={false} tex={String.raw`[K]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta{t}`} /> is the\n          time step, in seconds{\" \"}\n          <MathComponent display={false} tex={String.raw`[s]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`C_{node}`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Heat_capacity\"}\n            target={\"_blank\"}\n          >\n            Thermal Capacitance\n          </StyledLink>{\" \"}\n          , or Heat Capacity, of the node of interest, in Joules per degree\n          Kelvin{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{J}{K}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`T_{other\\_node}`} /> is\n          the current temperature of a node that is thermally connected with the\n          node of interest, in degrees{\" \"}\n          <MathComponent display={false} tex={String.raw`[K]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`T_{node}`} /> is the\n          current temperature the node of interest, in degrees{\" \"}\n          <MathComponent display={false} tex={String.raw`[K]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent\n            display={false}\n            tex={String.raw`R_{other\\_node \\leftrightarrow node}`}\n          />{\" \"}\n          is the{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_resistance\"}\n            target={\"_blank\"}\n          >\n            Thermal Resistance\n          </StyledLink>{\" \"}\n          between the two thermally connected nodes, in degrees Kelvin per Watt\n          <MathComponent display={false} tex={String.raw`[\\frac{K}{W}]`} /> if\n          conduction or convection, or in degrees Kelvin to the fourth per Watt\n          <MathComponent display={false} tex={String.raw`[\\frac{K^4}{W}]`} /> if\n          radiation\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent\n            display={false}\n            tex={String.raw`q_{generated/consumed}`}\n          />{\" \"}\n          is the net heat generated or consumed by the node of interest, in\n          Watts <MathComponent display={false} tex={String.raw`[W]`} />\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        Under the hood, thermalmodel.com solves the above equation for each node\n        at each timestep, resulting in a set of temperature values for each node\n        at each timestep over the duration of the model.\n      </StyledText>\n\n      <StyledText>\n        Fixed temperature, i.e. boundary condition nodes do not change\n        temperature over time. They influence nodes that are thermally connected\n        to them, but their calculated temperature difference at each time step\n        is discarded rather than added to their previous temperature.\n      </StyledText>\n\n      <StyledText>\n        The source code for the model can be seen{\" \"}\n        <StyledLink\n          href={\n            \"https://github.com/robinovitch61/thermalmodel.com/tree/main/packages/hotstuff-network\"\n          }\n          target={\"_blank\"}\n        >\n          here as a standalone Javascript package on npm\n        </StyledLink>\n        .\n      </StyledText>\n    </StyledModalContent>\n  );\n}\n","import * as React from \"react\";\nimport { MathComponent } from \"mathjax-react\";\nimport {\n  StyledLink,\n  StyledListItem,\n  StyledModalContent,\n  StyledSubTitle,\n  StyledText,\n  StyledTitle,\n} from \"./style\";\n\nexport default function TutorialModal(): React.ReactElement {\n  return (\n    <StyledModalContent>\n      <StyledTitle>How to Use This Website</StyledTitle>\n\n      <StyledSubTitle>Canvas Controls</StyledSubTitle>\n      <ul>\n        <li>Click a node to select it</li>\n        <li>Click and drag a node to move it</li>\n        <li>Double click a node to move the label position</li>\n        <li>Delete to remove selected nodes</li>\n        <li>Meta + Click and drag to select multiple nodes</li>\n        <li>Meta + A to select all nodes</li>\n        <li>Escape to deselect all nodes</li>\n        <li>Meta + C to copy selected nodes</li>\n        <li>Meta + V to paste copied nodes</li>\n        <li>Double click to add a new node</li>\n        <li>\n          Hold Alt and click, drag, and release between nodes to connect them\n        </li>\n        <li>\n          Edit or add node and connection properties in the tables on the right\n        </li>\n        <li>Click Run Model to view results in graphs on bottom left</li>\n        <li>Connection thicknesses represent relative thermal resistance</li>\n        <li>Node colors represent relative initial temperatures</li>\n      </ul>\n\n      <StyledSubTitle>Thermal Resistance Calculation</StyledSubTitle>\n      <StyledText>\n        Nodes can be thermally connected through Conduction, Convection, or\n        Radiation, and potentially have more than one thermal connection type at\n        once, e.g. a conductive connection and a radiative connection. The user\n        should calculate thermal resistance differently depending on the type of\n        connection, as follows:\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`R_{conduction} = \\frac{L}{kA} \\quad \\text{units:} \\Big{[}\\frac{K}{W}\\Big{]}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`L`} /> is the\n          conduction length, in meters{\" \"}\n          <MathComponent display={false} tex={String.raw`[m]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`k`} /> is the{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_conductivity\"}\n            target={\"_blank\"}\n          >\n            Thermal Conductivity\n          </StyledLink>\n          , in Watts per meter per degrees Kelvin{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{W}{mK}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`A`} /> is the\n          conduction area, in meters squared{\" \"}\n          <MathComponent display={false} tex={String.raw`[m^2]`} />\n        </StyledListItem>\n      </ul>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`R_{convection} = \\frac{1}{hA} \\quad \\text{units:} \\Big{[}\\frac{K}{W}\\Big{]}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`h`} /> is the{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Heat_transfer_coefficient\"}\n            target={\"_blank\"}\n          >\n            Convective Heat Transfer Coefficient\n          </StyledLink>\n          , in Watts per meters squared per degrees Kelvin{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{W}{m^2K}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`A`} /> is the\n          convection area, in meters squared{\" \"}\n          <MathComponent display={false} tex={String.raw`[m^2]`} />\n        </StyledListItem>\n      </ul>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`R_{radiation} = \\frac{1}{\\epsilon \\sigma A} \\quad \\text{units:} \\Big{[}\\frac{K^4}{W}\\Big{]}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\epsilon`} /> is the{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Emissivity\"}\n            target={\"_blank\"}\n          >\n            Emissivity\n          </StyledLink>\n          , a unit-less quantity\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\sigma`} /> is the{\" \"}\n          <StyledLink\n            href={\n              \"https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_constant\"\n            }\n            target={\"_blank\"}\n          >\n            Stefan-Boltzmann constant\n          </StyledLink>\n          ,{\" \"}\n          <MathComponent display={false} tex={String.raw`5.67 \\cdot 10^{−8}`} />{\" \"}\n          Watts per meters squared per degrees Kelvin to the fourth{\" \"}\n          <MathComponent display={false} tex={String.raw`[\\frac{W}{m^2K^4}]`} />\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`A`} /> is the radiation\n          area, in meters squared{\" \"}\n          <MathComponent display={false} tex={String.raw`[m^2]`} />\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        In building your model, you&apos;re responsible for determining thermal\n        resistances between nodes, thermal capacitances of nodes, and power\n        generation or consumption in each node in your model. From there,\n        thermalmodel.com will do the rest.\n      </StyledText>\n    </StyledModalContent>\n  );\n}\n","import * as React from \"react\";\nimport { useRef } from \"react\";\nimport { ModalState } from \"../../App\";\nimport styled from \"styled-components/macro\";\nimport useOnClickOutside from \"../../hooks/useOnClickOutside\";\nimport ConfirmationModal from \"./ConfirmationModal\";\nimport TheoryModal from \"./TheoryModal\";\nimport { StyledExitButton } from \"./style\";\nimport CrossMark from \"../../img/icons/CrossMark\";\nimport TutorialModal from \"./TutorialModal\";\nimport config from \"../../config\";\n\nconst StyledModal = styled.div<{ visible: boolean }>`\n  font-size: 1.1em;\n  line-height: 1.4em;\n  position: absolute;\n  width: 80vw;\n  height: 90vh;\n  max-width: 1400px;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  border: ${config.borderWidthPx}px solid black;\n  z-index: 10;\n  background: white;\n  display: ${(props) => (props.visible ? \"flex\" : \"none\")};\n  justify-content: center;\n  align-items: center;\n`;\n\nfunction getModalContent(\n  modalState: ModalState,\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>\n): React.ReactElement {\n  const type = modalState.type;\n\n  if (type === \"confirm\") {\n    return (\n      <ConfirmationModal\n        modalState={modalState}\n        setModalState={setModalState}\n      />\n    );\n  } else if (type === \"theory\") {\n    return <TheoryModal />;\n  } else if (type === \"tutorial\") {\n    return <TutorialModal />;\n  } else {\n    return <h1>Coming Soon</h1>;\n  }\n}\n\ntype ModalProps = {\n  modalState: ModalState;\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n};\n\nexport default function Modal(props: ModalProps): React.ReactElement {\n  const { modalState, setModalState } = props;\n\n  const modalRef = useRef<HTMLDivElement>(null);\n  useOnClickOutside(modalRef, () =>\n    setModalState((prev) => ({ ...prev, visible: false }))\n  );\n\n  const modalContent = getModalContent(modalState, setModalState);\n\n  return (\n    <StyledModal ref={modalRef} visible={modalState.visible}>\n      <StyledExitButton\n        onClick={() =>\n          setModalState((prevState) => ({\n            ...prevState,\n            visible: false,\n          }))\n        }\n      >\n        <CrossMark />\n      </StyledExitButton>\n      {modalContent}\n    </StyledModal>\n  );\n}\n","import * as React from \"react\";\nimport { ModalState } from \"../../App\";\nimport styled from \"styled-components/macro\";\nimport { StyledButton } from \"../../style\";\n\nconst StyledModalControls = styled.div``;\n\nconst StyledModalControlButton = styled(StyledButton)`\n  margin-right: 1em;\n`;\n\ntype ModalControlsProps = {\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n};\n\nexport default function ModalControls(\n  props: ModalControlsProps\n): React.ReactElement {\n  const { setModalState } = props;\n\n  return (\n    <StyledModalControls>\n      <StyledModalControlButton\n        onClick={() => setModalState({ visible: true, type: \"theory\" })}\n      >\n        Theory\n      </StyledModalControlButton>\n      <StyledModalControlButton\n        onClick={() => setModalState({ visible: true, type: \"tutorial\" })}\n      >\n        Tutorial\n      </StyledModalControlButton>\n      <StyledModalControlButton\n        onClick={() => setModalState({ visible: true, type: \"about\" })}\n      >\n        About\n      </StyledModalControlButton>\n    </StyledModalControls>\n  );\n}\n","export default __webpack_public_path__ + \"static/media/thermalmodel-logo.ee237af3.png\";","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport logo from \"../../img/thermalmodel-logo.png\";\nimport config from \"../../config\";\n\nconst StyledImg = styled.img`\n  height: ${config.headerHeightPx}px;\n  padding: 3px;\n`;\n\nexport default function Logo(): React.ReactElement {\n  return <StyledImg src={logo} />;\n}\n","import styled from \"styled-components/macro\";\nimport config from \"../../config\";\n\nexport const StyledHeader = styled.div<{ height: number }>`\n  height: ${(props) => props.height}px;\n  //border-bottom: ${config.borderWidthPx}px solid black;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: ${config.lightGrey};\n`;\n","import { HSConnection, HSNode, ModelOutput, run } from \"hotstuff-network\";\nimport React, { useCallback, useMemo, useState } from \"react\";\nimport { Point } from \"./utils/pointUtils\";\nimport Sidebar from \"./components/Sidebar/Sidebar\";\nimport Plot from \"./components/Plot/Plot\";\nimport useWindowSize from \"./components/Canvas/hooks/useWindowSize\";\nimport Canvas, { CanvasViewState } from \"./components/Canvas/Canvas\";\nimport useDraw from \"./hooks/useDraw\";\nimport useDoubleClick from \"./hooks/useDoubleClick\";\nimport useNodeConnectionUtils from \"./hooks/useNodeConnectionUtils\";\nimport useOnMouseDown from \"./hooks/useOnMouseDown\";\nimport useKeyDown from \"./hooks/useKeyDown\";\nimport {\n  defaultAppClipboard,\n  defaultAppState,\n  defaultModalState,\n} from \"./default\";\nimport useSessionStorageState from \"./hooks/useSessionStorageState\";\nimport { getCanvasCenter } from \"./components/Canvas/canvasUtils\";\nimport {\n  getNewAppNode,\n  getNewPossibleConnection,\n} from \"./utils/nodeConnectionUtils\";\nimport useAppStateModifiers from \"./hooks/useAppStateModifiers\";\nimport useResizablePanels from \"./hooks/useResizablePanels\";\nimport {\n  StyledApp,\n  StyledCanvas,\n  StyledHorizontalBorder,\n  StyledVerticalBorder,\n  StyledWorkspace,\n} from \"./style\";\nimport Modal from \"./components/Modal/Modal\";\nimport ErrorModal from \"./components/Modal/ErrorModal\";\nimport useTemporaryError from \"./components/Sidebar/hooks/useTemporaryError\";\nimport config from \"./config\";\nimport ModalControls from \"./components/Header/ModalControls\";\nimport Logo from \"./components/Header/Logo\";\nimport { StyledHeader } from \"./components/Header/style\";\n\nexport type Direction = \"L\" | \"R\" | \"U\" | \"D\";\n\nexport type AppNode = HSNode & {\n  center: Point;\n  isActive: boolean;\n  textDirection: Direction;\n  nodeNotes: string;\n};\n\nexport type AppConnection = HSConnection & {\n  firstNodeId: string; // duplicated data here to make working with tables easier\n  secondNodeId: string; // duplicated data here to make working with tables easier\n  connectionNotes: string;\n};\n\nexport type Timing = {\n  timeStepS: number;\n  totalTimeS: number;\n};\n\nexport type PanelSizes = {\n  editorWidthFraction: number;\n  canvasHeightFraction: number;\n  tableHeightFraction: number;\n};\n\nexport type ModalType = \"theory\" | \"tutorial\" | \"about\" | \"confirm\";\n\nexport type ModalState = {\n  visible: boolean;\n  type: ModalType;\n  onConfirm?: () => void;\n  confirmText?: string[];\n};\n\nexport type AppState = {\n  timing: Timing;\n  nodes: AppNode[];\n  connections: AppConnection[];\n  canvasViewState: CanvasViewState;\n  savedCanvasState: CanvasViewState;\n  panelSizes: PanelSizes;\n};\n\nexport type AppClipboard = {\n  copiedNodes: AppNode[];\n  copiedConnections: AppConnection[];\n};\n\nexport type ExportedAppState = AppState & { output?: ModelOutput };\n\nexport default function App(): React.ReactElement {\n  const [appState, setAppState] = useSessionStorageState<AppState>(\n    defaultAppState,\n    \"thermalModelAppState\"\n  );\n  const [output, setOutput] = useState<ModelOutput | undefined>(undefined);\n  const [modalState, setModalState] = useState<ModalState>(defaultModalState);\n  const [appErrors, setAppErrors, setTemporaryAppErrors] = useTemporaryError();\n\n  const [\n    setAppNodes,\n    setAppConnections,\n    setCanvasViewState,\n    setSavedCanvasState,\n    setTiming,\n  ] = useAppStateModifiers(setAppState, setOutput);\n\n  const [\n    addNode,\n    addConnection,\n    updateNodes,\n    deleteNodes,\n    updateConnections,\n    deleteConnections,\n    setActiveNodes,\n    clearActiveNodes,\n  ] = useNodeConnectionUtils(\n    appState.nodes,\n    setAppNodes,\n    appState.connections,\n    setAppConnections,\n    setOutput\n  );\n\n  const [keyboardActive, setKeyboardActive] = useState<boolean>(true);\n  const [clipboard, setClipboard] = useState<AppClipboard>(defaultAppClipboard);\n  useKeyDown(\n    keyboardActive,\n    appState.nodes,\n    setAppNodes,\n    deleteNodes,\n    appState.connections,\n    setAppConnections,\n    clipboard,\n    setClipboard\n  );\n\n  const [draw, clearAndRedraw] = useDraw(appState.nodes, appState.connections);\n  const handleDoubleClick = useDoubleClick(\n    appState.nodes,\n    addNode,\n    updateNodes\n  );\n  const onMouseDown = useOnMouseDown(\n    appState.nodes,\n    appState.connections,\n    addConnection,\n    updateNodes,\n    setActiveNodes,\n    clearActiveNodes,\n    clearAndRedraw\n  );\n\n  const [size, ratio] = useWindowSize();\n  const [windowWidth, windowHeight] = size;\n\n  const [\n    canvasPlotBorderRef,\n    onMouseDownOnCanvasPlotBorder,\n    leftRightBorderRef,\n    onMouseDownOnLeftRightBorder,\n    tableControlsBorderRef,\n    onMouseDownOnTableControlsBorder,\n  ] = useResizablePanels(setAppState, windowHeight, windowWidth);\n\n  // widthPercent/heights\n  const workspaceWidth = windowWidth;\n  const workspaceHeight = windowHeight;\n  const headerHeight = config.headerHeightPx;\n  const canvasHeight =\n    windowHeight * appState.panelSizes.canvasHeightFraction - headerHeight;\n  const canvasWidth =\n    windowWidth * (1 - appState.panelSizes.editorWidthFraction);\n  const plotHeight =\n    (1 - appState.panelSizes.canvasHeightFraction) * windowHeight -\n    config.tabHeightPx -\n    config.plotHeightBufferPx;\n  const plotWidth = canvasWidth;\n  const editorWidth = appState.panelSizes.editorWidthFraction * windowWidth;\n\n  const plot = useMemo(() => {\n    return (\n      <Plot\n        plotDimensions={{\n          height: plotHeight,\n          width: plotWidth,\n          margin: config.plotMargin,\n        }}\n        modelOutput={output}\n      />\n    );\n  }, [output, plotHeight, plotWidth]);\n\n  const addNodeInCenterOfCanvas = useCallback(() => {\n    addNode(\n      getNewAppNode(\n        appState.nodes,\n        getCanvasCenter(\n          canvasWidth,\n          canvasHeight,\n          appState.canvasViewState.offset,\n          appState.canvasViewState.scale\n        )\n      )\n    );\n  }, [\n    addNode,\n    appState.canvasViewState.offset,\n    appState.canvasViewState.scale,\n    appState.nodes,\n    canvasHeight,\n    canvasWidth,\n  ]);\n\n  const createNewLogicalConnection = useCallback(() => {\n    const newConnection = getNewPossibleConnection(\n      appState.nodes,\n      appState.connections\n    );\n    if (newConnection !== undefined) {\n      addConnection(newConnection);\n    }\n  }, [addConnection, appState.connections, appState.nodes]);\n\n  return (\n    <div>\n      <Modal modalState={modalState} setModalState={setModalState} />\n      <ErrorModal errors={appErrors} setErrors={setAppErrors} />\n      <StyledApp height={windowHeight} modalOpen={modalState.visible}>\n        <StyledHorizontalBorder\n          ref={canvasPlotBorderRef}\n          onMouseDown={onMouseDownOnCanvasPlotBorder}\n          y={appState.panelSizes.canvasHeightFraction}\n          width={1 - appState.panelSizes.editorWidthFraction}\n          left={0}\n        />\n        <StyledVerticalBorder\n          ref={leftRightBorderRef}\n          onMouseDown={onMouseDownOnLeftRightBorder}\n          x={1 - appState.panelSizes.editorWidthFraction}\n        />\n        <StyledHorizontalBorder\n          ref={tableControlsBorderRef}\n          onMouseDown={onMouseDownOnTableControlsBorder}\n          y={appState.panelSizes.tableHeightFraction}\n          width={appState.panelSizes.editorWidthFraction}\n          left={1 - appState.panelSizes.editorWidthFraction}\n        />\n\n        <StyledWorkspace\n          height={workspaceHeight}\n          width={(1 - appState.panelSizes.editorWidthFraction) * workspaceWidth}\n        >\n          <StyledHeader height={headerHeight}>\n            <Logo />\n            <ModalControls setModalState={setModalState} />\n          </StyledHeader>\n          <StyledCanvas height={canvasHeight}>\n            <Canvas\n              canvasWidth={canvasWidth}\n              canvasHeight={canvasHeight}\n              devicePixelRatio={ratio}\n              draw={draw}\n              onMouseDown={onMouseDown}\n              handleDoubleClick={handleDoubleClick}\n              canvasViewState={appState.canvasViewState}\n              setCanvasViewState={setCanvasViewState}\n              savedCanvasViewState={appState.savedCanvasState}\n              setSavedCanvasViewState={setSavedCanvasState}\n              setKeyboardActive={setKeyboardActive}\n            />\n          </StyledCanvas>\n          {plot}\n        </StyledWorkspace>\n        <Sidebar\n          appState={appState}\n          setAppState={setAppState}\n          setOutput={setOutput}\n          setModalState={setModalState}\n          height={windowHeight}\n          width={editorWidth}\n          setTiming={setTiming}\n          onAddNode={addNodeInCenterOfCanvas}\n          onAddConnection={createNewLogicalConnection}\n          updateNodes={(nodes: AppNode[]) => {\n            updateNodes(nodes);\n            setOutput(undefined);\n          }}\n          deleteNodes={deleteNodes}\n          setActiveNodes={setActiveNodes}\n          updateConnections={(conns: AppConnection[]) => {\n            updateConnections(conns);\n            setOutput(undefined);\n          }}\n          deleteConnections={deleteConnections}\n          onRunModel={() => {\n            const output = run({\n              nodes: appState.nodes,\n              connections: appState.connections,\n              timeStepS: appState.timing.timeStepS,\n              totalTimeS: appState.timing.totalTimeS,\n            });\n            if (output.errors?.length) {\n              setTemporaryAppErrors(output.errors.map((err) => err.message));\n            }\n            setOutput(output);\n            return output;\n          }}\n        />\n      </StyledApp>\n    </div>\n  );\n}\n","import * as React from \"react\";\n\nexport default function useSessionStorageState<T>(\n  defaultValue: T,\n  key: string\n): [T, React.Dispatch<React.SetStateAction<T>>] {\n  const [value, setValue] = React.useState<T>(() => {\n    const localState = window.sessionStorage.getItem(key);\n    if (localState === null || localState === undefined) {\n      return defaultValue;\n    } else {\n      return JSON.parse(localState) as T;\n    }\n  });\n\n  React.useEffect(() => {\n    window.sessionStorage.setItem(key, JSON.stringify(value));\n  }, [key, value]);\n  return [value, setValue];\n}\n","import * as React from \"react\";\nimport { useCallback } from \"react\";\nimport { CanvasViewState } from \"../components/Canvas/Canvas\";\nimport { ModelOutput } from \"hotstuff-network\";\nimport { AppConnection, AppNode, AppState, Timing } from \"../App\";\n\nexport default function useAppStateModifiers(\n  setAppState: React.Dispatch<React.SetStateAction<AppState>>,\n  setOutput: React.Dispatch<React.SetStateAction<ModelOutput | undefined>>\n): [\n  (newNodes: AppNode[]) => void,\n  (newConnections: AppConnection[]) => void,\n  (newCanvasState: CanvasViewState) => void,\n  (newCanvasState: CanvasViewState) => void,\n  (newTiming: Timing) => void\n] {\n  const setAppNodes = useCallback(\n    (newNodes: AppNode[]) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        nodes: newNodes,\n      }));\n    },\n    [setAppState]\n  );\n\n  const setAppConnections = useCallback(\n    (newConnections: AppConnection[]) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        connections: newConnections,\n      }));\n    },\n    [setAppState]\n  );\n\n  const setCanvasViewState = useCallback(\n    (newCanvasState: CanvasViewState) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        canvasViewState: newCanvasState,\n      }));\n    },\n    [setAppState]\n  );\n\n  const setSavedCanvasState = useCallback(\n    (newSavedCanvasState: CanvasViewState) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        savedCanvasState: newSavedCanvasState,\n      }));\n    },\n    [setAppState]\n  );\n\n  const setTiming = useCallback(\n    (newTiming: Timing) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        timing: newTiming,\n      }));\n      setOutput(undefined);\n    },\n    [setAppState, setOutput]\n  );\n\n  return [\n    setAppNodes,\n    setAppConnections,\n    setCanvasViewState,\n    setSavedCanvasState,\n    setTiming,\n  ];\n}\n","import * as React from \"react\";\nimport { useCallback } from \"react\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { ModelOutput } from \"hotstuff-network\";\n\nexport default function useNodeConnectionUtils(\n  appNodes: AppNode[],\n  setAppNodes: (newNodes: AppNode[]) => void,\n  appConnections: AppConnection[],\n  setAppConnections: (newConnections: AppConnection[]) => void,\n  setOutput: React.Dispatch<React.SetStateAction<ModelOutput | undefined>>\n): [\n  (node: AppNode) => void,\n  (connection: AppConnection) => void,\n  (nodesToUpdate: AppNode[], clearActiveNodes?: boolean) => void,\n  (nodeIds: string[]) => void,\n  (connsToUpdate: AppConnection[]) => void,\n  (connIds: string[]) => void,\n  (activeNodeIds: string[]) => void,\n  () => void\n] {\n  const addNode = useCallback(\n    (node: AppNode) => {\n      const newNodes = appNodes.map((node) => ({\n        ...node,\n        isActive: false,\n      }));\n      newNodes.push({ ...node, isActive: true });\n      setAppNodes(newNodes);\n      setOutput(undefined);\n    },\n    [appNodes, setAppNodes, setOutput]\n  );\n\n  const addConnection = useCallback(\n    (connection: AppConnection) => {\n      setAppConnections([...appConnections, connection]);\n      setOutput(undefined);\n    },\n    [appConnections, setAppConnections, setOutput]\n  );\n\n  const updateNodes = useCallback(\n    (nodesToUpdate: AppNode[], clearActiveNodes = false) => {\n      const newNodes = appNodes.map((node) => {\n        const nodeToUpdate = nodesToUpdate.find(\n          (newNode) => newNode.id === node.id\n        );\n        if (nodeToUpdate) {\n          return nodeToUpdate;\n        } else {\n          if (clearActiveNodes) {\n            return { ...node, isActive: false };\n          } else {\n            return node;\n          }\n        }\n      });\n      setAppNodes(newNodes);\n\n      const newConnections = appConnections.map((prevConn) => {\n        const newfirstNodeNode = nodesToUpdate.find(\n          (nodeToUpdate) => prevConn.firstNode.id == nodeToUpdate.id\n        );\n        if (newfirstNodeNode) {\n          return {\n            ...prevConn,\n            firstNode: newfirstNodeNode,\n            firstNodeId: newfirstNodeNode.id,\n          };\n        }\n\n        const newsecondNodeNode = nodesToUpdate.find(\n          (nodeToUpdate) => prevConn.secondNode.id == nodeToUpdate.id\n        );\n        if (newsecondNodeNode) {\n          return {\n            ...prevConn,\n            secondNode: newsecondNodeNode,\n            secondNodeId: newsecondNodeNode.id,\n          };\n        }\n        return prevConn;\n      });\n      setAppConnections(newConnections);\n    },\n    [appConnections, appNodes, setAppConnections, setAppNodes]\n  );\n\n  const deleteNodes = useCallback(\n    (nodeIds: string[]) => {\n      const newConnections = appConnections.filter(\n        (conn) =>\n          !nodeIds.includes(conn.firstNode.id) &&\n          !nodeIds.includes(conn.secondNode.id)\n      );\n      setAppConnections(newConnections);\n      setOutput(undefined);\n\n      const newNodes = appNodes.filter((node) => !nodeIds.includes(node.id));\n      setAppNodes(newNodes);\n    },\n    [appConnections, appNodes, setAppConnections, setAppNodes, setOutput]\n  );\n\n  const updateConnections = useCallback(\n    (connsToUpdate: AppConnection[]) => {\n      const sortedConnsToUpdate = connsToUpdate.map((conn) => {\n        const firstNodeFirst = conn.firstNode.name < conn.secondNode.name;\n        return {\n          ...conn,\n          firstNode: firstNodeFirst ? conn.firstNode : conn.secondNode,\n          firstNodeId: firstNodeFirst ? conn.firstNode.id : conn.secondNode.id,\n          secondNode: firstNodeFirst ? conn.secondNode : conn.firstNode,\n          secondNodeId: firstNodeFirst ? conn.secondNode.id : conn.firstNode.id,\n        };\n      });\n      const connIdsToUpdate = sortedConnsToUpdate.map((conn) => conn.id);\n      const oldConns = appConnections.filter(\n        (conn) => !connIdsToUpdate.includes(conn.id)\n      );\n      setAppConnections([...sortedConnsToUpdate, ...oldConns]);\n      setOutput(undefined);\n    },\n    [appConnections, setAppConnections, setOutput]\n  );\n\n  const deleteConnections = useCallback(\n    (connIds: string[]) => {\n      setAppConnections(\n        appConnections.filter((conn) => !connIds.includes(conn.id))\n      );\n      setOutput(undefined);\n    },\n    [appConnections, setAppConnections, setOutput]\n  );\n\n  const setActiveNodes = useCallback(\n    (activeNodeIds: string[]) => {\n      setAppNodes(\n        appNodes.map((node) => ({\n          ...node,\n          isActive: activeNodeIds.includes(node.id),\n        }))\n      );\n    },\n    [appNodes, setAppNodes]\n  );\n\n  const clearActiveNodes = useCallback(() => {\n    const anyActiveNodes = appNodes.find((node) => node.isActive) !== undefined;\n    if (anyActiveNodes) {\n      setAppNodes(\n        appNodes.map((node) => ({\n          ...node,\n          isActive: false,\n        }))\n      );\n    }\n  }, [appNodes, setAppNodes]);\n\n  return [\n    addNode,\n    addConnection,\n    updateNodes,\n    deleteNodes,\n    updateConnections,\n    deleteConnections,\n    setActiveNodes,\n    clearActiveNodes,\n  ];\n}\n","import React, { useEffect } from \"react\";\nimport { AppClipboard, AppConnection, AppNode } from \"../App\";\nimport { makeConnection, makeNode } from \"hotstuff-network\";\nimport { newNodeName } from \"../utils/nodeConnectionUtils\";\nimport config from \"../config\";\n\nexport default function useKeyDown(\n  keyboardActive: boolean,\n  appNodes: AppNode[],\n  setAppNodes: (nodes: AppNode[]) => void,\n  deleteNodes: (nodeIds: string[]) => void,\n  appConnections: AppConnection[],\n  setAppConnections: (newConnections: AppConnection[]) => void,\n  clipboard: AppClipboard,\n  setClipboard: React.Dispatch<React.SetStateAction<AppClipboard>>\n): void {\n  useEffect(() => {\n    const onKeyDown = (event: React.KeyboardEvent | KeyboardEvent) => {\n      if (keyboardActive) {\n        // meta + A makes all nodes active\n        if (event.metaKey && event.keyCode === 65) {\n          event.preventDefault();\n          setAppNodes(\n            appNodes.map((node) => {\n              return { ...node, isActive: true };\n            })\n          );\n        }\n\n        // delete active nodes on back/del\n        if (event.key === \"Backspace\" || event.key === \"Delete\") {\n          event.preventDefault();\n          deleteNodes(\n            appNodes.filter((node) => node.isActive).map((node) => node.id)\n          );\n        }\n\n        // escape key makes all inactive\n        if (event.keyCode === 27) {\n          setAppNodes(appNodes.map((node) => ({ ...node, isActive: false })));\n        }\n\n        // meta + C copies active nodes and associated connections to clipboard\n        if (event.metaKey && event.keyCode === 67) {\n          event.preventDefault();\n          const activeNodes = appNodes.filter((node) => node.isActive);\n          const newNodes = activeNodes.map((node) => {\n            return {\n              // order matters here\n              ...node,\n              ...makeNode(node),\n              center: {\n                x: node.center.x + config.pasteXOffset,\n                y: node.center.y,\n              },\n              name: newNodeName(\n                appNodes.map((node) => node.name),\n                node.name\n              ),\n            };\n          });\n\n          // map active node ids to new nodes\n          const activeNodeIdToNewNode = new Map<string, AppNode>();\n          for (let i = 0; i < activeNodes.length; i++) {\n            activeNodeIdToNewNode.set(activeNodes[i].id, newNodes[i]);\n          }\n\n          // map connections involving active nodes to new connections involving new nodes\n          // const activeNodeIds = activeNodes.map((node) => node.id);\n          const newConnections: AppConnection[] = [];\n          appConnections.forEach((conn) => {\n            const newFirstNode = activeNodeIdToNewNode.get(conn.firstNode.id);\n            const newSecondNode = activeNodeIdToNewNode.get(conn.secondNode.id);\n            if (!!newFirstNode && !!newSecondNode) {\n              const newConnection = {\n                ...conn,\n                ...makeConnection({\n                  ...conn,\n                  firstNode: newFirstNode,\n                  secondNode: newSecondNode,\n                }),\n              };\n              newConnections.push(newConnection);\n            }\n          });\n\n          setClipboard({\n            copiedNodes: newNodes,\n            copiedConnections: newConnections,\n          });\n        }\n\n        // meta + V pastes from clipboard\n        if (event.metaKey && event.keyCode === 86) {\n          event.preventDefault();\n          setAppNodes([\n            ...appNodes.map((node) => ({ ...node, isActive: false })),\n            ...clipboard.copiedNodes,\n          ]);\n          setAppConnections([\n            ...appConnections,\n            ...clipboard.copiedConnections,\n          ]);\n        }\n      }\n    };\n    document.addEventListener(\"keydown\", onKeyDown);\n    return () => document.removeEventListener(\"keydown\", onKeyDown);\n  }, [\n    appConnections,\n    appNodes,\n    clipboard,\n    deleteNodes,\n    keyboardActive,\n    setAppConnections,\n    setAppNodes,\n    setClipboard,\n  ]);\n}\n","import React, { useCallback } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport {\n  determineRadius,\n  intersectsCircle,\n  mouseToNodeCoords,\n  rotatedDirection,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppNode } from \"../App\";\nimport { getNewAppNode } from \"../utils/nodeConnectionUtils\";\nimport config from \"../config\";\n\nexport default function useDoubleClick(\n  appNodes: AppNode[],\n  addNode: (node: AppNode) => void,\n  updateNodes: (nodes: AppNode[]) => void\n): (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => void {\n  return useCallback(\n    (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => {\n      event.preventDefault();\n      if (config.multiSelectKeys.some((k) => event[k])) {\n        return;\n      }\n\n      const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n\n      const doubleClickedNode = appNodes.find((node) => {\n        const nodeRadius = determineRadius(\n          node.capacitanceJPerDegK,\n          appNodes.map((node) => node.capacitanceJPerDegK)\n        );\n        return intersectsCircle(nodeCoordsOfMouse, node.center, nodeRadius);\n      });\n\n      if (doubleClickedNode) {\n        updateNodes([\n          {\n            ...doubleClickedNode,\n            textDirection: rotatedDirection(doubleClickedNode.textDirection),\n          },\n        ]);\n      } else {\n        const newAppNode = getNewAppNode(appNodes, nodeCoordsOfMouse);\n        addNode(newAppNode);\n      }\n    },\n    [addNode, appNodes, updateNodes]\n  );\n}\n","import { useLayoutEffect, useState } from \"react\";\n\nexport default function useWindowSize(): [[number, number], number] {\n  const [size, setSize] = useState<[number, number]>([0, 0]);\n  const [ratio, setRatio] = useState(1);\n\n  useLayoutEffect(() => {\n    function updateSize() {\n      setSize([window.innerWidth, window.innerHeight]);\n    }\n    function updateRatio() {\n      const { devicePixelRatio: ratio = 1 } = window;\n      setRatio(ratio);\n    }\n    window.addEventListener(\"resize\", updateSize);\n    window.addEventListener(\"resize\", updateRatio);\n    updateSize();\n    updateRatio();\n    return () => {\n      window.removeEventListener(\"resize\", updateSize);\n      window.removeEventListener(\"resize\", updateRatio);\n    };\n  }, []);\n  return [size, ratio];\n}\n","export function forceShowScrollbars(): void {\n  // Returns whether scrollbars show up on scrollable elements.\n  // This is false on Macs when the \"General > Show scroll bars\" setting is\n  // not set to \"Always\" (the default is \"When scrolling\"). The approach\n  // taken here is to create an element that will scroll and then compare\n  // its outer widthPercent (including scrollbars) to its inner widthPercent (excluding\n  // scrollbars).\n  function areScrollbarsVisible() {\n    const scrollableElem = document.createElement(\"div\"),\n      innerElem = document.createElement(\"div\");\n    scrollableElem.style.width = \"30px\";\n    scrollableElem.style.height = \"30px\";\n    scrollableElem.style.overflow = \"scroll\";\n    scrollableElem.style.borderWidth = \"0\";\n    innerElem.style.width = \"30px\";\n    innerElem.style.height = \"60px\";\n    scrollableElem.appendChild(innerElem);\n    document.body.appendChild(scrollableElem); // Elements only have widthPercent if they're in the layout\n    const diff = scrollableElem.offsetWidth - scrollableElem.clientWidth;\n    document.body.removeChild(scrollableElem);\n    return diff > 0;\n  }\n\n  window.addEventListener(\"load\", function () {\n    // Show scrollbars if they're hidden.\n    if (!areScrollbarsVisible()) {\n      document.body.classList.add(\"force-show-scrollbars\");\n    }\n  });\n}\n","import * as React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport { forceShowScrollbars } from \"./utils/scrollBar\";\n\nforceShowScrollbars();\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}