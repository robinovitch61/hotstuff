{"version":3,"sources":["config.ts","components/Sidebar/EditableTable/style.ts","components/Sidebar/EditableTable/TableHeader.tsx","components/Sidebar/EditableTable/cells/DropDownTableCell.tsx","components/Sidebar/style.tsx","components/Sidebar/EditableInput.tsx","components/Sidebar/EditableStringInput.tsx","components/Sidebar/EditableTable/cells/TextTableCell.tsx","components/Sidebar/EditableNumberInput.tsx","components/Sidebar/EditableTable/cells/NumericalTableCell.tsx","components/Sidebar/EditableTable/cells/BooleanTableCell.tsx","components/Sidebar/EditableTable/TableCell.tsx","components/Sidebar/EditableTable/hooks/useSortableTable.ts","components/Sidebar/EditableTable/DeleteCell.tsx","components/Sidebar/EditableTable/NodeTable/NodeTable.tsx","utils/nodeConnectionUtils.ts","components/Sidebar/EditableTable/ConnectionTable/ConnectionTable.tsx","components/Tabs/Tabs.tsx","utils/pointUtils.ts","default.ts","components/Sidebar/ModelControls.tsx","components/Sidebar/Sidebar.tsx","components/Plot/LinePlot.tsx","components/Plot/Plot.tsx","components/Canvas/canvasUtils.ts","components/Canvas/hooks/usePanZoomCanvas.ts","components/Canvas/CanvasControls.tsx","components/Canvas/ModalControls.tsx","components/Canvas/Canvas.tsx","components/Canvas/hooks/useOnClickCanvas.ts","hooks/useDraw.ts","hooks/useAddConnection.ts","hooks/useMoveNode.ts","hooks/useMultiSelect.ts","hooks/useOnMouseDown.ts","hooks/useClickAndDragElement.ts","hooks/useResizablePanels.ts","style.tsx","components/Modal/ConfirmationModal.tsx","components/Modal/TheoryModal.tsx","components/Modal/Modal.tsx","hooks/useOnClickOutside.ts","App.tsx","hooks/useSessionStorageState.ts","hooks/useAppStateModifiers.ts","hooks/useNodeConnectionUtils.ts","hooks/useKeyDown.ts","hooks/useDoubleClick.ts","components/Canvas/hooks/useWindowSize.ts","utils/scrollBar.ts","index.tsx"],"names":["config","defaultTempDegC","defaultCapJPerDegK","defaultPowerGenW","defaultTotalTimeSeconds","defaultTimeStepSeconds","defaultNodeRadius","defaultResistanceDegKPerW","defaultEditorWidthFraction","defaultCanvasHeightFraction","defaultTableHeightFraction","minPanelFraction","newNodeNamePrefix","zoomSensitivity","minZoom","maxZoom","maxZoomDelta","minRadiusPx","maxRadiusPx","activeNodeOutlineWidthPx","tabHeightPx","plotHeightBufferPx","tableDeleteCellWidthPercent","tableDeleteCellMinWidthPx","plotMargin","left","right","top","bottom","plotDomainMarginPercent","maxPlotPoints","multiSelectKeys","StyledTableWrapper","styled","div","StyledTable","StyledTableBody","StyledAddButton","button","StyledRow","heightOffsetPx","isActive","StyledCell","width","minWidth","StyledDeleteCell","StyledHeaderWrapper","StyledColHeader","StyledColText","StyledSortIcon","TableHeader","props","columns","sortState","setSortState","sortIcon","direction","map","col","isSortedCol","key","onClick","sortDirection","minWidthPx","text","toString","style","cursor","StyledSelect","select","DropDownTableCell","value","setOption","id","onChange","event","newVal","target","selectedOption","options","find","option","undefined","onSelectOption","rowId","StyledInput","input","StyledEditor","height","StyledTables","heightFrac","StyledModelControlsWrapper","EditableInput","initialValue","onBlur","getNewValue","afterValue","useState","setValue","handleOnBlur","useCallback","prevVal","type","onFocus","replace","onKeyDown","EditableStringInput","TextTableCell","initialVal","getFloatVal","newValueText","newValueFloat","parseFloat","isNaN","EditableNumberInput","NumericalTableCell","StyledCheckbox","BooleanTableCell","initialIsActive","setIsActive","tabIndex","onKeyUp","showWhenActive","TableCell","row","onUpdateRow","initiallySetOption","length","useSortableTable","defaultSortState","tieBreakerKey","ultraSuperDuperTieBreakerKey","first","second","DeleteCell","onDeleteRow","defaultNodeSortState","nodeColumns","NodeTable","rows","onAddButton","sortByState","tableRows","sort","tableCell","ALL_CONNECTION_KINDS","getExistingConnections","firstNodeId","secondNodeId","connections","filter","conn","source","makeNewConnection","firstNode","secondNode","kind","resistance","firstNodeFirst","name","makeConnection","resistanceDegKPerW","sourceId","targetId","getNewConnection","existingConnections","existingKinds","remainingKinds","includes","getNewAppNode","appNodes","center","numNodesWithDefaultPrefix","node","startsWith","newNode","makeNode","temperatureDegC","capacitanceJPerDegK","powerGenW","isBoundary","textDirection","defaultConnectionSortState","connectionTypes","filterConnectionOptions","colKey","connectionId","selectedSourceId","selectedTargetId","otherConnections","some","c","selectedConnection","possibleKinds","connectionKind","getNewConnectionKindsPossible","opt","ConnectionTable","onSelectNewSource","connection","newSourceNode","nodes","onSelectNewTarget","newTargetNode","onSelectNewConnectionType","rowToUpdate","nodeOptions","connectionColumns","useMemo","activeNodeIds","cols","makeStyledCell","StyledTabsWrapper","StyledTabs","StyledTab","StyledTabText","StyledInnerContent","Tabs","activeIdx","setActiveIdx","tabs","tab","idx","className","topLeftRounded","_","component","ORIGIN","Object","freeze","x","y","diffPoints","p1","p2","scalePoint","scale","jerryNode","jerryAppNode","bedNode","bedAppNode","airNode","defaultNodes","defaultConnections","defaultTiming","timeStepS","totalTimeS","defaultCanvasViewState","offset","defaultPanelSizes","editorWidthFraction","canvasHeightFraction","tableHeightFraction","defaultModalState","visible","defaultAppState","output","timing","canvasViewState","savedCanvasState","panelSizes","StyledButton","StyledImport","StyledTopControls","StyledTimeControls","StyledTimeControl","StyledInputWrapper","StyledLabel","label","ModelControls","appState","setAppState","setModalState","onRunModel","setTiming","stagedAppState","setStagedAppState","newTotalTimeS","newTimeStepS","navigator","clipboard","writeText","JSON","stringify","parse","prev","onConfirm","confirmText","Sidebar","onAddNode","onAddConnection","updateNodes","deleteNodes","updateConnections","deleteConnections","nodeTable","connectionTable","StyledToolTip","StyledToolTipTitle","StyledToolTipItem","color","StyledToolTipValue","after","CustomTooltip","active","payload","sortedPayload","a","b","item","LinePlot","plotDimensions","plotData","lines","xAxisKey","xLabel","yLabel","yDomain","unit","LineChart","margin","data","CartesianGrid","strokeDasharray","XAxis","dataKey","position","dy","YAxis","domain","angle","dx","Tooltip","content","Legend","layout","verticalAlign","align","wrapperStyle","paddingLeft","paddingBottom","colors","StyledCharts","StyledPlot","roundToNearestTenth","Math","round","plotShape","lowerMag","floor","log10","divisibleBy","pow","includeAll","timeSeriesS","tempsAtAllTimes","minTemp","maxTemp","heatTransfersAtAllTimes","minHeatTransfer","maxHeatTransfer","forEach","t","val","abs","temp","time","ht","nodeResults","nodeResult","tempVal","tempDegC","connectionResults","connectionResult","heatTransferVal","heatTransferW","push","Plot","modelHasOutput","modelOutput","res","emptyOutput","tempPlotData","tempDomain","heatTransferPlotData","heatTransferDomain","yTempDomainMargin","yTempDomain","ceil","yHeatTransferDomainMargin","yHeatTransferDomain","heatTransferLines","Line","stroke","activeDot","r","isAnimationActive","tempLines","tempPlot","heatTransferPlot","DEFAULT_RADIUS","drawNode","context","radius","save","beginPath","arc","PI","fillStyle","fill","closePath","restore","drawCircle","lineWidth","strokeStyle","drawCircleOutline","translate","rotate","moveTo","lineTo","h","newRadius","sin","acos","drawHashPattern","font","textMetrics","measureText","fillText","actualBoundingBoxAscent","actualBoundingBoxDescent","drawNodeName","drawConnection","sourceCenter","sourceRadius","targetCenter","targetRadius","start","end","startOffset","endOffset","headLength","headWidth","arrowGap","atan2","adjLength","sqrt","drawBidirectionalArrow","drawUnidirectionalArrow","intersectsCircle","point","circleCenter","deltaX","deltaY","calculateMousePositionOnElement","element","viewportMousePos","pageX","pageY","boundingRect","getBoundingClientRect","mouseToNodeCoords","canvasState","canvasMouse","canvas","mouse","determineRadius","capacitance","allCapacitances","min","max","StyledButtons","CanvasControls","setCanvasViewState","setSavedCanvasState","StyledModalControls","StyledModalControlButton","ModalControls","StyledCanvasWrapper","StyledCanvas","cssWidth","cssHeight","Canvas","ref","onClickCanvas","canvasWidth","canvasHeight","devicePixelRatio","draw","onMouseDown","handleDoubleClick","savedCanvasViewState","setSavedCanvasViewState","setKeyboardActive","canvasRef","useRef","useEffect","handleClickOutside","keyBoardActive","current","contains","document","addEventListener","removeEventListener","setContext","mousePosRef","lastMousePosRef","lastCanvasViewState","mouseMove","newMousePos","mouseDiff","newCanvasViewState","mouseUp","startPan","useLayoutEffect","handleWheel","preventDefault","zoomDelta","zoom","newScale","mouseOffset","canvasElem","usePanZoomCanvas","renderCtx","getContext","onDoubleClick","useDraw","appConnections","nodeRadius","nodeColor","temperature","allTemperatures","range","scaleDiverging","test","determineColor","sourceAppNode","targetAppNode","clearAndRedraw","clearRect","useAddConnection","addConnection","drawConnectionBeingMade","clickedNode","nodeCoordsOfMouse","drawArrowWithoutHead","drawConnWrapper","mouseUpOnNode","newConnection","getNewAppNodes","clickedMouseEvent","currentMouseEvent","multiSelectKeyPressed","activeNodes","offsetMouseToCenter","newClickedCenter","newClickedNode","newActiveNodes","distanceFromClickedCenter","useMultiSelect","setActiveNodes","boxStart","drawBox","globalAlpha","fillRect","rect","boxEnd","startBox","endBox","topLeft","bottomRight","bottomLeft","topRight","isInsideBox","useOnMouseDown","clearActiveNodes","moveNode","movedRef","mouseDownEvent","k","newNodes","mouseUpEvent","useMoveNode","multiSelect","defaultBehavior","altKey","onMouseUp","clientX","clientY","useClickAndDragElement","params","lastMousePos","onDragX","onDragY","constrainX","constrainY","onMouseMove","mouseMoveEvent","currentMousePos","diff","constrainPanelSize","newPanelSize","StyledApp","modalOpen","StyledDraggableBorder","StyledHorizontalBorder","StyledVerticalBorder","StyledWorkspace","StyledConfirmationModal","StyledConfirmationText","p","StyledConfirmationButtons","StyledConfirmationButton","ConfirmationModal","modalState","StyledTheoryModal","StyledTitle","h1","StyledText","StyledLink","img","StyledListItem","li","TheoryModal","href","display","tex","String","raw","StyledModal","StyledExitButton","Modal","onClickOutside","modalRef","listener","modalContent","getModalContent","prevState","App","defaultValue","React","localState","window","sessionStorage","getItem","setItem","useSessionStorageState","newConnections","newCanvasState","newSavedCanvasState","newTiming","newModelOutput","useAppStateModifiers","setAppNodes","setAppConnections","setModelOutput","addNode","nodesToUpdate","prevConn","nodeToUpdate","nodeIds","connsToUpdate","connIdsToUpdate","oldConns","connIds","useNodeConnectionUtils","keyboardActive","metaKey","keyCode","useKeyDown","doubleClickedNode","newAppNode","useDoubleClick","size","setSize","ratio","setRatio","updateSize","innerWidth","innerHeight","updateRatio","useWindowSize","windowWidth","windowHeight","newX","minPx","maxPx","newY","deltaYPx","prevAppState","deltaXPx","useResizablePanels","canvasPlotBorderRef","onMouseDownOnCanvasPlotBorder","leftRightBorderRef","onMouseDownOnLeftRightBorder","tableControlsBorderRef","onMouseDownOnTableControlsBorder","workspaceWidth","workspaceHeight","plotHeight","plotWidth","editorWidth","plot","addNodeInCenterOfCanvas","topLeftPoint","getCanvasCenter","createNewLogicalConnection","getNewPossibleConnection","conns","run","errors","error","console","message","scrollableElem","createElement","innerElem","overflow","borderWidth","appendChild","body","offsetWidth","clientWidth","removeChild","areScrollbarsVisible","classList","add","ReactDOM","render","getElementById"],"mappings":"wLAqCeA,EAnCA,CACbC,gBAAiB,GACjBC,mBAAoB,GACpBC,iBAAkB,EAClBC,wBAAyB,IACzBC,uBAAwB,GACxBC,kBAAmB,GACnBC,0BAA2B,GAC3BC,2BAA4B,EAAI,EAAI,cACpCC,4BAA6B,EAAI,cACjCC,2BAA4B,GAC5BC,iBAAkB,GAClBC,kBAAmB,WACnBC,gBAAiB,KACjBC,QAAS,GACTC,QAAS,EACTC,aAAc,EACdC,YAAa,GACbC,YAAa,GACbC,yBAA0B,EAC1BC,YAAa,GACbC,mBAAoB,GACpBC,4BAA6B,GAC7BC,0BAA2B,GAC3BC,WAAY,CACVC,KAAM,GACNC,MAAO,GACPC,IAAK,GACLC,OAAQ,IAEVC,wBAAyB,GACzBC,cAAe,IACfC,gBAAiB,CAAC,UAAW,Y,OChClBC,EAAqBC,IAAOC,IAAV,+EAAGD,CAAH,iBAIlBE,EAAcF,IAAOC,IAAV,wEAAGD,CAAH,0CAKXG,EAAkBH,IAAOC,IAAV,4EAAGD,CAAH,iBAIfI,EAAkBJ,IAAOK,OAAV,4EAAGL,CAAH,MAEfM,EAAYN,IAAOC,IAAV,sEAAGD,CAAH,mGAQb,gBAAGO,EAAH,EAAGA,eAAH,OACLA,EAAc,UAAMA,EAAN,MAA2B,SAC7B,qBAAGC,SACJ,2BAA6B,UAG/BC,EAAaT,IAAOC,IAAV,uEAAGD,CAAH,6HAMZ,gBAAGU,EAAH,EAAGA,MAAH,gBAA0B,IAARA,EAAlB,QACI,gBAAGC,EAAH,EAAGA,SAAH,OAAqBA,EAAF,UAAgBA,EAAhB,MAA+B,UAGpDC,EAAmBZ,YAAOS,GAAV,6EAAGT,CAAH,+EAUhBa,EAAsBb,IAAOC,IAAV,gFAAGD,CAAH,4EAKvB,gBAAGO,EAAH,EAAGA,eAAH,OACLA,EAAc,UAAMA,EAAN,MAA2B,SAIhCO,EAAkBd,IAAOC,IAAV,4EAAGD,CAAH,yOAEjB,gBAAGU,EAAH,EAAGA,MAAH,gBAA0B,IAARA,EAAlB,QACI,gBAAGC,EAAH,EAAGA,SAAH,OAAqBA,EAAF,UAAgBA,EAAhB,MAA+B,UAYpDI,EAAgBf,IAAOC,IAAV,0EAAGD,CAAH,kCAKbgB,EAAiBhB,IAAOC,IAAV,4EAAGD,CAAH,oE,OC7DZ,SAASiB,EACtBC,GAEA,IAAQC,EAAqCD,EAArCC,QAASC,EAA4BF,EAA5BE,UAAWC,EAAiBH,EAAjBG,aAEtBC,EAAYF,EAEU,QAAxBA,EAAUG,UACV,SACA,SAHA,GAKJ,OACE,eAACV,EAAD,CAAqBN,eAAgBxC,EAAOoB,YAA5C,UACGgC,EAAQK,KAAI,SAACC,GACZ,IAAMC,EAAcN,GAAaA,EAAUO,MAAQF,EAAIE,IAWvD,OACE,eAACb,EAAD,CAEEc,QAbY,WAnBxB,IAA+BC,EAoBrBR,EAAa,CACXM,IAAKF,EAAIE,IACTJ,UACGG,GAAgBN,GAvBAS,EAyBST,EAAUG,UAxBvB,QAAlBM,EAA0B,OAAS,OAuB1B,SASNnB,MAAOe,EAAIf,MACXC,SAAUc,EAAIK,WAJhB,UAME,cAACf,EAAD,UAAgBU,EAAIM,OACpB,cAACf,EAAD,UAAiBU,EAAcJ,EAAW,OANrCG,EAAIE,IAAIK,eAUnB,cAAClB,EAAD,CACEJ,MAAO3C,EAAOsB,4BACdsB,SAAU5C,EAAOuB,0BACjB2C,MAAO,CAAEC,OAAQ,c,mBCxDnBC,EAAenC,IAAOoC,OAAV,qFAAGpC,CAAH,kEAeH,SAASqC,EACtBnB,GACqB,IAAD,EAWpB,OACE,cAACiB,EAAD,CAAcG,MAAK,UAAEpB,EAAMqB,iBAAR,aAAE,EAAiBC,GAAIC,SAX5C,SAAsBC,GACpB,IAAMC,EAASD,EAAME,OAAON,MAEtBO,EAAiB3B,EAAM4B,QAAQC,MAAK,SAACC,GAAD,OAAYA,EAAOR,KAAOG,UAE7CM,IAAnBJ,GACF3B,EAAMgC,eAAehC,EAAMiC,MAAON,IAKpC,SACG3B,EAAM4B,QAAQtB,KAAI,SAACwB,GAAD,OACjB,wBAAwBV,MAAOU,EAAOR,GAAtC,SACGQ,EAAOjB,MADGiB,EAAOR,SCjCrB,IAAMY,EAAcpD,IAAOqD,MAAV,wEAAGrD,CAAH,uMAgBXsD,EAAetD,IAAOC,IAAV,yEAAGD,CAAH,2DACb,SAACkB,GAAD,OAAWA,EAAMqC,UAClB,SAACrC,GAAD,OAAWA,EAAMR,SAIf8C,EAAexD,IAAOC,IAAV,yEAAGD,CAAH,iDAGb,SAACkB,GAAD,OAA8B,IAAnBA,EAAMuC,cAGhBC,EAA6B1D,IAAOC,IAAV,uFAAGD,CAAH,iDAG3B,SAACkB,GAAD,OAA8B,IAAnBA,EAAMuC,cCnBd,SAASE,EACtBzC,GAEA,IAAQ0C,EAAkD1C,EAAlD0C,aAAcC,EAAoC3C,EAApC2C,OAAQC,EAA4B5C,EAA5B4C,YAAaC,EAAe7C,EAAf6C,WAE3C,EAA0BC,mBACxBJ,EAAa5B,YAAc+B,GAAc,KAD3C,mBAAOzB,EAAP,KAAc2B,EAAd,KAWA,IAAMC,EAAeC,uBACnB,SAACzB,GACC,IAAMC,EAASmB,EAAYpB,GACvBA,EAAME,OAAON,QAAUsB,EAAa5B,gBAGlBiB,IAAXN,GACTsB,EAAStB,EAAOX,YAAc+B,GAAc,KAC5CF,EAAOlB,KAEPsB,EAASL,EAAa5B,YAAc+B,GAAc,KAClDF,EAAOD,IAPPK,GAAS,SAACG,GAAD,OAAaA,GAAWL,GAAc,SAUnD,CAACA,EAAYD,EAAaF,EAAcC,IAG1C,OACE,cAACT,EAAD,CACEiB,KAAK,OACL/B,MAAOA,EACPG,SA5BJ,SAAwBC,GACtB,IAAMC,EAASD,EAAME,OAAON,WACbW,IAAXN,GACFsB,EAAStB,IA0BT2B,QAAS,kBACPL,GAAS,SAACG,GAAD,OAAaA,EAAQG,QAAQR,GAAc,GAAI,QAE1DF,OAAQK,EAERM,UAAW,SAAC9B,GACQ,WAAdA,EAAMf,KACCe,EAAMf,OCnDV,SAAS8C,EACtBvD,GAEA,OACE,cAACyC,EAAD,CAEEC,aAAc1C,EAAM0C,aACpBC,OAAQ3C,EAAM2C,OACdC,YAAa,SAACpB,GAAD,OACXA,EAAME,OAAON,QAJVpB,EAAM0C,cCLF,SAASc,EACtBxD,GAEA,OACE,cAACuD,EAAD,CACEb,aAAc1C,EAAMyD,WACpBd,OAAQ3C,EAAM2C,SCXpB,SAASe,EACPlC,GAEA,IAAMmC,EAAenC,EAAME,OAAON,MAE5BwC,EAAgBC,WAAWrC,EAAME,OAAON,OAC9C,QAAqBW,IAAjB4B,IAA8BG,MAAMF,GAGxC,OAAOA,EASM,SAASG,EACtB/D,GAEA,OACE,cAACyC,EAAD,CAEEC,aAAc1C,EAAM0C,aACpBC,OAAQ3C,EAAM2C,OACdC,YAAac,EACbb,WAAY7C,EAAM6C,YAJb7C,EAAM0C,cAAgB1C,EAAM6C,YAAc,KCjBtC,SAASmB,EACtBhE,GAEA,OACE,cAAC+D,EAAD,CACErB,aAAc1C,EAAMyD,WACpBd,OAAQ3C,EAAM2C,OACdE,WAAY7C,EAAM6C,aCbxB,IAAMoB,EAAiBnF,IAAOC,IAAV,uFAAGD,CAAH,2HAgBL,SAASoF,EACtBlE,GAEA,MAAgC8C,wBACJf,IAA1B/B,EAAMmE,iBAAgCnE,EAAMmE,iBAD9C,mBAAO7E,EAAP,KAAiB8E,EAAjB,KAIA,OACE,eAACH,EAAD,CACEI,SAAU,EACVC,QAAS,SAAC9C,GACU,UAAdA,EAAMf,MACR2D,GAAa9E,GACbU,EAAMU,SAASpB,KAGnBoB,QAAS,WACP0D,GAAa9E,GACbU,EAAMU,SAASpB,IAVnB,iBAaSA,EAAWU,EAAMuE,eAAiB,MCpBhC,SAASC,EACtBxE,GAEA,IAAQyE,EACNzE,EADMyE,IAAKlE,EACXP,EADWO,IAAKmE,EAChB1E,EADgB0E,YAAa9C,EAC7B5B,EAD6B4B,QAAS+C,EACtC3E,EADsC2E,mBAAoB9B,EAC1D7C,EAD0D6C,WAEtDY,EAAagB,EAAIlE,EAAIE,KAE3B,OAAMmB,GAAWA,EAAQgD,OAAS,GAAKrE,EAAIyB,eAEvC,cAACb,EAAD,CAEEc,MAAOwC,EAAInD,GACXM,QAASA,EACTP,UAAWsD,EACX3C,eAAgBzB,EAAIyB,gBAJfyC,EAAInD,IAOkB,kBAAfmC,EAEd,cAACD,EAAD,CACEC,WAAYA,EACZd,OAAQ,SAAClB,GAAD,OAAYiD,EAAY,2BAAKD,GAAN,kBAAYlE,EAAIE,IAAMgB,QAInC,kBAAfgC,GACiB,kBAAjBgB,EAAIlE,EAAIE,KAGb,cAACuD,EAAD,CACEP,WAAYA,EACZd,OAAQ,SAAClB,GAAD,OAAYiD,EAAY,2BAAKD,GAAN,kBAAYlE,EAAIE,IAAMgB,MACrDoB,WAAYA,IAGe,mBAAfY,EAEd,cAACS,EAAD,CAEEC,gBAAiBV,EACjB/C,QAAS,SAACe,GAAD,OAAYiD,EAAY,2BAAKD,GAAN,kBAAYlE,EAAIE,IAAMgB,MACtD8C,eAAgB,UAHXd,EAAW3C,YAOb,6BC7DI,SAAS+D,EACtBC,EACAC,EACAC,GAMA,MACElC,mBAA4BgC,GAD9B,mBAAO5E,EAAP,KAAkBC,EAAlB,KAgCA,MAAO,CAACD,EAAWC,EA7BnB,SAAqB8E,EAAUC,GAC7B,MAA4B,QAAxBhF,EAAUG,UACR4E,EAAM/E,EAAUO,KAAOyE,EAAOhF,EAAUO,MAEjCwE,EAAM/E,EAAUO,OAASyE,EAAOhF,EAAUO,OAC/CwE,EAAMF,GAAiBG,EAAOH,IAEvBE,EAAMF,KAAmBG,EAAOH,IAClCE,EAAMD,GACXE,EAAOF,IANJ,GAaC,EAGNC,EAAM/E,EAAUO,KAAOyE,EAAOhF,EAAUO,MAClC,EACCwE,EAAM/E,EAAUO,OAASyE,EAAOhF,EAAUO,KAC5CwE,EAAMF,GAAiBG,EAAOH,GAAiB,GAAK,EAEpD,IC/BA,SAASI,EACtBnF,GAEA,OACE,cAACN,EAAD,CACE2E,SAAU,EACVC,QAAS,SAAC9C,GACU,UAAdA,EAAMf,KACRT,EAAMoF,YAAYpF,EAAMyE,MAG5BjF,MAAO3C,EAAOsB,4BACdsB,SAAU5C,EAAOuB,0BACjBsC,QAAS,kBAAMV,EAAMoF,YAAYpF,EAAMyE,MATzC,oBCMJ,IAAMY,EAAgD,CACpD5E,IAAK,OACLJ,UAAW,OAGPiF,EAAiC,CACrC,CACE7E,IAAK,OACLI,KAAM,OACNrB,MAAO,GACPoB,WAAY,KAEd,CACEH,IAAK,kBACLI,KAAM,cACNrB,MAAO,IACPoB,WAAY,KAEd,CACEH,IAAK,sBACLI,KAAM,uBACNrB,MAAO,IACPoB,WAAY,KAEd,CACEH,IAAK,YACLI,KAAM,gBACNrB,MAAO,IACPoB,WAAY,IAEd,CACEH,IAAK,aACLI,KAAM,cACNrB,MAAO,IACPoB,WAAY,KAWD,SAAS2E,EAAUvF,GAChC,IAAQwF,EAAgDxF,EAAhDwF,KAAMd,EAA0C1E,EAA1C0E,YAAaU,EAA6BpF,EAA7BoF,YAAaK,EAAgBzF,EAAhByF,YAExC,EAA+CZ,EAC7CQ,EACA,kBACA,uBAHF,mBAAOnF,EAAP,KAAkBC,EAAlB,KAAgCuF,EAAhC,KAQMC,EAFaH,EAAKI,KAAKF,GAEApF,KAAI,SAACmE,GAChC,OACE,eAACrF,EAAD,CAEEC,eAAgBxC,EAAOoB,YACvBqB,SAAUmF,EAAInF,SAHhB,UAKGgG,EAAYhF,KAAI,SAACC,GAChB,IAAMsF,EACJ,cAACrB,EAAD,CAAoBC,IAAKA,EAAKlE,IAAKA,EAAKmE,YAAaA,IAEvD,OACE,cAACnF,EAAD,CAEEC,MAAOe,EAAIf,MACXC,SAAUc,EAAIK,WAHhB,SAKGiF,GAJItF,EAAIE,QAQf,cAAC0E,EAAD,CAAYV,IAAKA,EAAKW,YAAa,kBAAMA,EAAYX,QAlBhDA,EAAInD,OAuBf,OACE,cAACzC,EAAD,UACE,eAACG,EAAD,WACE,cAACe,EAAD,CACEE,QAASqF,EACTpF,UAAWA,EACXC,aAAcA,IAEhB,cAAClB,EAAD,UAAkB0G,IAClB,cAACzG,EAAD,CAAiBwB,QAAS+E,EAA1B,oB,oBCnGAhI,EAAsBZ,EAAtBY,kBAEFqI,EAA2C,CAAC,OAAQ,OAAQ,OAE3D,SAASC,EACdC,EACAC,EACAC,GAEA,OAAOA,EAAYC,QACjB,SAACC,GAAD,OACGA,EAAKC,OAAO/E,KAAO0E,GAAeI,EAAK1E,OAAOJ,KAAO2E,GACrDG,EAAKC,OAAO/E,KAAO2E,GAAgBG,EAAK1E,OAAOJ,KAAO0E,KAItD,IAAMM,EAAoB,SAC/BC,EACAC,EACAC,EACAC,GAEA,IAAMC,EAAiBJ,EAAUK,MAAQJ,EAAWI,KACpD,OAAO,2BACFC,yBAAe,CAChBR,OAAQM,EAAiBJ,EAAYC,EACrC9E,OAAQiF,EAAiBH,EAAaD,EACtCO,mBAAoBJ,GAAc7J,EAAOO,0BACzCqJ,UALJ,IAOEM,SAAUJ,EAAiBJ,EAAUjF,GAAKkF,EAAWlF,GACrD0F,SAAUL,EAAiBH,EAAWlF,GAAKiF,EAAUjF,MA4BlD,SAAS2F,EACdV,EACAC,EACAN,GAEA,IAAMgB,EAAsBnB,EAC1BQ,EAAUjF,GACVkF,EAAWlF,GACX4E,GAGF,GAAmC,IAA/BgB,EAAoBtC,OACtB,OAAO0B,EAAkBC,EAAWC,EAAY,QAGlD,IAAMW,EAAgBD,EAAoB5G,KAAI,SAAC8F,GAAD,OAAUA,EAAKK,QACvDW,EAAiBtB,EAAqBK,QAC1C,SAACM,GAAD,OAAWU,EAAcE,SAASZ,MAGpC,OAAKU,EAAcE,SAAS,SAAYF,EAAcE,SAAS,SAG5DD,EAAeC,SAAS,UAAWD,EAAeC,SAAS,SAC3DF,EAAcE,SAAS,YAFnB,EAIEf,EAAkBC,EAAWC,EAAY,OALzCF,EAAkBC,EAAWC,EAAY,QA8B7C,SAASc,EAAcC,EAAqBC,GACjD,IAAMC,EAA4BF,EAASpB,QAAO,SAACuB,GAAD,OAChDA,EAAKd,KAAKe,WAAWlK,MACrBmH,OAEIgD,EAAUC,mBAAS,CACvBjB,KACgC,IAA9Ba,EAAA,UACOhK,GADP,UAEOA,EAFP,aAE6BgK,EAA4B,EAFzD,KAGFK,gBAAiBjL,EAAOC,gBACxBiL,oBAAqBlL,EAAOE,mBAC5BiL,UAAWnL,EAAOG,iBAClBiL,YAAY,IAGd,OAAO,2BACFL,GADL,IAEEJ,OAAQA,EACRlI,UAAU,EACV4I,cAAe,MCvHnB,IAAMC,EAAiE,CACrE1H,IAAK,WACLJ,UAAW,OAGP+H,GAAgC,CACpC,CACE9G,GAAI,OACJT,KAAM,2BAER,CACES,GAAI,OACJT,KAAM,uCAER,CACES,GAAI,MACJT,KAAM,iCAIV,SAASwH,GACPC,EACA1G,EACA2G,EACAC,EACAC,EACAvC,GAEA,IAAMwC,EAAmBxC,EAAYC,QACnC,SAACC,GAAD,QAAYA,EAAK9E,KAAOiH,MAG1B,GAAe,aAAXD,EAMF,OAJgC1G,EAAQuE,QACtC,SAACrE,GAAD,OAAYA,EAAOR,KAAOmH,KAGGtC,QAAO,SAACrE,GACrC,OAAQ4G,EAAiBC,MACvB,SAACC,GAAD,OACGA,EAAEvC,OAAO/E,KAAOQ,EAAOR,IAAMsH,EAAElH,OAAOJ,KAAOmH,GAC7CG,EAAEvC,OAAO/E,KAAOmH,GAAoBG,EAAElH,OAAOJ,KAAOQ,EAAOR,SAG7D,GAAe,aAAXgH,EAMT,OAJgC1G,EAAQuE,QACtC,SAACrE,GAAD,OAAYA,EAAOR,KAAOkH,KAGGrC,QAAO,SAACrE,GACrC,OAAQ4G,EAAiBC,MACvB,SAACC,GAAD,OACGA,EAAEvC,OAAO/E,KAAOkH,GAAoBI,EAAElH,OAAOJ,KAAOQ,EAAOR,IAC3DsH,EAAEvC,OAAO/E,KAAOQ,EAAOR,IAAMsH,EAAElH,OAAOJ,KAAOkH,QAG/C,GAAe,SAAXF,EAAmB,CAC5B,IAAMO,EAAqB3C,EAAYrE,MACrC,SAACuE,GAAD,OAAUA,EAAK9E,KAAOiH,KAExB,GAAMM,EAAoB,CACxB,IAAMC,EDvCL,SACLC,EACAxC,EACAC,EACAkC,GAKA,IAKMvB,EALsBpB,EAC1BQ,EAAUjF,GACVkF,EAAWlF,GACXoH,GAEwCpI,KAAI,SAAC8F,GAAD,OAAUA,EAAKK,QAC7D,MACqB,QAAnBsC,IACC5B,EAAcE,SAAS,SAAWF,EAAcE,SAAS,SAEnD,GAEAvB,EAAqBK,QAAO,SAACM,GAAD,OAAWU,EAAcE,SAASZ,MCkB7CuC,CACpBH,EAAmBpC,KACnBoC,EAAmBxC,OACnBwC,EAAmBnH,OACnBwE,GAEF,OAAOtE,EAAQuE,QAAO,SAAC8C,GAAD,OACpBH,EAAczB,SAAS4B,EAAI3H,OAG7B,OAAOM,EAGT,OAAOA,EAYI,SAASsH,GACtBlJ,GAEA,MACE6E,EACEsD,EACA,WACA,QAJJ,mBAAOjI,EAAP,KAAkBC,EAAlB,KAAgCuF,EAAhC,KAOMyD,EAAoBlG,uBACxB,SAAC3B,EAAYQ,GACX,IAAMsH,EAAapJ,EAAMwF,KAAK3D,MAAK,SAACuE,GAAD,OAAUA,EAAK9E,KAAOA,KACnD+H,EAAgBrJ,EAAMsJ,MAAMzH,MAAK,SAAC6F,GAAD,OAAUA,EAAKpG,KAAOQ,EAAOR,MAEjE8H,GACAC,GACDA,EAAc/H,KAAO8H,EAAW1H,OAAOJ,IAIzCtB,EAAM0E,YAAN,2BACK0E,GADL,IAEE/C,OAAQgD,EACRtC,SAAUsC,EAAc/H,QAG5B,CAACtB,IAGGuJ,EAAoBtG,uBACxB,SAAC3B,EAAYQ,GACX,IAAMsH,EAAapJ,EAAMwF,KAAK3D,MAAK,SAACuE,GAAD,OAAUA,EAAK9E,KAAOA,KACnDkI,EAAgBxJ,EAAMsJ,MAAMzH,MAAK,SAAC6F,GAAD,OAAUA,EAAKpG,KAAOQ,EAAOR,MAEjE8H,GACAI,GACDA,EAAclI,KAAO8H,EAAW/C,OAAO/E,IAIzCtB,EAAM0E,YAAN,2BACK0E,GADL,IAEE1H,OAAQ8H,EACRxC,SAAUwC,EAAclI,QAG5B,CAACtB,IAGGyJ,EAA4BxG,uBAChC,SAAC3B,EAAYQ,GACX,IAAM4H,EAAc1J,EAAMwF,KAAK3D,MAAK,SAACuE,GAAD,OAAUA,EAAK9E,KAAOA,KACtDoI,GACF1J,EAAM0E,YAAN,2BACKgF,GADL,IAEEjD,KAAM3E,EAAOR,QAInB,CAACtB,IAGG2J,EAA4B3J,EAAMsJ,MAAMhJ,KAAI,SAACoH,GAAD,MAAW,CAC3DpG,GAAIoG,EAAKpG,GACTT,KAAM6G,EAAKd,SAGPgD,EAA6CC,mBACjD,iBAAM,CACJ,CACEhJ,KAAM,aACNJ,IAAK,WACLjB,MAAO,GACPoB,WAAY,IACZgB,QAAS+H,EACT3H,eAAgBmH,GAElB,CACEtI,KAAM,cACNJ,IAAK,WACLjB,MAAO,GACPoB,WAAY,IACZgB,QAAS+H,EACT3H,eAAgBuH,GAElB,CACE1I,KAAM,aACNJ,IAAK,qBACLjB,MAAO,GACPoB,WAAY,KAEd,CACEC,KAAM,OACNJ,IAAK,OACLjB,MAAO,GACPoB,WAAY,IACZgB,QAASwG,GACTpG,eAAgByH,MAGpB,CACEE,EACAF,EACAN,EACAI,IAIEO,EAAgB9J,EAAMsJ,MACzBnD,QAAO,SAACuB,GAAD,OAAUA,EAAKpI,YACtBgB,KAAI,SAACoH,GAAD,OAAUA,EAAKpG,MAahBqE,EAXiD3F,EAAMwF,KAC1DlF,KAAI,SAACmE,GACJ,OAAO,2BACFA,GADL,IAEEnF,SACEwK,EAAczC,SAAS5C,EAAI4B,OAAO/E,KAClCwI,EAAczC,SAAS5C,EAAI/C,OAAOJ,SAGvCsE,KAAKF,GAEmCpF,KAAI,SAACmE,GAC9C,IAAMsF,EAAOH,EAAkBtJ,KAAI,SAACC,GAClC,SAASyJ,EACPpI,EACAP,GAEA,OACE,cAAC9B,EAAD,CAA0BC,MAAOe,EAAIf,MAAOC,SAAUc,EAAIK,WAA1D,SACE,cAAC4D,EAAD,CACEC,IAAKA,EACLlE,IAAKA,EACLqB,QAASA,EACT+C,mBAAoBtD,EACpBqD,YAAa1E,EAAM0E,YACnB7B,WACc,uBAAZtC,EAAIE,SACAsB,EACa,QAAb0C,EAAIgC,KACJ,SACA,UAZOlG,EAAIE,KAmBzB,GAAMF,EAAIqB,QAAS,CACjB,IAAMP,EAAYd,EAAIqB,QAAQC,MAC5B,SAACC,GAAD,OAAYA,EAAOR,KAAOmD,EAAIlE,EAAIE,QAiBpC,OAAOuJ,EAdU3I,EAAD,CAGVA,GAHU,mBAIPgH,GACD9H,EAAIE,IACJF,EAAIqB,SAAW,GACf6C,EAAInD,GACJmD,EAAI4B,OAAO/E,GACXmD,EAAI/C,OAAOJ,GACXtB,EAAMwF,MACNW,QAAO,SAAC8C,GAAD,OAASA,EAAI3H,KAAOD,EAAUC,QAVzC,GAa2BD,GAE/B,OAAO2I,EAAe,QAAIjI,MAI9B,OACE,eAAC3C,EAAD,CAEEC,eAAgBxC,EAAOoB,YACvBqB,SAAUmF,EAAInF,SAHhB,UAKGyK,EACD,cAAC5E,EAAD,CAAYV,IAAKA,EAAKW,YAAa,kBAAMpF,EAAMoF,YAAYX,QALtDA,EAAInD,OAUf,OACE,cAACzC,EAAD,UACE,eAACG,EAAD,WACE,cAACe,EAAD,CACEE,QAAS2J,EACT1J,UAAWA,EACXC,aAAcA,IAEhB,cAAClB,EAAD,UAAkB0G,IAClB,cAACzG,EAAD,CAAiBwB,QAASV,EAAMyF,YAAhC,oBC9SR,IAAMwE,GAAoBnL,IAAOC,IAAV,8EAAGD,CAAH,2FAQjBoL,GAAapL,IAAOC,IAAV,uEAAGD,CAAH,qJAGJjC,EAAOoB,aASbkM,GAAYrL,IAAOC,IAAV,sEAAGD,CAAH,oUAEJ,gBAAGU,EAAH,EAAGA,MAAH,gBAA0B,IAARA,EAAlB,QAuBL4K,GAAgBtL,IAAOC,IAAV,0EAAGD,CAAH,qEASbuL,GAAqBvL,IAAOC,IAAV,+EAAGD,CAAH,yCAeT,SAASwL,GAAKtK,GAC3B,MAAkC8C,mBAAS,GAA3C,mBAAOyH,EAAP,KAAkBC,EAAlB,KAEA,OACE,eAACP,GAAD,WACGjK,EAAMyK,KAAK7F,OAAS,GACnB,cAACsF,GAAD,UACGlK,EAAMyK,KAAKnK,KAAI,SAACoK,EAAKC,GACpB,OACE,cAACR,GAAD,CAEE9F,SAAU,EACV3D,QAAS,kBAAM8J,EAAaG,IAC5BrG,QAAS,SAAC9C,GACU,UAAdA,EAAMf,KACR+J,EAAaG,IAGjBnL,MAAOkL,EAAIlL,MATb,SAWE,cAAC4K,GAAD,CAAeQ,UAAWD,IAAQJ,EAAY,SAAW,GAAzD,SACGG,EAAI7J,QAXF6J,EAAI7J,WAmBnB,cAACwJ,GAAD,CAAoBQ,eAAgB7K,EAAMyK,KAAK7F,QAAU,EAAzD,SACG5E,EAAMyK,KAAKtE,QAAO,SAAC2E,EAAGH,GAAJ,OAAYA,IAAQJ,KAAW,GAAGQ,eClGtD,IAAMC,GAASC,OAAOC,OAAO,CAAEC,EAAG,EAAGC,EAAG,IAUxC,SAASC,GAAWC,EAAWC,GACpC,MAAO,CAAEJ,EAAGG,EAAGH,EAAII,EAAGJ,EAAGC,EAAGE,EAAGF,EAAIG,EAAGH,GAGjC,SAASI,GAAWF,EAAWG,GACpC,MAAO,CAAEN,EAAGG,EAAGH,EAAIM,EAAOL,EAAGE,EAAGF,EAAIK,GCbtC,IAAMC,GAAY7D,mBAAS,CACzBjB,KAAM,gBACNkB,gBAAiB,KACjBC,oBAAqB,MACrBC,UAAW,IACXC,YAAY,IAER0D,GAAqB,2BACtBD,IADsB,IAEzBlE,OAAQ,CAAE2D,EAAG,IAAKC,EAAG,KACrB9L,UAAU,EACV4I,cAAe,MAGX0D,GAAU/D,mBAAS,CACvBjB,KAAM,iBACNkB,gBAAiB,GACjBC,oBAAqB,IACrBC,UAAW,EACXC,YAAY,IAER4D,GAAmB,2BACpBD,IADoB,IAEvBpE,OAAQ,CAAE2D,EAAG,IAAKC,EAAG,KACrB9L,UAAU,EACV4I,cAAe,MAGX4D,GAAUjE,mBAAS,CACvBjB,KAAM,gBACNkB,gBAAiB,KACjBC,oBAAqB,IACrBC,UAAW,EACXC,YAAY,IASD8D,GAA0B,CAACJ,GAAcE,GAP7B,2BACpBC,IADoB,IAEvBtE,OAAQ,CAAE2D,EAAG,IAAKC,EAAG,KACrB9L,UAAU,EACV4I,cAAe,OAKJ8D,GAAsC,CACjD1F,EAAkBoF,GAAWE,GAAS,OAAQ,KAC9CtF,EAAkBwF,GAASJ,GAAW,OAAQ,KAC9CpF,EAAkBwF,GAASF,GAAS,OAAQ,MAGjCK,GAAwB,CACnCC,UAAWrP,EAAOK,uBAClBiP,WAAYtP,EAAOI,yBAGRmP,GAA0C,CACrDC,OAAQrB,GACRS,MAAO,GAGIa,GAAgC,CAC3CC,oBAAqB1P,EAAOQ,2BAC5BmP,qBAAsB3P,EAAOS,4BAC7BmP,oBAAqB5P,EAAOU,4BAGjBmP,GAAgC,CAC3CC,SAAS,EACTxJ,KAAM,UAGKyJ,GAAkB,CAC7BC,YAAQ9K,EACR+K,OAAQb,GACR3C,MAAOyC,GACP7F,YAAa8F,GACbe,gBAAiBX,GACjBY,iBAAkBZ,GAClBa,WAAYX,IC9ER9J,GAA6B1D,IAAOC,IAAV,gGAAGD,CAAH,wIAU1BoO,GAAepO,IAAOK,OAAV,kFAAGL,CAAH,uCAKZqO,GAAerO,IAAOC,IAAV,kFAAGD,CAAH,2CAKZoD,GAAcpD,IAAOqD,MAAV,iFAAGrD,CAAH,yBAIXsO,GAAoBtO,IAAOC,IAAV,uFAAGD,CAAH,mCAOjBuO,GAAqBvO,IAAOC,IAAV,wFAAGD,CAAH,MAElBwO,GAAoBxO,IAAOC,IAAV,uFAAGD,CAAH,2GASjByO,GAAqBzO,IAAOC,IAAV,wFAAGD,CAAH,0EAOlB0O,GAAc1O,IAAO2O,MAAV,iFAAG3O,CAAH,yBAYF,SAAS4O,GACtB1N,GAEA,IAAQ2N,EAAgE3N,EAAhE2N,SAAUC,EAAsD5N,EAAtD4N,YAAaC,EAAyC7N,EAAzC6N,cAAeC,EAA0B9N,EAA1B8N,WAAYC,EAAc/N,EAAd+N,UAE1D,EAA4CjL,mBAAiB,IAA7D,mBAAOkL,EAAP,KAAuBC,EAAvB,KAEA,OACE,eAAC,GAAD,WACE,eAACZ,GAAD,WACE,eAACC,GAAD,WACE,cAACE,GAAD,4BACA,cAACD,GAAD,UACE,cAACxJ,EAAD,CACErB,aAAciL,EAASb,OAAOX,WAC9BxJ,OAAQ,SAACuL,GAAD,OACNH,EAAU,2BAAKJ,EAASb,QAAf,IAAuBX,WAAY+B,aAKpD,eAACZ,GAAD,WACE,cAACE,GAAD,6BACA,cAACD,GAAD,UACE,cAACxJ,EAAD,CACErB,aAAciL,EAASb,OAAOZ,UAC9BvJ,OAAQ,SAACwL,GAAD,OACNJ,EAAU,2BACLJ,EAASb,QADL,IAEPZ,UAAWiC,gBAOvB,eAACf,GAAD,WACE,cAACF,GAAD,CAAcxM,QAASoN,EAAvB,uBACA,cAACZ,GAAD,CACExM,QAAS,kBACP0N,UAAUC,UAAUC,UAAUC,KAAKC,UAAUb,KAFjD,wCAQF,eAACR,GAAD,WACE,cAACK,GAAD,qBACA,cAAC,GAAD,CACEpM,MAAO4M,EACPzM,SAAU,SAACC,GAAD,OAAWyM,EAAkBzM,EAAME,OAAON,UAEtD,cAAC8L,GAAD,CACExM,QAAS,WACPkN,EAAYW,KAAKE,MAAMT,IACvBC,EAAkB,KAHtB,6BAUF,cAACf,GAAD,CACExM,QAAS,kBACPmN,GAAc,SAACa,GAAD,mBAAC,eACVA,GADS,IAEZ/B,SAAS,EACTxJ,KAAM,UACNwL,UAAW,kBAAMf,EAAYhB,KAC7BgC,YAAa,CACX,gHACA,uCATR,sBChGS,SAASC,GAAQ7O,GAC9B,IACE2N,EAaE3N,EAbF2N,SACAC,EAYE5N,EAZF4N,YACAC,EAWE7N,EAXF6N,cACArO,EAUEQ,EAVFR,MACA6C,EASErC,EATFqC,OACA0L,EAQE/N,EARF+N,UACAe,EAOE9O,EAPF8O,UACAC,EAME/O,EANF+O,gBACAC,EAKEhP,EALFgP,YACAC,EAIEjP,EAJFiP,YACAC,EAGElP,EAHFkP,kBACAC,EAEEnP,EAFFmP,kBACArB,EACE9N,EADF8N,WAGIsB,EACJ,cAAC7J,EAAD,CACEC,KAAMmI,EAASrE,MACf5E,YAAa,SAACgD,GAAD,OAAmBsH,EAAY,CAACtH,IAAO,IACpDtC,YAAa,SAACsC,GAAD,OAAmBuH,EAAY,CAACvH,EAAKpG,MAClDmE,YAAaqJ,IAIXO,EACJ,cAACnG,GAAD,CACE1D,KAAMmI,EAASzH,YACfoD,MAAOqE,EAASrE,MAChB5E,YAAa,SAAC0E,GAAD,OACX8F,EAAkB,CAAC9F,KAErBhE,YAAa,SAACgE,GAAD,OACX+F,EAAkB,CAAC/F,EAAW9H,MAEhCmE,YAAasJ,IAIjB,OACE,eAAC3M,EAAD,CAAc5C,MAAOA,EAAO6C,OAAQA,EAApC,UACE,cAACC,EAAD,CAAcC,WAAYoL,EAASV,WAAWR,oBAA9C,SACE,cAACnC,GAAD,CACEG,KAAM,CACJ,CAAE5J,KAAM,QAASkK,UAAWqE,EAAW5P,MAAO,IAC9C,CAAEqB,KAAM,cAAekK,UAAWsE,EAAiB7P,MAAO,SAIhE,cAACgD,EAAD,CACED,WAAY,EAAIoL,EAASV,WAAWR,oBADtC,SAGE,cAACiB,GAAD,CACEC,SAAUA,EACVC,YAAaA,EACbC,cAAeA,EACfC,WAAYA,EACZC,UAAWA,S,uFC9EfuB,GAAgBxQ,IAAOC,IAAV,8EAAGD,CAAH,4EAObyQ,GAAqBzQ,IAAOC,IAAV,mFAAGD,CAAH,qCAKlB0Q,GAAoB1Q,IAAOC,IAAV,kFAAGD,CAAH,2DACZ,SAACkB,GAAD,OAAWA,EAAMyP,SAKtBC,GAAqB5Q,IAAOC,IAAV,mFAAGD,CAAH,8CAIR,SAACkB,GAAD,OAAWA,EAAM2P,SAIjC,SAASC,GAAc5P,GACrB,IAAQ6P,EAAkC7P,EAAlC6P,OAAQC,EAA0B9P,EAA1B8P,QAASrC,EAAiBzN,EAAjByN,MAAOkC,EAAU3P,EAAV2P,MAEhC,GAAIE,GAAUC,GAAWA,EAAQlL,OAAQ,CACvC,IAAMmL,EAAgB,YAAID,GAASlK,MACjC,SAACoK,EAAmBC,GAClB,OAAID,EAAE5O,MAAQ6O,EAAE7O,OACN,EACC4O,EAAE5O,QAAU6O,EAAE7O,MACnB4O,EAAEpJ,KAAOqJ,EAAErJ,KACN,GAEC,EAGH,KAKb,OACE,eAAC0I,GAAD,WACE,cAACC,GAAD,0BAA8B9B,EAA9B,OACCsC,EAAczP,KAAI,SAAC4P,GAClB,OACE,eAACV,GAAD,CAAmCC,MAAOS,EAAKT,OAAS,QAAxD,UACE,8BAAMS,EAAKtJ,OACX,cAAC8I,GAAD,CAAoBC,MAAOA,EAA3B,SACGO,EAAK9O,UAHc8O,EAAKtJ,YAYvC,OAAO,KAcM,SAASuJ,GAASnQ,GAC/B,IACEoQ,EAQEpQ,EARFoQ,eACAC,EAOErQ,EAPFqQ,SACAC,EAMEtQ,EANFsQ,MACAC,EAKEvQ,EALFuQ,SACAC,EAIExQ,EAJFwQ,OACAC,EAGEzQ,EAHFyQ,OACAC,EAEE1Q,EAFF0Q,QACAC,EACE3Q,EADF2Q,KAGF,OACE,eAACC,GAAA,EAAD,CACEvO,OAAQ+N,EAAe/N,OACvB7C,MAAO4Q,EAAe5Q,MACtBqR,OAAQT,EAAeS,OACvBC,KAAMT,EAJR,UAME,cAACU,GAAA,EAAD,CAAeC,gBAAgB,QAC/B,cAACC,GAAA,EAAD,CACEC,QAASX,EACT9C,MAAO,CACLrM,MAAOoP,EACPW,SAAU,SACVC,GAAI,MAGR,cAACC,GAAA,EAAD,CACEC,OAAQZ,EACRjD,MAAO,CACLrM,MAAOqP,EACPU,SAAU,SACVI,OAAQ,GACRC,IAAK,MAGT,cAACC,GAAA,EAAD,CAASC,QAAS,cAAC9B,GAAD,CAAeD,MAAOgB,MACxC,cAACgB,GAAA,EAAD,CACEC,OAAO,aACPC,cAAc,MACdC,MAAM,SACNC,aAAc,CACZC,YAAa,OACbC,cAAe,UAGlB3B,KCjIP,IAAQ3R,GAA2C9B,EAA3C8B,cAAeD,GAA4B7B,EAA5B6B,wBAEjBwT,GAAS,CACb,UACA,UACA,UACA,UACA,UACA,UACA,WAGIC,GAAerT,IAAOC,IAAV,8SAiBZqT,GAAatT,IAAOC,IAAV,8HAEJ,SAACiB,GAAD,OAAWA,EAAMqC,UA0B7B,SAASgQ,GAAoBlQ,GAC3B,OAAOmQ,KAAKC,MAAc,GAARpQ,GAAc,GAGlC,SAASqQ,GACP1B,GAGA,IAAM2B,EAAWH,KAAKI,MAAMJ,KAAKK,MAAM7B,EAAK3E,aACtCyG,EAAcN,KAAKO,IAAI,GAAIJ,EAAW,GAK5C,IAAMK,EAAahC,EAAKiC,YAAYnO,OAASjG,GAEvCqU,EAAwC,GAC1CC,EAAU,IACVC,GAAW,IACTC,EAAgD,GAClDC,EAAkB,IAClBC,GAAmB,IAiCvB,OA/BAvC,EAAKiC,YAAYO,SAAQ,SAACC,EAAG5I,GAC3B,GAAImI,IAdWU,EAcWD,EAba,IAAhCjB,KAAKmB,IAAID,EAAMZ,IAaQ,CAC5B,IAAMc,EAA2B,CAAEC,KAAMJ,GACnCK,EAAyB,CAAED,KAAMJ,GAEvCzC,EAAK+C,YAAYP,SAAQ,SAACQ,GACxB,IAAMC,EAAUD,EAAWE,SAASrJ,GAChCoJ,EAAUd,EACZA,EAAUc,EACDA,EAAUb,IACnBA,EAAUa,GAEZL,EAAKI,EAAWpM,KAAKd,MAAQyL,GAAoB0B,MAGnDjD,EAAKmD,kBAAkBX,SAAQ,SAACY,GAC9B,IAAMC,EAAkBD,EAAiBE,cAAczJ,GACnDwJ,EAAkBf,EACpBA,EAAkBe,EACTA,EAAkBd,IAC3BA,EAAkBc,GAEpBP,EAAG,GAAD,OACGM,EAAiB9K,WAAW/C,OAAOO,KADtC,eACiDsN,EAAiB9K,WAAW1H,OAAOkF,OAClFyL,GAAoB8B,MAG1BnB,EAAgBqB,KAAKX,GACrBP,EAAwBkB,KAAKT,GAzCjC,IAAiBJ,KA4CV,CACLR,EACA,CAACC,EAASC,GACVC,EACA,CAACC,EAAiBC,IASP,SAASiB,GAAKtU,GAC3B,IAAMuU,KACJvU,EAAMwU,aAAexU,EAAMwU,YAAYX,YAAYjP,OAAS,GAExD6P,EACJF,GAAkBvU,EAAMwU,YAAcxU,EAAMwU,YAAcE,cAE5D,EACElC,GAAUiC,GADZ,mBAAOE,EAAP,KAAqBC,EAArB,KAAiCC,EAAjC,KAAuDC,EAAvD,KAGMC,GACHH,EAAW,GAAKA,EAAW,IAAMlW,GAC9BsW,EAA4CT,EAC9C,CACEjC,KAAKI,MAAMkC,EAAW,GAAKG,GAC3BzC,KAAK2C,KAAKL,EAAW,GAAKG,SAE5BhT,EAEEmT,GACHJ,EAAmB,GAAKA,EAAmB,IAAMpW,GAC9CyW,EAAoDZ,EACtD,CACEjC,KAAKI,MAAMoC,EAAmB,GAAKI,GACnC5C,KAAK2C,KAAKH,EAAmB,GAAKI,SAEpCnT,EAEEqT,EAAoBvL,mBACxB,kBACE4K,EAAIR,kBAAkB3T,KAAI,SAAC4T,EAAkBvJ,GAC3C,OACE,cAAC0K,GAAA,EAAD,CAEElS,KAAM,WACN+N,QAAO,UAAKgD,EAAiB9K,WAAW/C,OAAOO,KAAxC,eAAmDsN,EAAiB9K,WAAW1H,OAAOkF,MAC7F0O,OAAQpD,GAAOvH,GACf4K,UAAW,CAAEC,EAAG,GAChBC,mBAAmB,GALdvB,EAAiB9K,WAAW9H,SASzC,CAACmT,EAAIR,oBAGDyB,EAAY7L,mBAChB,kBACE4K,EAAIZ,YAAYvT,KAAI,SAACwT,EAAYnJ,GAC/B,OACE,cAAC0K,GAAA,EAAD,CAEElS,KAAM,WACN+N,QAAS4C,EAAWpM,KAAKd,KACzB0O,OAAQpD,GAAOvH,GACf4K,UAAW,CAAEC,EAAG,GAChBC,mBAAmB,GALd3B,EAAWpM,KAAKpG,SAS7B,CAACmT,EAAIZ,cAGD8B,EACJ,cAACxF,GAAD,CACEC,eAAgBpQ,EAAMoQ,eACtBC,SAAUsE,EACVrE,MAAOoF,EACPnF,SAAU,OACVC,OAAQ,WACRC,OAAQ,qBACRC,QAASsE,EACTrE,KAAM,SAIJiF,EACJ,cAACzF,GAAD,CACEC,eAAgBpQ,EAAMoQ,eACtBC,SAAUwE,EACVvE,MAAO8E,EACP7E,SAAU,OACVC,OAAQ,WACRC,OAAQ,wBACRC,QAASyE,EACTxE,KAAM,MAIV,OACE,cAACyB,GAAD,CACE/P,OAAQrC,EAAMoQ,eAAe/N,OAC7B7C,MAAOQ,EAAMoQ,eAAe5Q,MAF9B,SAIE,cAAC2S,GAAD,UACE,cAAC7H,GAAD,CACEG,KAAM,CACJ,CACE5J,KAAM,cACNkK,UAAW4K,EACXnW,MAAO,IAET,CACEqB,KAAM,gBACNkK,UAAW6K,EACXpW,MAAO,W,cCrObxB,GAAuDnB,EAAvDmB,yBAA0BF,GAA6BjB,EAA7BiB,YAAaC,GAAgBlB,EAAhBkB,YAClC8X,GAAiBvD,KAAKI,OAAO5U,GAAcC,IAAe,GA+HhE,SAAS+X,GACdC,EACAnP,EACAY,EACAwO,EACAvG,EACAnQ,EACA2I,EACAC,IArIF,SACE6N,EACAvO,EACAwO,EACAvG,GAEAsG,EAAQE,OACRF,EAAQG,YACRH,EAAQI,IAAI3O,EAAO2D,EAAG3D,EAAO4D,EAAG4K,EAAQ,EAAG,EAAI1D,KAAK8D,IACpDL,EAAQM,UAAY5G,EACpBsG,EAAQO,OACRP,EAAQQ,YACRR,EAAQS,UA2HRC,CAAWV,EAASvO,EAAQwO,EAAQvG,GAChCnQ,GAzHN,SACEyW,EACAvO,EACAwO,EACAvG,GAEAsG,EAAQE,OACRF,EAAQG,YAERH,EAAQI,IACN3O,EAAO2D,EACP3D,EAAO4D,EACP4K,EAAShY,GAA2B,EACpC,EACA,EAAIsU,KAAK8D,IAEXL,EAAQW,UAAY1Y,GACpB+X,EAAQY,YAAclH,EACtBsG,EAAQT,SACRS,EAAQQ,YACRR,EAAQS,UAsGNI,CAAkBb,EAASvO,EAAQwO,EAAQ,SAEzC/N,GArGN,SACE8N,EACAvO,EACAwO,GAEAD,EAAQE,OACRF,EAAQW,UAAY,EACpBX,EAAQM,UAAY,UAOpBN,EAAQc,UAAUrP,EAAO2D,EAAG3D,EAAO4D,GACnC2K,EAAQe,OAAOxE,KAAK8D,GAAK,GAGzBL,EAAQG,YACRH,EAAQgB,QAAQf,EAAQ,GACxBD,EAAQiB,OAAOhB,EAAQ,GACvBD,EAAQT,SAIR,IADA,IAAI2B,EAAI,EACDA,EAhBO,IAgBKjB,GAAQ,CACzBiB,GAjBY,IAkBZ,IAAMC,EAAYlB,EAAS1D,KAAK6E,IAAI7E,KAAK8E,KAAKH,EAAIjB,IAClDD,EAAQgB,QAAQG,EAlBH,EAkBuBD,GACpClB,EAAQiB,OAAOE,EAnBF,EAmBsBD,GACnClB,EAAQT,SACRS,EAAQgB,QAAQG,EArBH,GAqBwBD,GACrClB,EAAQiB,OAAOE,EAtBF,GAsBuBD,GACpClB,EAAQT,SAEVS,EAAQQ,YAGRR,EAAQG,YACRH,EAAQI,IAAI,EAAG,EAAGH,EA5BH,EA4BoB,EAAa,EAAV1D,KAAK8D,IAAQ,GACnDL,EAAQI,IAAI,EAAG,EAAGH,EAAQ,EAAa,EAAV1D,KAAK8D,IAAQ,GAC1CL,EAAQO,OAERP,EAAQS,UA2DNa,CAAgBtB,EAASvO,EAAQwO,GAxDrC,SACED,EACAnP,EACAY,EACAwO,EACA9N,GAGA6N,EAAQE,OACRF,EAAQuB,KAAO,iBACf,IAAMC,EAAcxB,EAAQyB,YAAY5Q,GAClCpH,EAAQ+X,EAAY/X,MAC1BuW,EAAQc,UAAUrP,EAAO2D,EAAG3D,EAAO4D,GACb,MAAlBlD,EACF6N,EAAQ0B,SACN7Q,GACCpH,EAAQ,EACT+X,EAAYG,wBAA0B1B,EAVvB,GAYU,MAAlB9N,EACT6N,EAAQ0B,SACN7Q,EACAoP,EAfe,EAgBfuB,EAAYG,wBAA0B,GAEb,MAAlBxP,EACT6N,EAAQ0B,SACN7Q,GACCpH,EAAQ,IACP+X,EAAYI,yBAA2B3B,EAtB1B,IAyBjBD,EAAQ0B,SACN7Q,IACEpH,EAAQwW,EA3BK,GA4BfuB,EAAYG,wBAA0B,GAG1C3B,EAAQS,UAoBRoB,CAAa7B,EAASnP,EAAMY,EAAQwO,EAAQ9N,GAiIvC,SAAS2P,GACd9B,EACA+B,EACAC,EACAC,EACAC,EACAxR,GAEI,CAAC,OAAQ,QAAQY,SAASZ,GAtIzB,SACLsP,EACAmC,EACAC,EACA1I,GAGO,IAFP2I,EAEM,uDAFQ,EACdC,EACM,uDADM,EAEZtC,EAAQE,OACRF,EAAQG,YACRH,EAAQY,YAAclH,EACtBsG,EAAQW,UAAY,EACpB,IAAM4B,EAAa,EACbC,EAAY,EACZC,EAAW,EACXhH,EAAK2G,EAAIhN,EAAI+M,EAAM/M,EACnBiG,EAAK+G,EAAI/M,EAAI8M,EAAM9M,EACnBmG,EAAQe,KAAKmG,MAAMrH,EAAII,GAEvBkH,EADSpG,KAAKqG,KAAKnH,EAAKA,EAAKJ,EAAKA,GACbiH,EAE3BtC,EAAQc,UAAUqB,EAAM/M,EAAG+M,EAAM9M,GACjC2K,EAAQe,OAAOvF,GAEfwE,EAAQG,YACRH,EAAQgB,OAAOqB,EAAaI,GAC5BzC,EAAQiB,OAAO0B,EAAWF,GAC1BzC,EAAQgB,OAAO2B,EAAYJ,EAAYC,EAAYC,GACnDzC,EAAQiB,OAAO0B,EAAWF,GAC1BzC,EAAQiB,OAAO0B,EAAYJ,IAAcC,EAAYC,IAErDzC,EAAQgB,OAAO2B,GAAYF,GAC3BzC,EAAQiB,OAAOoB,GAAcI,GAC7BzC,EAAQgB,OAAOqB,EAAcE,IAAcC,EAAYC,IACvDzC,EAAQiB,OAAOoB,GAAcI,GAC7BzC,EAAQiB,OAAOoB,EAAcE,EAAYC,EAAYC,GAErDzC,EAAQT,SACRS,EAAQQ,YACRR,EAAQS,UAgGNoC,CACE7C,EACA+B,EACAE,EACA,QACAD,EACAE,GAnGC,SACLlC,EACAmC,EACAC,EACA1I,GAGO,IAFP2I,EAEM,uDAFQ,EACdC,EACM,uDADM,EAEZtC,EAAQE,OACRF,EAAQG,YACRH,EAAQY,YAAclH,EACtBsG,EAAQW,UAAY,EACpB,IAAM4B,EAAa,EACbC,EAAY,EACZ/G,EAAK2G,EAAIhN,EAAI+M,EAAM/M,EACnBiG,EAAK+G,EAAI/M,EAAI8M,EAAM9M,EACnBmG,EAAQe,KAAKmG,MAAMrH,EAAII,GAEvBkH,EADSpG,KAAKqG,KAAKnH,EAAKA,EAAKJ,EAAKA,GACbiH,EAE3BtC,EAAQc,UAAUqB,EAAM/M,EAAG+M,EAAM9M,GACjC2K,EAAQe,OAAOvF,GAEfwE,EAAQG,YACRH,EAAQgB,OAAOqB,EAAa,GAC5BrC,EAAQiB,OAAO0B,EAAW,GAC1B3C,EAAQgB,OAAO2B,EAAYJ,GAAaC,GACxCxC,EAAQiB,OAAO0B,EAAW,GAC1B3C,EAAQiB,OAAO0B,EAAYJ,EAAYC,GACvCxC,EAAQT,SACRS,EAAQQ,YACRR,EAAQS,UAuENqC,CACE9C,EACA+B,EACAE,EACA,QACAD,EACAE,GAKC,SAASa,GACdC,EACAC,EACAhD,GAEA,IAAMiD,EAASF,EAAM5N,EAAI6N,EAAa7N,EAChC+N,EAASH,EAAM3N,EAAI4N,EAAa5N,EACtC,OAAOkH,KAAKO,IAAIoG,EAAQ,GAAK3G,KAAKO,IAAIqG,EAAQ,IAAM5G,KAAKO,IAAImD,EAAQ,GA8BhE,SAASmD,GACd3X,EACA4X,GAEA,IAAMC,EAAmB,CAAElO,EAAG3J,EAAM8X,MAAOlO,EAAG5J,EAAM+X,OAC9CC,EAAeJ,EAAQK,wBAE7B,OAAOpO,GAAWgO,EADO,CAAElO,EAAGqO,EAAalb,KAAM8M,EAAGoO,EAAahb,MAY5D,SAASkb,GACdlY,EACAmY,GAEA,GAAIA,EAAY5D,QAAS,CACvB,IAAM6D,EAAcT,GAClB3X,EACAmY,EAAY5D,QAAQ8D,QAEtB,OAhBFC,EAiBIF,EAhBJvN,EAiBIsN,EAAY5M,gBAAgBV,OAhBhCZ,EAiBIkO,EAAY5M,gBAAgBtB,MAfzBJ,GAAWG,GAAWsO,EAAOrO,GAAQY,GAkB1C,OAAOrB,GAvBX,IACE8O,EACAzN,EACAZ,EAmDK,SAASsO,GACdC,EACAC,GAEA,IAAMC,EAAM5H,KAAK4H,IAAL,MAAA5H,KAAI,YAAQ2H,IAClBE,EAAM7H,KAAK6H,IAAL,MAAA7H,KAAI,YAAQ2H,IAIxB,OAAIC,IAAQC,EACHtE,IAGLmE,EAAcE,IAAQC,EAAMD,IAASnc,GAAcD,IACrDA,GC7ZJ,IAAQF,GAAoDf,EAApDe,QAASD,GAA2Cd,EAA3Cc,QAASD,GAAkCb,EAAlCa,gBAAiBG,GAAiBhB,EAAjBgB,aCR3C,IAAMuc,GAAgBtb,IAAOC,IAAV,mFAAGD,CAAH,2EAQboO,GAAepO,IAAOK,OAAV,kFAAGL,CAAH,mBAWH,SAASub,GACtBra,GAEA,OACE,eAACoa,GAAD,WACE,cAAC,GAAD,CACE1Z,QAAS,kBACPV,EAAM2Z,YAAY5D,SAClB/V,EAAMsa,mBAAmB,CAAEjO,OAAQrB,GAAQS,MAAO,KAHtD,wBAQA,cAAC,GAAD,CACE/K,QAAS,kBACPV,EAAM2Z,YAAY5D,SAClB/V,EAAMsa,mBAAmB,CACvBjO,OAAQrM,EAAMgN,iBAAiBX,OAC/BZ,MAAOzL,EAAMgN,iBAAiBvB,SALpC,iCAWA,cAAC,GAAD,CACE/K,QAAS,WACPV,EAAMua,oBAAoB,CACxBlO,OAAQrM,EAAM2Z,YAAY5M,gBAAgBV,OAC1CZ,MAAOzL,EAAM2Z,YAAY5M,gBAAgBtB,SAJ/C,0BC5CN,I,MAAM+O,GAAsB1b,IAAOC,IAAV,yFAAGD,CAAH,4CAMnB2b,GAA2B3b,IAAOK,OAAV,8FAAGL,CAAH,sBAQf,SAAS4b,GACtB1a,GAEA,IAAQ6N,EAAkB7N,EAAlB6N,cAER,OACE,eAAC2M,GAAD,WACE,cAACC,GAAD,CACE/Z,QAAS,kBAAMmN,EAAc,CAAElB,SAAS,EAAMxJ,KAAM,YADtD,oBAKA,cAACsX,GAAD,CACE/Z,QAAS,kBAAMmN,EAAc,CAAElB,SAAS,EAAMxJ,KAAM,cADtD,sBAKA,cAACsX,GAAD,CACE/Z,QAAS,kBAAMmN,EAAc,CAAElB,SAAS,EAAMxJ,KAAM,WADtD,sBCzBN,IAAMwX,GAAsB7b,IAAOC,IAAV,8FAMnB6b,GAAe9b,IAAO+a,OAAV,8DACP,gBAAGgB,EAAH,EAAGA,SAAH,gBAAqBA,EAArB,SACC,gBAAGC,EAAH,EAAGA,UAAH,gBAAsBA,EAAtB,SAqCG,SAASC,GAAO/a,GAC7B,ICpDAgb,EACAC,EDoDEC,EAYElb,EAZFkb,YACAC,EAWEnb,EAXFmb,aACAC,EAUEpb,EAVFob,iBACAC,EASErb,EATFqb,KACAC,EAQEtb,EARFsb,YACAC,EAOEvb,EAPFub,kBACAxO,EAME/M,EANF+M,gBACAuN,EAKEta,EALFsa,mBACAkB,EAIExb,EAJFwb,qBACAC,EAGEzb,EAHFyb,wBACAC,EAEE1b,EAFF0b,kBACA7N,EACE7N,EADF6N,cAII8N,EAAYC,iBAA0B,MCpE5CZ,EDqEiBW,ECpEjBV,EDoE4BS,EClE5BG,qBAAU,WACR,IAAMC,EAAqB,SAACta,GAC1B,IAAMua,IACFf,EAAIgB,SAAWhB,EAAIgB,QAAQC,SAASza,EAAME,QAC9CuZ,EAAcc,IAKhB,OADAG,SAASC,iBAAiB,YAAaL,GAChC,WAELI,SAASE,oBAAoB,YAAaN,MAE3C,CAACd,EAAKC,IDsDT,MH3Da,SACbU,EACA5O,EACAuN,GAMA,MAA8BxX,mBAA0C,MAAxE,mBAAOiT,EAAP,KAAgBsG,EAAhB,KACMC,EAAcV,iBAAc5Q,IAC5BuR,EAAkBX,iBAAc5Q,IAChCwR,EAAsBZ,iBAAwB7O,GAG9C0P,EAAYxZ,uBAChB,SAACzB,GACC,GAAIuU,EAAS,CAEX,IAAM2G,EAAcvD,GAClB3X,EACAuU,EAAQ8D,QAEV0C,EAAgBP,QAAUM,EAAYN,QACtCM,EAAYN,QAAUU,EAEtB,IAAMC,EAAYnR,GAChBH,GAAWiR,EAAYN,QAASO,EAAgBP,SAChDjP,EAAgBtB,OAEZmR,EAAqB,CACzBnR,MAAOsB,EAAgBtB,MACvBY,QPpCgBf,EOoCEkR,EAAoBR,QAAQ3P,OPpCnBd,EOoC2BoR,EPnCvD,CAAExR,EAAGG,EAAGH,EAAII,EAAGJ,EAAGC,EAAGE,EAAGF,EAAIG,EAAGH,KOqChCkP,EAAmBsC,GACnBJ,EAAoBR,QAAUY,EPvC/B,IAAmBtR,EAAWC,IO0CjC,CAACwK,EAAShJ,EAAgBtB,MAAO6O,IAG7BuC,EAAU5Z,uBAAY,WAC1BiZ,SAASE,oBAAoB,YAAaK,GAC1CP,SAASE,oBAAoB,UAAWS,KACvC,CAACJ,IAEEK,EAAW7Z,uBACf,SAACzB,GACKuU,IACFmG,SAASC,iBAAiB,YAAaM,GACvCP,SAASC,iBAAiB,UAAWU,GACrCP,EAAYN,QAAU7C,GACpB3X,EACAuU,EAAQ8D,WAId,CAAC9D,EAAS0G,EAAWI,IAqDvB,OAjDAE,2BAAgB,WACd,SAASC,EAAYxb,GAEnB,GADAA,EAAMyb,iBACFlH,EAAS,CAEX,IAAM2G,EAAcvD,GAClB3X,EACAuU,EAAQ8D,QAEV0C,EAAgBP,QAAUM,EAAYN,QACtCM,EAAYN,QAAUU,EAGtB,IAAMQ,EAAY1b,EAAM0X,OAASxb,GAC3Byf,EACJ,GACC7K,KAAKmB,IAAIyJ,GAAarf,GAClBqf,EAAY5K,KAAKmB,IAAIyJ,GAAcrf,GACpCqf,GACAE,EAAWrQ,EAAgBtB,MAAQ0R,EACzC,GAAIC,EAAWxf,IAAWwf,EAAWzf,GACnC,OAIF,IAKM0f,EAAchS,GALFG,GAChB8Q,EAAYN,QACZjP,EAAgBtB,OAEDD,GAAW8Q,EAAYN,QAASoB,IAG3CR,EAAqB,CACzBvQ,OAAQhB,GAAWmR,EAAoBR,QAAQ3P,OAAQgR,GACvD5R,MAAO2R,GAET9C,EAAmBsC,GACnBJ,EAAoBR,QAAUY,GAIlC,IAAMU,EAAa3B,EAAUK,QAC7B,GAAIsB,EAGF,OAFAd,EAAoBR,QAAUjP,EAC9BuQ,EAAWnB,iBAAiB,QAASa,GAC9B,kBAAMM,EAAWlB,oBAAoB,QAASY,MAEtD,CAACrB,EAAW5O,EAAiBgJ,EAASuE,IAElC,CAACvE,EAASsG,EAAYS,GGnDWS,CACtC5B,EACA5O,EACAuN,GAHF,mBAAOvE,EAAP,KAAgBsG,EAAhB,KAA4BS,EAA5B,KAyCA,OAlCAC,2BAAgB,WACd,GAAIpB,EAAUK,QAAS,CAErB,IAAMwB,EAAY7B,EAAUK,QAAQyB,WAAW,MAC/CpB,EAAWmB,MAEZ,CAACnB,IAGJU,2BAAgB,WACVhH,IAEFA,EAAQ8D,OAAOra,MAAQ0b,EAAcE,EACrCrF,EAAQ8D,OAAOxX,OAAS8Y,EAAeC,EAEvCrF,EAAQtK,MACNsB,EAAgBtB,MAAQ2P,EACxBrO,EAAgBtB,MAAQ2P,GAE1BrF,EAAQc,UAAU9J,EAAgBV,OAAOlB,EAAG4B,EAAgBV,OAAOjB,GAEnEiQ,EAAKtF,MAEN,CACDoF,EACAD,EACAnF,EACAqF,EACAC,EACAtO,EAAgBV,OAAOlB,EACvB4B,EAAgBV,OAAOjB,EACvB2B,EAAgBtB,QAIhB,eAACkP,GAAD,WACE,cAACD,GAAD,CAAe7M,cAAeA,IAC9B,cAACwM,GAAD,CACEC,mBAAoBA,EACpBX,YAAa,CACX5D,UACAhJ,kBACAmO,cACAC,gBAEFnO,iBAAkBwO,EAClBjB,oBAAqBkB,IAEvB,cAACb,GAAD,CACEI,IAAKW,EACLnc,MAAO0b,EAAcE,EACrB/Y,OAAQ8Y,EAAeC,EACvBP,SAAUK,EACVJ,UAAWK,EACXG,YAAa,SAAC9Z,GAAD,OACX8Z,EACE9Z,EACA,CAAEuU,UAAShJ,kBAAiBmO,cAAaC,iBACzC,kBAAM2B,EAAStb,OAGnBkc,cAAe,SAAClc,GAAD,OACb+Z,EAAkB/Z,EAAO,CACvBuU,UACAhJ,kBACAmO,cACAC,uBEzIG,SAASwC,GACtBpW,EACAqW,GAKA,IAAMvC,EAAOpY,uBACX,SAAC8S,GACCxO,EAAS+L,SAAQ,SAAC5L,GAChB,IAAMmW,EAAa9D,GACjBrS,EAAKK,oBACLR,EAASjH,KAAI,SAACoH,GAAD,OAAUA,EAAKK,wBAExB+V,ENsZP,SACLC,EACAC,GAEA,IAAM/K,EAAUX,KAAK4H,IAAL,MAAA5H,KAAI,YAAQ0L,IACtB9K,EAAUZ,KAAK6H,IAAL,MAAA7H,KAAI,YAAQ0L,IACtBC,EAAQ/K,EAAUD,EAIxB,OAHaiL,eACV5M,OAAO,CAAC2B,EAAUgL,EAAQ,GAAIhL,EAAUC,GAAW,EAAGA,EAAU+K,EAAQ,IACxEA,MAAM,CAAC,OAAQ,UAAW,OACtBE,CAAKJ,GMhaYK,CAChB1W,EAAKI,gBACLP,EAASjH,KAAI,SAACoH,GAAD,OAAUA,EAAKI,oBAE9BgO,GACEC,EACArO,EAAKd,KACLc,EAAKF,OACLqW,EACAC,EACApW,EAAKpI,SACLoI,EAAKO,WACLP,EAAKQ,kBAIT0V,EAAetd,KAAI,SAAC8F,GAClB,IAAQC,EAAyBD,EAAzBC,OAAQ3E,EAAiB0E,EAAjB1E,OAAQ+E,EAASL,EAATK,KAClB4X,EAAgB9W,EAAS1F,MAAK,SAAC6F,GAAD,OAAUA,EAAKpG,KAAO+E,EAAO/E,MAC3Dgd,EAAgB/W,EAAS1F,MAAK,SAAC6F,GAAD,OAAUA,EAAKpG,KAAOI,EAAOJ,MACjE,GAAI+c,GAAiBC,EAAe,CAClC,IAAMvG,EAAegC,GACnBsE,EAActW,oBACdR,EAASjH,KAAI,SAACoH,GAAD,OAAUA,EAAKK,wBAExBkQ,EAAe8B,GACnBuE,EAAcvW,oBACdR,EAASjH,KAAI,SAACoH,GAAD,OAAUA,EAAKK,wBAE9B8P,GACE9B,EACAsI,EAAc7W,OACduQ,EACAuG,EAAc9W,OACdyQ,EACAxR,SAKR,CAACmX,EAAgBrW,IAGbgX,EAAiBtb,uBACrB,SAAC0W,GACKA,EAAY5D,UACd4D,EAAY5D,QAAQyI,WACjB7E,EAAY5M,gBAAgBV,OAAOlB,GACnCwO,EAAY5M,gBAAgBV,OAAOjB,EACpCuO,EAAYuB,YAAcvB,EAAY5M,gBAAgBtB,MACtDkO,EAAYwB,aAAexB,EAAY5M,gBAAgBtB,OAEzD4P,EAAK1B,EAAY5D,YAGrB,CAACsF,IAGH,MAAO,CAACA,EAAMkD,GCvED,SAASE,GACtBlX,EACAqW,EACAc,EACAH,GAMA,IAAMI,EAA0B1b,uBAC9B,SACEzB,EACAod,EACAjF,GAEA,GAAIA,EAAY5D,QAAS,CACvB,IAAM8I,EAAoBnF,GAAkBlY,EAAOmY,GACnD4E,EAAe5E,GP2MhB,SACL5D,EACAmC,EACAC,EACA1I,GAGO,IAFP2I,EAEM,uDAFQ,EACdC,EACM,uDADM,EAEZtC,EAAQE,OACRF,EAAQG,YACRH,EAAQY,YAAclH,EACtBsG,EAAQW,UAAY,EACpB,IAAMlF,EAAK2G,EAAIhN,EAAI+M,EAAM/M,EACnBiG,EAAK+G,EAAI/M,EAAI8M,EAAM9M,EACnBmG,EAAQe,KAAKmG,MAAMrH,EAAII,GACvB5M,EAAS0N,KAAKqG,KAAKnH,EAAKA,EAAKJ,EAAKA,GACxC2E,EAAQc,UAAUqB,EAAM/M,EAAG+M,EAAM9M,GACjC2K,EAAQe,OAAOvF,GACfwE,EAAQG,YACRH,EAAQgB,OAAOqB,EAAa,GAC5B,IAAMM,EAAY9T,EAASyT,EAC3BtC,EAAQiB,OAAO0B,EAAW,GAC1B3C,EAAQT,SACRS,EAAQQ,YACRR,EAAQS,UOlOFsI,CACEnF,EAAY5D,QACZ6I,EAAYpX,OACZqX,EACA,WAIN,CAACN,IAGH,OAAOtb,uBACL,SACEzB,EACAod,EACAjF,GAEA,IAAMoF,EAAkB,SAACvd,GACvBmd,EAAwBnd,EAAOod,EAAajF,IAmC9CuC,SAASC,iBAAiB,YAAa4C,GACvC7C,SAASC,iBAAiB,WAjCV,SAAVU,EAAWrb,GACf0a,SAASE,oBAAoB,YAAa2C,GAC1C7C,SAASE,oBAAoB,UAAWS,GAGxC,IAAMgC,EAAoBnF,GAAkBlY,EAAOmY,GAC7CqF,EAAgBzX,EAAS1F,MAAK,SAAC6F,GACnC,IAAMmW,EAAa9D,GACjBrS,EAAKK,oBACLR,EAASjH,KAAI,SAACoH,GAAD,OAAUA,EAAKK,wBAE9B,OACE+Q,GAAiB+F,EAAmBnX,EAAKF,OAAQqW,IACjDnW,EAAKpG,KAAOsd,EAAYtd,MAI5B,GAAI0d,EAAe,CACjB,IAAMC,EAAgBhY,EACpB2X,EACAI,EACApB,GAEIqB,EACJP,EAAcO,GAEdV,EAAe5E,QAGjB4E,EAAe5E,QAMrB,CACE+E,EACAd,EACArW,EACAgX,EACAI,ICpFN,SAASO,GACPC,EACAC,EACAzF,EACAiF,EACAS,EACAC,GAEA,IAAMC,EAAsBlU,GAC1BqO,GAAkByF,EAAmBxF,GACrCiF,EAAYpX,QAGRgY,EAAmBnU,GACvBqO,GAAkB0F,EAAmBzF,GACrC4F,GAGIE,EAAc,2BACfb,GADe,IAElBtf,UAAU,EACVkI,OAAQgY,IAGJE,EACJd,EAAYtf,UAAY+f,EACpBC,EAAYhf,KAAI,SAACoH,GACf,IAAMiY,EAA4BtU,GAChCuT,EAAYpX,OACZE,EAAKF,QAEP,OAAO,2BACFE,GADL,IAEEF,OAAQ6D,GAAWmU,EAAkBG,QAGzC,GAEN,MAAM,CAAEF,GAAR,mBAA2BC,ICpCd,SAASE,GACtBrY,EACAsY,EACAtB,GAEA,OAAOtb,uBACL,SAACzB,EAAsCmY,GACrC,IAAMmG,EAAWpG,GAAkBlY,EAAOmY,GACpCoG,EAAU,SAACve,GTkPhB,IACLuU,EACAmC,EACAC,EACA1I,ESrPUkK,EAAY5D,UACdwI,EAAe5E,GTiPvB5D,ES/OU4D,EAAY5D,QTgPtBmC,ES/OU4H,ETgPV3H,ES/OUuB,GAAkBlY,EAAOmY,GTgPnClK,ES/OU,OTiPVsG,EAAQE,OACRF,EAAQG,YACRH,EAAQM,UAAY5G,EACpBsG,EAAQiK,YAAc,GACtBjK,EAAQkK,SAAS/H,EAAM/M,EAAG+M,EAAM9M,EAAG+M,EAAIhN,EAAI+M,EAAM/M,EAAGgN,EAAI/M,EAAI8M,EAAM9M,GAClE2K,EAAQQ,YAGRR,EAAQG,YACRH,EAAQY,YAAclH,EACtBsG,EAAQmK,KAAKhI,EAAM/M,EAAG+M,EAAM9M,EAAG+M,EAAIhN,EAAI+M,EAAM/M,EAAGgN,EAAI/M,EAAI8M,EAAM9M,GAC9D2K,EAAQT,SACRS,EAAQQ,YAERR,EAAQS,YS9OJ0F,SAASC,iBAAiB,YAAa4D,GACvC7D,SAASC,iBAAiB,WAdV,SAAVU,EAAWrb,GACf0a,SAASE,oBAAoB,YAAa2D,GAC1C7D,SAASE,oBAAoB,UAAWS,GAExC,IAAMsD,EAASzG,GAAkBlY,EAAOmY,GAClC7P,EAAgBvC,EACnBpB,QACC,SAACuB,GAAD,OT8RL,SACL0Y,EACAC,EACAtH,GAEA,MACEqH,EAASjV,EAAIkV,EAAOlV,GAAKiV,EAAShV,EAAIiV,EAAOjV,EACzC,CAACgV,EAAUC,GACX,CAACA,EAAQD,GAHf,mBAAOE,EAAP,KAAgBC,EAAhB,KAKA,EACEH,EAASjV,EAAIkV,EAAOlV,GAAKiV,EAAShV,EAAIiV,EAAOjV,EACzC,CAACgV,EAAUC,GACX,CAACA,EAAQD,GAHf,mBAAOI,EAAP,KAAmBC,EAAnB,KAKA,OACGH,EAAQnV,GAAK4N,EAAM5N,GAClB4N,EAAM5N,GAAKoV,EAAYpV,GACvBmV,EAAQlV,GAAK2N,EAAM3N,GACnB2N,EAAM3N,GAAKmV,EAAYnV,GACxBoV,EAAWrV,GAAK4N,EAAM5N,GACrB4N,EAAM5N,GAAKsV,EAAStV,GACpBsV,EAASrV,GAAK2N,EAAM3N,GACpB2N,EAAM3N,GAAKoV,EAAWpV,ESpTdsV,CAAYZ,EAAUK,EAAQzY,EAAKF,SAAWE,EAAKpI,YAEtDgB,KAAI,SAACoH,GAAD,OAAUA,EAAKpG,MACtBue,EAAe/V,QAKnB,CAACvC,EAAUgX,EAAgBsB,IC9BhB,SAASc,GACtBpZ,EACAqW,EACAc,EACA1P,EACA6Q,EACAe,EACArC,GAMA,IAAMjY,EAAoBmY,GACxBlX,EACAqW,EACAc,EACAH,GAEIsC,EFeO,SACb7R,GAOA,IAAM8R,EAAWlF,kBAAgB,GAEjC,OAAO3Y,uBACL,SACE8d,EACAnC,EACAU,EACA3F,GAEA,IAAM0F,EAAwBxiB,EAAO+B,gBAAgB+J,MACnD,SAACqY,GAAD,OAAOD,EAAeC,MAElBH,EAAW,SAACzB,GAChB,GAAIzF,EAAY5D,QAAS,CACvB+K,EAAS9E,SAAU,EACnB,IAAMiF,EAAW/B,GACf6B,EACA3B,EACAzF,EACAiF,EACAS,EACAC,GAEFtQ,EACEiS,GACCpkB,EAAO+B,gBAAgB+J,MAAK,SAACqY,GAAD,OAAO5B,EAAkB4B,SAkB5D9E,SAASC,iBAAiB,YAAa0E,GACvC3E,SAASC,iBAAiB,WAfV,SAAVU,EAAWqE,GACfhF,SAASE,oBAAoB,YAAayE,GAC1C3E,SAASE,oBAAoB,UAAWS,GACxC,IAAMoE,EAAW/B,GACf6B,EACAG,EACAvH,EACAiF,EACAS,EACAC,GAEFtQ,EAAYiS,GAAW5B,GACvByB,EAAS9E,SAAU,OAKvB,CAAChN,IErEcmS,CAAYnS,GACvBoS,EAAcxB,GAAerY,EAAUsY,EAAgBtB,GAE7D,OAAOtb,uBACL,SACE8d,EACApH,EACA0H,GAEA,IAAMxC,EAAoBnF,GAAkBqH,EAAgBpH,GAEtD2F,EAAc/X,EAASpB,QAAO,SAACuB,GAAD,OAAUA,EAAKpI,YAC7CwK,EAAgBwV,EAAYhf,KAAI,SAACoH,GAAD,OAAUA,EAAKpG,MAE/Csd,EAAcrX,EAAS1F,MAAK,SAAC6F,GACjC,IAAMmW,EAAa9D,GACjBrS,EAAKK,oBACLR,EAASjH,KAAI,SAACoH,GAAD,OAAUA,EAAKK,wBAE9B,OAAO+Q,GAAiB+F,EAAmBnX,EAAKF,OAAQqW,MAG1D,GAAIe,EACEmC,EAAeO,OACjBhb,EAAkBya,EAAgBnC,EAAajF,GAE/C9c,EAAO+B,gBAAgB+J,MAAK,SAACqY,GAAD,OAAOD,EAAeC,OAClDlX,EAAczC,SAASuX,EAAYtd,IAEnCue,EAAe/V,EAAc3D,QAAO,SAAC7E,GAAD,OAAQA,IAAOsd,EAAYtd,OAE/Duf,EAASE,EAAgBnC,EAAaU,EAAa3F,QAGrD,GAAI9c,EAAO+B,gBAAgB+J,MAAK,SAACqY,GAAD,OAAOD,EAAeC,MACpDI,EAAYL,EAAgBpH,OACvB,CAWLuC,SAASC,iBAAiB,WATR,SAAZoF,EAAaL,GAEfA,EAAaM,UAAYT,EAAeS,SACxCN,EAAaO,UAAYV,EAAeU,SAExCb,IAEF1E,SAASE,oBAAoB,UAAWmF,MAG1CF,EAAgBN,MAItB,CACExZ,EACAqZ,EACAC,EACAO,EACA9a,EACAuZ,ICvFS,SAAS6B,GAAuBC,GAM7C,IAAMC,EAAehG,sBAA0B7Z,GAEvC8f,EAA6CF,EAA7CE,QAASC,EAAoCH,EAApCG,QAASC,EAA2BJ,EAA3BI,WAAYC,EAAeL,EAAfK,WAEhCT,EAAY,SAAZA,IACJrF,SAASE,oBAAoB,YAAa6F,GAC1C/F,SAASE,oBAAoB,UAAWmF,IAGpCU,EAAc,SAACC,GACnB,GAAIN,EAAa5F,QAAS,CACxB,IAAMmG,EAAkB,CACtBhX,EAAG+W,EAAe5I,MAClBlO,EAAG8W,EAAe3I,OAEd6I,EAAO/W,GAAW8W,EAAiBP,EAAa5F,SACtD6F,GAAWA,EAAQO,EAAKjX,GACxB2W,GAAWA,EAAQM,EAAKhX,GACxBwW,EAAa5F,QAAU,CACrB7Q,EAAG4W,EAAaA,EAAWI,EAAgBhX,GAAKgX,EAAgBhX,EAChEC,EAAG4W,EAAaA,EAAWG,EAAgB/W,GAAK+W,EAAgB/W,KAKtE,OAAO,SAAC2V,GACN7E,SAASC,iBAAiB,YAAa8F,GACvC/F,SAASC,iBAAiB,UAAWoF,GACrCK,EAAa5F,QAAU,CAAE7Q,EAAG4V,EAAezH,MAAOlO,EAAG2V,EAAexH,QChCxE,SAAS8I,GAAmBC,GAC1B,OAAOA,EAAezlB,EAAOW,iBACzBX,EAAOW,iBACP8kB,EAAe,EAAIzlB,EAAOW,iBAC1B,EAAIX,EAAOW,iBACX8kB,ECTC,IAAMC,GAAYzjB,IAAOC,IAAV,uEAAGD,CAAH,mJAEV,SAACkB,GAAD,OAAWA,EAAMqC,UACjB,SAACrC,GAAD,OAAYA,EAAMwiB,UAAY,YAAc,WACpC,SAACxiB,GAAD,OAAYA,EAAMwiB,UAAY,OAAS,WAO9CC,GAAwB3jB,IAAOC,IAAV,mFAAGD,CAAH,kCAKrB4jB,GAAyB5jB,YAAO2jB,IAAV,oFAAG3jB,CAAH,8FAKxB,SAACkB,GAAD,OAAyB,IAAdA,EAAMR,SAEnB,SAACQ,GAAD,OAAqB,IAAVA,EAAMoL,KAGhB,SAACpL,GAAD,OAAwB,IAAbA,EAAM1B,QAGdqkB,GAAuB7jB,YAAO2jB,IAAV,kFAAG3jB,CAAH,qFAKvB,SAACkB,GAAD,OAAqB,IAAVA,EAAMmL,KAKdyX,GAAkB9jB,IAAOC,IAAV,6EAAGD,CAAH,+BAChB,SAACkB,GAAD,OAAWA,EAAMqC,UAClB,SAACrC,GAAD,OAAWA,EAAMR,SAGfob,GAAe9b,IAAOC,IAAV,0EAAGD,CAAH,8BAEb,SAACkB,GAAD,OAAWA,EAAMqC,UC5C7B,IAAMwgB,GAA0B/jB,IAAOC,IAAV,iGAAGD,CAAH,gHASvBgkB,GAAyBhkB,IAAOikB,EAAV,gGAAGjkB,CAAH,sFAQtBkkB,GAA4BlkB,IAAOC,IAAV,mGAAGD,CAAH,mBAIzBmkB,GAA2BnkB,IAAOK,OAAV,kGAAGL,CAAH,uEAYf,SAASokB,GACtBljB,GAEA,IAAQmjB,EAA8BnjB,EAA9BmjB,WAAYtV,EAAkB7N,EAAlB6N,cAEpB,OACE,eAACgV,GAAD,WACGM,EAAWvU,aACVuU,EAAWvU,YAAYtO,KAAI,SAACO,GAAD,OACzB,cAACiiB,GAAD,UAAoCjiB,GAAPA,MAEjC,eAACmiB,GAAD,WACE,cAACC,GAAD,CACEviB,QAAS,kBAAMmN,GAAc,SAACa,GAAD,mBAAC,eAAeA,GAAhB,IAAsB/B,SAAS,QAD9D,gBAKA,cAACsW,GAAD,CACEviB,QAAS,WACPyiB,EAAWxU,WAAawU,EAAWxU,YACnCd,GAAc,SAACa,GAAD,mBAAC,eAAeA,GAAhB,IAAsB/B,SAAS,QAHjD,uB,uJClDFyW,GAAoBtkB,IAAOC,IAAV,qFAAGD,CAAH,4DAOjBukB,GAAcvkB,IAAOwkB,GAAV,+EAAGxkB,CAAH,MAEXykB,GAAazkB,IAAOikB,EAAV,8EAAGjkB,CAAH,MAOV0kB,IALY1kB,IAAO2kB,IAAV,6EAAG3kB,CAAH,gCAKIA,IAAOkR,EAAV,8EAAGlR,CAAH,OAEV4kB,GAAiB5kB,IAAO6kB,GAAV,kFAAG7kB,CAAH,wBAIL,SAAS8kB,KACtB,OACE,eAACR,GAAD,WACE,cAACC,GAAD,8CAEA,eAACE,GAAD,oEACyD,IACvD,cAACC,GAAD,CACEK,KAAM,2DACNniB,OAAQ,SAFV,yBAKc,IAPhB,6CAQ6C,OAG7C,cAAC,KAAD,CACEoiB,SAAS,EACTC,IAAKC,OAAOC,IAAT,0IAGL,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,oEAAmC,IADvE,4DAIA,eAACP,GAAD,WACE,cAAC,KAAD,CACEI,SAAS,EACTC,IAAKC,OAAOC,IAAT,4FACF,IAJL,mEASF,eAACV,GAAD,oDACyC,IACvC,cAACC,GAAD,CACEK,KACE,qEAEFniB,OAAQ,SAJV,kCAFF,qUAcoE,IAClE,cAAC8hB,GAAD,CACEK,KAAM,4CACNniB,OAAQ,SAFV,yBAfF,OAwBA,cAAC6hB,GAAD,wMAMA,eAACA,GAAD,WACE,cAACC,GAAD,CACEK,KACE,iEAEFniB,OAAQ,SAJV,0CAOc,IARhB,aAYA,cAAC,KAAD,CAAeoiB,SAAS,EAAMC,IAAKC,OAAOC,IAAT,gEAEjC,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,oCAIA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,MAC2D,IACzD,cAACT,GAAD,CACEK,KAAM,4DACNniB,OAAQ,SAFV,iCAKc,IAPhB,KAQK,IACH,cAAC8hB,GAAD,CACEK,KAAM,sDACNniB,OAAQ,SAFV,mCAKc,IAdhB,yCAiBA,eAACgiB,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,oDADpC,yDAMF,eAACV,GAAD,sDAC2C,IACzC,cAACC,GAAD,CACEK,KAAM,mDACNniB,OAAQ,SAFV,gCAKc,IAPhB,KAQI,cAAC,KAAD,CAAeoiB,SAAS,EAAOC,IAAKC,OAAOC,IAAT,sCARtC,gTAgBA,cAAC,KAAD,CAAeH,SAAS,EAAMC,IAAKC,OAAOC,IAAT,mFAEjC,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,oCAIA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,oDADpC,sDAIA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,MAC2D,IACzD,cAACT,GAAD,CACEK,KAAM,mDACNniB,OAAQ,SAFV,gCAKc,IAPhB,4CAYF,eAAC6hB,GAAD,+BACoB,IAClB,cAACC,GAAD,CACEK,KAAM,8CACNniB,OAAQ,SAFV,iCAKc,IAPhB,mJAYA,cAAC,KAAD,CACEoiB,SAAS,EACTC,IAAKC,OAAOC,IAAT,+JAGL,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,MAC2D,IACzD,cAACT,GAAD,CACEK,KAAM,8CACNniB,OAAQ,SAFV,iCAKc,IAPhB,8DAUA,eAACgiB,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,wCAIA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,oDADpC,sDAIA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,+DADpC,0GAOF,cAACV,GAAD,gHAKA,cAAC,KAAD,CAAeO,SAAS,EAAMC,IAAKC,OAAOC,IAAT,2EAEjC,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,mEAIA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,+DADpC,8FAOF,eAACV,GAAD,4CACiC,IAC/B,cAAC,KAAD,CAAeO,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCAFpC,0HAOA,cAAC,KAAD,CACEH,SAAS,EACTC,IAAKC,OAAOC,IAAT,4KAGL,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,MAC2D,IACzD,cAACT,GAAD,CACEK,KAAM,8CACNniB,OAAQ,SAFV,iCAKc,IAPhB,8DAUA,eAACgiB,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,+DADpC,2FAKA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,oDADpC,sDAIA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,MAC2D,IACzD,cAACT,GAAD,CACEK,KAAM,mDACNniB,OAAQ,SAFV,gCAKc,IAPhB,yCAUA,eAACgiB,GAAD,WACE,cAAC,KAAD,CACEI,SAAS,EACTC,IAAKC,OAAOC,IAAT,qDACF,IAJL,4DASF,cAACV,GAAD,mcAUA,cAACA,GAAD,yFAKA,cAAC,KAAD,CACEO,SAAS,EACTC,IAAKC,OAAOC,IAAT,8UAGL,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,oEAAmC,IADvE,+FAKA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,sDADpC,sCAIA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,uCADpC,MACkE,IAChE,cAACT,GAAD,CACEK,KAAM,8CACNniB,OAAQ,SAFV,iCAKc,IAPhB,sFAWA,eAACgiB,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,kEADpC,mHAKA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,uCADpC,wEAIA,eAACP,GAAD,WACE,cAAC,KAAD,CACEI,SAAS,EACTC,IAAKC,OAAOC,IAAT,4GACF,IAJL,SAKS,IACP,cAACT,GAAD,CACEK,KAAM,mDACNniB,OAAQ,SAFV,gCAKc,IAXhB,iLAgBA,eAACgiB,GAAD,WACE,cAAC,KAAD,CACEI,SAAS,EACTC,IAAKC,OAAOC,IAAT,qDACF,IAJL,oFAUF,cAACV,GAAD,oMAMA,cAACA,GAAD,mQAOA,cAACA,GAAD,uMAMA,cAAC,KAAD,CACEO,SAAS,EACTC,IAAKC,OAAOC,IAAT,+FAGL,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,8CAIA,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,UAC+D,IAC7D,cAACT,GAAD,CACEK,KAAM,qDACNniB,OAAQ,SAFV,kCAFF,wDAUA,eAACgiB,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,yDAMF,cAAC,KAAD,CACEH,SAAS,EACTC,IAAKC,OAAOC,IAAT,+FAGL,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,UAC+D,IAC7D,cAACT,GAAD,CACEK,KAAM,0DACNniB,OAAQ,SAFV,kDAFF,mEAUA,eAACgiB,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,yDAMF,cAAC,KAAD,CACEH,SAAS,EACTC,IAAKC,OAAOC,IAAT,2HAGL,+BACE,eAACP,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,oDADpC,UACsE,IACpE,cAACT,GAAD,CACEK,KAAM,2CACNniB,OAAQ,SAFV,wBAFF,4BAUA,eAACgiB,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gDADpC,UACoE,IAClE,cAACT,GAAD,CACEK,KACE,kEAEFniB,OAAQ,SAJV,uCAFF,kGAaA,eAACgiB,GAAD,WACE,cAAC,KAAD,CAAeI,SAAS,EAAOC,IAAKC,OAAOC,IAAT,gCADpC,wDAMF,cAACV,GAAD,mQAOA,eAACA,GAAD,8DACmD,IACjD,cAACC,GAAD,CACEK,KACE,wFAEFniB,OAAQ,SAJV,8CAOc,IAThB,qCC9cN,IAAMwiB,GAAcplB,IAAOC,IAAV,wEAAGD,CAAH,qPAeJ,SAACkB,GAAD,OAAYA,EAAM2M,QAAU,OAAS,UAK5CwX,GAAmBrlB,IAAOK,OAAV,6EAAGL,CAAH,0DAgCP,SAASslB,GAAMpkB,GAC5B,ICzDAgb,EACAqJ,EDwDQlB,EAA8BnjB,EAA9BmjB,WAAYtV,EAAkB7N,EAAlB6N,cAEdyW,EAAW1I,iBAAuB,MC3DxCZ,ED4DkBsJ,EC3DlBD,ED2D4B,kBAC1BxW,GAAc,SAACa,GAAD,mBAAC,eAAeA,GAAhB,IAAsB/B,SAAS,QC1D/CkP,qBAAU,WACR,IAAM0I,EAAW,SACf/iB,GAGKwZ,EAAIgB,UAAWhB,EAAIgB,QAAQC,SAASza,EAAME,SAG/C2iB,KAIF,OAFAnI,SAASC,iBAAiB,YAAaoI,GACvCrI,SAASC,iBAAiB,aAAcoI,GACjC,WACLrI,SAASE,oBAAoB,YAAamI,GAC1CrI,SAASE,oBAAoB,aAAcmI,MAE5C,CAACvJ,EAAKqJ,ID6CT,IAAMG,EAjCR,SACErB,EACAtV,GAEA,IAAM1K,EAAOggB,EAAWhgB,KAExB,MAAa,YAATA,EAEA,cAAC+f,GAAD,CACEC,WAAYA,EACZtV,cAAeA,IAGD,WAAT1K,EACF,cAACygB,GAAD,IAEA,6CAiBYa,CAAgBtB,EAAYtV,GAEjD,OACE,eAACqW,GAAD,CAAalJ,IAAKsJ,EAAU3X,QAASwW,EAAWxW,QAAhD,UACE,cAACwX,GAAD,CACEzjB,QAAS,kBACPmN,GAAc,SAAC6W,GAAD,mBAAC,eACVA,GADS,IAEZ/X,SAAS,QAJf,eAUC6X,KEnDP,IAAQnmB,GAAgDxB,EAAhDwB,WAAYJ,GAAoCpB,EAApCoB,YAAaC,GAAuBrB,EAAvBqB,mBA6ClB,SAASymB,KACtB,MC3Ea,SACbC,EACAnkB,GAEA,MAA0BokB,YAAkB,WAC1C,IAAMC,EAAaC,OAAOC,eAAeC,QAAQxkB,GACjD,OAAmB,OAAfqkB,QAAsC/iB,IAAf+iB,EAClBF,EAEArW,KAAKE,MAAMqW,MALtB,mBAAO1jB,EAAP,KAAc2B,EAAd,KAYA,OAHA8hB,aAAgB,WACdE,OAAOC,eAAeE,QAAQzkB,EAAK8N,KAAKC,UAAUpN,MACjD,CAACX,EAAKW,IACF,CAACA,EAAO2B,GD2DiBoiB,CAC9BvY,GACA,oBAFF,mBAAOe,EAAP,KAAiBC,EAAjB,KAKA,EAAoC9K,mBAAqB4J,IAAzD,mBAAOyW,EAAP,KAAmBtV,EAAnB,KAEA,EE9Ea,SACbD,GAsEA,MAAO,CA7Da3K,uBAClB,SAACge,GACCrT,GAAY,SAAC8W,GAAD,mBAAC,eACRA,GADO,IAEVpb,MAAO2X,SAGX,CAACrT,IAGuB3K,uBACxB,SAACmiB,GACCxX,GAAY,SAAC8W,GAAD,mBAAC,eACRA,GADO,IAEVxe,YAAakf,SAGjB,CAACxX,IAGwB3K,uBACzB,SAACoiB,GACCzX,GAAY,SAAC8W,GAAD,mBAAC,eACRA,GADO,IAEV3X,gBAAiBsY,SAGrB,CAACzX,IAGyB3K,uBAC1B,SAACqiB,GACC1X,GAAY,SAAC8W,GAAD,mBAAC,eACRA,GADO,IAEV1X,iBAAkBsY,SAGtB,CAAC1X,IAGe3K,uBAChB,SAACsiB,GACC3X,GAAY,SAAC8W,GAAD,mBAAC,eACRA,GADO,IAEV5X,OAAQyY,EACR1Y,YAAQ9K,SAGZ,CAAC6L,IAGoB3K,uBACrB,SAACuiB,GACC5X,GAAY,SAAC8W,GAAD,mBAAC,eACRA,GADO,IAEV7X,OAAQ2Y,SAGZ,CAAC5X,KFiBC6X,CAAqB7X,GAPzB,mBACE8X,EADF,KAEEC,EAFF,KAGErL,EAHF,KAIEC,EAJF,KAKExM,EALF,KAME6X,EANF,KASA,EGzFa,SACbre,EACAme,EACA9H,EACA+H,EACAC,GAWA,IAAMC,EAAU5iB,uBACd,SAACyE,GACC,IAAMuZ,EAAW1Z,EAASjH,KAAI,SAACoH,GAAD,mBAAC,eAC1BA,GADyB,IAE5BpI,UAAU,OAEZ2hB,EAAS5M,KAAT,2BAAmB3M,GAAnB,IAAyBpI,UAAU,KACnComB,EAAYzE,GACZ2E,OAAe7jB,KAEjB,CAACwF,EAAUme,EAAaE,IAGpBlH,EAAgBzb,uBACpB,SAACmG,GACCuc,EAAkB,GAAD,mBAAK/H,GAAL,CAAqBxU,KACtCwc,OAAe7jB,KAEjB,CAAC6b,EAAgB+H,EAAmBC,IAGhC5W,EAAc/L,uBAClB,SAAC6iB,GAAwD,IAA9BlF,EAA6B,wDAChDK,EAAW1Z,EAASjH,KAAI,SAACoH,GAI7B,OAHqBoe,EAAcjkB,MACjC,SAAC+F,GAAD,OAAaA,EAAQtG,KAAOoG,EAAKpG,QAK7Bsf,EACK,2BAAKlZ,GAAZ,IAAkBpI,UAAU,IAErBoI,MAIbge,EAAYzE,GAEZ,IAAMmE,EAAiBxH,EAAetd,KAAI,SAACylB,GACzC,IAAM1c,EAAgByc,EAAcjkB,MAClC,SAACmkB,GAAD,OAAkBD,EAAS1f,OAAO/E,IAAM0kB,EAAa1kB,MAEvD,GAAI+H,EACF,OAAO,2BACF0c,GADL,IAEE1f,OAAQgD,EACRtC,SAAUsC,EAAc/H,KAI5B,IAAMkI,EAAgBsc,EAAcjkB,MAClC,SAACmkB,GAAD,OAAkBD,EAASrkB,OAAOJ,IAAM0kB,EAAa1kB,MAEvD,OAAIkI,EACK,2BACFuc,GADL,IAEErkB,OAAQ8H,EACRxC,SAAUwC,EAAclI,KAGrBykB,KAETJ,EAAkBP,KAEpB,CAACxH,EAAgBrW,EAAUoe,EAAmBD,IAgEhD,MAAO,CACLG,EACAnH,EACA1P,EAhEkB/L,uBAClB,SAACgjB,GACC,IAAMb,EAAiBxH,EAAezX,QACpC,SAACC,GAAD,OACG6f,EAAQ5e,SAASjB,EAAKC,OAAO/E,MAAQ2kB,EAAQ5e,SAASjB,EAAK1E,OAAOJ,OAEvEqkB,EAAkBP,GAClBQ,OAAe7jB,GAEf,IAAMkf,EAAW1Z,EAASpB,QAAO,SAACuB,GAAD,OAAWue,EAAQ5e,SAASK,EAAKpG,OAClEokB,EAAYzE,KAEd,CAACrD,EAAgBrW,EAAUoe,EAAmBD,EAAaE,IAGnC3iB,uBACxB,SAACijB,GACC,IAAMC,EAAkBD,EAAc5lB,KAAI,SAAC8F,GAAD,OAAUA,EAAK9E,MACnD8kB,EAAWxI,EAAezX,QAC9B,SAACC,GAAD,OAAW+f,EAAgB9e,SAASjB,EAAK9E,OAE3CqkB,EAAkB,GAAD,mBAAKO,GAAL,YAAuBE,KACxCR,OAAe7jB,KAEjB,CAAC6b,EAAgB+H,EAAmBC,IAGZ3iB,uBACxB,SAACojB,GACCV,EACE/H,EAAezX,QAAO,SAACC,GAAD,OAAWigB,EAAQhf,SAASjB,EAAK9E,QAEzDskB,OAAe7jB,KAEjB,CAAC6b,EAAgB+H,EAAmBC,IAGf3iB,uBACrB,SAAC6G,GACC4b,EACEne,EAASjH,KAAI,SAACoH,GAAD,mBAAC,eACTA,GADQ,IAEXpI,SAAUwK,EAAczC,SAASK,EAAKpG,YAI5C,CAACiG,EAAUme,IAGYziB,uBAAY,gBAC+BlB,IAA3CwF,EAAS1F,MAAK,SAAC6F,GAAD,OAAUA,EAAKpI,aAElDomB,EACEne,EAASjH,KAAI,SAACoH,GAAD,mBAAC,eACTA,GADQ,IAEXpI,UAAU,UAIf,CAACiI,EAAUme,KH7CVY,CACF3Y,EAASrE,MACToc,EACA/X,EAASzH,YACTyf,EACAC,GAdF,mBACEC,EADF,KAEEnH,EAFF,KAGE1P,EAHF,KAIEC,EAJF,KAKEC,EALF,KAMEC,EANF,KAOE0Q,EAPF,KAQEe,EARF,KAiBA,EAA4C9d,oBAAkB,GAA9D,mBAAOyjB,EAAP,KAAuB7K,EAAvB,MI3Ga,SACb6K,EACAhf,EACAme,EACAzW,GAEA4M,qBAAU,WACR,IAAMvY,EAAY,SAAC9B,GACb+kB,IAEE/kB,EAAMglB,SAA6B,KAAlBhlB,EAAMilB,UACzBjlB,EAAMyb,iBACNyI,EACEne,EAASjH,KAAI,SAACoH,GACZ,OAAO,2BAAKA,GAAZ,IAAkBpI,UAAU,SAMhB,cAAdkC,EAAMf,KAAqC,WAAde,EAAMf,MACrCe,EAAMyb,iBACNhO,EACE1H,EAASpB,QAAO,SAACuB,GAAD,OAAUA,EAAKpI,YAAUgB,KAAI,SAACoH,GAAD,OAAUA,EAAKpG,QAK1C,KAAlBE,EAAMilB,SACRf,EAAYne,EAASjH,KAAI,SAACoH,GAAD,mBAAC,eAAeA,GAAhB,IAAsBpI,UAAU,UAK/D,OADA4c,SAASC,iBAAiB,UAAW7Y,GAC9B,kBAAM4Y,SAASE,oBAAoB,UAAW9Y,MACpD,CAACiE,EAAU0H,EAAasX,EAAgBb,IJyE3CgB,CAAWH,EAAgB5Y,EAASrE,MAAOoc,EAAazW,GAExD,MAA+B0O,GAAQhQ,EAASrE,MAAOqE,EAASzH,aAAhE,mBAAOmV,EAAP,KAAakD,EAAb,KACMhD,EKtGO,SACbhU,EACAse,EACA7W,GAEA,OAAO/L,uBACL,SAACzB,EAAsCmY,GAErC,GADAnY,EAAMyb,kBACFpgB,EAAO+B,gBAAgB+J,MAAK,SAACqY,GAAD,OAAOxf,EAAMwf,MAA7C,CAIA,IvByW2B3gB,EuBzWrBwe,EAAoBnF,GAAkBlY,EAAOmY,GAE7CgN,EAAoBpf,EAAS1F,MAAK,SAAC6F,GACvC,IAAMmW,EAAa9D,GACjBrS,EAAKK,oBACLR,EAASjH,KAAI,SAACoH,GAAD,OAAUA,EAAKK,wBAE9B,OAAO+Q,GAAiB+F,EAAmBnX,EAAKF,OAAQqW,MAG1D,GAAI8I,EACF3X,EAAY,CAAC,2BAEN2X,GAFK,IAGRze,evB2VqB7H,EuB3VWsmB,EAAkBze,cvB6V1C,MAAd7H,EACK,IACgB,MAAdA,EACF,IACgB,MAAdA,EACF,IAEA,auBjWE,CACL,IAAMumB,EAAatf,EAAcC,EAAUsX,GAC3CgH,EAAQe,OAGZ,CAACf,EAASte,EAAUyH,ILoEI6X,CACxBlZ,EAASrE,MACTuc,EACA7W,GAEIsM,EAAcqF,GAClBhT,EAASrE,MACTqE,EAASzH,YACTwY,EACA1P,EACA6Q,EACAe,EACArC,GAGF,EM/Ha,WACb,MAAwBzb,mBAA2B,CAAC,EAAG,IAAvD,mBAAOgkB,EAAP,KAAaC,EAAb,KACA,EAA0BjkB,mBAAS,GAAnC,mBAAOkkB,EAAP,KAAcC,EAAd,KAmBA,OAjBAlK,2BAAgB,WACd,SAASmK,IACPH,EAAQ,CAAChC,OAAOoC,WAAYpC,OAAOqC,cAErC,SAASC,IACP,MAAwCtC,OAAhC3J,iBACR6L,OADA,MAAkC,EAAlC,GAOF,OAJAlC,OAAO5I,iBAAiB,SAAU+K,GAClCnC,OAAO5I,iBAAiB,SAAUkL,GAClCH,IACAG,IACO,WACLtC,OAAO3I,oBAAoB,SAAU8K,GACrCnC,OAAO3I,oBAAoB,SAAUiL,MAEtC,IACI,CAACP,EAAME,GN0GQM,GAAtB,mBAAOR,EAAP,KAAaE,EAAb,KACA,cAAoCF,EAApC,GAAOS,EAAP,KAAoBC,EAApB,KAEA,ENtHa,SACb5Z,EACA4Z,EACAD,GASA,IAAMxF,EAAa9e,uBACjB,SAACwkB,GACC,IAAMC,EAAQH,EAAc1qB,EAAOW,iBAC7BmqB,EAAQJ,GAAe,EAAI1qB,EAAOW,kBACxC,OAAIiqB,EAAOC,EACFA,EACED,EAAOE,EACTA,EAEAF,IAGX,CAACF,IAGGvF,EAAa/e,uBACjB,SAAC2kB,GACC,IAAMF,EAAQF,EAAe3qB,EAAOW,iBAC9BmqB,EAAQH,GAAgB,EAAI3qB,EAAOW,kBACzC,OAAIoqB,EAAOF,EACFA,EACEE,EAAOD,EACTA,EAEAC,IAGX,CAACJ,IAiEH,MAAO,CA9DqB5L,iBAAO,MAgBG8F,GAAuB,CAC3DI,QAhBwB7e,uBACxB,SAAC4kB,GACCja,GAAY,SAACka,GAAD,mBAAC,eACRA,GADO,IAEV7a,WAAW,2BACN6a,EAAa7a,YADR,IAERT,qBAAsB6V,GACpByF,EAAa7a,WAAWT,qBACtBqb,EAAWL,YAKrB,CAAC5Z,EAAa4Z,IAIdxF,eAGyBpG,iBAAO,MAeG8F,GAAuB,CAC1DG,QAfuB5e,uBACvB,SAAC8kB,GACCna,GAAY,SAACka,GAAD,mBAAC,eACRA,GADO,IAEV7a,WAAW,2BACN6a,EAAa7a,YADR,IAERV,oBAAqB8V,GACnByF,EAAa7a,WAAWV,oBAAsBwb,EAAWR,YAKjE,CAAC3Z,EAAa2Z,IAIdxF,eAG6BnG,iBAAO,MAgBG8F,GAAuB,CAC9DI,QAhB2B7e,uBAC3B,SAAC4kB,GACCja,GAAY,SAACka,GAAD,mBAAC,eACRA,GADO,IAEV7a,WAAW,2BACN6a,EAAa7a,YADR,IAERR,oBAAqB4V,GACnByF,EAAa7a,WAAWR,oBACtBob,EAAWL,YAKrB,CAAC5Z,EAAa4Z,IAIdxF,gBMwBEgG,CAAmBpa,EAAa4Z,EAAcD,GAPlD,oBACEU,GADF,MAEEC,GAFF,MAGEC,GAHF,MAIEC,GAJF,MAKEC,GALF,MAMEC,GANF,MAUMC,GAAiBhB,EACjBiB,GAAkBhB,EAClBrM,GAAeqM,EAAe7Z,EAASV,WAAWT,qBAClD0O,GACJqM,GAAe,EAAI5Z,EAASV,WAAWV,qBACnCkc,IACH,EAAI9a,EAASV,WAAWT,sBAAwBgb,EACjDvpB,GACAC,GACIwqB,GAAYxN,GACZyN,GAAchb,EAASV,WAAWV,oBAAsBgb,EAExDqB,GAAO/e,mBAAQ,WACnB,OACE,cAACyK,GAAD,CACElE,eAAgB,CACd/N,OAAQomB,GACRjpB,MAAOkpB,GACP7X,OAAQxS,IAEVmW,YAAa7G,EAASd,WAGzB,CAACc,EAASd,OAAQ4b,GAAYC,KAE3BG,GAA0B5lB,uBAAY,WAC1C4iB,EACEve,EACEqG,EAASrE,MlBoOV,SACL4R,EACAC,EACA9O,EACAZ,GAEA,IAAMqd,EAAezc,EAKrB,OAAOhB,GAJkBG,GACvB,CAAEL,EAAG+P,EAAa9P,EAAG+P,GACrB,EAAI1P,GAE8Bqd,GkB9O9BC,CACE7N,GACAC,GACAxN,EAASZ,gBAAgBV,OACzBsB,EAASZ,gBAAgBtB,WAI9B,CACDoa,EACAlY,EAASZ,gBAAgBV,OACzBsB,EAASZ,gBAAgBtB,MACzBkC,EAASrE,MACT6R,GACAD,KAGI8N,GAA6B/lB,uBAAY,WAC7C,IAAMgc,E3BzFH,SACL1X,EACAqW,GAC4B,IAAD,gBACHrW,GADG,IAC3B,2BAAkC,CAAC,IAAD,EAAvBhB,EAAuB,sBACPgB,GADO,IAChC,2BAAmC,CAAC,IAAzBf,EAAwB,QACjC,GAAID,EAAUjF,KAAOkF,EAAWlF,GAAI,CAClC,IAAM2d,EAAgBhY,EACpBV,EACAC,EACAoX,GAEF,GAAMqB,EACJ,OAAOA,IATmB,gCADP,+B2BsFHgK,CACpBtb,EAASrE,MACTqE,EAASzH,kBAEWnE,IAAlBkd,GACFP,EAAcO,KAEf,CAACP,EAAe/Q,EAASzH,YAAayH,EAASrE,QAElD,OACE,gCACE,cAAC8a,GAAD,CAAOjB,WAAYA,EAAYtV,cAAeA,IAC9C,eAAC0U,GAAD,CAAWlgB,OAAQmlB,EAAchF,UAAWW,EAAWxW,QAAvD,UACE,cAAC+V,GAAD,CACE1H,IAAKiN,GACL3M,YAAa4M,GACb9c,EAAGuC,EAASV,WAAWT,qBACvBhN,MAAO,EAAImO,EAASV,WAAWV,oBAC/BjO,KAAM,IAER,cAACqkB,GAAD,CACE3H,IAAKmN,GACL7M,YAAa8M,GACbjd,EAAG,EAAIwC,EAASV,WAAWV,sBAE7B,cAACmW,GAAD,CACE1H,IAAKqN,GACL/M,YAAagN,GACbld,EAAGuC,EAASV,WAAWR,oBACvBjN,MAAOmO,EAASV,WAAWV,oBAC3BjO,KAAM,EAAIqP,EAASV,WAAWV,sBAGhC,eAACqW,GAAD,CACEvgB,OAAQmmB,GACRhpB,OAAQ,EAAImO,EAASV,WAAWV,qBAAuBgc,GAFzD,UAIE,cAAC,GAAD,CAAclmB,OAAQ8Y,GAAtB,SACE,cAACJ,GAAD,CACEG,YAAaA,GACbC,aAAcA,GACdC,iBAAkB4L,EAClB3L,KAAMA,EACNC,YAAaA,EACbC,kBAAmBA,EACnBxO,gBAAiBY,EAASZ,gBAC1BuN,mBAAoBA,EACpBkB,qBAAsB7N,EAASX,iBAC/ByO,wBAAyBlB,EACzBmB,kBAAmBA,EACnB7N,cAAeA,MAGlB+a,MAEH,cAAC/Z,GAAD,CACElB,SAAUA,EACVC,YAAaA,EACbC,cAAeA,EACfxL,OAAQmlB,EACRhoB,MAAOmpB,GACP5a,UAAWA,EACXe,UAAW+Z,GACX9Z,gBAAiBia,GACjBha,YAAa,SAAC1F,GACZ0F,EAAY1F,GACZsc,OAAe7jB,IAEjBkN,YAAaA,EACbC,kBAAmB,SAACga,GAClBha,EAAkBga,GAClBtD,OAAe7jB,IAEjBoN,kBAAmBA,EACnBrB,WAAY,WAAO,IAAD,EACVjB,EAASsc,cAAI,CACjB7f,MAAOqE,EAASrE,MAChBpD,YAAayH,EAASzH,YACtBgG,UAAWyB,EAASb,OAAOZ,UAC3BC,WAAYwB,EAASb,OAAOX,cAE9B,UAAIU,EAAOuc,cAAX,aAAI,EAAexkB,SACjBiI,EAAOuc,OAAO9V,SAAQ,SAAC+V,GAAD,OAAWC,QAAQD,MAAMA,EAAME,YAEvD3D,EAAe/Y,YO1PzBkY,OAAO5I,iBAAiB,QAAQ,YAhBhC,WACE,IAAMqN,EAAiBtN,SAASuN,cAAc,OAC5CC,EAAYxN,SAASuN,cAAc,OACrCD,EAAezoB,MAAMvB,MAAQ,OAC7BgqB,EAAezoB,MAAMsB,OAAS,OAC9BmnB,EAAezoB,MAAM4oB,SAAW,SAChCH,EAAezoB,MAAM6oB,YAAc,IACnCF,EAAU3oB,MAAMvB,MAAQ,OACxBkqB,EAAU3oB,MAAMsB,OAAS,OACzBmnB,EAAeK,YAAYH,GAC3BxN,SAAS4N,KAAKD,YAAYL,GAC1B,IAAMpH,EAAOoH,EAAeO,YAAcP,EAAeQ,YAEzD,OADA9N,SAAS4N,KAAKG,YAAYT,GACnBpH,EAAO,GAKT8H,IACHhO,SAAS4N,KAAKK,UAAUC,IAAI,4BClBlCC,IAASC,OACP,cAAC,aAAD,UACE,cAAC3F,GAAD,MAEFzI,SAASqO,eAAe,W","file":"static/js/main.5c2130d9.chunk.js","sourcesContent":["type MouseEventKey = \"shiftKey\" | \"altKey\" | \"metaKey\" | \"ctrlKey\";\n\nconst config = {\n  defaultTempDegC: 23,\n  defaultCapJPerDegK: 10,\n  defaultPowerGenW: 0,\n  defaultTotalTimeSeconds: 600,\n  defaultTimeStepSeconds: 0.1,\n  defaultNodeRadius: 20,\n  defaultResistanceDegKPerW: 10,\n  defaultEditorWidthFraction: 1 - 1 / 1.61803398875,\n  defaultCanvasHeightFraction: 1 / 1.61803398875,\n  defaultTableHeightFraction: 0.5,\n  minPanelFraction: 0.1,\n  newNodeNamePrefix: \"New Node\",\n  zoomSensitivity: 1500, // bigger = less zoom per click\n  minZoom: 0.5,\n  maxZoom: 2,\n  maxZoomDelta: 2,\n  minRadiusPx: 20,\n  maxRadiusPx: 40,\n  activeNodeOutlineWidthPx: 5,\n  tabHeightPx: 25,\n  plotHeightBufferPx: 10,\n  tableDeleteCellWidthPercent: 0.1,\n  tableDeleteCellMinWidthPx: 40,\n  plotMargin: {\n    left: 10,\n    right: 20,\n    top: 20,\n    bottom: 20,\n  },\n  plotDomainMarginPercent: 0.1,\n  maxPlotPoints: 400,\n  multiSelectKeys: [\"metaKey\", \"ctrlKey\"] as MouseEventKey[],\n};\n\nexport default config;\n","import styled from \"styled-components/macro\";\n\nexport const StyledTableWrapper = styled.div`\n  width: 100%;\n`;\n\nexport const StyledTable = styled.div`\n  width: 100%;\n  border-collapse: collapse;\n`;\n\nexport const StyledTableBody = styled.div`\n  width: 100%;\n`;\n\nexport const StyledAddButton = styled.button``;\n\nexport const StyledRow = styled.div<{\n  heightOffsetPx?: number;\n  isActive: boolean;\n}>`\n  display: inline-flex;\n  align-items: center;\n  min-width: 100%;\n  position: sticky;\n  top: ${({ heightOffsetPx }) =>\n    heightOffsetPx ? `${heightOffsetPx}px` : \"0px\"};\n  background: ${({ isActive }) =>\n    isActive ? \"rgba(112, 165, 255, 0.2)\" : \"none\"};\n`;\n\nexport const StyledCell = styled.div<{ width: number; minWidth?: number }>`\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid #ddd;\n  height: 2em;\n  width: ${({ width }) => `${width * 100}%`};\n  min-width: ${({ minWidth }) => (!!minWidth ? `${minWidth}px` : \"none\")};\n`;\n\nexport const StyledDeleteCell = styled(StyledCell)`\n  cursor: pointer;\n  user-select: none;\n  min-width: 40px;\n\n  &:hover {\n    background: black;\n  }\n`;\n\nexport const StyledHeaderWrapper = styled.div<{ heightOffsetPx?: number }>`\n  display: flex;\n  width: 100%;\n  height: 100%;\n  position: sticky;\n  top: ${({ heightOffsetPx }) =>\n    heightOffsetPx ? `${heightOffsetPx}px` : \"0px\"};\n  z-index: 1;\n`;\n\nexport const StyledColHeader = styled.div<{ width: number; minWidth?: number }>`\n  display: inline-flex;\n  width: ${({ width }) => `${width * 100}%`};\n  min-width: ${({ minWidth }) => (!!minWidth ? `${minWidth}px` : \"none\")};\n  justify-content: center;\n  align-items: center;\n  font-weight: bold;\n  border: 1px solid lightgrey;\n  cursor: pointer;\n  user-select: none;\n  position: relative;\n  background: white;\n  border-bottom: 1px solid black;\n`;\n\nexport const StyledColText = styled.div`\n  font-size: 0.8em;\n  padding: 1em;\n`;\n\nexport const StyledSortIcon = styled.div`\n  position: absolute;\n  bottom: 0;\n  right: 50%;\n  transform: translate(50%);\n`;\n","import config from \"../../../config\";\nimport {\n  StyledColHeader,\n  StyledColText,\n  StyledHeaderWrapper,\n  StyledSortIcon,\n} from \"./style\";\nimport * as React from \"react\";\nimport { SortDirection, TableColumn, TableSortState } from \"./types\";\n\ntype TableHeaderProps<T> = {\n  columns: TableColumn<T>[];\n  sortState: TableSortState<T>;\n  setSortState: React.Dispatch<React.SetStateAction<TableSortState<T>>>;\n};\n\nfunction oppositeSortDirection(sortDirection: SortDirection): SortDirection {\n  return sortDirection === \"ASC\" ? \"DESC\" : \"ASC\";\n}\n\nexport default function TableHeader<T>(\n  props: TableHeaderProps<T>\n): React.ReactElement {\n  const { columns, sortState, setSortState } = props;\n\n  const sortIcon = !sortState\n    ? \"\"\n    : sortState.direction === \"ASC\"\n    ? \"\\u25B2\"\n    : \"\\u25BC\";\n\n  return (\n    <StyledHeaderWrapper heightOffsetPx={config.tabHeightPx}>\n      {columns.map((col) => {\n        const isSortedCol = sortState && sortState.key === col.key;\n        const onClick = () => {\n          setSortState({\n            key: col.key,\n            direction:\n              !isSortedCol || !sortState\n                ? \"ASC\"\n                : oppositeSortDirection(sortState.direction),\n          });\n        };\n\n        return (\n          <StyledColHeader\n            key={col.key.toString()}\n            onClick={onClick}\n            width={col.width}\n            minWidth={col.minWidthPx}\n          >\n            <StyledColText>{col.text}</StyledColText>\n            <StyledSortIcon>{isSortedCol ? sortIcon : \"\"}</StyledSortIcon>\n          </StyledColHeader>\n        );\n      })}\n      <StyledColHeader\n        width={config.tableDeleteCellWidthPercent}\n        minWidth={config.tableDeleteCellMinWidthPx}\n        style={{ cursor: \"unset\" }}\n      />\n    </StyledHeaderWrapper>\n  );\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { CellOption } from \"../types\";\n\nconst StyledSelect = styled.select`\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n  background: unset;\n`;\n\nexport type DropDownTableCellProps = {\n  rowId: string;\n  options: CellOption[];\n  setOption?: CellOption;\n  onSelectOption: (id: string, option: CellOption) => void;\n  optionsFilter?: (option: CellOption) => CellOption[];\n};\n\nexport default function DropDownTableCell(\n  props: DropDownTableCellProps\n): React.ReactElement {\n  function handleChange(event: React.ChangeEvent<HTMLSelectElement>) {\n    const newVal = event.target.value;\n\n    const selectedOption = props.options.find((option) => option.id === newVal);\n\n    if (selectedOption !== undefined) {\n      props.onSelectOption(props.rowId, selectedOption);\n    }\n  }\n\n  return (\n    <StyledSelect value={props.setOption?.id} onChange={handleChange}>\n      {props.options.map((option) => (\n        <option key={option.id} value={option.id}>\n          {option.text}\n        </option>\n      ))}\n    </StyledSelect>\n  );\n}\n","import styled from \"styled-components/macro\";\n\nexport const StyledInput = styled.input`\n  display: inline-block;\n  border: none;\n  width: 100%;\n  height: 100%;\n  text-align: center;\n  padding: 0;\n  background: unset;\n\n  &::-webkit-inner-spin-button,\n  &::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n`;\n\nexport const StyledEditor = styled.div<{ width: number; height: number }>`\n  height: ${(props) => props.height}px;\n  width: ${(props) => props.width}px;\n  border-left: 3px solid black;\n`;\n\nexport const StyledTables = styled.div<{ heightFrac: number }>`\n  display: inline-flex;\n  width: 100%;\n  height: ${(props) => props.heightFrac * 100}%;\n`;\n\nexport const StyledModelControlsWrapper = styled.div<{ heightFrac: number }>`\n  display: inline-flex;\n  width: 100%;\n  height: ${(props) => props.heightFrac * 100}%;\n`;\n","import React, { useCallback, useState } from \"react\";\nimport { StyledInput } from \"./style\";\n\ninterface CanBeMadeString {\n  toString: () => string;\n}\n\ntype EditableInputProps<T> = {\n  initialValue: T;\n  onBlur: (value: T) => void;\n  getNewValue: (event: React.ChangeEvent<HTMLInputElement>) => T | undefined;\n  afterValue?: string;\n};\n\nexport default function EditableInput<T extends CanBeMadeString>(\n  props: EditableInputProps<T>\n): React.ReactElement {\n  const { initialValue, onBlur, getNewValue, afterValue } = props;\n\n  const [value, setValue] = useState<string>(\n    initialValue.toString() + (afterValue || \"\")\n  );\n\n  function handleOnChange(event: React.ChangeEvent<HTMLInputElement>) {\n    const newVal = event.target.value;\n    if (newVal !== undefined) {\n      setValue(newVal);\n    }\n  }\n\n  const handleOnBlur = useCallback(\n    (event: React.ChangeEvent<HTMLInputElement>) => {\n      const newVal = getNewValue(event);\n      if (event.target.value === initialValue.toString()) {\n        setValue((prevVal) => prevVal + (afterValue || \"\"));\n        return;\n      } else if (newVal !== undefined) {\n        setValue(newVal.toString() + (afterValue || \"\"));\n        onBlur(newVal);\n      } else {\n        setValue(initialValue.toString() + (afterValue || \"\"));\n        onBlur(initialValue);\n      }\n    },\n    [afterValue, getNewValue, initialValue, onBlur]\n  );\n\n  return (\n    <StyledInput\n      type=\"text\"\n      value={value}\n      onChange={handleOnChange}\n      onFocus={() =>\n        setValue((prevVal) => prevVal.replace(afterValue || \"\", \"\"))\n      }\n      onBlur={handleOnBlur}\n      // TODO LEO\n      onKeyDown={(event: React.KeyboardEvent) => {\n        if (event.key === \"Escape\") {\n        } else if (event.key === \"Enter\") {\n        }\n      }}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableInput from \"./EditableInput\";\n\ntype EditableStringInputProps = {\n  initialValue: string;\n  onBlur: (value: string) => void;\n};\n\nexport default function EditableStringInput(\n  props: EditableStringInputProps\n): React.ReactElement {\n  return (\n    <EditableInput<string>\n      key={props.initialValue}\n      initialValue={props.initialValue}\n      onBlur={props.onBlur}\n      getNewValue={(event: React.ChangeEvent<HTMLInputElement>) =>\n        event.target.value\n      }\n    />\n  );\n}\n","import React from \"react\";\nimport EditableStringInput from \"../../EditableStringInput\";\n\nexport type TextTableCellProps = {\n  initialVal: string;\n  onBlur: (newValue: string) => void;\n};\n\nexport default function TextTableCell(\n  props: TextTableCellProps\n): React.ReactElement {\n  return (\n    <EditableStringInput\n      initialValue={props.initialVal}\n      onBlur={props.onBlur}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableInput from \"./EditableInput\";\n\nfunction getFloatVal(\n  event: React.ChangeEvent<HTMLInputElement>\n): number | undefined {\n  const newValueText = event.target.value;\n  // things like 123.3abc will still parse as 123.3\n  const newValueFloat = parseFloat(event.target.value);\n  if (newValueText === undefined || isNaN(newValueFloat)) {\n    return undefined;\n  }\n  return newValueFloat;\n}\n\ntype EditableNumberInputProps = {\n  initialValue: number;\n  onBlur: (value: number) => void;\n  afterValue?: string;\n};\n\nexport default function EditableNumberInput(\n  props: EditableNumberInputProps\n): React.ReactElement {\n  return (\n    <EditableInput<number>\n      key={props.initialValue + (props.afterValue || \"\")}\n      initialValue={props.initialValue}\n      onBlur={props.onBlur}\n      getNewValue={getFloatVal}\n      afterValue={props.afterValue}\n    />\n  );\n}\n","import React from \"react\";\nimport EditableNumberInput from \"../../EditableNumberInput\";\n\nexport type NumericalTableCellProps = {\n  initialVal: number;\n  onBlur: (newValue: number) => void;\n  afterValue?: string;\n};\n\nexport default function NumericalTableCell(\n  props: NumericalTableCellProps\n): React.ReactElement {\n  return (\n    <EditableNumberInput\n      initialValue={props.initialVal}\n      onBlur={props.onBlur}\n      afterValue={props.afterValue}\n    />\n  );\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst StyledCheckbox = styled.div`\n  display: inline-flex;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  user-select: none;\n`;\n\nexport type BooleanTableCellProps = {\n  initialIsActive?: boolean;\n  onClick: (isActive: boolean) => void;\n  showWhenActive: string;\n};\n\nexport default function BooleanTableCell(\n  props: BooleanTableCellProps\n): React.ReactElement {\n  const [isActive, setIsActive] = useState<boolean>(\n    props.initialIsActive !== undefined ? props.initialIsActive : false\n  );\n\n  return (\n    <StyledCheckbox\n      tabIndex={0}\n      onKeyUp={(event: React.KeyboardEvent) => {\n        if (event.key === \"Enter\") {\n          setIsActive(!isActive);\n          props.onClick(!isActive);\n        }\n      }}\n      onClick={() => {\n        setIsActive(!isActive);\n        props.onClick(!isActive);\n      }}\n    >\n      &nbsp;{isActive ? props.showWhenActive : \"\"}\n    </StyledCheckbox>\n  );\n}\n","import * as React from \"react\";\nimport DropDownTableCell from \"./cells/DropDownTableCell\";\nimport TextTableCell from \"./cells/TextTableCell\";\nimport NumericalTableCell from \"./cells/NumericalTableCell\";\nimport BooleanTableCell from \"./cells/BooleanTableCell\";\nimport { CellOption, TableColumn } from \"./types\";\n\ntype TableCellType = {\n  id: string;\n};\n\ntype TableCellProps<T extends TableCellType> = {\n  row: T;\n  col: TableColumn<T>;\n  onUpdateRow: (row: T) => void;\n  options?: CellOption[];\n  initiallySetOption?: CellOption;\n  afterValue?: string;\n};\n\nexport default function TableCell<T extends TableCellType>(\n  props: TableCellProps<T>\n): React.ReactElement {\n  const { row, col, onUpdateRow, options, initiallySetOption, afterValue } =\n    props;\n  const initialVal = row[col.key];\n\n  if (!!options && options.length > 0 && col.onSelectOption) {\n    return (\n      <DropDownTableCell\n        key={row.id}\n        rowId={row.id}\n        options={options}\n        setOption={initiallySetOption}\n        onSelectOption={col.onSelectOption}\n      />\n    );\n  } else if (typeof initialVal === \"string\") {\n    return (\n      <TextTableCell\n        initialVal={initialVal}\n        onBlur={(newVal) => onUpdateRow({ ...row, [col.key]: newVal })}\n      />\n    );\n  } else if (\n    typeof initialVal === \"number\" &&\n    typeof row[col.key] === \"number\"\n  ) {\n    return (\n      <NumericalTableCell\n        initialVal={initialVal}\n        onBlur={(newVal) => onUpdateRow({ ...row, [col.key]: newVal })}\n        afterValue={afterValue}\n      />\n    );\n  } else if (typeof initialVal === \"boolean\") {\n    return (\n      <BooleanTableCell\n        key={initialVal.toString()}\n        initialIsActive={initialVal}\n        onClick={(newVal) => onUpdateRow({ ...row, [col.key]: newVal })}\n        showWhenActive={\"\"}\n      />\n    );\n  } else {\n    return <></>;\n  }\n}\n","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { TableSortState } from \"../types\";\n\nexport default function useSortableTable<T>(\n  defaultSortState: TableSortState<T>,\n  tieBreakerKey: keyof T,\n  ultraSuperDuperTieBreakerKey: keyof T\n): [\n  TableSortState<T>,\n  React.Dispatch<React.SetStateAction<TableSortState<T>>>,\n  (first: T, second: T) => number\n] {\n  const [sortState, setSortState] =\n    useState<TableSortState<T>>(defaultSortState);\n\n  function sortByState(first: T, second: T): number {\n    if (sortState.direction === \"ASC\") {\n      if (first[sortState.key] > second[sortState.key]) {\n        return 1;\n      } else if (first[sortState.key] === second[sortState.key]) {\n        if (first[tieBreakerKey] > second[tieBreakerKey]) {\n          return 1;\n        } else if (first[tieBreakerKey] === second[tieBreakerKey]) {\n          return first[ultraSuperDuperTieBreakerKey] >\n            second[ultraSuperDuperTieBreakerKey]\n            ? 1\n            : -1;\n        } else {\n          return -1;\n        }\n      } else {\n        return -1;\n      }\n    } else {\n      if (first[sortState.key] > second[sortState.key]) {\n        return -1;\n      } else if (first[sortState.key] === second[sortState.key]) {\n        return first[tieBreakerKey] > second[tieBreakerKey] ? 1 : -1;\n      } else {\n        return 1;\n      }\n    }\n  }\n\n  return [sortState, setSortState, sortByState];\n}\n","import React from \"react\";\nimport config from \"../../../config\";\nimport { StyledDeleteCell } from \"./style\";\n\ntype DeleteCellProps<T> = {\n  row: T;\n  onDeleteRow: (row: T) => void;\n};\n\nexport default function DeleteCell<T>(\n  props: DeleteCellProps<T>\n): React.ReactElement {\n  return (\n    <StyledDeleteCell\n      tabIndex={0}\n      onKeyUp={(event: React.KeyboardEvent) => {\n        if (event.key === \"Enter\") {\n          props.onDeleteRow(props.row);\n        }\n      }}\n      width={config.tableDeleteCellWidthPercent}\n      minWidth={config.tableDeleteCellMinWidthPx}\n      onClick={() => props.onDeleteRow(props.row)}\n    >\n      \n    </StyledDeleteCell>\n  );\n}\n","import React from \"react\";\nimport config from \"../../../../config\";\nimport { AppNode } from \"../../../../App\";\nimport {\n  StyledCell,\n  StyledRow,\n  StyledTable,\n  StyledTableBody,\n  StyledTableWrapper,\n  StyledAddButton,\n} from \"../style\";\nimport { TableColumn, TableSortState } from \"../types\";\nimport TableHeader from \"../TableHeader\";\nimport TableCell from \"../TableCell\";\nimport useSortableTable from \"../hooks/useSortableTable\";\nimport DeleteCell from \"../DeleteCell\";\n\ntype NodeTableColumn = TableColumn<AppNode>;\n\nconst defaultNodeSortState: TableSortState<AppNode> = {\n  key: \"name\",\n  direction: \"ASC\",\n};\n\nconst nodeColumns: NodeTableColumn[] = [\n  {\n    key: \"name\",\n    text: \"Name\",\n    width: 0.3,\n    minWidthPx: 100,\n  },\n  {\n    key: \"temperatureDegC\",\n    text: \"Temp [degC]\",\n    width: 0.15,\n    minWidthPx: 100,\n  },\n  {\n    key: \"capacitanceJPerDegK\",\n    text: \"Capacitance [J/degK]\",\n    width: 0.15,\n    minWidthPx: 100,\n  },\n  {\n    key: \"powerGenW\",\n    text: \"Power Gen [W]\",\n    width: 0.15,\n    minWidthPx: 80,\n  },\n  {\n    key: \"isBoundary\",\n    text: \"Fixed Temp?\",\n    width: 0.15,\n    minWidthPx: 80,\n  },\n];\n\ntype NodeTableProps = {\n  rows: AppNode[];\n  onUpdateRow: (row: AppNode) => void;\n  onDeleteRow: (row: AppNode) => void;\n  onAddButton: () => void;\n};\n\nexport default function NodeTable(props: NodeTableProps): React.ReactElement {\n  const { rows, onUpdateRow, onDeleteRow, onAddButton } = props;\n\n  const [sortState, setSortState, sortByState] = useSortableTable<AppNode>(\n    defaultNodeSortState,\n    \"temperatureDegC\",\n    \"capacitanceJPerDegK\"\n  );\n\n  const sortedRows = rows.sort(sortByState);\n\n  const tableRows = sortedRows.map((row) => {\n    return (\n      <StyledRow\n        key={row.id}\n        heightOffsetPx={config.tabHeightPx}\n        isActive={row.isActive}\n      >\n        {nodeColumns.map((col) => {\n          const tableCell = (\n            <TableCell<AppNode> row={row} col={col} onUpdateRow={onUpdateRow} />\n          );\n          return (\n            <StyledCell\n              key={col.key}\n              width={col.width}\n              minWidth={col.minWidthPx}\n            >\n              {tableCell}\n            </StyledCell>\n          );\n        })}\n        <DeleteCell row={row} onDeleteRow={() => onDeleteRow(row)} />\n      </StyledRow>\n    );\n  });\n\n  return (\n    <StyledTableWrapper>\n      <StyledTable>\n        <TableHeader<AppNode>\n          columns={nodeColumns}\n          sortState={sortState}\n          setSortState={setSortState}\n        />\n        <StyledTableBody>{tableRows}</StyledTableBody>\n        <StyledAddButton onClick={onAddButton}>+</StyledAddButton>\n      </StyledTable>\n    </StyledTableWrapper>\n  );\n}\n","import {\n  HSConnection,\n  HSConnectionKind,\n  HSNode,\n  makeConnection,\n  makeNode,\n} from \"hotstuff-network\";\nimport config from \"../config\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { Point } from \"./pointUtils\";\n\nconst { newNodeNamePrefix } = config;\n\nconst ALL_CONNECTION_KINDS: HSConnectionKind[] = [\"cond\", \"conv\", \"rad\"];\n\nexport function getExistingConnections(\n  firstNodeId: string,\n  secondNodeId: string,\n  connections: HSConnection[]\n): HSConnection[] {\n  return connections.filter(\n    (conn) =>\n      (conn.source.id === firstNodeId && conn.target.id === secondNodeId) ||\n      (conn.source.id === secondNodeId && conn.target.id === firstNodeId)\n  );\n}\n\nexport const makeNewConnection = (\n  firstNode: HSNode,\n  secondNode: HSNode,\n  kind: HSConnectionKind,\n  resistance?: number\n): AppConnection => {\n  const firstNodeFirst = firstNode.name <= secondNode.name;\n  return {\n    ...makeConnection({\n      source: firstNodeFirst ? firstNode : secondNode,\n      target: firstNodeFirst ? secondNode : firstNode,\n      resistanceDegKPerW: resistance || config.defaultResistanceDegKPerW,\n      kind,\n    }),\n    sourceId: firstNodeFirst ? firstNode.id : secondNode.id,\n    targetId: firstNodeFirst ? secondNode.id : firstNode.id,\n  };\n};\n\nexport function getNewConnectionKindsPossible(\n  connectionKind: HSConnectionKind,\n  firstNode: HSNode,\n  secondNode: HSNode,\n  otherConnections: HSConnection[]\n): HSConnectionKind[] {\n  // if there's another connection between the nodes (either direction) with that same kind:\n  // - no option for the same kind of connection\n  // - no option for both conduction and convection at once as this doesn't make sense physically (solid vs. fluid)\n  const existingConnections = getExistingConnections(\n    firstNode.id,\n    secondNode.id,\n    otherConnections\n  );\n  const existingKinds = existingConnections.map((conn) => conn.kind);\n  if (\n    connectionKind === \"rad\" &&\n    (existingKinds.includes(\"cond\") || existingKinds.includes(\"conv\"))\n  ) {\n    return [];\n  } else\n    return ALL_CONNECTION_KINDS.filter((kind) => !existingKinds.includes(kind));\n}\n\nexport function getNewConnection(\n  firstNode: AppNode,\n  secondNode: AppNode,\n  connections: AppConnection[]\n): AppConnection | undefined {\n  const existingConnections = getExistingConnections(\n    firstNode.id,\n    secondNode.id,\n    connections\n  );\n  // if no current connections, make a conductive connection\n  if (existingConnections.length === 0) {\n    return makeNewConnection(firstNode, secondNode, \"cond\");\n  }\n\n  const existingKinds = existingConnections.map((conn) => conn.kind);\n  const remainingKinds = ALL_CONNECTION_KINDS.filter(\n    (kind) => !existingKinds.includes(kind)\n  );\n\n  if (!existingKinds.includes(\"cond\") && !existingKinds.includes(\"conv\")) {\n    return makeNewConnection(firstNode, secondNode, \"cond\");\n  } else if (\n    (remainingKinds.includes(\"cond\") || remainingKinds.includes(\"conv\")) &&\n    !existingKinds.includes(\"rad\")\n  ) {\n    return makeNewConnection(firstNode, secondNode, \"rad\");\n  }\n}\n\nexport function getNewPossibleConnection(\n  appNodes: AppNode[],\n  appConnections: AppConnection[]\n): AppConnection | undefined {\n  for (const firstNode of appNodes) {\n    for (const secondNode of appNodes) {\n      if (firstNode.id !== secondNode.id) {\n        const newConnection = getNewConnection(\n          firstNode,\n          secondNode,\n          appConnections\n        );\n        if (!!newConnection) {\n          return newConnection;\n        }\n      }\n    }\n  }\n  return undefined;\n}\n\nexport function getNewAppNode(appNodes: AppNode[], center: Point): AppNode {\n  const numNodesWithDefaultPrefix = appNodes.filter((node) =>\n    node.name.startsWith(newNodeNamePrefix)\n  ).length;\n\n  const newNode = makeNode({\n    name:\n      numNodesWithDefaultPrefix === 0\n        ? `${newNodeNamePrefix}`\n        : `${newNodeNamePrefix} (${numNodesWithDefaultPrefix + 1})`,\n    temperatureDegC: config.defaultTempDegC,\n    capacitanceJPerDegK: config.defaultCapJPerDegK,\n    powerGenW: config.defaultPowerGenW,\n    isBoundary: false,\n  });\n\n  return {\n    ...newNode,\n    center: center,\n    isActive: false,\n    textDirection: \"D\",\n  };\n}\n","import React, { useCallback, useMemo } from \"react\";\nimport config from \"../../../../config\";\nimport { AppConnection, AppNode } from \"../../../../App\";\nimport {\n  StyledAddButton,\n  StyledCell,\n  StyledRow,\n  StyledTable,\n  StyledTableBody,\n  StyledTableWrapper,\n} from \"../style\";\nimport { CellOption, TableColumn, TableSortState } from \"../types\";\nimport TableHeader from \"../TableHeader\";\nimport TableCell from \"../TableCell\";\nimport useSortableTable from \"../hooks/useSortableTable\";\nimport DeleteCell from \"../DeleteCell\";\nimport { HSConnectionKind } from \"hotstuff-network\";\nimport { getNewConnectionKindsPossible } from \"../../../../utils/nodeConnectionUtils\";\n\nexport type AppConnectionTable = AppConnection & { isActive: boolean };\ntype ConnectionTableColumn = TableColumn<AppConnection>;\n\nconst defaultConnectionSortState: TableSortState<AppConnectionTable> = {\n  key: \"sourceId\",\n  direction: \"ASC\",\n};\n\nconst connectionTypes: CellOption[] = [\n  {\n    id: \"cond\",\n    text: \" Conduction\",\n  },\n  {\n    id: \"conv\",\n    text: \" Convection\",\n  },\n  {\n    id: \"rad\",\n    text: \" Radiation\",\n  },\n];\n\nfunction filterConnectionOptions(\n  colKey: string,\n  options: CellOption[],\n  connectionId: string,\n  selectedSourceId: string,\n  selectedTargetId: string,\n  connections: AppConnection[]\n): CellOption[] {\n  const otherConnections = connections.filter(\n    (conn) => !(conn.id !== connectionId)\n  );\n\n  if (colKey === \"sourceId\") {\n    // options for source node\n    const noSelfConnectionOptions = options.filter(\n      (option) => option.id !== selectedTargetId\n    );\n    // for each source option, there is no other connection that already matches the source -> target or target -> source\n    return noSelfConnectionOptions.filter((option) => {\n      return !otherConnections.some(\n        (c) =>\n          (c.source.id === option.id && c.target.id === selectedTargetId) ||\n          (c.source.id === selectedTargetId && c.target.id === option.id)\n      );\n    });\n  } else if (colKey === \"targetId\") {\n    // options for target node\n    const noSelfConnectionOptions = options.filter(\n      (option) => option.id !== selectedSourceId\n    );\n    // for each target option, there is no other connection that already matches the source -> target or target -> source\n    return noSelfConnectionOptions.filter((option) => {\n      return !otherConnections.some(\n        (c) =>\n          (c.source.id === selectedSourceId && c.target.id === option.id) ||\n          (c.source.id === option.id && c.target.id === selectedSourceId)\n      );\n    });\n  } else if (colKey === \"kind\") {\n    const selectedConnection = connections.find(\n      (conn) => conn.id === connectionId\n    );\n    if (!!selectedConnection) {\n      const possibleKinds = getNewConnectionKindsPossible(\n        selectedConnection.kind,\n        selectedConnection.source,\n        selectedConnection.target,\n        connections\n      );\n      return options.filter((opt) =>\n        possibleKinds.includes(opt.id as HSConnectionKind)\n      );\n    } else {\n      return options;\n    }\n  } else {\n    return options;\n  }\n}\n\ntype ConnectionTableProps = {\n  rows: AppConnection[];\n  nodes: AppNode[];\n  onUpdateRow: (row: AppConnection) => void;\n  onDeleteRow: (row: AppConnection) => void;\n  onAddButton: () => void;\n};\n\nexport default function ConnectionTable(\n  props: ConnectionTableProps\n): React.ReactElement {\n  const [sortState, setSortState, sortByState] =\n    useSortableTable<AppConnectionTable>(\n      defaultConnectionSortState,\n      \"targetId\",\n      \"kind\"\n    );\n\n  const onSelectNewSource = useCallback(\n    (id: string, option: CellOption) => {\n      const connection = props.rows.find((conn) => conn.id === id);\n      const newSourceNode = props.nodes.find((node) => node.id === option.id);\n      if (\n        !connection ||\n        !newSourceNode ||\n        newSourceNode.id === connection.target.id\n      ) {\n        return;\n      }\n      props.onUpdateRow({\n        ...connection,\n        source: newSourceNode,\n        sourceId: newSourceNode.id,\n      });\n    },\n    [props]\n  );\n\n  const onSelectNewTarget = useCallback(\n    (id: string, option: CellOption) => {\n      const connection = props.rows.find((conn) => conn.id === id);\n      const newTargetNode = props.nodes.find((node) => node.id === option.id);\n      if (\n        !connection ||\n        !newTargetNode ||\n        newTargetNode.id === connection.source.id\n      ) {\n        return;\n      }\n      props.onUpdateRow({\n        ...connection,\n        target: newTargetNode,\n        targetId: newTargetNode.id,\n      });\n    },\n    [props]\n  );\n\n  const onSelectNewConnectionType = useCallback(\n    (id: string, option: CellOption) => {\n      const rowToUpdate = props.rows.find((conn) => conn.id === id);\n      if (rowToUpdate) {\n        props.onUpdateRow({\n          ...rowToUpdate,\n          kind: option.id as HSConnectionKind,\n        });\n      }\n    },\n    [props]\n  );\n\n  const nodeOptions: CellOption[] = props.nodes.map((node) => ({\n    id: node.id,\n    text: node.name,\n  }));\n\n  const connectionColumns: ConnectionTableColumn[] = useMemo(\n    () => [\n      {\n        text: \"First Node\",\n        key: \"sourceId\",\n        width: 0.3,\n        minWidthPx: 100,\n        options: nodeOptions,\n        onSelectOption: onSelectNewSource,\n      },\n      {\n        text: \"Second Node\",\n        key: \"targetId\",\n        width: 0.3,\n        minWidthPx: 100,\n        options: nodeOptions,\n        onSelectOption: onSelectNewTarget,\n      },\n      {\n        text: \"Resistance\",\n        key: \"resistanceDegKPerW\",\n        width: 0.2,\n        minWidthPx: 100,\n      },\n      {\n        text: \"Kind\",\n        key: \"kind\",\n        width: 0.2,\n        minWidthPx: 100,\n        options: connectionTypes,\n        onSelectOption: onSelectNewConnectionType,\n      },\n    ],\n    [\n      nodeOptions,\n      onSelectNewConnectionType,\n      onSelectNewSource,\n      onSelectNewTarget,\n    ]\n  );\n\n  const activeNodeIds = props.nodes\n    .filter((node) => node.isActive)\n    .map((node) => node.id);\n\n  const sortedRowsWithActiveInfo: AppConnectionTable[] = props.rows\n    .map((row) => {\n      return {\n        ...row,\n        isActive:\n          activeNodeIds.includes(row.source.id) ||\n          activeNodeIds.includes(row.target.id),\n      };\n    })\n    .sort(sortByState);\n\n  const tableRows = sortedRowsWithActiveInfo.map((row) => {\n    const cols = connectionColumns.map((col) => {\n      function makeStyledCell(\n        options: CellOption[],\n        setOption: CellOption | undefined\n      ) {\n        return (\n          <StyledCell key={col.key} width={col.width} minWidth={col.minWidthPx}>\n            <TableCell<AppConnectionTable>\n              row={row}\n              col={col}\n              options={options}\n              initiallySetOption={setOption}\n              onUpdateRow={props.onUpdateRow}\n              afterValue={\n                col.key !== \"resistanceDegKPerW\"\n                  ? undefined\n                  : row.kind === \"rad\"\n                  ? \" K^4/W\"\n                  : \" K/W\"\n              }\n            />\n          </StyledCell>\n        );\n      }\n\n      if (!!col.options) {\n        const setOption = col.options.find(\n          (option) => option.id === row[col.key]\n        );\n\n        const options = !setOption\n          ? []\n          : [\n              setOption,\n              ...filterConnectionOptions(\n                col.key,\n                col.options || [],\n                row.id,\n                row.source.id,\n                row.target.id,\n                props.rows\n              ).filter((opt) => opt.id !== setOption.id),\n            ];\n\n        return makeStyledCell(options, setOption);\n      } else {\n        return makeStyledCell([], undefined);\n      }\n    });\n\n    return (\n      <StyledRow\n        key={row.id}\n        heightOffsetPx={config.tabHeightPx}\n        isActive={row.isActive}\n      >\n        {cols}\n        <DeleteCell row={row} onDeleteRow={() => props.onDeleteRow(row)} />\n      </StyledRow>\n    );\n  });\n\n  return (\n    <StyledTableWrapper>\n      <StyledTable>\n        <TableHeader<AppConnectionTable>\n          columns={connectionColumns}\n          sortState={sortState}\n          setSortState={setSortState}\n        />\n        <StyledTableBody>{tableRows}</StyledTableBody>\n        <StyledAddButton onClick={props.onAddButton}>+</StyledAddButton>\n      </StyledTable>\n    </StyledTableWrapper>\n  );\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components/macro\";\nimport config from \"../../config\";\n\nconst StyledTabsWrapper = styled.div`\n  display: inline-flex;\n  width: 100%;\n  flex-direction: column;\n  overflow: auto;\n  position: relative;\n`;\n\nconst StyledTabs = styled.div`\n  display: inline-flex;\n  width: 100%;\n  height: ${config.tabHeightPx}px;\n  justify-content: space-evenly;\n  position: sticky;\n  top: 0;\n  background: white;\n  box-sizing: border-box;\n  z-index: 1;\n`;\n\nconst StyledTab = styled.div<{ width: number }>`\n  display: inline-flex;\n  width: ${({ width }) => `${width * 100}%`};\n  cursor: pointer;\n  text-decoration: none;\n  align-items: center;\n  //background: lightgray;\n  //background: rgb(85, 9, 121);\n  background: linear-gradient(\n    90deg,\n    rgba(46, 228, 233, 1) 0%,\n    rgba(46, 228, 233, 1) 40%,\n    rgba(255, 0, 230, 1) 80%,\n    rgba(85, 9, 121, 1) 100%\n  );\n  border-radius: 5px 5px 0 0;\n  border: 1px solid black;\n  border-bottom: 2px solid black;\n\n  &:hover,\n  &:focus {\n    opacity: 0.7;\n  }\n`;\n\nconst StyledTabText = styled.div`\n  font-size: 1.1em;\n  padding: 0.2em 0.5em;\n\n  &.active {\n    font-weight: bold;\n  }\n`;\n\nconst StyledInnerContent = styled.div<{ topLeftRounded: boolean }>`\n  background: white;\n  position: relative;\n`;\n\ntype Tab = {\n  text: string;\n  component: React.ReactElement;\n  width: number; // between 0 and 1\n};\n\nexport type TabsProps = {\n  tabs: Tab[];\n};\n\nexport default function Tabs(props: TabsProps): React.ReactElement {\n  const [activeIdx, setActiveIdx] = useState(0);\n\n  return (\n    <StyledTabsWrapper>\n      {props.tabs.length > 1 && (\n        <StyledTabs>\n          {props.tabs.map((tab, idx) => {\n            return (\n              <StyledTab\n                key={tab.text}\n                tabIndex={0}\n                onClick={() => setActiveIdx(idx)}\n                onKeyUp={(event: React.KeyboardEvent) => {\n                  if (event.key === \"Enter\") {\n                    setActiveIdx(idx);\n                  }\n                }}\n                width={tab.width}\n              >\n                <StyledTabText className={idx === activeIdx ? \"active\" : \"\"}>\n                  {tab.text}\n                </StyledTabText>\n              </StyledTab>\n            );\n          })}\n        </StyledTabs>\n      )}\n\n      <StyledInnerContent topLeftRounded={props.tabs.length <= 1}>\n        {props.tabs.filter((_, idx) => idx === activeIdx)[0].component}\n      </StyledInnerContent>\n    </StyledTabsWrapper>\n  );\n}\n","export type Point = {\n  x: number;\n  y: number;\n};\n\nexport const ORIGIN = Object.freeze({ x: 0, y: 0 });\n\nexport function makePoint(x: number, y: number): Point {\n  return { x, y };\n}\n\nexport function addPoints(p1: Point, p2: Point): Point {\n  return { x: p1.x + p2.x, y: p1.y + p2.y };\n}\n\nexport function diffPoints(p1: Point, p2: Point): Point {\n  return { x: p1.x - p2.x, y: p1.y - p2.y };\n}\n\nexport function scalePoint(p1: Point, scale: number): Point {\n  return { x: p1.x / scale, y: p1.y / scale };\n}\n\n// export function distanceBetweenPoints(p1: Point, p2: Point): number {\n//   return Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2));\n// }\n","import { makeNode } from \"hotstuff-network\";\nimport { AppConnection, AppNode, ModalState, PanelSizes, Timing } from \"./App\";\nimport config from \"./config\";\nimport { ORIGIN } from \"./utils/pointUtils\";\nimport { CanvasViewState } from \"./components/Canvas/Canvas\";\nimport { makeNewConnection } from \"./utils/nodeConnectionUtils\";\n\nconst jerryNode = makeNode({\n  name: \"Jerry the Cat\",\n  temperatureDegC: 38.3,\n  capacitanceJPerDegK: 16.2e3, // 3.6kJ/kg/degK * 4.5kg\n  powerGenW: 100, // ??\n  isBoundary: false,\n});\nconst jerryAppNode: AppNode = {\n  ...jerryNode,\n  center: { x: 200, y: 150 },\n  isActive: false,\n  textDirection: \"L\",\n};\n\nconst bedNode = makeNode({\n  name: \"Heated Cat Bed\",\n  temperatureDegC: 40, // ??\n  capacitanceJPerDegK: 10e3,\n  powerGenW: 4,\n  isBoundary: false,\n});\nconst bedAppNode: AppNode = {\n  ...bedNode,\n  center: { x: 500, y: 150 },\n  isActive: false,\n  textDirection: \"R\",\n};\n\nconst airNode = makeNode({\n  name: \"Apartment Air\",\n  temperatureDegC: 22.5,\n  capacitanceJPerDegK: 6e5, // 1.0035J/g/degK * 600,000g\n  powerGenW: 0,\n  isBoundary: false,\n});\nconst airAppNode: AppNode = {\n  ...airNode,\n  center: { x: 350, y: 300 },\n  isActive: false,\n  textDirection: \"D\",\n};\n\nexport const defaultNodes: AppNode[] = [jerryAppNode, bedAppNode, airAppNode];\n\nexport const defaultConnections: AppConnection[] = [\n  makeNewConnection(jerryNode, bedNode, \"cond\", 2.5), // 0.01m / 0.1m^2 / 0.04W/m/degK\n  makeNewConnection(airNode, jerryNode, \"conv\", 0.33), // 1 / 0.3m^2 / 10W/m^2/degK\n  makeNewConnection(airNode, bedNode, \"conv\", 0.67), // 1 / 0.3m^2 / 5W/m^2/degK\n];\n\nexport const defaultTiming: Timing = {\n  timeStepS: config.defaultTimeStepSeconds,\n  totalTimeS: config.defaultTotalTimeSeconds,\n};\n\nexport const defaultCanvasViewState: CanvasViewState = {\n  offset: ORIGIN,\n  scale: 1,\n};\n\nexport const defaultPanelSizes: PanelSizes = {\n  editorWidthFraction: config.defaultEditorWidthFraction,\n  canvasHeightFraction: config.defaultCanvasHeightFraction,\n  tableHeightFraction: config.defaultTableHeightFraction,\n};\n\nexport const defaultModalState: ModalState = {\n  visible: false,\n  type: \"theory\",\n};\n\nexport const defaultAppState = {\n  output: undefined,\n  timing: defaultTiming,\n  nodes: defaultNodes,\n  connections: defaultConnections,\n  canvasViewState: defaultCanvasViewState,\n  savedCanvasState: defaultCanvasViewState,\n  panelSizes: defaultPanelSizes,\n};\n","import * as React from \"react\";\nimport { useState } from \"react\";\nimport styled from \"styled-components/macro\";\nimport EditableNumberInput from \"./EditableNumberInput\";\nimport { AppState, ModalState, Timing } from \"../../App\";\nimport { defaultAppState } from \"../../default\";\n\nconst StyledModelControlsWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  justify-content: center;\n  align-items: center;\n  border-top: 3px solid black;\n  flex-wrap: wrap;\n`;\n\nconst StyledButton = styled.button`\n  margin-top: 5px;\n  margin-bottom: 5px;\n`;\n\nconst StyledImport = styled.div`\n  padding: 0.2em;\n  border: 1px solid black;\n`;\n\nconst StyledInput = styled.input`\n  margin-right: 0.5em;\n`;\n\nconst StyledTopControls = styled.div`\n  display: flex;\n  > * {\n    margin: 1em;\n  }\n`;\n\nconst StyledTimeControls = styled.div``;\n\nconst StyledTimeControl = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  width: 100%;\n  align-items: center;\n  justify-content: space-between;\n  margin: 0.5em;\n`;\n\nconst StyledInputWrapper = styled.div`\n  border: 1px solid black;\n  border-radius: 2px;\n  max-width: 3em;\n  height: 1.5em;\n`;\n\nconst StyledLabel = styled.label`\n  margin-right: 0.2em;\n`;\n\nexport type ModelControlsProps = {\n  appState: AppState;\n  setAppState: React.Dispatch<React.SetStateAction<AppState>>;\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n  onRunModel: () => void;\n  setTiming: (newTiming: Timing) => void;\n};\n\nexport default function ModelControls(\n  props: ModelControlsProps\n): React.ReactElement {\n  const { appState, setAppState, setModalState, onRunModel, setTiming } = props;\n\n  const [stagedAppState, setStagedAppState] = useState<string>(\"\");\n\n  return (\n    <StyledModelControlsWrapper>\n      <StyledTimeControls>\n        <StyledTimeControl>\n          <StyledLabel>Run Time [s]:</StyledLabel>\n          <StyledInputWrapper>\n            <EditableNumberInput\n              initialValue={appState.timing.totalTimeS}\n              onBlur={(newTotalTimeS: number) =>\n                setTiming({ ...appState.timing, totalTimeS: newTotalTimeS })\n              }\n            />\n          </StyledInputWrapper>\n        </StyledTimeControl>\n        <StyledTimeControl>\n          <StyledLabel>Time Step [s]:</StyledLabel>\n          <StyledInputWrapper>\n            <EditableNumberInput\n              initialValue={appState.timing.timeStepS}\n              onBlur={(newTimeStepS: number) =>\n                setTiming({\n                  ...appState.timing,\n                  timeStepS: newTimeStepS,\n                })\n              }\n            />\n          </StyledInputWrapper>\n        </StyledTimeControl>\n      </StyledTimeControls>\n      <StyledTopControls>\n        <StyledButton onClick={onRunModel}>Run Model</StyledButton>\n        <StyledButton\n          onClick={() =>\n            navigator.clipboard.writeText(JSON.stringify(appState))\n          }\n        >\n          Copy Model to ClipBoard\n        </StyledButton>\n      </StyledTopControls>\n      <StyledImport>\n        <StyledLabel>Model:</StyledLabel>\n        <StyledInput\n          value={stagedAppState}\n          onChange={(event) => setStagedAppState(event.target.value)}\n        />\n        <StyledButton\n          onClick={() => {\n            setAppState(JSON.parse(stagedAppState));\n            setStagedAppState(\"\");\n          }}\n        >\n          Import Model\n        </StyledButton>\n      </StyledImport>\n\n      <StyledButton\n        onClick={() =>\n          setModalState((prev) => ({\n            ...prev,\n            visible: true,\n            type: \"confirm\",\n            onConfirm: () => setAppState(defaultAppState),\n            confirmText: [\n              \"This will reset the entire model, discarding all your current nodes, connections, parameters and output data.\",\n              \"Permanently reset everything?\",\n            ],\n          }))\n        }\n      >\n        Reset\n      </StyledButton>\n    </StyledModelControlsWrapper>\n  );\n}\n","import * as React from \"react\";\nimport {\n  AppConnection,\n  AppNode,\n  AppState,\n  ModalState,\n  Timing,\n} from \"../../App\";\nimport NodeTable from \"./EditableTable/NodeTable/NodeTable\";\nimport ConnectionTable from \"./EditableTable/ConnectionTable/ConnectionTable\";\nimport Tabs from \"../Tabs/Tabs\";\nimport ModelControls from \"./ModelControls\";\nimport {\n  StyledEditor,\n  StyledModelControlsWrapper,\n  StyledTables,\n} from \"./style\";\n\ntype SidebarProps = {\n  appState: AppState;\n  setAppState: React.Dispatch<React.SetStateAction<AppState>>;\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n  width: number;\n  height: number;\n  setTiming: (newTiming: Timing) => void;\n  onAddNode: () => void;\n  onAddConnection: () => void;\n  updateNodes: (nodes: AppNode[], clearActiveNodes: boolean) => void;\n  deleteNodes: (nodeIds: string[]) => void;\n  updateConnections: (connections: AppConnection[]) => void;\n  deleteConnections: (connectionIds: string[]) => void;\n  onRunModel: () => void;\n};\n\nexport default function Sidebar(props: SidebarProps): React.ReactElement {\n  const {\n    appState,\n    setAppState,\n    setModalState,\n    width,\n    height,\n    setTiming,\n    onAddNode,\n    onAddConnection,\n    updateNodes,\n    deleteNodes,\n    updateConnections,\n    deleteConnections,\n    onRunModel,\n  } = props;\n\n  const nodeTable = (\n    <NodeTable\n      rows={appState.nodes}\n      onUpdateRow={(node: AppNode) => updateNodes([node], false)}\n      onDeleteRow={(node: AppNode) => deleteNodes([node.id])}\n      onAddButton={onAddNode}\n    />\n  );\n\n  const connectionTable = (\n    <ConnectionTable\n      rows={appState.connections}\n      nodes={appState.nodes}\n      onUpdateRow={(connection: AppConnection) =>\n        updateConnections([connection])\n      }\n      onDeleteRow={(connection: AppConnection) =>\n        deleteConnections([connection.id])\n      }\n      onAddButton={onAddConnection}\n    />\n  );\n\n  return (\n    <StyledEditor width={width} height={height}>\n      <StyledTables heightFrac={appState.panelSizes.tableHeightFraction}>\n        <Tabs\n          tabs={[\n            { text: \"Nodes\", component: nodeTable, width: 0.5 },\n            { text: \"Connections\", component: connectionTable, width: 0.5 },\n          ]}\n        />\n      </StyledTables>\n      <StyledModelControlsWrapper\n        heightFrac={1 - appState.panelSizes.tableHeightFraction}\n      >\n        <ModelControls\n          appState={appState}\n          setAppState={setAppState}\n          setModalState={setModalState}\n          onRunModel={onRunModel}\n          setTiming={setTiming}\n        />\n      </StyledModelControlsWrapper>\n    </StyledEditor>\n  );\n}\n","import {\n  CartesianGrid,\n  Legend,\n  LineChart,\n  Tooltip,\n  TooltipPayload,\n  TooltipProps,\n  XAxis,\n  YAxis,\n} from \"recharts\";\nimport * as React from \"react\";\nimport { PlotDimensions } from \"./Plot\";\nimport styled from \"styled-components/macro\";\n\nconst StyledToolTip = styled.div`\n  background: rgba(255, 255, 255, 0.7);\n  padding: 0.2em;\n  //border-radius: 10px;\n  border: 1px solid black;\n`;\n\nconst StyledToolTipTitle = styled.div`\n  font-size: 1em;\n  font-weight: bold;\n`;\n\nconst StyledToolTipItem = styled.div<{ color: string }>`\n  color: ${(props) => props.color};\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst StyledToolTipValue = styled.div<{ after: string }>`\n  margin-left: 1em;\n\n  &::after {\n    content: \"${(props) => props.after}\";\n  }\n`;\n\nfunction CustomTooltip(props: TooltipProps & { after: string }) {\n  const { active, payload, label, after } = props;\n\n  if (active && payload && payload.length) {\n    const sortedPayload = [...payload].sort(\n      (a: TooltipPayload, b: TooltipPayload) => {\n        if (a.value > b.value) {\n          return -1;\n        } else if (a.value === b.value) {\n          if (a.name > b.name) {\n            return 1;\n          } else {\n            return -1;\n          }\n        } else {\n          return 1;\n        }\n      }\n    );\n\n    return (\n      <StyledToolTip>\n        <StyledToolTipTitle>{`Time: ${label}s`}</StyledToolTipTitle>\n        {sortedPayload.map((item) => {\n          return (\n            <StyledToolTipItem key={item.name} color={item.color || \"black\"}>\n              <div>{item.name}</div>\n              <StyledToolTipValue after={after}>\n                {item.value}\n              </StyledToolTipValue>\n            </StyledToolTipItem>\n          );\n        })}\n      </StyledToolTip>\n    );\n  }\n\n  return null;\n}\n\ntype LinePlotProps = {\n  plotDimensions: PlotDimensions;\n  plotData?: ReadonlyArray<Record<string, unknown>>;\n  lines: React.ReactElement[];\n  xAxisKey: string;\n  xLabel: string;\n  yLabel: string;\n  yDomain?: [number, number];\n  unit: string;\n};\n\nexport default function LinePlot(props: LinePlotProps): React.ReactElement {\n  const {\n    plotDimensions,\n    plotData,\n    lines,\n    xAxisKey,\n    xLabel,\n    yLabel,\n    yDomain,\n    unit,\n  } = props;\n\n  return (\n    <LineChart\n      height={plotDimensions.height}\n      width={plotDimensions.width}\n      margin={plotDimensions.margin}\n      data={plotData}\n    >\n      <CartesianGrid strokeDasharray=\"3 3\" />\n      <XAxis\n        dataKey={xAxisKey}\n        label={{\n          value: xLabel,\n          position: \"center\",\n          dy: 20,\n        }}\n      />\n      <YAxis\n        domain={yDomain}\n        label={{\n          value: yLabel,\n          position: \"center\",\n          angle: -90,\n          dx: -20,\n        }}\n      />\n      <Tooltip content={<CustomTooltip after={unit} />} />\n      <Legend\n        layout=\"horizontal\"\n        verticalAlign=\"top\"\n        align=\"center\"\n        wrapperStyle={{\n          paddingLeft: \"10px\",\n          paddingBottom: \"10px\",\n        }}\n      />\n      {lines}\n    </LineChart>\n  );\n}\n","import * as React from \"react\";\nimport { useMemo } from \"react\";\nimport { Line } from \"recharts\";\nimport styled from \"styled-components\";\nimport { emptyOutput, ModelOutput } from \"hotstuff-network\";\nimport LinePlot from \"./LinePlot\";\nimport Tabs from \"../Tabs/Tabs\";\nimport config from \"../../config\";\n\nconst { maxPlotPoints, plotDomainMarginPercent } = config;\n\nconst colors = [\n  \"#2ecc71\",\n  \"#3498db\",\n  \"#9b59b6\",\n  \"#e74c3c\",\n  \"#e67e22\",\n  \"#34495e\",\n  \"#16a085\",\n];\n\nconst StyledCharts = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n\n  .chart {\n    width: 60% !important;\n    max-width: 900px;\n\n    @media only screen and (max-width: 600px) {\n      width: 90% !important;\n      touch-action: pan-y;\n    }\n  }\n`;\n\nconst StyledPlot = styled.div<{ height: number; width: number }>`\n  width: 100%;\n  height: ${(props) => props.height}px;\n  border-top: 3px solid black;\n  margin: 0;\n  padding: 0;\n`;\n\ntype Margin = {\n  left: number;\n  right: number;\n  top: number;\n  bottom: number;\n};\n\nexport type PlotDimensions = {\n  height: number;\n  width: number;\n  margin: Margin;\n};\n\ntype TimeSeriesPlotData = {\n  time: number;\n  [key: string]: number;\n};\n\ntype PlotDomain = [number, number];\n\nfunction roundToNearestTenth(input: number): number {\n  return Math.round(input * 10) / 10;\n}\n\nfunction plotShape(\n  data: ModelOutput\n): [TimeSeriesPlotData[], PlotDomain, TimeSeriesPlotData[], PlotDomain] {\n  // the number of points depends on the order of magnitude\n  const lowerMag = Math.floor(Math.log10(data.totalTimeS));\n  const divisibleBy = Math.pow(10, lowerMag - 1);\n  function include(val: number) {\n    return Math.abs(val % divisibleBy) === 0;\n  }\n\n  const includeAll = data.timeSeriesS.length < maxPlotPoints;\n\n  const tempsAtAllTimes: TimeSeriesPlotData[] = [];\n  let minTemp = 1e9;\n  let maxTemp = -1e9;\n  const heatTransfersAtAllTimes: TimeSeriesPlotData[] = [];\n  let minHeatTransfer = 1e9;\n  let maxHeatTransfer = -1e9;\n\n  data.timeSeriesS.forEach((t, idx) => {\n    if (includeAll || include(t)) {\n      const temp: TimeSeriesPlotData = { time: t };\n      const ht: TimeSeriesPlotData = { time: t };\n\n      data.nodeResults.forEach((nodeResult) => {\n        const tempVal = nodeResult.tempDegC[idx];\n        if (tempVal < minTemp) {\n          minTemp = tempVal;\n        } else if (tempVal > maxTemp) {\n          maxTemp = tempVal;\n        }\n        temp[nodeResult.node.name] = roundToNearestTenth(tempVal);\n      });\n\n      data.connectionResults.forEach((connectionResult) => {\n        const heatTransferVal = connectionResult.heatTransferW[idx];\n        if (heatTransferVal < minHeatTransfer) {\n          minHeatTransfer = heatTransferVal;\n        } else if (heatTransferVal > maxHeatTransfer) {\n          maxHeatTransfer = heatTransferVal;\n        }\n        ht[\n          `${connectionResult.connection.source.name} to ${connectionResult.connection.target.name}`\n        ] = roundToNearestTenth(heatTransferVal);\n      });\n\n      tempsAtAllTimes.push(temp);\n      heatTransfersAtAllTimes.push(ht);\n    }\n  });\n  return [\n    tempsAtAllTimes,\n    [minTemp, maxTemp],\n    heatTransfersAtAllTimes,\n    [minHeatTransfer, maxHeatTransfer],\n  ];\n}\n\ntype PlotProps = {\n  plotDimensions: PlotDimensions;\n  modelOutput?: ModelOutput;\n};\n\nexport default function Plot(props: PlotProps): React.ReactElement {\n  const modelHasOutput = !!(\n    props.modelOutput && props.modelOutput.nodeResults.length > 0\n  );\n  const res =\n    modelHasOutput && props.modelOutput ? props.modelOutput : emptyOutput;\n\n  const [tempPlotData, tempDomain, heatTransferPlotData, heatTransferDomain] =\n    plotShape(res);\n\n  const yTempDomainMargin =\n    (tempDomain[1] - tempDomain[0]) * plotDomainMarginPercent;\n  const yTempDomain: [number, number] | undefined = modelHasOutput\n    ? [\n        Math.floor(tempDomain[0] - yTempDomainMargin),\n        Math.ceil(tempDomain[1] + yTempDomainMargin),\n      ]\n    : undefined;\n\n  const yHeatTransferDomainMargin =\n    (heatTransferDomain[1] - heatTransferDomain[0]) * plotDomainMarginPercent;\n  const yHeatTransferDomain: [number, number] | undefined = modelHasOutput\n    ? [\n        Math.floor(heatTransferDomain[0] - yHeatTransferDomainMargin),\n        Math.ceil(heatTransferDomain[1] + yHeatTransferDomainMargin),\n      ]\n    : undefined;\n\n  const heatTransferLines = useMemo(\n    () =>\n      res.connectionResults.map((connectionResult, idx) => {\n        return (\n          <Line\n            key={connectionResult.connection.id}\n            type={\"monotone\"}\n            dataKey={`${connectionResult.connection.source.name} to ${connectionResult.connection.target.name}`}\n            stroke={colors[idx]}\n            activeDot={{ r: 8 }}\n            isAnimationActive={false}\n          />\n        );\n      }),\n    [res.connectionResults]\n  );\n\n  const tempLines = useMemo(\n    () =>\n      res.nodeResults.map((nodeResult, idx) => {\n        return (\n          <Line\n            key={nodeResult.node.id}\n            type={\"monotone\"}\n            dataKey={nodeResult.node.name}\n            stroke={colors[idx]}\n            activeDot={{ r: 8 }}\n            isAnimationActive={false}\n          />\n        );\n      }),\n    [res.nodeResults]\n  );\n\n  const tempPlot = (\n    <LinePlot\n      plotDimensions={props.plotDimensions}\n      plotData={tempPlotData}\n      lines={tempLines}\n      xAxisKey={\"time\"}\n      xLabel={\"Time [s]\"}\n      yLabel={\"Temperature [degC]\"}\n      yDomain={yTempDomain}\n      unit={\"degC\"}\n    />\n  );\n\n  const heatTransferPlot = (\n    <LinePlot\n      plotDimensions={props.plotDimensions}\n      plotData={heatTransferPlotData}\n      lines={heatTransferLines}\n      xAxisKey={\"time\"}\n      xLabel={\"Time [s]\"}\n      yLabel={\"Heat Transfer [Watts]\"}\n      yDomain={yHeatTransferDomain}\n      unit={\"W\"}\n    />\n  );\n\n  return (\n    <StyledPlot\n      height={props.plotDimensions.height}\n      width={props.plotDimensions.width}\n    >\n      <StyledCharts>\n        <Tabs\n          tabs={[\n            {\n              text: \"Temperature\",\n              component: tempPlot,\n              width: 0.5,\n            },\n            {\n              text: \"Heat Transfer\",\n              component: heatTransferPlot,\n              width: 0.5,\n            },\n          ]}\n        />\n      </StyledCharts>\n    </StyledPlot>\n  );\n}\n","import { diffPoints, ORIGIN, Point, scalePoint } from \"../../utils/pointUtils\";\nimport config from \"../../config\";\nimport { Direction } from \"../../App\";\nimport * as React from \"react\";\nimport { CanvasState } from \"./Canvas\";\nimport { scaleDiverging } from \"d3-scale\";\nimport { HSConnectionKind } from \"hotstuff-network\";\n\nconst { activeNodeOutlineWidthPx, minRadiusPx, maxRadiusPx } = config;\nexport const DEFAULT_RADIUS = Math.floor((minRadiusPx + maxRadiusPx) / 2);\n\nfunction drawCircle(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number,\n  color: string\n): void {\n  context.save();\n  context.beginPath();\n  context.arc(center.x, center.y, radius, 0, 2 * Math.PI);\n  context.fillStyle = color;\n  context.fill();\n  context.closePath();\n  context.restore();\n}\n\nfunction drawCircleOutline(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number,\n  color: string\n): void {\n  context.save();\n  context.beginPath();\n  // inset\n  context.arc(\n    center.x,\n    center.y,\n    radius - activeNodeOutlineWidthPx / 2,\n    0,\n    2 * Math.PI\n  );\n  context.lineWidth = activeNodeOutlineWidthPx;\n  context.strokeStyle = color;\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nfunction drawHashPattern(\n  context: CanvasRenderingContext2D,\n  center: Point,\n  radius: number\n) {\n  context.save();\n  context.lineWidth = 2;\n  context.fillStyle = \"#FFFFFF\";\n\n  const delta = 4.5;\n  const buffer = 1;\n  const circle = 2;\n\n  // save the canvas above, now transform it for ease of drawing\n  context.translate(center.x, center.y);\n  context.rotate(Math.PI / 4);\n\n  // draw horizontal line\n  context.beginPath();\n  context.moveTo(-radius, 0);\n  context.lineTo(radius, 0);\n  context.stroke();\n\n  // draw smaller horizontal lines offset vertically from center\n  let h = 0; // vertical distance from center\n  while (h + delta < radius) {\n    h = h + delta;\n    const newRadius = radius * Math.sin(Math.acos(h / radius));\n    context.moveTo(-newRadius - buffer, h);\n    context.lineTo(newRadius + buffer, h);\n    context.stroke();\n    context.moveTo(-newRadius - buffer, -h);\n    context.lineTo(newRadius + buffer, -h);\n    context.stroke();\n  }\n  context.closePath();\n\n  // clip off the extra bits around the circle\n  context.beginPath();\n  context.arc(0, 0, radius + circle, 0, Math.PI * 2, false);\n  context.arc(0, 0, radius, 0, Math.PI * 2, true);\n  context.fill();\n\n  context.restore();\n}\n\nfunction drawNodeName(\n  context: CanvasRenderingContext2D,\n  name: string,\n  center: Point,\n  radius: number,\n  textDirection: Direction\n) {\n  const bufferText = 2;\n  context.save();\n  context.font = \"14px Helvetica\";\n  const textMetrics = context.measureText(name);\n  const width = textMetrics.width;\n  context.translate(center.x, center.y);\n  if (textDirection === \"D\") {\n    context.fillText(\n      name,\n      -width / 2,\n      textMetrics.actualBoundingBoxAscent + radius + bufferText\n    );\n  } else if (textDirection === \"R\") {\n    context.fillText(\n      name,\n      radius + bufferText,\n      textMetrics.actualBoundingBoxAscent / 2\n    );\n  } else if (textDirection === \"U\") {\n    context.fillText(\n      name,\n      -width / 2,\n      -(textMetrics.actualBoundingBoxDescent + radius + bufferText)\n    );\n  } else {\n    context.fillText(\n      name,\n      -(width + radius + bufferText),\n      textMetrics.actualBoundingBoxAscent / 2\n    );\n  }\n  context.restore();\n}\n\nexport function drawNode(\n  context: CanvasRenderingContext2D,\n  name: string,\n  center: Point,\n  radius: number,\n  color: string,\n  isActive: boolean,\n  isBoundary: boolean,\n  textDirection: Direction\n): void {\n  drawCircle(context, center, radius, color);\n  if (isActive) {\n    drawCircleOutline(context, center, radius, \"black\");\n  }\n  if (isBoundary) {\n    drawHashPattern(context, center, radius);\n  }\n  drawNodeName(context, name, center, radius, textDirection);\n}\n\nexport function drawBidirectionalArrow(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string,\n  startOffset = 0,\n  endOffset = 0\n): void {\n  context.save();\n  context.beginPath();\n  context.strokeStyle = color;\n  context.lineWidth = 2;\n  const headLength = 9;\n  const headWidth = 4;\n  const arrowGap = 0;\n  const dx = end.x - start.x;\n  const dy = end.y - start.y;\n  const angle = Math.atan2(dy, dx);\n  const length = Math.sqrt(dx * dx + dy * dy);\n  const adjLength = length - endOffset;\n\n  context.translate(start.x, start.y);\n  context.rotate(angle);\n\n  context.beginPath();\n  context.moveTo(startOffset, arrowGap);\n  context.lineTo(adjLength, arrowGap);\n  context.moveTo(adjLength - headLength, headWidth + arrowGap);\n  context.lineTo(adjLength, arrowGap);\n  context.lineTo(adjLength - headLength, -(headWidth - arrowGap));\n\n  context.moveTo(adjLength, -arrowGap);\n  context.lineTo(startOffset, -arrowGap);\n  context.moveTo(startOffset + headLength, -(headWidth + arrowGap));\n  context.lineTo(startOffset, -arrowGap);\n  context.lineTo(startOffset + headLength, headWidth - arrowGap);\n\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nexport function drawUnidirectionalArrow(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string,\n  startOffset = 0,\n  endOffset = 0\n): void {\n  context.save();\n  context.beginPath();\n  context.strokeStyle = color;\n  context.lineWidth = 2;\n  const headLength = 9;\n  const headWidth = 4;\n  const dx = end.x - start.x;\n  const dy = end.y - start.y;\n  const angle = Math.atan2(dy, dx);\n  const length = Math.sqrt(dx * dx + dy * dy);\n  const adjLength = length - endOffset;\n\n  context.translate(start.x, start.y);\n  context.rotate(angle);\n\n  context.beginPath();\n  context.moveTo(startOffset, 0);\n  context.lineTo(adjLength, 0);\n  context.moveTo(adjLength - headLength, -headWidth);\n  context.lineTo(adjLength, 0);\n  context.lineTo(adjLength - headLength, headWidth);\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nexport function drawArrowWithoutHead(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string,\n  startOffset = 0,\n  endOffset = 0\n): void {\n  context.save();\n  context.beginPath();\n  context.strokeStyle = color;\n  context.lineWidth = 2;\n  const dx = end.x - start.x;\n  const dy = end.y - start.y;\n  const angle = Math.atan2(dy, dx);\n  const length = Math.sqrt(dx * dx + dy * dy);\n  context.translate(start.x, start.y);\n  context.rotate(angle);\n  context.beginPath();\n  context.moveTo(startOffset, 0);\n  const adjLength = length - endOffset;\n  context.lineTo(adjLength, 0);\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\nexport function drawClearBox(\n  context: CanvasRenderingContext2D,\n  start: Point,\n  end: Point,\n  color: string\n): void {\n  context.save();\n  context.beginPath();\n  context.fillStyle = color;\n  context.globalAlpha = 0.2;\n  context.fillRect(start.x, start.y, end.x - start.x, end.y - start.y);\n  context.closePath();\n\n  // outline\n  context.beginPath();\n  context.strokeStyle = color;\n  context.rect(start.x, start.y, end.x - start.x, end.y - start.y);\n  context.stroke();\n  context.closePath();\n\n  context.restore();\n}\n\nexport function drawConnection(\n  context: CanvasRenderingContext2D,\n  sourceCenter: Point,\n  sourceRadius: number,\n  targetCenter: Point,\n  targetRadius: number,\n  kind: HSConnectionKind\n): void {\n  if ([\"cond\", \"conv\"].includes(kind)) {\n    drawBidirectionalArrow(\n      context,\n      sourceCenter,\n      targetCenter,\n      \"black\",\n      sourceRadius,\n      targetRadius\n    );\n  } else {\n    drawUnidirectionalArrow(\n      context,\n      sourceCenter,\n      targetCenter,\n      \"black\",\n      sourceRadius,\n      targetRadius\n    );\n  }\n}\n\nexport function intersectsCircle(\n  point: Point,\n  circleCenter: Point,\n  radius: number\n): boolean {\n  const deltaX = point.x - circleCenter.x;\n  const deltaY = point.y - circleCenter.y;\n  return Math.pow(deltaX, 2) + Math.pow(deltaY, 2) <= Math.pow(radius, 2);\n}\n\nexport function isInsideBox(\n  startBox: Point,\n  endBox: Point,\n  point: Point\n): boolean {\n  const [topLeft, bottomRight] =\n    startBox.x < endBox.x && startBox.y < endBox.y\n      ? [startBox, endBox]\n      : [endBox, startBox];\n\n  const [bottomLeft, topRight] =\n    startBox.x < endBox.x && startBox.y > endBox.y\n      ? [startBox, endBox]\n      : [endBox, startBox];\n\n  return (\n    (topLeft.x <= point.x &&\n      point.x <= bottomRight.x &&\n      topLeft.y <= point.y &&\n      point.y <= bottomRight.y) ||\n    (bottomLeft.x <= point.x &&\n      point.x <= topRight.x &&\n      topRight.y <= point.y &&\n      point.y <= bottomLeft.y)\n  );\n}\n\nexport function calculateMousePositionOnElement(\n  event: React.MouseEvent | MouseEvent,\n  element: HTMLElement\n): Point {\n  const viewportMousePos = { x: event.pageX, y: event.pageY };\n  const boundingRect = element.getBoundingClientRect();\n  const topLeftCanvasPos = { x: boundingRect.left, y: boundingRect.top };\n  return diffPoints(viewportMousePos, topLeftCanvasPos);\n}\n\nfunction canvasMouseToNodeCoords(\n  mouse: Point,\n  offset: Point,\n  scale: number\n): Point {\n  return diffPoints(scalePoint(mouse, scale), offset);\n}\n\nexport function mouseToNodeCoords(\n  event: React.MouseEvent | MouseEvent,\n  canvasState: CanvasState\n): Point {\n  if (canvasState.context) {\n    const canvasMouse = calculateMousePositionOnElement(\n      event,\n      canvasState.context.canvas\n    );\n    return canvasMouseToNodeCoords(\n      canvasMouse,\n      canvasState.canvasViewState.offset,\n      canvasState.canvasViewState.scale\n    );\n  } else {\n    return ORIGIN;\n  }\n}\n\nexport function rotatedDirection(direction: Direction): Direction {\n  // assume rotate counter-clockwise\n  if (direction === \"D\") {\n    return \"R\";\n  } else if (direction === \"R\") {\n    return \"U\";\n  } else if (direction === \"U\") {\n    return \"L\";\n  } else {\n    return \"D\";\n  }\n}\n\nexport function getCanvasCenter(\n  canvasWidth: number,\n  canvasHeight: number,\n  offset: Point,\n  scale: number\n): Point {\n  const topLeftPoint = offset;\n  const distanceToCenter = scalePoint(\n    { x: canvasWidth, y: canvasHeight },\n    2 * scale\n  );\n  return diffPoints(distanceToCenter, topLeftPoint);\n}\n\nexport function determineRadius(\n  capacitance: number,\n  allCapacitances: number[]\n): number {\n  const min = Math.min(...allCapacitances);\n  const max = Math.max(...allCapacitances);\n  // cap = min -> minRadius\n  // cap = max -> maxRadius\n  // radius = (cap - min) / (max - min) * 20 + 10\n  if (min === max) {\n    return DEFAULT_RADIUS;\n  }\n  return (\n    ((capacitance - min) / (max - min)) * (maxRadiusPx - minRadiusPx) +\n    minRadiusPx\n  );\n}\n\nexport function determineColor(\n  temperature: number,\n  allTemperatures: number[]\n): string {\n  const minTemp = Math.min(...allTemperatures);\n  const maxTemp = Math.max(...allTemperatures);\n  const range = maxTemp - minTemp;\n  const test = scaleDiverging<string>()\n    .domain([minTemp - range / 3, (minTemp + maxTemp) / 2, maxTemp + range / 3])\n    .range([\"blue\", \"#ababab\", \"red\"]);\n  return test(temperature);\n}\n","import * as React from \"react\";\nimport { useCallback, useLayoutEffect, useRef, useState } from \"react\";\nimport {\n  addPoints,\n  diffPoints,\n  ORIGIN,\n  Point,\n  scalePoint,\n} from \"../../../utils/pointUtils\";\nimport config from \"../../../config\";\nimport { calculateMousePositionOnElement } from \"../canvasUtils\";\nimport { CanvasViewState } from \"../Canvas\";\n\nconst { maxZoom, minZoom, zoomSensitivity, maxZoomDelta } = config;\n\nexport default function usePanZoomCanvas(\n  canvasRef: React.RefObject<HTMLCanvasElement>,\n  canvasViewState: CanvasViewState,\n  setCanvasViewState: (newCanvasViewState: CanvasViewState) => void\n): [\n  CanvasRenderingContext2D | null,\n  React.Dispatch<React.SetStateAction<CanvasRenderingContext2D | null>>,\n  (event: React.MouseEvent | MouseEvent) => void\n] {\n  const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\n  const mousePosRef = useRef<Point>(ORIGIN);\n  const lastMousePosRef = useRef<Point>(ORIGIN);\n  const lastCanvasViewState = useRef<CanvasViewState>(canvasViewState);\n\n  // functions for panning\n  const mouseMove = useCallback(\n    (event: React.MouseEvent | MouseEvent) => {\n      if (context) {\n        // update mouse position\n        const newMousePos = calculateMousePositionOnElement(\n          event,\n          context.canvas\n        );\n        lastMousePosRef.current = mousePosRef.current;\n        mousePosRef.current = newMousePos;\n\n        const mouseDiff = scalePoint(\n          diffPoints(mousePosRef.current, lastMousePosRef.current),\n          canvasViewState.scale\n        );\n        const newCanvasViewState = {\n          scale: canvasViewState.scale,\n          offset: addPoints(lastCanvasViewState.current.offset, mouseDiff),\n        };\n        setCanvasViewState(newCanvasViewState);\n        lastCanvasViewState.current = newCanvasViewState;\n      }\n    },\n    [context, canvasViewState.scale, setCanvasViewState]\n  );\n\n  const mouseUp = useCallback(() => {\n    document.removeEventListener(\"mousemove\", mouseMove);\n    document.removeEventListener(\"mouseup\", mouseUp);\n  }, [mouseMove]);\n\n  const startPan = useCallback(\n    (event: React.MouseEvent | MouseEvent) => {\n      if (context) {\n        document.addEventListener(\"mousemove\", mouseMove);\n        document.addEventListener(\"mouseup\", mouseUp);\n        mousePosRef.current = calculateMousePositionOnElement(\n          event,\n          context.canvas\n        );\n      }\n    },\n    [context, mouseMove, mouseUp]\n  );\n\n  // add event listener on canvas for zoom\n  useLayoutEffect(() => {\n    function handleWheel(event: WheelEvent) {\n      event.preventDefault();\n      if (context) {\n        // update mouse position\n        const newMousePos = calculateMousePositionOnElement(\n          event,\n          context.canvas\n        );\n        lastMousePosRef.current = mousePosRef.current;\n        mousePosRef.current = newMousePos;\n\n        // calculate new scale/zoom\n        const zoomDelta = event.deltaY / zoomSensitivity;\n        const zoom =\n          1 -\n          (Math.abs(zoomDelta) > maxZoomDelta\n            ? (zoomDelta / Math.abs(zoomDelta)) * maxZoomDelta\n            : zoomDelta);\n        const newScale = canvasViewState.scale * zoom;\n        if (newScale > maxZoom || newScale < minZoom) {\n          return;\n        }\n\n        // offset the canvas such that the point under the mouse doesn't move\n        const lastMouse = scalePoint(\n          mousePosRef.current,\n          canvasViewState.scale\n        );\n        const newMouse = scalePoint(mousePosRef.current, newScale);\n        const mouseOffset = diffPoints(lastMouse, newMouse);\n\n        const newCanvasViewState = {\n          offset: diffPoints(lastCanvasViewState.current.offset, mouseOffset),\n          scale: newScale,\n        };\n        setCanvasViewState(newCanvasViewState);\n        lastCanvasViewState.current = newCanvasViewState;\n      }\n    }\n\n    const canvasElem = canvasRef.current;\n    if (canvasElem) {\n      lastCanvasViewState.current = canvasViewState;\n      canvasElem.addEventListener(\"wheel\", handleWheel);\n      return () => canvasElem.removeEventListener(\"wheel\", handleWheel);\n    }\n  }, [canvasRef, canvasViewState, context, setCanvasViewState]);\n\n  return [context, setContext, startPan];\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { ORIGIN } from \"../../utils/pointUtils\";\nimport { CanvasState, CanvasViewState } from \"./Canvas\";\n\nconst StyledButtons = styled.div`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst StyledButton = styled.button`\n  margin: 0.2em;\n`;\n\ntype CanvasControlsProps = {\n  setCanvasViewState: (canvasViewState: CanvasViewState) => void;\n  canvasState: CanvasState;\n  savedCanvasState: CanvasViewState;\n  setSavedCanvasState: (newSavedCanvasState: CanvasViewState) => void;\n};\n\nexport default function CanvasControls(\n  props: CanvasControlsProps\n): React.ReactElement {\n  return (\n    <StyledButtons>\n      <StyledButton\n        onClick={() =>\n          props.canvasState.context &&\n          props.setCanvasViewState({ offset: ORIGIN, scale: 1 })\n        }\n      >\n        Reset View\n      </StyledButton>\n      <StyledButton\n        onClick={() =>\n          props.canvasState.context &&\n          props.setCanvasViewState({\n            offset: props.savedCanvasState.offset,\n            scale: props.savedCanvasState.scale,\n          })\n        }\n      >\n        Reset View to Saved\n      </StyledButton>\n      <StyledButton\n        onClick={() => {\n          props.setSavedCanvasState({\n            offset: props.canvasState.canvasViewState.offset,\n            scale: props.canvasState.canvasViewState.scale,\n          });\n        }}\n      >\n        Save View\n      </StyledButton>\n    </StyledButtons>\n  );\n}\n","import * as React from \"react\";\nimport { ModalState } from \"../../App\";\nimport styled from \"styled-components/macro\";\n\nconst StyledModalControls = styled.div`\n  position: absolute;\n  right: 10px;\n  top: 10px;\n`;\n\nconst StyledModalControlButton = styled.button`\n  margin-left: 1em;\n`;\n\ntype ModalControlsProps = {\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n};\n\nexport default function ModalControls(\n  props: ModalControlsProps\n): React.ReactElement {\n  const { setModalState } = props;\n\n  return (\n    <StyledModalControls>\n      <StyledModalControlButton\n        onClick={() => setModalState({ visible: true, type: \"theory\" })}\n      >\n        Theory\n      </StyledModalControlButton>\n      <StyledModalControlButton\n        onClick={() => setModalState({ visible: true, type: \"tutorial\" })}\n      >\n        Tutorial\n      </StyledModalControlButton>\n      <StyledModalControlButton\n        onClick={() => setModalState({ visible: true, type: \"about\" })}\n      >\n        About\n      </StyledModalControlButton>\n    </StyledModalControls>\n  );\n}\n","import * as React from \"react\";\nimport { useLayoutEffect, useRef } from \"react\";\nimport styled from \"styled-components\";\nimport usePanZoomCanvas from \"./hooks/usePanZoomCanvas\";\nimport { Point } from \"../../utils/pointUtils\";\nimport CanvasControls from \"./CanvasControls\";\nimport useOnClickCanvas from \"./hooks/useOnClickCanvas\";\nimport { ModalState } from \"../../App\";\nimport ModalControls from \"./ModalControls\";\n\nconst StyledCanvasWrapper = styled.div`\n  display: block;\n  max-height: 100%;\n  position: relative;\n`;\n\nconst StyledCanvas = styled.canvas<{ cssWidth: number; cssHeight: number }>`\n  width: ${({ cssWidth }) => `${cssWidth}px`};\n  height: ${({ cssHeight }) => `${cssHeight}px`};\n`;\n\nexport type CanvasViewState = {\n  offset: Point;\n  scale: number;\n};\n\nexport type CanvasState = {\n  context: CanvasRenderingContext2D | null;\n  canvasViewState: CanvasViewState;\n  canvasWidth: number;\n  canvasHeight: number;\n};\n\nexport type CanvasProps = {\n  canvasWidth: number;\n  canvasHeight: number;\n  devicePixelRatio: number;\n  draw: (context: CanvasRenderingContext2D) => void;\n  onMouseDown: (\n    event: React.MouseEvent | MouseEvent,\n    canvasState: CanvasState,\n    defaultBehavior: (event: React.MouseEvent | MouseEvent) => void\n  ) => void;\n  handleDoubleClick: (\n    event: React.MouseEvent,\n    canvasState: CanvasState\n  ) => void;\n  canvasViewState: CanvasViewState;\n  setCanvasViewState: (newCanvasState: CanvasViewState) => void;\n  savedCanvasViewState: CanvasViewState;\n  setSavedCanvasViewState: (newSavedCanvasState: CanvasViewState) => void;\n  setKeyboardActive: React.Dispatch<React.SetStateAction<boolean>>;\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n};\n\nexport default function Canvas(props: CanvasProps): React.ReactElement {\n  const {\n    canvasWidth,\n    canvasHeight,\n    devicePixelRatio,\n    draw,\n    onMouseDown,\n    handleDoubleClick,\n    canvasViewState,\n    setCanvasViewState,\n    savedCanvasViewState,\n    setSavedCanvasViewState,\n    setKeyboardActive,\n    setModalState,\n  } = props;\n\n  // hooks\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  useOnClickCanvas(canvasRef, setKeyboardActive);\n  const [context, setContext, startPan] = usePanZoomCanvas(\n    canvasRef,\n    canvasViewState,\n    setCanvasViewState\n  );\n\n  // setup canvas and set context\n  useLayoutEffect(() => {\n    if (canvasRef.current) {\n      // get new drawing context\n      const renderCtx = canvasRef.current.getContext(\"2d\");\n      setContext(renderCtx);\n    }\n  }, [setContext]);\n\n  // draw\n  useLayoutEffect(() => {\n    if (context) {\n      // clear canvas\n      context.canvas.width = canvasWidth * devicePixelRatio;\n      context.canvas.height = canvasHeight * devicePixelRatio;\n\n      context.scale(\n        canvasViewState.scale * devicePixelRatio,\n        canvasViewState.scale * devicePixelRatio\n      );\n      context.translate(canvasViewState.offset.x, canvasViewState.offset.y);\n\n      draw(context);\n    }\n  }, [\n    canvasHeight,\n    canvasWidth,\n    context,\n    devicePixelRatio,\n    draw,\n    canvasViewState.offset.x,\n    canvasViewState.offset.y,\n    canvasViewState.scale,\n  ]);\n\n  return (\n    <StyledCanvasWrapper>\n      <ModalControls setModalState={setModalState} />\n      <CanvasControls\n        setCanvasViewState={setCanvasViewState}\n        canvasState={{\n          context,\n          canvasViewState,\n          canvasWidth,\n          canvasHeight,\n        }}\n        savedCanvasState={savedCanvasViewState}\n        setSavedCanvasState={setSavedCanvasViewState}\n      />\n      <StyledCanvas\n        ref={canvasRef}\n        width={canvasWidth * devicePixelRatio}\n        height={canvasHeight * devicePixelRatio}\n        cssWidth={canvasWidth}\n        cssHeight={canvasHeight}\n        onMouseDown={(event: React.MouseEvent | MouseEvent) =>\n          onMouseDown(\n            event,\n            { context, canvasViewState, canvasWidth, canvasHeight },\n            () => startPan(event)\n          )\n        }\n        onDoubleClick={(event: React.MouseEvent) =>\n          handleDoubleClick(event, {\n            context,\n            canvasViewState,\n            canvasWidth,\n            canvasHeight,\n          })\n        }\n      />\n    </StyledCanvasWrapper>\n  );\n}\n","import * as React from \"react\";\nimport { useEffect } from \"react\";\n\nexport default function useOnClickCanvas(\n  ref: React.RefObject<HTMLCanvasElement>,\n  onClickCanvas: React.Dispatch<React.SetStateAction<boolean>>\n): void {\n  useEffect(() => {\n    const handleClickOutside = (event: React.MouseEvent | MouseEvent) => {\n      const keyBoardActive =\n        !!ref.current && ref.current.contains(event.target as Node);\n      onClickCanvas(keyBoardActive);\n    };\n\n    // Bind the event listener\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      // Unbind the event listener on clean up\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [ref, onClickCanvas]);\n}\n","import { useCallback } from \"react\";\nimport {\n  determineColor,\n  determineRadius,\n  drawConnection,\n  drawNode,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\n\nexport default function useDraw(\n  appNodes: AppNode[],\n  appConnections: AppConnection[]\n): [\n  (context: CanvasRenderingContext2D) => void,\n  (canvasState: CanvasState) => void\n] {\n  const draw = useCallback(\n    (context: CanvasRenderingContext2D) => {\n      appNodes.forEach((node) => {\n        const nodeRadius = determineRadius(\n          node.capacitanceJPerDegK,\n          appNodes.map((node) => node.capacitanceJPerDegK)\n        );\n        const nodeColor = determineColor(\n          node.temperatureDegC,\n          appNodes.map((node) => node.temperatureDegC)\n        );\n        drawNode(\n          context,\n          node.name,\n          node.center,\n          nodeRadius,\n          nodeColor,\n          node.isActive,\n          node.isBoundary,\n          node.textDirection\n        );\n      });\n\n      appConnections.map((conn) => {\n        const { source, target, kind } = conn;\n        const sourceAppNode = appNodes.find((node) => node.id === source.id);\n        const targetAppNode = appNodes.find((node) => node.id === target.id);\n        if (sourceAppNode && targetAppNode) {\n          const sourceRadius = determineRadius(\n            sourceAppNode.capacitanceJPerDegK,\n            appNodes.map((node) => node.capacitanceJPerDegK)\n          );\n          const targetRadius = determineRadius(\n            targetAppNode.capacitanceJPerDegK,\n            appNodes.map((node) => node.capacitanceJPerDegK)\n          );\n          drawConnection(\n            context,\n            sourceAppNode.center,\n            sourceRadius,\n            targetAppNode.center,\n            targetRadius,\n            kind\n          );\n        }\n      });\n    },\n    [appConnections, appNodes]\n  );\n\n  const clearAndRedraw = useCallback(\n    (canvasState: CanvasState) => {\n      if (canvasState.context) {\n        canvasState.context.clearRect(\n          -canvasState.canvasViewState.offset.x,\n          -canvasState.canvasViewState.offset.y,\n          canvasState.canvasWidth / canvasState.canvasViewState.scale,\n          canvasState.canvasHeight / canvasState.canvasViewState.scale\n        );\n        draw(canvasState.context);\n      }\n    },\n    [draw]\n  );\n\n  return [draw, clearAndRedraw];\n}\n","import React, { useCallback } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport {\n  determineRadius,\n  drawArrowWithoutHead,\n  intersectsCircle,\n  mouseToNodeCoords,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { getNewConnection } from \"../utils/nodeConnectionUtils\";\n\nexport default function useAddConnection(\n  appNodes: AppNode[],\n  appConnections: AppConnection[],\n  addConnection: (newConnection: AppConnection) => void,\n  clearAndRedraw: (canvasState: CanvasState) => void\n): (\n  event: React.MouseEvent | MouseEvent,\n  clickedNode: AppNode,\n  canvasState: CanvasState\n) => void {\n  const drawConnectionBeingMade = useCallback(\n    (\n      event: React.MouseEvent | MouseEvent,\n      clickedNode: AppNode,\n      canvasState: CanvasState\n    ) => {\n      if (canvasState.context) {\n        const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n        clearAndRedraw(canvasState);\n        drawArrowWithoutHead(\n          canvasState.context,\n          clickedNode.center,\n          nodeCoordsOfMouse,\n          \"grey\"\n        );\n      }\n    },\n    [clearAndRedraw]\n  );\n\n  return useCallback(\n    (\n      event: React.MouseEvent | MouseEvent,\n      clickedNode: AppNode,\n      canvasState: CanvasState\n    ) => {\n      const drawConnWrapper = (event: React.MouseEvent | MouseEvent) => {\n        drawConnectionBeingMade(event, clickedNode, canvasState);\n      };\n\n      const mouseUp = (event: React.MouseEvent | MouseEvent) => {\n        document.removeEventListener(\"mousemove\", drawConnWrapper);\n        document.removeEventListener(\"mouseup\", mouseUp);\n\n        // if arrow released on a node, make new connection\n        const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n        const mouseUpOnNode = appNodes.find((node) => {\n          const nodeRadius = determineRadius(\n            node.capacitanceJPerDegK,\n            appNodes.map((node) => node.capacitanceJPerDegK)\n          );\n          return (\n            intersectsCircle(nodeCoordsOfMouse, node.center, nodeRadius) &&\n            node.id !== clickedNode.id\n          );\n        });\n\n        if (mouseUpOnNode) {\n          const newConnection = getNewConnection(\n            clickedNode,\n            mouseUpOnNode,\n            appConnections\n          );\n          if (!!newConnection) {\n            addConnection(newConnection);\n          } else {\n            clearAndRedraw(canvasState);\n          }\n        } else {\n          clearAndRedraw(canvasState);\n        }\n      };\n      document.addEventListener(\"mousemove\", drawConnWrapper);\n      document.addEventListener(\"mouseup\", mouseUp);\n    },\n    [\n      addConnection,\n      appConnections,\n      appNodes,\n      clearAndRedraw,\n      drawConnectionBeingMade,\n    ]\n  );\n}\n","import React, { useCallback, useRef } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport { mouseToNodeCoords } from \"../components/Canvas/canvasUtils\";\nimport { AppNode } from \"../App\";\nimport { diffPoints } from \"../utils/pointUtils\";\nimport config from \"../config\";\n\nfunction getNewAppNodes(\n  clickedMouseEvent: React.MouseEvent | MouseEvent,\n  currentMouseEvent: React.MouseEvent | MouseEvent,\n  canvasState: CanvasState,\n  clickedNode: AppNode,\n  multiSelectKeyPressed: boolean,\n  activeNodes: AppNode[]\n): AppNode[] {\n  const offsetMouseToCenter = diffPoints(\n    mouseToNodeCoords(clickedMouseEvent, canvasState),\n    clickedNode.center\n  );\n\n  const newClickedCenter = diffPoints(\n    mouseToNodeCoords(currentMouseEvent, canvasState),\n    offsetMouseToCenter\n  );\n\n  const newClickedNode = {\n    ...clickedNode,\n    isActive: true,\n    center: newClickedCenter,\n  };\n\n  const newActiveNodes =\n    clickedNode.isActive || multiSelectKeyPressed\n      ? activeNodes.map((node) => {\n          const distanceFromClickedCenter = diffPoints(\n            clickedNode.center,\n            node.center\n          );\n          return {\n            ...node,\n            center: diffPoints(newClickedCenter, distanceFromClickedCenter),\n          };\n        })\n      : [];\n\n  return [newClickedNode, ...newActiveNodes];\n}\n\nexport default function useMoveNode(\n  updateNodes: (nodesToUpdate: AppNode[], clearActiveNodes?: boolean) => void\n): (\n  event: React.MouseEvent | MouseEvent,\n  clickedNode: AppNode,\n  activeNodes: AppNode[],\n  canvasState: CanvasState\n) => void {\n  const movedRef = useRef<boolean>(false);\n\n  return useCallback(\n    (\n      mouseDownEvent: React.MouseEvent | MouseEvent,\n      clickedNode: AppNode,\n      activeNodes: AppNode[],\n      canvasState: CanvasState\n    ) => {\n      const multiSelectKeyPressed = config.multiSelectKeys.some(\n        (k) => mouseDownEvent[k]\n      );\n      const moveNode = (currentMouseEvent: React.MouseEvent | MouseEvent) => {\n        if (canvasState.context) {\n          movedRef.current = true;\n          const newNodes = getNewAppNodes(\n            mouseDownEvent,\n            currentMouseEvent,\n            canvasState,\n            clickedNode,\n            multiSelectKeyPressed,\n            activeNodes\n          );\n          updateNodes(\n            newNodes,\n            !config.multiSelectKeys.some((k) => currentMouseEvent[k])\n          );\n        }\n      };\n      const mouseUp = (mouseUpEvent: React.MouseEvent | MouseEvent) => {\n        document.removeEventListener(\"mousemove\", moveNode);\n        document.removeEventListener(\"mouseup\", mouseUp);\n        const newNodes = getNewAppNodes(\n          mouseDownEvent,\n          mouseUpEvent,\n          canvasState,\n          clickedNode,\n          multiSelectKeyPressed,\n          activeNodes\n        );\n        updateNodes(newNodes, !multiSelectKeyPressed);\n        movedRef.current = false;\n      };\n      document.addEventListener(\"mousemove\", moveNode);\n      document.addEventListener(\"mouseup\", mouseUp);\n    },\n    [updateNodes]\n  );\n}\n","import React, { useCallback } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport {\n  drawClearBox,\n  isInsideBox,\n  mouseToNodeCoords,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppNode } from \"../App\";\n\nexport default function useMultiSelect(\n  appNodes: AppNode[],\n  setActiveNodes: (activeNodeIds: string[]) => void,\n  clearAndRedraw: (canvasState: CanvasState) => void\n): (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => void {\n  return useCallback(\n    (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => {\n      const boxStart = mouseToNodeCoords(event, canvasState);\n      const drawBox = (event: React.MouseEvent | MouseEvent) => {\n        if (canvasState.context) {\n          clearAndRedraw(canvasState);\n          drawClearBox(\n            canvasState.context,\n            boxStart,\n            mouseToNodeCoords(event, canvasState),\n            \"grey\"\n          );\n        }\n      };\n      const mouseUp = (event: React.MouseEvent | MouseEvent) => {\n        document.removeEventListener(\"mousemove\", drawBox);\n        document.removeEventListener(\"mouseup\", mouseUp);\n\n        const boxEnd = mouseToNodeCoords(event, canvasState);\n        const activeNodeIds = appNodes\n          .filter(\n            (node) =>\n              isInsideBox(boxStart, boxEnd, node.center) || node.isActive\n          )\n          .map((node) => node.id);\n        setActiveNodes(activeNodeIds);\n      };\n      document.addEventListener(\"mousemove\", drawBox);\n      document.addEventListener(\"mouseup\", mouseUp);\n    },\n    [appNodes, clearAndRedraw, setActiveNodes]\n  );\n}\n","import * as React from \"react\";\nimport { useCallback } from \"react\";\nimport {\n  determineRadius,\n  intersectsCircle,\n  mouseToNodeCoords,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport useAddConnection from \"./useAddConnection\";\nimport useMoveNode from \"./useMoveNode\";\nimport useMultiSelect from \"./useMultiSelect\";\nimport config from \"../config\";\n\nexport default function useOnMouseDown(\n  appNodes: AppNode[],\n  appConnections: AppConnection[],\n  addConnection: (newConnection: AppConnection) => void,\n  updateNodes: (nodesToUpdate: AppNode[], clearActiveNodes?: boolean) => void,\n  setActiveNodes: (activeNodeIds: string[]) => void,\n  clearActiveNodes: () => void,\n  clearAndRedraw: (canvasState: CanvasState) => void\n): (\n  event: React.MouseEvent | MouseEvent,\n  canvasState: CanvasState,\n  defaultBehavior: (event: React.MouseEvent | MouseEvent) => void\n) => void {\n  const makeNewConnection = useAddConnection(\n    appNodes,\n    appConnections,\n    addConnection,\n    clearAndRedraw\n  );\n  const moveNode = useMoveNode(updateNodes);\n  const multiSelect = useMultiSelect(appNodes, setActiveNodes, clearAndRedraw);\n\n  return useCallback(\n    (\n      mouseDownEvent: React.MouseEvent | MouseEvent,\n      canvasState: CanvasState,\n      defaultBehavior: (event: React.MouseEvent | MouseEvent) => void\n    ) => {\n      const nodeCoordsOfMouse = mouseToNodeCoords(mouseDownEvent, canvasState);\n\n      const activeNodes = appNodes.filter((node) => node.isActive);\n      const activeNodeIds = activeNodes.map((node) => node.id);\n\n      const clickedNode = appNodes.find((node) => {\n        const nodeRadius = determineRadius(\n          node.capacitanceJPerDegK,\n          appNodes.map((node) => node.capacitanceJPerDegK)\n        );\n        return intersectsCircle(nodeCoordsOfMouse, node.center, nodeRadius);\n      });\n\n      if (clickedNode) {\n        if (mouseDownEvent.altKey) {\n          makeNewConnection(mouseDownEvent, clickedNode, canvasState);\n        } else if (\n          config.multiSelectKeys.some((k) => mouseDownEvent[k]) &&\n          activeNodeIds.includes(clickedNode.id)\n        ) {\n          setActiveNodes(activeNodeIds.filter((id) => id !== clickedNode.id));\n        } else {\n          moveNode(mouseDownEvent, clickedNode, activeNodes, canvasState);\n        }\n      } else {\n        if (config.multiSelectKeys.some((k) => mouseDownEvent[k])) {\n          multiSelect(mouseDownEvent, canvasState);\n        } else {\n          // only clear active nodes if click with no pan\n          const onMouseUp = (mouseUpEvent: React.MouseEvent | MouseEvent) => {\n            if (\n              mouseUpEvent.clientX === mouseDownEvent.clientX &&\n              mouseUpEvent.clientY === mouseDownEvent.clientY\n            ) {\n              clearActiveNodes();\n            }\n            document.removeEventListener(\"mouseup\", onMouseUp);\n          };\n          document.addEventListener(\"mouseup\", onMouseUp);\n          defaultBehavior(mouseDownEvent);\n        }\n      }\n    },\n    [\n      appNodes,\n      clearActiveNodes,\n      moveNode,\n      multiSelect,\n      makeNewConnection,\n      setActiveNodes,\n    ]\n  );\n}\n","import * as React from \"react\";\nimport { useRef } from \"react\";\nimport { diffPoints, Point } from \"../utils/pointUtils\";\n\nexport default function useClickAndDragElement(params: {\n  onDragX?: (deltaXPx: number) => void;\n  onDragY?: (deltaYPx: number) => void;\n  constrainX?: (newYPx: number) => number;\n  constrainY?: (newYPx: number) => number;\n}): (mouseDownEvent: React.MouseEvent | MouseEvent) => void {\n  const lastMousePos = useRef<Point | undefined>(undefined);\n\n  const { onDragX, onDragY, constrainX, constrainY } = params;\n\n  const onMouseUp = () => {\n    document.removeEventListener(\"mousemove\", onMouseMove);\n    document.removeEventListener(\"mouseup\", onMouseUp);\n  };\n\n  const onMouseMove = (mouseMoveEvent: React.MouseEvent | MouseEvent) => {\n    if (lastMousePos.current) {\n      const currentMousePos = {\n        x: mouseMoveEvent.pageX,\n        y: mouseMoveEvent.pageY,\n      };\n      const diff = diffPoints(currentMousePos, lastMousePos.current);\n      onDragX && onDragX(diff.x);\n      onDragY && onDragY(diff.y);\n      lastMousePos.current = {\n        x: constrainX ? constrainX(currentMousePos.x) : currentMousePos.x,\n        y: constrainY ? constrainY(currentMousePos.y) : currentMousePos.y,\n      };\n    }\n  };\n\n  return (mouseDownEvent: React.MouseEvent | MouseEvent) => {\n    document.addEventListener(\"mousemove\", onMouseMove);\n    document.addEventListener(\"mouseup\", onMouseUp);\n    lastMousePos.current = { x: mouseDownEvent.pageX, y: mouseDownEvent.pageY };\n  };\n}\n","import * as React from \"react\";\nimport { useCallback, useRef } from \"react\";\nimport useClickAndDragElement from \"./useClickAndDragElement\";\nimport { AppState } from \"../App\";\nimport config from \"../config\";\n\nfunction constrainPanelSize(newPanelSize: number): number {\n  return newPanelSize < config.minPanelFraction\n    ? config.minPanelFraction\n    : newPanelSize > 1 - config.minPanelFraction\n    ? 1 - config.minPanelFraction\n    : newPanelSize;\n}\n\nexport default function useResizablePanels(\n  setAppState: React.Dispatch<React.SetStateAction<AppState>>,\n  windowHeight: number,\n  windowWidth: number\n): [\n  React.MutableRefObject<null>,\n  (mouseDownEvent: MouseEvent | React.MouseEvent<Element, MouseEvent>) => void,\n  React.MutableRefObject<null>,\n  (mouseDownEvent: MouseEvent | React.MouseEvent<Element, MouseEvent>) => void,\n  React.MutableRefObject<null>,\n  (mouseDownEvent: MouseEvent | React.MouseEvent<Element, MouseEvent>) => void\n] {\n  const constrainX = useCallback(\n    (newX: number) => {\n      const minPx = windowWidth * config.minPanelFraction;\n      const maxPx = windowWidth * (1 - config.minPanelFraction);\n      if (newX < minPx) {\n        return minPx;\n      } else if (newX > maxPx) {\n        return maxPx;\n      } else {\n        return newX;\n      }\n    },\n    [windowWidth]\n  );\n\n  const constrainY = useCallback(\n    (newY: number) => {\n      const minPx = windowHeight * config.minPanelFraction;\n      const maxPx = windowHeight * (1 - config.minPanelFraction);\n      if (newY < minPx) {\n        return minPx;\n      } else if (newY > maxPx) {\n        return maxPx;\n      } else {\n        return newY;\n      }\n    },\n    [windowHeight]\n  );\n\n  const canvasPlotBorderRef = useRef(null);\n  const onDragYCanvasPlot = useCallback(\n    (deltaYPx: number) => {\n      setAppState((prevAppState) => ({\n        ...prevAppState,\n        panelSizes: {\n          ...prevAppState.panelSizes,\n          canvasHeightFraction: constrainPanelSize(\n            prevAppState.panelSizes.canvasHeightFraction +\n              deltaYPx / windowHeight\n          ),\n        },\n      }));\n    },\n    [setAppState, windowHeight]\n  );\n  const onMouseDownOnCanvasPlotBorder = useClickAndDragElement({\n    onDragY: onDragYCanvasPlot,\n    constrainY,\n  });\n\n  const leftRightBorderRef = useRef(null);\n  const onDragXLeftRight = useCallback(\n    (deltaXPx: number) => {\n      setAppState((prevAppState) => ({\n        ...prevAppState,\n        panelSizes: {\n          ...prevAppState.panelSizes,\n          editorWidthFraction: constrainPanelSize(\n            prevAppState.panelSizes.editorWidthFraction - deltaXPx / windowWidth\n          ),\n        },\n      }));\n    },\n    [setAppState, windowWidth]\n  );\n  const onMouseDownOnLeftRightBorder = useClickAndDragElement({\n    onDragX: onDragXLeftRight,\n    constrainX,\n  });\n\n  const tableControlsBorderRef = useRef(null);\n  const onDragYTableControls = useCallback(\n    (deltaYPx: number) => {\n      setAppState((prevAppState) => ({\n        ...prevAppState,\n        panelSizes: {\n          ...prevAppState.panelSizes,\n          tableHeightFraction: constrainPanelSize(\n            prevAppState.panelSizes.tableHeightFraction +\n              deltaYPx / windowHeight\n          ),\n        },\n      }));\n    },\n    [setAppState, windowHeight]\n  );\n  const onMouseDownOnTableControlsBorder = useClickAndDragElement({\n    onDragY: onDragYTableControls,\n    constrainY,\n  });\n\n  return [\n    canvasPlotBorderRef,\n    onMouseDownOnCanvasPlotBorder,\n    leftRightBorderRef,\n    onMouseDownOnLeftRightBorder,\n    tableControlsBorderRef,\n    onMouseDownOnTableControlsBorder,\n  ];\n}\n","import styled from \"styled-components/macro\";\n\nexport const StyledApp = styled.div<{ height: number; modalOpen: boolean }>`\n  display: flex;\n  height: ${(props) => props.height}px;\n  filter: ${(props) => (props.modalOpen ? \"blur(5px)\" : \"unset\")};\n  pointer-events: ${(props) => (props.modalOpen ? \"none\" : \"unset\")};\n  user-select: none;\n  -webkit-user-select: none; /* Chrome/Safari */\n  -moz-user-select: none; /* Firefox */\n  -ms-user-select: none; /* IE10+ */\n`;\n\nexport const StyledDraggableBorder = styled.div`\n  position: absolute;\n  z-index: 1;\n`;\n\nexport const StyledHorizontalBorder = styled(StyledDraggableBorder)<{\n  width: number;\n  y: number;\n  left: number;\n}>`\n  width: ${(props) => props.width * 100}%;\n  height: 10px;\n  top: ${(props) => props.y * 100}%;\n  transform: translate(0, -5px);\n  cursor: row-resize;\n  left: ${(props) => props.left * 100}%;\n`;\n\nexport const StyledVerticalBorder = styled(StyledDraggableBorder)<{\n  x: number;\n}>`\n  height: 100%;\n  width: 10px;\n  left: ${(props) => props.x * 100}%;\n  transform: translate(-5px, 0);\n  cursor: col-resize;\n`;\n\nexport const StyledWorkspace = styled.div<{ height: number; width: number }>`\n  height: ${(props) => props.height}px;\n  width: ${(props) => props.width}px;\n`;\n\nexport const StyledCanvas = styled.div<{ height: number }>`\n  width: 100%;\n  height: ${(props) => props.height}px;\n`;\n","import * as React from \"react\";\nimport { ModalState } from \"../../App\";\nimport styled from \"styled-components/macro\";\n\nconst StyledConfirmationModal = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin: 2em;\n  justify-content: center;\n  align-items: center;\n  line-height: 1.8em;\n`;\n\nconst StyledConfirmationText = styled.p`\n  margin: 0.8em;\n  font-size: 1.5em;\n  font-weight: bold;\n  max-width: 800px;\n  text-align: center;\n`;\n\nconst StyledConfirmationButtons = styled.div`\n  display: flex;\n`;\n\nconst StyledConfirmationButton = styled.button`\n  font-size: 1.5em;\n  margin-left: 1em;\n  margin-right: 1em;\n  min-width: 100px;\n`;\n\ntype ConfirmationModalProps = {\n  modalState: ModalState;\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n};\n\nexport default function ConfirmationModal(\n  props: ConfirmationModalProps\n): React.ReactElement {\n  const { modalState, setModalState } = props;\n\n  return (\n    <StyledConfirmationModal>\n      {modalState.confirmText &&\n        modalState.confirmText.map((text) => (\n          <StyledConfirmationText key={text}>{text}</StyledConfirmationText>\n        ))}\n      <StyledConfirmationButtons>\n        <StyledConfirmationButton\n          onClick={() => setModalState((prev) => ({ ...prev, visible: false }))}\n        >\n          No\n        </StyledConfirmationButton>\n        <StyledConfirmationButton\n          onClick={() => {\n            modalState.onConfirm && modalState.onConfirm();\n            setModalState((prev) => ({ ...prev, visible: false }));\n          }}\n        >\n          Yes\n        </StyledConfirmationButton>\n      </StyledConfirmationButtons>\n    </StyledConfirmationModal>\n  );\n}\n","import * as React from \"react\";\nimport styled from \"styled-components/macro\";\nimport { MathComponent } from \"mathjax-react\";\n\nconst StyledTheoryModal = styled.div`\n  width: 80%;\n  max-width: 1200px;\n  height: 90%;\n  overflow-y: auto;\n`;\n\nconst StyledTitle = styled.h1``;\n\nconst StyledText = styled.p``;\n\nconst StyledImg = styled.img`\n  width: 90%;\n  max-width: 700px;\n`;\n\nconst StyledLink = styled.a``;\n\nconst StyledListItem = styled.li`\n  margin-bottom: 1em;\n`;\n\nexport default function TheoryModal(): React.ReactElement {\n  return (\n    <StyledTheoryModal>\n      <StyledTitle>How Does hotstuff.network Work?</StyledTitle>\n\n      <StyledText>\n        The thermal model used by hotstuff.network is a linear{\" \"}\n        <StyledLink\n          href={\"https://en.wikipedia.org/wiki/State-space_representation\"}\n          target={\"_blank\"}\n        >\n          state space\n        </StyledLink>{\" \"}\n        model based off conservation of heat flow:{\" \"}\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`\\sum{q_{in/out}} + \\sum{q_{generated/consumed}} = 0`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\sum{q_{in/out}}`} />{\" \"}\n          is the sum of all heat transfer in or out in Watts [W]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent\n            display={false}\n            tex={String.raw`\\sum{q_{generated/consumed}}`}\n          />{\" \"}\n          is the sum of all heat generated or consumed, in Watts [W]\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        The class of model is referred to as a{\" \"}\n        <StyledLink\n          href={\n            \"https://en.wikipedia.org/wiki/Lumped-element_model#Thermal_systems\"\n          }\n          target={\"_blank\"}\n        >\n          Lumped-Element model\n        </StyledLink>\n        , which produces accurate results when each &quot;lump&quot;, or in the\n        terminology of this tool, &quot;node&quot;, can be assumed to have\n        uniform temperature. A node can be assumed to be uniform temperature\n        when the diffusion of heat energy within it is much greater than the\n        transfer of heat into or out of it. This is quantified by a small{\" \"}\n        <StyledLink\n          href={\"https://en.wikipedia.org/wiki/Biot_number\"}\n          target={\"_blank\"}\n        >\n          Biot number\n        </StyledLink>\n        .\n      </StyledText>\n\n      <StyledText>\n        What follows is the definition and manipulation of fundamental heat\n        transfer equations into the numerical form hotstuff.network uses to\n        calculate node temperatures when it runs a model.\n      </StyledText>\n\n      <StyledText>\n        <StyledLink\n          href={\n            \"https://en.wikipedia.org/wiki/Thermal_conduction#Fourier's_law\"\n          }\n          target={\"_blank\"}\n        >\n          Fourier&apos;s Law in 1 dimension\n        </StyledLink>{\" \"}\n        states:\n      </StyledText>\n\n      <MathComponent display={true} tex={String.raw`q =-c \\Delta T`} />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`q`} /> is heat transfer\n          in Watts [W]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`c`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_contact_conductance\"}\n            target={\"_blank\"}\n          >\n            Thermal Conductance\n          </StyledLink>{\" \"}\n          or{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_transmittance\"}\n            target={\"_blank\"}\n          >\n            Thermal Transmittance\n          </StyledLink>{\" \"}\n          in Watts per degree Kelvin [W/degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta T`} /> is the\n          temperature difference in degrees [degK]\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        The reciprocal of Thermal Conductance is{\" \"}\n        <StyledLink\n          href={\"https://en.wikipedia.org/wiki/Thermal_resistance\"}\n          target={\"_blank\"}\n        >\n          Thermal Resistance\n        </StyledLink>{\" \"}\n        , <MathComponent display={false} tex={String.raw`R = 1/c`} />, measured\n        in degrees Kelvin per Watt [degK/W]. For a given object or material,\n        this can be thought of as the temperature difference required to get one\n        Watt of heat to flow through it. Materials with higher thermal\n        resistance require more of a temperature difference to achieve the same\n        heat flow.\n      </StyledText>\n\n      <MathComponent display={true} tex={String.raw`q = -\\frac{\\Delta T}{R}`} />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`q`} /> is heat transfer\n          in Watts [W]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta T`} /> is the\n          temperature difference in degrees [degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`R`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_resistance\"}\n            target={\"_blank\"}\n          >\n            Thermal Resistance\n          </StyledLink>{\" \"}\n          in degrees Kelvin per Watt [degK/W]\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        The definition of{\" \"}\n        <StyledLink\n          href={\"https://en.wikipedia.org/wiki/Heat_capacity\"}\n          target={\"_blank\"}\n        >\n          Thermal Capacitance\n        </StyledLink>{\" \"}\n        (different than Thermal Conductance above) is the amount of heat energy\n        applied to an object to produce 1 degree of temperature change in it:\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`C = \\lim_{\\Delta T \\to 0} \\frac{Q}{\\Delta T} = \\frac{dQ}{dT}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`C`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Heat_capacity\"}\n            target={\"_blank\"}\n          >\n            Thermal Capacitance\n          </StyledLink>{\" \"}\n          , or Heat Capacity, in Joules per degree Kelvin [J/degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`Q`} /> is heat\n          transferred in Joules [J]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta T`} /> is the\n          temperature difference in degrees [degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\frac{dQ}{dT}`} /> is\n          the rate of change of heat transfer with respect to temperature in\n          Joules per degree [J/degK]\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        Rearranging and differentiating the equation above with respect to time,\n        we obtain the following:\n      </StyledText>\n\n      <MathComponent display={true} tex={String.raw`q = C \\frac{dT}{dt}`} />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`q`} /> is heat transfer\n          in Watts (i.e. Joules per Second) [W = J/s]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\frac{dT}{dt}`} /> is\n          the derivative of temperature with respect to time in degrees per\n          second [degK/s]\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        Equating the two equations for{\" \"}\n        <MathComponent display={false} tex={String.raw`q`} />, heat transfer in\n        Watts, working out the signs, and adding in power generated or consumed,\n        we obtain the following:\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`C \\frac{dT}{dt} = \\sum{\\frac{\\Delta T}{R}} - q_{generated/consumed}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`C`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Heat_capacity\"}\n            target={\"_blank\"}\n          >\n            Thermal Capacitance\n          </StyledLink>{\" \"}\n          , or Heat Capacity, in Joules per degree Kelvin [J/degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\frac{dT}{dt}`} /> is\n          the derivative of temperature with respect to time in degrees per\n          second [degK/s]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta T`} /> is the\n          temperature difference in degrees [degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`R`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_resistance\"}\n            target={\"_blank\"}\n          >\n            Thermal Resistance\n          </StyledLink>{\" \"}\n          in degrees Kelvin per Watt [degK/W]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent\n            display={false}\n            tex={String.raw`q_{generated/consumed}`}\n          />{\" \"}\n          is the net heat generated or consumed, in Watts [W]\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        This partial differential equation can be converted to a numerical\n        equation with reasonable results assuming the time step between discrete\n        states is small. In using hotstuff.network, you&apos;ll notice that as\n        you increase the time step and rerun a model, unstable results\n        eventually show up - errors compound at each step and blow up the\n        temperature differences to unreasonable numbers. If you see instability,\n        decrease the time step size.\n      </StyledText>\n\n      <StyledText>\n        Assuming small time steps, this equation holds for each node in the\n        model:\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`\\Delta T_{node} = \\frac{\\Delta{t}}{C_{node}}(\\sum{\\frac{T_{other\\_node} - T_{node}}{R_{other\\_node \\leftrightarrow node}}} - q_{generated/consumed})`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta{T}_{node}`} />{\" \"}\n          is the change in temperature of the node of interest at that time\n          step, in degrees [degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\Delta{t}`} /> is the\n          time step in seconds [s]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`C_{node}`} /> is{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Heat_capacity\"}\n            target={\"_blank\"}\n          >\n            Thermal Capacitance\n          </StyledLink>{\" \"}\n          , or Heat Capacity, of the node of interest in Joules per degree\n          Kelvin [J/degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`T_{other\\_node}`} /> is\n          the current temperature of a node that is thermally connected with the\n          node of interest in degrees [degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`T_{node}`} /> is the\n          current temperature the node of interest in degrees [degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent\n            display={false}\n            tex={String.raw`R_{other\\_node \\leftrightarrow node}`}\n          />{\" \"}\n          is the{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_resistance\"}\n            target={\"_blank\"}\n          >\n            Thermal Resistance\n          </StyledLink>{\" \"}\n          between the two thermally connected nodes in degrees Kelvin per Watt\n          [degK/W] if conduction or convection, or degrees Kelvin to the fourth\n          per Watt [degK^4/W] if radiation\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent\n            display={false}\n            tex={String.raw`q_{generated/consumed}`}\n          />{\" \"}\n          is the net heat generated or consumed by the node of interest, in\n          Watts [W]\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        Under the hood, hotstuff.network solves the above equation for each node\n        at each timestep, resulting in a set of simulated temperatures for each\n        node over the duration of the model.\n      </StyledText>\n\n      <StyledText>\n        Boundary condition nodes do not change temperature over time. They\n        influence nodes that are thermally connected to them, but their\n        calculated temperature difference at each time step is discarded rather\n        than added to their previous temperature.\n      </StyledText>\n\n      <StyledText>\n        Nodes can be thermally connected through Conduction, Convection, or\n        Radiation. The user should calculate thermal resistance differently\n        depending on the type of connection, as follows:\n      </StyledText>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`R_{conduction} = \\frac{L}{kA}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`L`} /> is the\n          conduction length, in meters [m]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`k`} /> is the{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Thermal_conductivity\"}\n            target={\"_blank\"}\n          >\n            Thermal Conductivity\n          </StyledLink>\n          , in Watts per meter per degrees Kelvin [W/m/degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`A`} /> is the\n          conduction area, in meters squared [m^2]\n        </StyledListItem>\n      </ul>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`R_{convection} = \\frac{1}{hA}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`h`} /> is the{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Heat_transfer_coefficient\"}\n            target={\"_blank\"}\n          >\n            Convective Heat Transfer Coefficient\n          </StyledLink>\n          , in Watts per meters squared per degrees Kelvin [W/m^2/degK]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`A`} /> is the\n          convection area, in meters squared [m^2]\n        </StyledListItem>\n      </ul>\n\n      <MathComponent\n        display={true}\n        tex={String.raw`R_{radiation} = \\frac{1}{\\epsilon \\sigma A}`}\n      />\n\n      <ul>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\epsilon`} /> is the{\" \"}\n          <StyledLink\n            href={\"https://en.wikipedia.org/wiki/Emissivity\"}\n            target={\"_blank\"}\n          >\n            Emissivity\n          </StyledLink>\n          , a unit-less quantity\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`\\sigma`} /> is the{\" \"}\n          <StyledLink\n            href={\n              \"https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_constant\"\n            }\n            target={\"_blank\"}\n          >\n            Stefan-Boltzmann constant\n          </StyledLink>\n          , 5.67 * 10^8 Watts per meters squared per degrees Kelvin to the\n          fourth [W/m^2/degK^4]\n        </StyledListItem>\n        <StyledListItem>\n          <MathComponent display={false} tex={String.raw`A`} /> is the radiation\n          area, in meters squared [m^2]\n        </StyledListItem>\n      </ul>\n\n      <StyledText>\n        In building your model, you&apos;ll primarily be concerned with\n        determining thermal resistances between nodes, thermal capacitances of\n        nodes, and power generation/consumption of each node in your model. From\n        there, hotstuff.network will do the rest.\n      </StyledText>\n\n      <StyledText>\n        The source code for the entire model can be seen{\" \"}\n        <StyledLink\n          href={\n            \"https://github.com/robinovitch61/hotstuff.network/tree/main/packages/hotstuff-network\"\n          }\n          target={\"_blank\"}\n        >\n          here as a standalone npm package\n        </StyledLink>{\" \"}\n        - contributions are welcome!\n      </StyledText>\n    </StyledTheoryModal>\n  );\n}\n","import * as React from \"react\";\nimport { useRef } from \"react\";\nimport { ModalState } from \"../../App\";\nimport styled from \"styled-components/macro\";\nimport useOnClickOutside from \"../../hooks/useOnClickOutside\";\nimport ConfirmationModal from \"./ConfirmationModal\";\nimport TheoryModal from \"./TheoryModal\";\n\nconst StyledModal = styled.div<{ visible: boolean }>`\n  font-size: 1.1em;\n  line-height: 1.4em;\n  position: absolute;\n  width: 80vw;\n  height: 90vh;\n  max-width: 1400px;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  border: 3px solid black;\n  z-index: 10;\n  background: white;\n  display: ${(props) => (props.visible ? \"flex\" : \"none\")};\n  justify-content: center;\n  align-items: center;\n`;\n\nconst StyledExitButton = styled.button`\n  position: absolute;\n  right: 1em;\n  top: 1em;\n  font-size: 1.2em;\n`;\n\nfunction getModalContent(\n  modalState: ModalState,\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>\n): React.ReactElement {\n  const type = modalState.type;\n\n  if (type === \"confirm\") {\n    return (\n      <ConfirmationModal\n        modalState={modalState}\n        setModalState={setModalState}\n      />\n    );\n  } else if (type === \"theory\") {\n    return <TheoryModal />;\n  } else {\n    return <h1>Coming Soon</h1>;\n  }\n}\n\ntype ModalProps = {\n  modalState: ModalState;\n  setModalState: React.Dispatch<React.SetStateAction<ModalState>>;\n};\n\nexport default function Modal(props: ModalProps): React.ReactElement {\n  const { modalState, setModalState } = props;\n\n  const modalRef = useRef<HTMLDivElement>(null);\n  useOnClickOutside(modalRef, () =>\n    setModalState((prev) => ({ ...prev, visible: false }))\n  );\n\n  const modalContent = getModalContent(modalState, setModalState);\n\n  return (\n    <StyledModal ref={modalRef} visible={modalState.visible}>\n      <StyledExitButton\n        onClick={() =>\n          setModalState((prevState) => ({\n            ...prevState,\n            visible: false,\n          }))\n        }\n      >\n        X\n      </StyledExitButton>\n      {modalContent}\n    </StyledModal>\n  );\n}\n","import * as React from \"react\";\nimport { useEffect } from \"react\";\n\nexport default function useOnClickOutside(\n  ref: React.RefObject<HTMLDivElement>,\n  onClickOutside: () => void\n): void {\n  useEffect(() => {\n    const listener = (\n      event: React.MouseEvent | MouseEvent | React.TouchEvent | TouchEvent\n    ) => {\n      // Do nothing if clicking ref's element or descendent elements\n      if (!ref.current || ref.current.contains(event.target as Node | null)) {\n        return;\n      }\n      onClickOutside();\n    };\n    document.addEventListener(\"mousedown\", listener);\n    document.addEventListener(\"touchstart\", listener);\n    return () => {\n      document.removeEventListener(\"mousedown\", listener);\n      document.removeEventListener(\"touchstart\", listener);\n    };\n  }, [ref, onClickOutside]);\n}\n","import { HSConnection, HSNode, ModelOutput, run } from \"hotstuff-network\";\nimport React, { useCallback, useMemo, useState } from \"react\";\nimport { Point } from \"./utils/pointUtils\";\nimport Sidebar from \"./components/Sidebar/Sidebar\";\nimport Plot from \"./components/Plot/Plot\";\nimport config from \"./config\";\nimport useWindowSize from \"./components/Canvas/hooks/useWindowSize\";\nimport Canvas, { CanvasViewState } from \"./components/Canvas/Canvas\";\nimport useDraw from \"./hooks/useDraw\";\nimport useDoubleClick from \"./hooks/useDoubleClick\";\nimport useNodeConnectionUtils from \"./hooks/useNodeConnectionUtils\";\nimport useOnMouseDown from \"./hooks/useOnMouseDown\";\nimport useKeyDown from \"./hooks/useKeyDown\";\nimport { defaultAppState, defaultModalState } from \"./default\";\nimport useSessionStorageState from \"./hooks/useSessionStorageState\";\nimport { getCanvasCenter } from \"./components/Canvas/canvasUtils\";\nimport {\n  getNewAppNode,\n  getNewPossibleConnection,\n} from \"./utils/nodeConnectionUtils\";\nimport useAppStateModifiers from \"./hooks/useAppStateModifiers\";\nimport useResizablePanels from \"./hooks/useResizablePanels\";\nimport {\n  StyledApp,\n  StyledCanvas,\n  StyledHorizontalBorder,\n  StyledVerticalBorder,\n  StyledWorkspace,\n} from \"./style\";\nimport Modal from \"./components/Modal/Modal\";\n\nconst { plotMargin, tabHeightPx, plotHeightBufferPx } = config;\n\nexport type Direction = \"L\" | \"R\" | \"U\" | \"D\";\n\nexport type AppNode = HSNode & {\n  center: Point;\n  isActive: boolean;\n  textDirection: Direction;\n};\n\nexport type AppConnection = HSConnection & {\n  sourceId: string; // duplicated data here to make working with tables easier\n  targetId: string; // duplicated data here to make working with tables easier\n};\n\nexport type Timing = {\n  timeStepS: number;\n  totalTimeS: number;\n};\n\nexport type PanelSizes = {\n  editorWidthFraction: number;\n  canvasHeightFraction: number;\n  tableHeightFraction: number;\n};\n\nexport type ModalType = \"theory\" | \"tutorial\" | \"about\" | \"confirm\";\n\nexport type ModalState = {\n  visible: boolean;\n  type: ModalType;\n  onConfirm?: () => void;\n  confirmText?: string[];\n};\n\nexport type AppState = {\n  output?: ModelOutput;\n  timing: Timing;\n  nodes: AppNode[];\n  connections: AppConnection[];\n  canvasViewState: CanvasViewState;\n  savedCanvasState: CanvasViewState;\n  panelSizes: PanelSizes;\n};\n\nexport default function App(): React.ReactElement {\n  const [appState, setAppState] = useSessionStorageState<AppState>(\n    defaultAppState,\n    \"hotstuffAppState\"\n  );\n\n  const [modalState, setModalState] = useState<ModalState>(defaultModalState);\n\n  const [\n    setAppNodes,\n    setAppConnections,\n    setCanvasViewState,\n    setSavedCanvasState,\n    setTiming,\n    setModelOutput,\n  ] = useAppStateModifiers(setAppState);\n\n  const [\n    addNode,\n    addConnection,\n    updateNodes,\n    deleteNodes,\n    updateConnections,\n    deleteConnections,\n    setActiveNodes,\n    clearActiveNodes,\n  ] = useNodeConnectionUtils(\n    appState.nodes,\n    setAppNodes,\n    appState.connections,\n    setAppConnections,\n    setModelOutput\n  );\n\n  const [keyboardActive, setKeyboardActive] = useState<boolean>(true);\n  useKeyDown(keyboardActive, appState.nodes, setAppNodes, deleteNodes);\n\n  const [draw, clearAndRedraw] = useDraw(appState.nodes, appState.connections);\n  const handleDoubleClick = useDoubleClick(\n    appState.nodes,\n    addNode,\n    updateNodes\n  );\n  const onMouseDown = useOnMouseDown(\n    appState.nodes,\n    appState.connections,\n    addConnection,\n    updateNodes,\n    setActiveNodes,\n    clearActiveNodes,\n    clearAndRedraw\n  );\n\n  const [size, ratio] = useWindowSize();\n  const [windowWidth, windowHeight] = size;\n\n  const [\n    canvasPlotBorderRef,\n    onMouseDownOnCanvasPlotBorder,\n    leftRightBorderRef,\n    onMouseDownOnLeftRightBorder,\n    tableControlsBorderRef,\n    onMouseDownOnTableControlsBorder,\n  ] = useResizablePanels(setAppState, windowHeight, windowWidth);\n\n  // width/heights\n  const workspaceWidth = windowWidth;\n  const workspaceHeight = windowHeight;\n  const canvasHeight = windowHeight * appState.panelSizes.canvasHeightFraction;\n  const canvasWidth =\n    windowWidth * (1 - appState.panelSizes.editorWidthFraction);\n  const plotHeight =\n    (1 - appState.panelSizes.canvasHeightFraction) * windowHeight -\n    tabHeightPx -\n    plotHeightBufferPx;\n  const plotWidth = canvasWidth;\n  const editorWidth = appState.panelSizes.editorWidthFraction * windowWidth;\n\n  const plot = useMemo(() => {\n    return (\n      <Plot\n        plotDimensions={{\n          height: plotHeight,\n          width: plotWidth,\n          margin: plotMargin,\n        }}\n        modelOutput={appState.output}\n      />\n    );\n  }, [appState.output, plotHeight, plotWidth]);\n\n  const addNodeInCenterOfCanvas = useCallback(() => {\n    addNode(\n      getNewAppNode(\n        appState.nodes,\n        getCanvasCenter(\n          canvasWidth,\n          canvasHeight,\n          appState.canvasViewState.offset,\n          appState.canvasViewState.scale\n        )\n      )\n    );\n  }, [\n    addNode,\n    appState.canvasViewState.offset,\n    appState.canvasViewState.scale,\n    appState.nodes,\n    canvasHeight,\n    canvasWidth,\n  ]);\n\n  const createNewLogicalConnection = useCallback(() => {\n    const newConnection = getNewPossibleConnection(\n      appState.nodes,\n      appState.connections\n    );\n    if (newConnection !== undefined) {\n      addConnection(newConnection);\n    }\n  }, [addConnection, appState.connections, appState.nodes]);\n\n  return (\n    <div>\n      <Modal modalState={modalState} setModalState={setModalState} />\n      <StyledApp height={windowHeight} modalOpen={modalState.visible}>\n        <StyledHorizontalBorder\n          ref={canvasPlotBorderRef}\n          onMouseDown={onMouseDownOnCanvasPlotBorder}\n          y={appState.panelSizes.canvasHeightFraction}\n          width={1 - appState.panelSizes.editorWidthFraction}\n          left={0}\n        />\n        <StyledVerticalBorder\n          ref={leftRightBorderRef}\n          onMouseDown={onMouseDownOnLeftRightBorder}\n          x={1 - appState.panelSizes.editorWidthFraction}\n        />\n        <StyledHorizontalBorder\n          ref={tableControlsBorderRef}\n          onMouseDown={onMouseDownOnTableControlsBorder}\n          y={appState.panelSizes.tableHeightFraction}\n          width={appState.panelSizes.editorWidthFraction}\n          left={1 - appState.panelSizes.editorWidthFraction}\n        />\n\n        <StyledWorkspace\n          height={workspaceHeight}\n          width={(1 - appState.panelSizes.editorWidthFraction) * workspaceWidth}\n        >\n          <StyledCanvas height={canvasHeight}>\n            <Canvas\n              canvasWidth={canvasWidth}\n              canvasHeight={canvasHeight}\n              devicePixelRatio={ratio}\n              draw={draw}\n              onMouseDown={onMouseDown}\n              handleDoubleClick={handleDoubleClick}\n              canvasViewState={appState.canvasViewState}\n              setCanvasViewState={setCanvasViewState}\n              savedCanvasViewState={appState.savedCanvasState}\n              setSavedCanvasViewState={setSavedCanvasState}\n              setKeyboardActive={setKeyboardActive}\n              setModalState={setModalState}\n            />\n          </StyledCanvas>\n          {plot}\n        </StyledWorkspace>\n        <Sidebar\n          appState={appState}\n          setAppState={setAppState}\n          setModalState={setModalState}\n          height={windowHeight}\n          width={editorWidth}\n          setTiming={setTiming}\n          onAddNode={addNodeInCenterOfCanvas}\n          onAddConnection={createNewLogicalConnection}\n          updateNodes={(nodes: AppNode[]) => {\n            updateNodes(nodes);\n            setModelOutput(undefined);\n          }}\n          deleteNodes={deleteNodes}\n          updateConnections={(conns: AppConnection[]) => {\n            updateConnections(conns);\n            setModelOutput(undefined);\n          }}\n          deleteConnections={deleteConnections}\n          onRunModel={() => {\n            const output = run({\n              nodes: appState.nodes,\n              connections: appState.connections,\n              timeStepS: appState.timing.timeStepS,\n              totalTimeS: appState.timing.totalTimeS,\n            });\n            if (output.errors?.length) {\n              output.errors.forEach((error) => console.error(error.message));\n            }\n            setModelOutput(output);\n          }}\n        />\n      </StyledApp>\n    </div>\n  );\n}\n","import * as React from \"react\";\n\nexport default function useSessionStorageState<T>(\n  defaultValue: T,\n  key: string\n): [T, React.Dispatch<React.SetStateAction<T>>] {\n  const [value, setValue] = React.useState<T>(() => {\n    const localState = window.sessionStorage.getItem(key);\n    if (localState === null || localState === undefined) {\n      return defaultValue;\n    } else {\n      return JSON.parse(localState) as T;\n    }\n  });\n\n  React.useEffect(() => {\n    window.sessionStorage.setItem(key, JSON.stringify(value));\n  }, [key, value]);\n  return [value, setValue];\n}\n","import * as React from \"react\";\nimport { useCallback } from \"react\";\nimport { CanvasViewState } from \"../components/Canvas/Canvas\";\nimport { ModelOutput } from \"hotstuff-network\";\nimport { AppConnection, AppNode, AppState, Timing } from \"../App\";\n\nexport default function useAppStateModifiers(\n  setAppState: React.Dispatch<React.SetStateAction<AppState>>\n): [\n  (newNodes: AppNode[]) => void,\n  (newConnections: AppConnection[]) => void,\n  (newCanvasState: CanvasViewState) => void,\n  (newCanvasState: CanvasViewState) => void,\n  (newTiming: Timing) => void,\n  (newModelOutput: ModelOutput | undefined) => void\n] {\n  const setAppNodes = useCallback(\n    (newNodes: AppNode[]) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        nodes: newNodes,\n      }));\n    },\n    [setAppState]\n  );\n\n  const setAppConnections = useCallback(\n    (newConnections: AppConnection[]) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        connections: newConnections,\n      }));\n    },\n    [setAppState]\n  );\n\n  const setCanvasViewState = useCallback(\n    (newCanvasState: CanvasViewState) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        canvasViewState: newCanvasState,\n      }));\n    },\n    [setAppState]\n  );\n\n  const setSavedCanvasState = useCallback(\n    (newSavedCanvasState: CanvasViewState) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        savedCanvasState: newSavedCanvasState,\n      }));\n    },\n    [setAppState]\n  );\n\n  const setTiming = useCallback(\n    (newTiming: Timing) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        timing: newTiming,\n        output: undefined,\n      }));\n    },\n    [setAppState]\n  );\n\n  const setModelOutput = useCallback(\n    (newModelOutput: ModelOutput | undefined) => {\n      setAppState((prevState) => ({\n        ...prevState,\n        output: newModelOutput,\n      }));\n    },\n    [setAppState]\n  );\n\n  return [\n    setAppNodes,\n    setAppConnections,\n    setCanvasViewState,\n    setSavedCanvasState,\n    setTiming,\n    setModelOutput,\n  ];\n}\n","import { useCallback } from \"react\";\nimport { AppConnection, AppNode } from \"../App\";\nimport { ModelOutput } from \"hotstuff-network\";\n\nexport default function useNodeConnectionUtils(\n  appNodes: AppNode[],\n  setAppNodes: (newNodes: AppNode[]) => void,\n  appConnections: AppConnection[],\n  setAppConnections: (newConnections: AppConnection[]) => void,\n  setModelOutput: (newModelOutput: ModelOutput | undefined) => void\n): [\n  (node: AppNode) => void,\n  (connection: AppConnection) => void,\n  (nodesToUpdate: AppNode[], clearActiveNodes?: boolean) => void,\n  (nodeIds: string[]) => void,\n  (connsToUpdate: AppConnection[]) => void,\n  (connIds: string[]) => void,\n  (activeNodeIds: string[]) => void,\n  () => void\n] {\n  const addNode = useCallback(\n    (node: AppNode) => {\n      const newNodes = appNodes.map((node) => ({\n        ...node,\n        isActive: false,\n      }));\n      newNodes.push({ ...node, isActive: true });\n      setAppNodes(newNodes);\n      setModelOutput(undefined);\n    },\n    [appNodes, setAppNodes, setModelOutput]\n  );\n\n  const addConnection = useCallback(\n    (connection: AppConnection) => {\n      setAppConnections([...appConnections, connection]);\n      setModelOutput(undefined);\n    },\n    [appConnections, setAppConnections, setModelOutput]\n  );\n\n  const updateNodes = useCallback(\n    (nodesToUpdate: AppNode[], clearActiveNodes = false) => {\n      const newNodes = appNodes.map((node) => {\n        const nodeToUpdate = nodesToUpdate.find(\n          (newNode) => newNode.id === node.id\n        );\n        if (nodeToUpdate) {\n          return nodeToUpdate;\n        } else {\n          if (clearActiveNodes) {\n            return { ...node, isActive: false };\n          } else {\n            return node;\n          }\n        }\n      });\n      setAppNodes(newNodes);\n\n      const newConnections = appConnections.map((prevConn) => {\n        const newSourceNode = nodesToUpdate.find(\n          (nodeToUpdate) => prevConn.source.id == nodeToUpdate.id\n        );\n        if (newSourceNode) {\n          return {\n            ...prevConn,\n            source: newSourceNode,\n            sourceId: newSourceNode.id,\n          };\n        }\n\n        const newTargetNode = nodesToUpdate.find(\n          (nodeToUpdate) => prevConn.target.id == nodeToUpdate.id\n        );\n        if (newTargetNode) {\n          return {\n            ...prevConn,\n            target: newTargetNode,\n            targetId: newTargetNode.id,\n          };\n        }\n        return prevConn;\n      });\n      setAppConnections(newConnections);\n    },\n    [appConnections, appNodes, setAppConnections, setAppNodes]\n  );\n\n  const deleteNodes = useCallback(\n    (nodeIds: string[]) => {\n      const newConnections = appConnections.filter(\n        (conn) =>\n          !nodeIds.includes(conn.source.id) && !nodeIds.includes(conn.target.id)\n      );\n      setAppConnections(newConnections);\n      setModelOutput(undefined);\n\n      const newNodes = appNodes.filter((node) => !nodeIds.includes(node.id));\n      setAppNodes(newNodes);\n    },\n    [appConnections, appNodes, setAppConnections, setAppNodes, setModelOutput]\n  );\n\n  const updateConnections = useCallback(\n    (connsToUpdate: AppConnection[]) => {\n      const connIdsToUpdate = connsToUpdate.map((conn) => conn.id);\n      const oldConns = appConnections.filter(\n        (conn) => !connIdsToUpdate.includes(conn.id)\n      );\n      setAppConnections([...connsToUpdate, ...oldConns]);\n      setModelOutput(undefined);\n    },\n    [appConnections, setAppConnections, setModelOutput]\n  );\n\n  const deleteConnections = useCallback(\n    (connIds: string[]) => {\n      setAppConnections(\n        appConnections.filter((conn) => !connIds.includes(conn.id))\n      );\n      setModelOutput(undefined);\n    },\n    [appConnections, setAppConnections, setModelOutput]\n  );\n\n  const setActiveNodes = useCallback(\n    (activeNodeIds: string[]) => {\n      setAppNodes(\n        appNodes.map((node) => ({\n          ...node,\n          isActive: activeNodeIds.includes(node.id),\n        }))\n      );\n    },\n    [appNodes, setAppNodes]\n  );\n\n  const clearActiveNodes = useCallback(() => {\n    const anyActiveNodes = appNodes.find((node) => node.isActive) !== undefined;\n    if (anyActiveNodes) {\n      setAppNodes(\n        appNodes.map((node) => ({\n          ...node,\n          isActive: false,\n        }))\n      );\n    }\n  }, [appNodes, setAppNodes]);\n\n  return [\n    addNode,\n    addConnection,\n    updateNodes,\n    deleteNodes,\n    updateConnections,\n    deleteConnections,\n    setActiveNodes,\n    clearActiveNodes,\n  ];\n}\n","import React, { useEffect } from \"react\";\nimport { AppNode } from \"../App\";\n\nexport default function useKeyDown(\n  keyboardActive: boolean,\n  appNodes: AppNode[],\n  setAppNodes: (newNodes: AppNode[]) => void,\n  deleteNodes: (nodeIds: string[]) => void\n): void {\n  useEffect(() => {\n    const onKeyDown = (event: React.KeyboardEvent | KeyboardEvent) => {\n      if (keyboardActive) {\n        // meta + A makes all nodes active\n        if (event.metaKey && event.keyCode === 65) {\n          event.preventDefault();\n          setAppNodes(\n            appNodes.map((node) => {\n              return { ...node, isActive: true };\n            })\n          );\n        }\n\n        // delete active nodes on back/del\n        if (event.key === \"Backspace\" || event.key === \"Delete\") {\n          event.preventDefault();\n          deleteNodes(\n            appNodes.filter((node) => node.isActive).map((node) => node.id)\n          );\n        }\n\n        // escape key makes all inactive\n        if (event.keyCode === 27) {\n          setAppNodes(appNodes.map((node) => ({ ...node, isActive: false })));\n        }\n      }\n    };\n    document.addEventListener(\"keydown\", onKeyDown);\n    return () => document.removeEventListener(\"keydown\", onKeyDown);\n  }, [appNodes, deleteNodes, keyboardActive, setAppNodes]);\n}\n","import React, { useCallback } from \"react\";\nimport { CanvasState } from \"../components/Canvas/Canvas\";\nimport {\n  determineRadius,\n  intersectsCircle,\n  mouseToNodeCoords,\n  rotatedDirection,\n} from \"../components/Canvas/canvasUtils\";\nimport { AppNode } from \"../App\";\nimport { getNewAppNode } from \"../utils/nodeConnectionUtils\";\nimport config from \"../config\";\n\nexport default function useDoubleClick(\n  appNodes: AppNode[],\n  addNode: (node: AppNode) => void,\n  updateNodes: (nodes: AppNode[]) => void\n): (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => void {\n  return useCallback(\n    (event: React.MouseEvent | MouseEvent, canvasState: CanvasState) => {\n      event.preventDefault();\n      if (config.multiSelectKeys.some((k) => event[k])) {\n        return;\n      }\n\n      const nodeCoordsOfMouse = mouseToNodeCoords(event, canvasState);\n\n      const doubleClickedNode = appNodes.find((node) => {\n        const nodeRadius = determineRadius(\n          node.capacitanceJPerDegK,\n          appNodes.map((node) => node.capacitanceJPerDegK)\n        );\n        return intersectsCircle(nodeCoordsOfMouse, node.center, nodeRadius);\n      });\n\n      if (doubleClickedNode) {\n        updateNodes([\n          {\n            ...doubleClickedNode,\n            textDirection: rotatedDirection(doubleClickedNode.textDirection),\n          },\n        ]);\n      } else {\n        const newAppNode = getNewAppNode(appNodes, nodeCoordsOfMouse);\n        addNode(newAppNode);\n      }\n    },\n    [addNode, appNodes, updateNodes]\n  );\n}\n","import { useLayoutEffect, useState } from \"react\";\n\nexport default function useWindowSize(): [[number, number], number] {\n  const [size, setSize] = useState<[number, number]>([0, 0]);\n  const [ratio, setRatio] = useState(1);\n\n  useLayoutEffect(() => {\n    function updateSize() {\n      setSize([window.innerWidth, window.innerHeight]);\n    }\n    function updateRatio() {\n      const { devicePixelRatio: ratio = 1 } = window;\n      setRatio(ratio);\n    }\n    window.addEventListener(\"resize\", updateSize);\n    window.addEventListener(\"resize\", updateRatio);\n    updateSize();\n    updateRatio();\n    return () => {\n      window.removeEventListener(\"resize\", updateSize);\n      window.removeEventListener(\"resize\", updateRatio);\n    };\n  }, []);\n  return [size, ratio];\n}\n","export function forceShowScrollbars(): void {\n  // Returns whether scrollbars show up on scrollable elements.\n  // This is false on Macs when the \"General > Show scroll bars\" setting is\n  // not set to \"Always\" (the default is \"When scrolling\"). The approach\n  // taken here is to create an element that will scroll and then compare\n  // its outer width (including scrollbars) to its inner width (excluding\n  // scrollbars).\n  function areScrollbarsVisible() {\n    const scrollableElem = document.createElement(\"div\"),\n      innerElem = document.createElement(\"div\");\n    scrollableElem.style.width = \"30px\";\n    scrollableElem.style.height = \"30px\";\n    scrollableElem.style.overflow = \"scroll\";\n    scrollableElem.style.borderWidth = \"0\";\n    innerElem.style.width = \"30px\";\n    innerElem.style.height = \"60px\";\n    scrollableElem.appendChild(innerElem);\n    document.body.appendChild(scrollableElem); // Elements only have width if they're in the layout\n    const diff = scrollableElem.offsetWidth - scrollableElem.clientWidth;\n    document.body.removeChild(scrollableElem);\n    return diff > 0;\n  }\n\n  window.addEventListener(\"load\", function () {\n    // Show scrollbars if they're hidden.\n    if (!areScrollbarsVisible()) {\n      document.body.classList.add(\"force-show-scrollbars\");\n    }\n  });\n}\n","import * as React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport { forceShowScrollbars } from \"./utils/scrollBar\";\n\nforceShowScrollbars();\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}